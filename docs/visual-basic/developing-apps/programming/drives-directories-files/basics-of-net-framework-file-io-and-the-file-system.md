---
title: "Основы файлового ввода-вывода и файловой системы в .NET Framework (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "2015-07-20"
ms.prod: ".net"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-visual-basic"
ms.topic: "article"
dev_langs: 
  - "VB"
helpviewer_keywords: 
  - "доступ к файлу, файл ввода-вывода Visual Basic"
  - "атрибуты файла, определение"
  - "потоки, основные операции"
  - "разрешения файла"
  - "потоки"
  - "потоки, определение"
ms.assetid: 49d837c0-cf28-416f-8606-4d83d7b479ef
caps.latest.revision: 30
author: "stevehoag"
ms.author: "shoag"
caps.handback.revision: 30
---
# Основы файлового ввода-вывода и файловой системы в .NET Framework (Visual Basic)
[!INCLUDE[vs2017banner](../../../../visual-basic/includes/vs2017banner.md)]

Классы в пространстве имен <xref:System.IO> используются для работы с дисками, файлами и каталогами.  
  
 Пространство имен <xref:System.IO> содержит классы <xref:System.IO.File> и <xref:System.IO.Directory>, обеспечивающие функциональные возможности [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)] для работы с файлами и каталогами. Поскольку методы этих объектов являются статическими или общими элементами, их можно использовать непосредственно, без предварительного создания экземпляра класса. С этими классами связаны классы <xref:System.IO.FileInfo> и <xref:System.IO.DirectoryInfo>, которые знакомы пользователям функции `My`. Чтобы использовать эти классы, необходимо полностью уточнить имена или импортировать подходящие пространства имен, включив операторы `Imports` в начало соответствующего кода. Дополнительные сведения см. в статье [Оператор Imports (пространство имен .NET и тип)](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md).  
  
> [!NOTE]
>  В других подразделах этого раздела для работы с дисками, файлами и каталогами вместо класса `My.Computer.FileSystem` используется объект `System.IO`. Объект `My.Computer.FileSystem` предназначен главным образом для использования в программах [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)]. Классы `System.IO` предназначены для использования в любом языке, который поддерживает [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)], в том числе [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb-md.md)].  
  
## <a name="definition-of-a-stream"></a>Определение потока  
 [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)] использует потоки для поддержки чтения и записи файлов. Поток можно представить в виде одномерного набора связанных данных, у которого есть начало и конец, где курсор указывает текущее положение в потоке.  
  
 ![Курсор показывает текущую позицию в filestream.](../../../../visual-basic/developing-apps/programming/drives-directories-files/media/filestream.gif "FileStream")  
  
## <a name="stream-operations"></a>Потоковые операции  
 Данные, содержащиеся в потоке, могут поступать из памяти, файла или сокета TCP/IP. Потоки имеют основные операции, которые могут быть применены к ним:  
  
-   Чтение. Вы можете выполнять чтение из потока, передавая данные в структуру данных, например строку или массив байтов.  
  
-   **Запись**. Вы можете выполнять запись в поток, передавая данные из источника данных в поток.  
  
-   **Поиск**. Вы можете запрашивать и изменять положение в потоке.  
  
 Для получения дополнительной информации см. [Composing Streams](../Topic/Composing%20Streams.md).  
  
## <a name="types-of-streams"></a>Типы потоков  
 В [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)] поток представлен классом <xref:System.IO.Stream>, который образует абстрактный класс для всех других потоков. Вы не можете непосредственно создать экземпляр класса <xref:System.IO.Stream>. Вместо него вы должны использовать один из реализуемых им классов.  
  
 Существует много типов потоков, но при работе с файловым вводом-выводом наиболее важными типами являются класс <xref:System.IO.FileStream>, который предоставляет способ чтения и записи файлов, и класс <xref:System.IO.IsolatedStorage.IsolatedStorageFileStream>, который предоставляет способ создания файлов и каталогов в изолированном хранилище. К другим потокам, которые можно использовать при работе с файловым вводом-выводом, относятся следующие:  
  
-   <xref:System.IO.BufferedStream>;  
  
-   <xref:System.Security.Cryptography.CryptoStream>;  
  
-   <xref:System.IO.MemoryStream>;  
  
-   <xref:System.Net.Sockets.NetworkStream>.  
  
 В следующей таблице перечислены типичные задачи, выполняемые с помощью потока:  
  
|||  
|-|-|  
|Задача|См. статью|  
|Чтение и запись файла данных|[Практическое руководство. Считывание из нового файла данных и запись в этот файл](../Topic/How%20to:%20Read%20and%20Write%20to%20a%20Newly%20Created%20Data%20File.md)|  
|Чтение текста из файла|[Практическое руководство. Считывание текста из файла](../Topic/How%20to:%20Read%20Text%20from%20a%20File.md)|  
|Запись текста в файл|[Практическое руководство. Запись текста в файл](../Topic/How%20to:%20Write%20Text%20to%20a%20File.md)|  
|Считывание символов из строки|[Практическое руководство. Считывание символов из строки](../Topic/How%20to:%20Read%20Characters%20from%20a%20String.md)|  
|Запись символов в строку|[Практическое руководство. Запись символов в строку](../Topic/How%20to:%20Write%20Characters%20to%20a%20String.md)|  
|Шифрование данных|[Шифрование данных](../Topic/Encrypting%20Data.md)|  
|Расшифровка данных|[Расшифровка данных](../Topic/Decrypting%20Data.md)|  
  
## <a name="file-access-and-attributes"></a>Доступ к файлам и атрибуты  
 Вы можете управлять созданием, открытием файлов и их совместным использованием, используя перечисления <xref:System.IO.FileAccess>, <xref:System.IO.FileMode> и <xref:System.IO.FileShare>, которые содержат флаги, используемые конструкторами класса <xref:System.IO.FileStream>. Например, когда вы открываете или создаете новый поток <xref:System.IO.FileStream>, перечисление <xref:System.IO.FileMode> позволяет указать, открывается ли файл для добавления, следует ли создать новый файл, если указанный файл не существует, будет ли перезаписан существующий файл и т. д.  
  
 Перечисление <xref:System.IO.FileAttributes> активирует сбор относящихся к файлу сведений. <xref:System.IO.FileAttributes> возвращает сохраненные атрибуты файла, например, является ли он сжатым, зашифрованным, скрытым, доступным только для чтения, архивом, каталогом, системным файлом или временным файлом.  
  
 В следующей таблице перечислены задачи, касающиеся доступа к файлам и атрибутов файлов:  
  
|||  
|-|-|  
|**Задача**|**См. статью**|  
|Открытие файла журнала и добавление в него текста|[Практическое руководство. Открытие файла журнала и добавление в него данных](../Topic/How%20to:%20Open%20and%20Append%20to%20a%20Log%20File.md)|  
|Определение атрибутов файла|<xref:System.IO.FileAttributes>|  
  
## <a name="file-permissions"></a>Разрешения файла  
 Доступом к файлам и каталогам можно управлять с помощью класса <xref:System.Security.Permissions.FileIOPermission>. Это может быть особенно важно для разработчиков, работающих с веб-формами, которые по умолчанию выполняются в контексте специальной локальной учетной записи пользователя ASP.NET, создаваемой в рамках установок [!INCLUDE[vstecasp](../../../../csharp/language-reference/preprocessor-directives/includes/vstecasp-md.md)] и [!INCLUDE[dnprdnshort](../../../../csharp/getting-started/includes/dnprdnshort-md.md)]. Когда такое приложение запрашивает доступ к ресурсу, учетная запись пользователя ASP.NET имеет ограниченные разрешения, что может помешать пользователю выполнять действия, такие как запись в файл из веб-приложения. Дополнительные сведения см. в статьях о [разрешениях безопасности](http://msdn.microsoft.com/ru-ru/b03757b4-e926-4196-b738-3733ced2bda0) и <xref:System.Security.Permissions.FileIOPermission>.  
  
## <a name="isolated-file-storage"></a>Изолированное хранилище файлов  
 Изолированное хранилище — это попытка устранить проблемы, которые могут возникать, если при работе с файлами у пользователя или кода отсутствуют необходимые разрешения. Изолированное хранилище назначает каждому пользователю секцию данных, которая может содержать одно или несколько хранилищ. Хранилища могут изолироваться друг от друга по пользователю или по сборке. Доступ к хранилищу имеет только пользователь и сборка, которые его создали. Хранилище действует в качестве полноценной виртуальной файловой системы — в пределах одного хранилища можно создавать и использовать каталоги и файлы.  
  
 В следующей таблице перечислены типичные задачи, связанные с изолированным хранилищем файлов.  
  
|||  
|-|-|  
|Задача|См. статью|  
|Создание изолированного хранилища|[Практическое руководство. Получение хранилищ для изолированного хранения](../Topic/How%20to:%20Obtain%20Stores%20for%20Isolated%20Storage.md)|  
|Перечисление изолированных хранилищ|[Практическое руководство. Перечисление хранилищ для изолированного хранилища](../Topic/How%20to:%20Enumerate%20Stores%20for%20Isolated%20Storage.md)|  
|Удаление изолированного хранилища|[Практическое руководство. Удаление хранилищ из области изолированного хранения](../Topic/How%20to:%20Delete%20Stores%20in%20Isolated%20Storage.md)|  
|Создание файла или каталога в изолированном хранилище|[Практическое руководство. Создание файлов и каталогов в изолированном хранилище](../Topic/How%20to:%20Create%20Files%20and%20Directories%20in%20Isolated%20Storage.md)|  
|Поиск файла в изолированном хранилище|[Практическое руководство. Поиск существующих файлов и каталогов в изолированном хранилище](../Topic/How%20to:%20Find%20Existing%20Files%20and%20Directories%20in%20Isolated%20Storage.md)|  
|Чтение или запись файла в изолированном хранилище|[Практическое руководство. Считывание из файлов и запись в файлы в изолированном хранилище](../Topic/How%20to:%20Read%20and%20Write%20to%20Files%20in%20Isolated%20Storage.md)|  
|Удаление файла или каталога в изолированном хранилище|[Практическое руководство. Удаление файлов и каталогов из изолированного хранилища](../Topic/How%20to:%20Delete%20Files%20and%20Directories%20in%20Isolated%20Storage.md)|  
  
## <a name="file-events"></a>События файлов  
 Компонент <xref:System.IO.FileSystemWatcher> позволяет наблюдать за изменениями в файлах и каталогах в локальной системе или на любом компьютере, к которому есть доступ по сети. Например, при изменении файла можно отправить пользователю соответствующее оповещение. При внесении изменений выдается одно или несколько событий, которые сохраняются в буфере и передаются в компонент <xref:System.IO.FileSystemWatcher> для обработки.  
  
## <a name="see-also"></a>См. также  
 [Составление потоков](../Topic/Composing%20Streams.md)   
 [Файловый и потоковый ввод-вывод](../Topic/File%20and%20Stream%20I-O.md)   
 [Асинхронный файловый ввод-вывод](../Topic/Asynchronous%20File%20I-O.md)   
 [Классы, используемые при файловом вводе-выводе в .NET Framework, и файловая система (Visual Basic)](../../../../visual-basic/developing-apps/programming/drives-directories-files/classes-used-in-net-framework-file-io-and-the-file-system.md)