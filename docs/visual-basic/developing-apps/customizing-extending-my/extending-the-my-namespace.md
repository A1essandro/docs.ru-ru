---
title: "Расширение пространства имен My в Visual Basic | Документы Microsoft"
ms.date: 2015-07-20
ms.prod: .net
ms.technology:
- devlang-visual-basic
ms.topic: article
f1_keywords:
- vb.AddingMyExtensions
dev_langs:
- VB
helpviewer_keywords:
- My namespace, customizing
- My namespace
- My namespace, extending
ms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e
caps.latest.revision: 13
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: 1d1e957536f35b81a9672994c9d4d261afb764ea
ms.lasthandoff: 03/13/2017

---
# <a name="extending-the-my-namespace-in-visual-basic"></a>Расширение пространства имен My в Visual Basic
`My` Имен в Visual Basic предоставляет свойства и методы, позволяющие легко воспользоваться преимуществами возможности платформы .NET Framework. `My` Имен упрощает типовых задач программирования, часто сводя сложную задачу к одной строке кода. Кроме того `My` пространства имен является полностью расширяемым, что можно настроить поведение `My` и добавлять новые службы в его иерархию для адаптации к потребностям конкретного приложения. В этом разделе обсуждается настройка существующих членов `My` пространства имен и добавить пользовательские классы для `My` пространства имен.  
  
 **Содержание раздела**  
  
-   [Настройка существующих элементов пространства имен My](#customizing)  
  
-   [Добавление элементов в объекты My](#addingtoobjects)  
  
-   [Добавление пользовательских объектов в пространство имен My](#addingcustom)  
  
-   [Добавление элементов в пространство имен My](#addingtonamespace)  
  
-   [Добавление событий в пользовательские объекты](#addingevents)  
  
-   [Рекомендации по проектированию](#design)  
  
-   [Разработка библиотек классов для My](#designing)  
  
-   [Упаковка и развертывание расширений](#packaging)  
  
##  <a name="customizing"></a>Настройка существующих элементов пространства имен My  
 `My` Имен в Visual Basic предоставляет часто используемые сведения о приложении, компьютере и т.д. Полный список объектов в `My` пространства имен, в разделе [Мои ссылки](../../../visual-basic/language-reference/keywords/my-reference.md). Возможно, вам потребуется настроить существующие члены `My` пространства имен, чтобы они лучше соответствовали требованиям приложения. Любое свойство объекта в `My` пространства имен, не только для чтения можно задать пользовательское значение.  
  
 Например, предположим, вы часто используете `My.User` объекта для доступа к текущему контексту безопасности пользователя, запустившего приложение. Тем не менее вашей компании использует нестандартный объект пользователя для предоставления дополнительных сведений и возможностей для пользователей компании. В этом случае можно заменить значение по умолчанию `My.User.CurrentPrincipal` свойства с экземпляром собственного пользовательского объекта-участника, как показано в следующем примере.  
  
 [!code-vb[VbVbcnExtendingMy&#1;](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_1.vb)]  
  
 Установка `CurrentPrincipal` свойство `My.User` объекта изменяется удостоверение, под которой запускается приложение. `My.User` Объект, в свою очередь, возвращает сведения о вновь заданном пользователе.  
  
##  <a name="addingtoobjects"></a>Добавление элементов в объекты My  
 Типы, возвращаемые `My.Application` и `My.Computer` определяются как `Partial` классы. Таким образом, можно расширить `My.Application` и `My.Computer` объектов путем создания `Partial` класс с именем `MyApplication` или `MyComputer`. Класс не может быть `Private` класса. Если класс задан как часть `My` пространства имен, можно добавить свойства и методы, которые будут включены в `My.Application` или `My.Computer` объектов.  
  
 Например, в следующем примере добавляется свойство с именем `DnsServerIPAddresses` для `My.Computer` объектов.  
  
 [!code-vb[VbVbcnExtendingMy&#2;](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_2.vb)]  
  
##  <a name="addingcustom"></a>Добавление пользовательских объектов в пространство имен My  
 Хотя `My` пространство имен предоставляет решения для многие часто встречающиеся задачи программирования, встречаются задачи, `My` пространства имен не рассматриваются. Например приложение может получить доступ к пользовательским службам каталогов для пользовательских данных, или ваше приложение может использовать сборки, которые не устанавливаются по умолчанию вместе с Visual Basic. Вы можете расширить `My` пространство имен и включить пользовательские решения типовых задач, относящихся к вашей среде. `My` Пространство имен можно легко расширить для добавления новых элементов для удовлетворения растущих потребностей приложения. Кроме того, можно развертывать на `My` расширения пространства имен для других разработчиков в качестве шаблона Visual Basic.  
  
###  <a name="addingtonamespace"></a>Добавление элементов в пространство имен My  
 Поскольку `My` — это пространство имен как любое другое пространство имен, можно добавлять свойства верхнего уровня к нему, просто добавив модуль и указав `Namespace` из `My`. Снабдите модуль `HideModuleName` атрибут, как показано в следующем примере. `HideModuleName` Атрибута гарантирует, что технология IntelliSense не будет отображать имя модуля при отображении элементов из `My` пространства имен.  
  
 [!code-vb[VbVbcnExtendingMy&#3;](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_3.vb)]  
  
 Добавление членов в `My` пространства имен, добавить свойства для модуля. Для каждого свойства, добавляемого `My` пространства имен, добавьте закрытое поле типа `ThreadSafeObjectProvider(Of T)`, где типом является тип, возвращаемый вашим пользовательским свойством. Это поле используется для создания экземпляров потокобезопасных объектов возвращается свойством путем вызова `GetInstance` метод. В результате каждый поток, который обращается к расширенное свойство получает собственный экземпляр возвращаемого типа. В следующем примере добавляется свойство с именем `SampleExtension` типа `SampleExtension` для `My` пространство имен:  
  
 [!code-vb[VbVbcnExtendingMy&#4;](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_4.vb)]  
  
##  <a name="addingevents"></a>Добавление событий в пользовательские объекты  
 Можно использовать `My.Application` объект для предоставления событий пользовательским `My` объектов путем расширения `MyApplication` разделяемого класса в `My` пространства имен. Для проектов Windows можно дважды щелкнуть **Мой проект** узел проекта в **обозревателе решений**. В Visual Basic **конструктора проектов**, нажмите кнопку `Application` и нажмите кнопку `View Application Events` кнопки. Будет создан новый файл с именем ApplicationEvents.vb. Он содержит следующий код для расширения `MyApplication` класса.  
  
 [!code-vb[VbVbcnExtendingMy&#5;](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_5.vb)]  
  
 Можно добавить обработчики событий для настраиваемых `My` объекты, добавив пользовательские обработчики событий для `MyApplication` класса. Пользовательские события позволяют добавлять код, который будет выполняться при добавлении обработчика событий, удалении или события. Обратите внимание, что `AddHandler` кода для пользовательского события выполняется только в том случае, если код добавлен пользователем для обработки события. Предположим, что `SampleExtension` объект из предыдущего раздела имеет `Load` событие, которое требуется добавить пользовательский обработчик. В следующем примере кода показан пользовательский обработчик событий с именем `SampleExtensionLoad` , который будет вызываться при `My.SampleExtension.Load` событием. При добавлении кода для обработки нового `My.SampleExtensionLoad` событий, `AddHandler` выполняется часть этого кода пользовательского события. `MyApplication_SampleExtensionLoad` Метод есть в примере кода, чтобы показать пример обработчика событий, который обрабатывает `My.SampleExtensionLoad` события. Обратите внимание, что `SampleExtensionLoad` событий будут доступны при выборе **Мои события приложения** параметр в левом раскрывающемся списке над редактором кода при редактировании файла ApplicationEvents.vb.  
  
 [!code-vb[VbVbcnExtendingMy №&6;](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_6.vb)]  
  
##  <a name="design"></a>Рекомендации по проектированию  
 При разработке расширений к `My` пространства имен, следуйте приведенным ниже рекомендациям, чтобы свести к минимуму стоимость обслуживания компонентов расширения.  
  
-   **Включать только логику расширения.** Логика `My` расширение пространства имен должна содержать только код, необходимый для предоставления требуемой функциональности в `My` пространства имен. Поскольку расширение будет присутствовать в проектах пользователей виде исходного кода, обновление компонента расширения влечет высокую стоимость обслуживания и по возможности следует избегать.  
  
-   **Свести к минимуму предположения проекта.** При создании расширений пространства `My` пространства имен, не предполагайте наличия определенного набора ссылок, импорта на уровне проекта или особых параметров компилятора (например, `Option Strict` off). Вместо этого Минимизируйте зависимости и определяйте все ссылки на тип с помощью `Global` ключевое слово. Кроме того, убедитесь, что расширение компилируется с `Option Strict` на для минимизации ошибок в расширении.  
  
-   **Изолируйте код расширения.** Размещение кода в одном файле расширения делает простым развертыванием в качестве шаблона элемента Visual Studio. Дополнительные сведения см. в разделе «Упаковка и развертывание расширения» далее в этом разделе. Помещение всего `My` кода расширения пространства имен в один файл или отдельную папку в проекте также поможет пользователям найти `My` расширение пространства имен.  
  
##  <a name="designing"></a>Разработка библиотек классов для My  
 Как и в случае с большинством объектных моделей, одни шаблоны разработки хорошо работают в `My` пространства имен, а другие нет. При разработке расширения для `My` пространство имен, необходимо учитывать следующие принципы:  
  
-   **Методы без запоминания состояния.** Методы в `My` пространства имен должны обеспечивать полное решение определенной задачи. Убедитесь, что значения параметров, которые передаются в метод предоставляют все входные данные, необходимые для выполнения конкретной задачи. Избегайте создания методов, основанных на предыдущих состояниях, таких как открытые подключения к ресурсам.  
  
-   **Глобальные экземпляры.** Единственное состояние, которое поддерживается в `My` пространством имен является глобальным для проекта. Например `My.Application.Info` инкапсулирует состояние, общее для всего приложения.  
  
-   **Простые типы параметров.** Сохраняйте простоту, избегая сложных типов параметров. Создайте методы, которые либо принимают параметр ввода, либо принимают простых типов входных данных, такие как строки, примитивные типы и т. д.  
  
-   **Фабричные методы.** Некоторые типы трудно создать экземпляр. Предоставление фабричных методов в качестве расширений к `My` пространство имен позволяет легче обнаруживать и употреблять типы, попадающие в эту категорию. Примером хорошо работающего фабричного метода является `My.Computer.FileSystem.OpenTextFileReader`. Существует несколько типов потоков в .NET Framework. В частности, задавая текстовые файлы `OpenTextFileReader` помогает пользователю понять, какой поток следует использовать.  
  
 Эти правила не противоречат общие принципы проектирования библиотек классов. Скорее, это рекомендации, оптимизированные для разработчиков, использующих Visual Basic и `My` пространства имен. Общие принципы проектирования библиотек классов, в разделе [Framework рекомендации по проектированию](http://msdn.microsoft.com/library/5fbcaf4f-ea2a-4d20-b0d6-e61dee202b4b).  
  
##  <a name="packaging"></a>Упаковка и развертывание расширений  
 Можно включить `My` расширения пространства имен в шаблон проекта Visual Studio, или можно упаковать и развернуть их в качестве шаблона элемента Visual Studio. При упаковке вашей `My` расширения пространства имен в качестве шаблона элемента Visual Studio, можно воспользоваться преимуществами дополнительных возможностей, предоставляемых Visual Basic. Эти возможности позволяют включить расширение, когда проект ссылается на отдельную сборку, или предоставить пользователям возможность явно добавлять к `My` расширение пространства имен с помощью **Мои расширения** страницы в конструкторе проектов Visual Basic.  
  
 Дополнительные сведения о развертывании `My` расширения пространства имен, в разделе [упаковка и развертывание пользовательских Мои расширения](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md).  
  
## <a name="see-also"></a>См. также  
 [Упаковка и развертывание пользовательских расширений пространства имен My](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)   
 [Расширение модели приложения Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)   
 [Настройка доступа к объектам, доступные в моей](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)   
 [Страница "Мои расширения" Конструктор проектов](https://docs.microsoft.com/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)   
 [Страница "Приложение" в конструкторе проектов (Visual Basic)](https://docs.microsoft.com/visualstudio/ide/reference/application-page-project-designer-visual-basic)   
 [Partial](../../../visual-basic/language-reference/modifiers/partial.md)
