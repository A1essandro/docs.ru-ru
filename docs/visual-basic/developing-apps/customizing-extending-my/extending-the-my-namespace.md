---
title: "Расширение пространства имен My в Visual Basic"
ms.date: 07/20/2015
ms.prod: .net
ms.technology: devlang-visual-basic
ms.topic: article
f1_keywords: vb.AddingMyExtensions
helpviewer_keywords:
- My namespace [Visual Basic], customizing
- My namespace
- My namespace [Visual Basic], extending
ms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: 25fff04b19cce299a2d437e662fb7481153d29da
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="extending-the-my-namespace-in-visual-basic"></a>Расширение пространства имен My в Visual Basic
`My` Имен в Visual Basic предоставляет свойства и методы, которые позволяют легко воспользоваться преимуществами платформы .NET. `My` Имен упрощает типовых задач программирования, часто сводя сложную задачу для одной строки кода. Кроме того `My` пространства имен является полностью расширяемым, чтобы можно было настроить поведение `My` и добавлять новые службы в его иерархии адаптироваться к потребностям конкретного приложения. В этом разделе обсуждается настройка существующих членов `My` пространства имен и как добавить пользовательские классы для `My` пространства имен.  
  
 **Содержание раздела**  
  
-   [Настройка существующих элементов пространства имен My](#customizing)  
  
-   [Добавление элементов в объекты My](#addingtoobjects)  
  
-   [Добавление пользовательских объектов для My-пространство имен](#addingcustom)  
  
-   [Добавление элементов в пространство имен My](#addingtonamespace)  
  
-   [Добавление событий в пользовательские объекты](#addingevents)  
  
-   [Рекомендации по проектированию](#design)  
  
-   [Разработка библиотек классов для My](#designing)  
  
-   [Упаковка и развертывание расширений](#packaging)  
  
##  <a name="customizing"></a>Настройка существующих элементов пространства имен My  
 `My` Пространства имен в Visual Basic предоставляет часто используемые сведения о приложении, компьютера и многое другое. Полный список объектов в `My` пространства имен, в разделе [My Reference](../../../visual-basic/language-reference/keywords/my-reference.md). Возможно, вам потребуется настроить существующие члены `My` пространства имен, чтобы они лучше соответствовали требованиям приложения. Любое свойство в объект `My` пространства имен, который не только для чтения можно задать пользовательское значение.  
  
 Например, предположим, вы часто используете `My.User` объекта для доступа к текущему контексту безопасности пользователя, запустившего приложение. Тем не менее компании используется объект пользовательского для предоставления дополнительных сведений и возможности для пользователей в организации. В этом случае можно заменить значение по умолчанию `My.User.CurrentPrincipal` свойства с экземпляром собственного пользовательского объекта-участника, как показано в следующем примере.  
  
 [!code-vb[VbVbcnExtendingMy#1](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_1.vb)]  
  
 Установка `CurrentPrincipal` свойство `My.User` изменениях объекта, удостоверение, под которой запускается приложение. `My.User` Объект, в свою очередь, возвращает сведения о вновь указанного пользователя.  
  
##  <a name="addingtoobjects"></a>Добавление элементов в объекты My  
 Типы, возвращаемые `My.Application` и `My.Computer` определяются как `Partial` классы. Таким образом, можно расширить `My.Application` и `My.Computer` объектов путем создания `Partial` класс с именем `MyApplication` или `MyComputer`. Класс не может быть `Private` класса. Если класс задан как часть `My` пространства имен, можно добавить свойства и методы, которые будут включены с `My.Application` или `My.Computer` объектов.  
  
 Например, в следующем примере добавляется свойство с именем `DnsServerIPAddresses` для `My.Computer` объекта.  
  
 [!code-vb[VbVbcnExtendingMy#2](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_2.vb)]  
  
##  <a name="addingcustom"></a>Добавление пользовательских объектов для My-пространство имен  
 Несмотря на то что `My` пространство имен предоставляет решения для многие часто встречающиеся задачи программирования, встречаются задачи, `My` пространства имен не рассматриваются. Например приложение может получить доступ к пользовательским службам каталогов для пользовательских данных, или ваше приложение может использовать сборки, которые не устанавливаются по умолчанию вместе с Visual Basic. Вы можете расширить `My` пространство имен и включить пользовательские решения типовых задач, относящихся к вашей среде. `My` Пространства имен можно легко расширить для добавления новых элементов для удовлетворения растущих потребностей приложения. Кроме того, можно развернуть на `My` расширений пространства имен для других разработчиков в качестве шаблона Visual Basic.  
  
###  <a name="addingtonamespace"></a>Добавление элементов в пространство имен My  
 Поскольку `My` является пространством имен как любое другое пространство имен, можно добавлять свойства верхнего уровня к нему, просто добавив модуль и указав `Namespace` из `My`. Снабдите модуль `HideModuleName` атрибута, как показано в следующем примере. `HideModuleName` Атрибут гарантирует, что IntelliSense не будет отображать имя модуля при отображении элементов из `My` пространства имен.  
  
 [!code-vb[VbVbcnExtendingMy#3](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_3.vb)]  
  
 Добавление членов в `My` пространства имен, добавить свойства для модуля. Для каждого свойства, добавляемого `My` пространства имен, добавьте закрытое поле типа `ThreadSafeObjectProvider(Of T)`, где типом является тип, возвращаемый вашим пользовательским свойством. Это поле используется для создания экземпляров потокобезопасный объект возвращается в свойстве путем вызова `GetInstance` метод. В результате каждый поток, который обращается к расширенное свойство получает свой собственный экземпляр возвращаемого типа. В следующем примере добавляется свойство с именем `SampleExtension` типа `SampleExtension` для `My` пространство имен:  
  
 [!code-vb[VbVbcnExtendingMy#4](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_4.vb)]  
  
##  <a name="addingevents"></a>Добавление событий в пользовательские объекты  
 Можно использовать `My.Application` объекта для предоставления событий пользовательским `My` объектов путем расширения `MyApplication` разделяемого класса в `My` пространства имен. Для проектов Windows можно дважды щелкнуть **Мой проект** узел проекта в **обозревателе решений**. В Visual Basic **конструктора проектов**, нажмите кнопку `Application` и нажмите кнопку `View Application Events` кнопки. Будет создан новый файл с именем ApplicationEvents.vb. Оно содержит следующий код для расширения `MyApplication` класса.  
  
 [!code-vb[VbVbcnExtendingMy#5](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_5.vb)]  
  
 Можно добавить обработчики событий для настраиваемых `My` объектов путем добавления пользовательских обработчиков событий для `MyApplication` класса. Пользовательские события позволяют добавлять код, который будет выполняться при добавлении обработчика событий, удалена, или вызывать событие. Обратите внимание, что `AddHandler` кода для пользовательского события выполняется только в том случае, если код добавлен пользователем для обработки события. Например, рассмотрим, `SampleExtension` объекта из предыдущего раздела `Load` событие, которое требуется добавить пользовательский обработчик. В следующем примере кода показан пользовательский обработчик событий с именем `SampleExtensionLoad` , который будет вызываться при `My.SampleExtension.Load` событием. При добавлении кода для обработки нового `My.SampleExtensionLoad` событий, `AddHandler` выполняется часть этот код пользовательского события. `MyApplication_SampleExtensionLoad` Метод включен в пример кода демонстрирует пример обработчика событий, который обрабатывает `My.SampleExtensionLoad` событий. Обратите внимание, что `SampleExtensionLoad` события будут доступны при выборе **Мои события приложения** параметр в левом раскрывающемся списке над редактором кода при редактировании файла ApplicationEvents.vb.  
  
 [!code-vb[VbVbcnExtendingMy#6](../../../visual-basic/developing-apps/customizing-extending-my/codesnippet/VisualBasic/extending-the-my-namespace_6.vb)]  
  
##  <a name="design"></a>Рекомендации по проектированию  
 При разработке расширения `My` пространства имен, следуйте приведенным ниже рекомендациям, чтобы свести к минимуму затраты на обслуживание компонентов расширения.  
  
-   **Содержит только логику расширения.** Логика `My` расширение пространства имен должно содержать только код, необходимый для предоставления требуемых функций в `My` пространства имен. Так как расширение будет присутствовать в проектах пользователей в виде исходного кода, обновление компонента расширения влечет за собой высокую стоимость обслуживания и по возможности следует избегать.  
  
-   **Свести к минимуму предположения проекта.** При создании расширений пространства `My` пространства имен, не следует считать набор ссылок, импорта на уровне проекта или особых параметров компилятора (например, `Option Strict` off). Вместо этого Минимизируйте зависимости и определяйте все ссылки на тип с помощью `Global` ключевое слово. Кроме того, убедитесь, что расширение компилируется с `Option Strict` on для минимизации ошибок в расширении.  
  
-   **Локализация кода расширения.** Поместив данный код в одном файле расширение делает простым развертыванием в качестве шаблона элемента Visual Studio. Дополнительные сведения см. в разделе «Упаковка и развертывание расширения» далее в этом разделе. Размещение всех `My` кода расширения пространства имен в один файл или отдельную папку в проекте также поможет пользователям найти `My` расширение пространства имен.  
  
##  <a name="designing"></a>Разработка библиотек классов для My  
 Как и в случае с большинством объектных моделей, одни шаблоны разработки хорошо работают в `My` пространства имен, а другие нет. При разработке расширения для `My` пространства имен, необходимо учитывать следующие принципы:  
  
-   **Методы без сохранения состояния.** Методы в `My` пространства имен следует создать полноценное решение для определенной задачи. Убедитесь, что значения параметров, которые передаются в метод предоставляет все входные данные, необходимые для выполнения конкретной задачи. Избегайте создания методов, которые зависят от предыдущего состояния, таких как открытые подключения к ресурсам.  
  
-   **Глобальные экземпляры.** Единственное состояние, которое хранится в `My` пространством имен является глобальным для проекта. Например `My.Application.Info` инкапсулирует состояние, общее для всего приложения.  
  
-   **Простые типы параметров.** Простоты, чтобы избежать сложных типов параметров. Создайте методы, которые либо принимают без параметра ввода, либо принимают простых типов входных данных, такие как строки, типы-примитивы и т. д.  
  
-   **Фабричные методы.** Некоторые типы трудно создать экземпляр. Предоставление фабричных методов в качестве расширений для `My` пространство имен позволяет упростить обнаружение и использование типов, которые попадают в эту категорию. Пример фабричный метод, которое работает хорошо — `My.Computer.FileSystem.OpenTextFileReader`. Существует несколько типов потоков в .NET Framework. В частности, задавая текстовые файлы `OpenTextFileReader` помогает пользователю понять, какой поток следует использовать.  
  
 Эти правила не противоречат общие принципы проектирования библиотек классов. Вместо этого они приведены рекомендации, которые оптимизированы для разработчиков, использующих Visual Basic и `My` пространства имен. Общие принципы проектирования библиотек классов, в разделе [рекомендации по разработке Framework](../../../standard/design-guidelines/index.md).  
  
##  <a name="packaging"></a>Упаковка и развертывание расширений  
 Можно включить `My` расширений пространства имен в шаблон проекта Visual Studio, или можно упаковать и развернуть их в качестве шаблона элемента Visual Studio. При упаковке вашей `My` расширений пространства имен в качестве шаблона элемента Visual Studio, можно воспользоваться преимуществами дополнительных возможностей, предоставляемых Visual Basic. Эти возможности позволяют включить расширение, когда проект ссылается на отдельную сборку, или предоставить пользователям возможность добавлять явно вашей `My` расширение пространства имен с помощью **Мои расширения** страницы в Visual Basic Конструктор проектов.  
  
 Дополнительные сведения о развертывании `My` расширений пространства имен, в разделе [упаковка и развертывание расширений My Custom](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md).  
  
## <a name="see-also"></a>См. также  
 [Упаковка и развертывание пользовательских расширений пространства имен My](../../../visual-basic/developing-apps/customizing-extending-my/packaging-and-deploying-custom-my-extensions.md)  
 [Расширение модели приложения Visual Basic](../../../visual-basic/developing-apps/customizing-extending-my/extending-the-visual-basic-application-model.md)  
 [Настройка доступа к объектам через My](../../../visual-basic/developing-apps/customizing-extending-my/customizing-which-objects-are-available-in-my.md)  
 [Страница "Мои расширения" Конструктор проектов](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)  
 [Страница "Приложение" в конструкторе проектов (Visual Basic)](/visualstudio/ide/reference/application-page-project-designer-visual-basic)  
 [Partial](../../../visual-basic/language-reference/modifiers/partial.md)
