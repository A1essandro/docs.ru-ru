---
title: Компонент PrintForm (Visual Basic)
ms.date: 07/20/2015
helpviewer_keywords:
- PrintForm component [Visual Basic]
ms.assetid: 03de98b8-b54c-4764-91d7-83c64e974750
ms.openlocfilehash: 879d31c5a572689d84af6b2e46f3d33e1a8841c8
ms.sourcegitcommit: 5bbfe34a9a14e4ccb22367e57b57585c208cf757
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2018
ms.locfileid: "46000808"
---
# <a name="printform-component-visual-basic"></a><span data-ttu-id="e1da2-102">Компонент PrintForm (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="e1da2-102">PrintForm Component (Visual Basic)</span></span>
<span data-ttu-id="e1da2-103"><xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> Компонент для Visual Basic позволяет напечатать изображение формы Windows во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="e1da2-103">The <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component for Visual Basic enables you to print an image of a Windows Form at run time.</span></span> <span data-ttu-id="e1da2-104">Его поведение заменяет поведение метода `PrintForm` в более ранних версиях Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="e1da2-104">Its behavior replaces that of the `PrintForm` method in earlier versions of Visual Basic.</span></span>  
  
 <span data-ttu-id="e1da2-105">Элементы управления PowerPack больше не включены в Visual Studio, но их можно скачать [центра загрузки](https://www.microsoft.com/en-us/download/details.aspx?id=25169).</span><span class="sxs-lookup"><span data-stu-id="e1da2-105">The PowerPack controls are no longer included in Visual Studio, but you can download them from the [Download Center](https://www.microsoft.com/en-us/download/details.aspx?id=25169).</span></span>  
  
## <a name="printform-component-overview"></a><span data-ttu-id="e1da2-106">Обзор компонента PrintForm</span><span class="sxs-lookup"><span data-stu-id="e1da2-106">PrintForm Component Overview</span></span>  
 <span data-ttu-id="e1da2-107">Распространенной ситуацией, связанной с формами Windows Forms, является создание формы с форматированием, которое походит на бумажную форму или отчет, а затем печать изображения формы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-107">A common scenario for Windows Forms is to create a form that is formatted to resemble a paper form or a report, and then to print an image of the form.</span></span> <span data-ttu-id="e1da2-108">Также для этого можно использовать компонент <xref:System.Drawing.Printing.PrintDocument> , хотя это требует большого объема кода.</span><span class="sxs-lookup"><span data-stu-id="e1da2-108">Although you can use a <xref:System.Drawing.Printing.PrintDocument> component to do this, it would require a lot of code.</span></span> <span data-ttu-id="e1da2-109">Компонент <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> позволяет вывести изображение формы для печати на принтер, в окно предварительного просмотра печати или в файл без использования компонента <xref:System.Drawing.Printing.PrintDocument> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-109">The <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component enables you to print an image of a form to a printer, to a print preview window, or to a file without using a <xref:System.Drawing.Printing.PrintDocument> component.</span></span>  
  
 <span data-ttu-id="e1da2-110">Компонент <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> расположен на вкладке **Visual Basic PowerPacks** **панели элементов**.</span><span class="sxs-lookup"><span data-stu-id="e1da2-110">The <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component is located on the **Visual Basic PowerPacks** tab of the **Toolbox**.</span></span> <span data-ttu-id="e1da2-111">При перетаскивании в форму он отображается в небольшой области компонентов, расположенной под нижней границей формы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-111">When it is dragged onto a form it appears in the component tray, the small area under the bottom border of the form.</span></span> <span data-ttu-id="e1da2-112">Для выбранного компонента определяющие его поведение свойства можно задать в окне **Свойства** .</span><span class="sxs-lookup"><span data-stu-id="e1da2-112">When the component is selected, properties that define its behavior can be set in the **Properties** window.</span></span> <span data-ttu-id="e1da2-113">Все эти свойства можно также задать в коде.</span><span class="sxs-lookup"><span data-stu-id="e1da2-113">All of these properties can also be set in code.</span></span> <span data-ttu-id="e1da2-114">Можно также создать экземпляр компонента <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> в коде без добавления компонента во время разработки.</span><span class="sxs-lookup"><span data-stu-id="e1da2-114">You can also create an instance of the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component in code without adding the component at design time.</span></span>  
  
 <span data-ttu-id="e1da2-115">При печати формы печатается все содержимое клиентской области формы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-115">When you print a form, everything in the client area of the form is printed.</span></span> <span data-ttu-id="e1da2-116">Это включает в себя все элементы управления, а также любой текст и графику.</span><span class="sxs-lookup"><span data-stu-id="e1da2-116">This includes all controls and any text or graphics drawn on the form by graphics methods.</span></span> <span data-ttu-id="e1da2-117">По умолчанию заголовок, полосы прокрутки и границы формы не печатаются.</span><span class="sxs-lookup"><span data-stu-id="e1da2-117">By default, the form's title bar, scroll bars, and border are not printed.</span></span> <span data-ttu-id="e1da2-118">По умолчанию компонент <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> печатает только видимую часть формы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-118">Also by default, the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component prints only the visible part of the form.</span></span> <span data-ttu-id="e1da2-119">Например, если пользователь изменяет размер формы во время выполнения, будут напечатаны только видимые элементы управления и графика.</span><span class="sxs-lookup"><span data-stu-id="e1da2-119">For example, if the user resizes the form at run time, only the controls and graphics that are currently visible are printed.</span></span>  
  
 <span data-ttu-id="e1da2-120">Принтер по умолчанию, используемый компонентом <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> , определяется параметрами панели управления операционной системы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-120">The default printer used by the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component is determined by the operating system's Control Panel settings.</span></span>  
  
 <span data-ttu-id="e1da2-121">После запуска печати отображается стандартное диалоговое окно печати <xref:System.Drawing.Printing.PrintDocument> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-121">After printing is initiated, a standard <xref:System.Drawing.Printing.PrintDocument> printing dialog box is displayed.</span></span> <span data-ttu-id="e1da2-122">Это диалоговое окно позволяет пользователям отменить задание печати.</span><span class="sxs-lookup"><span data-stu-id="e1da2-122">This dialog box enables users to cancel the print job.</span></span>  
  
### <a name="key-methods-properties-and-events"></a><span data-ttu-id="e1da2-123">Ключевые методы, свойства и события</span><span class="sxs-lookup"><span data-stu-id="e1da2-123">Key Methods, Properties, and Events</span></span>  
 <span data-ttu-id="e1da2-124">Основной метод компонента <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> — метод <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> , который выводит изображение формы на принтер, в окно предварительного просмотра печати или в файл.</span><span class="sxs-lookup"><span data-stu-id="e1da2-124">The key method of the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component is the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> method, which prints an image of the form to a printer, print preview window, or file.</span></span> <span data-ttu-id="e1da2-125">Существуют две версии метода <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-125">There are two versions of the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> method:</span></span>  
  
-   <span data-ttu-id="e1da2-126">Базовая версия без параметров: `Print()`</span><span class="sxs-lookup"><span data-stu-id="e1da2-126">A basic version without parameters: `Print()`</span></span>  
  
-   <span data-ttu-id="e1da2-127">Перегруженная версия с параметрами, задающими режим печати: `Print(printForm As Form, printFormOption As PrintOption)`</span><span class="sxs-lookup"><span data-stu-id="e1da2-127">An overloaded version with parameters that specify printing behavior: `Print(printForm As Form, printFormOption As PrintOption)`</span></span>  
  
     <span data-ttu-id="e1da2-128">Параметр `PrintOption` перегруженного метода определяет базовую реализацию, используемую для печати формы, указывает, печатаются ли заголовок формы, полосы прокрутки и границы или прокручиваемые области формы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-128">The `PrintOption` parameter of the overloaded method determines the underlying implementation used to print the form, whether the form's title bar, scroll bars, and border are printed, and whether scrollable parts of the form are printed.</span></span>  
  
 <span data-ttu-id="e1da2-129">Свойство <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintAction%2A> является основным свойством компонента <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-129">The <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintAction%2A> property is a key property of the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component.</span></span> <span data-ttu-id="e1da2-130">Это свойство определяет, отправляются ли выходные данные на принтер, отображаются ли в окне предварительного просмотра или сохраняются в виде EPS-файла.</span><span class="sxs-lookup"><span data-stu-id="e1da2-130">This property determines whether the output is sent to a printer, displayed in a print preview window, or saved as an Encapsulated PostScript file.</span></span> <span data-ttu-id="e1da2-131">Если для свойства <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintAction%2A> задано значение <xref:System.Drawing.Printing.PrintAction.PrintToFile>, свойство <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintFileName%2A> указывает путь и имя файла.</span><span class="sxs-lookup"><span data-stu-id="e1da2-131">If the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintAction%2A> property is set to <xref:System.Drawing.Printing.PrintAction.PrintToFile>, the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintFileName%2A> property specifies the path and file name.</span></span>  
  
 <span data-ttu-id="e1da2-132">Свойство <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrinterSettings%2A> предоставляет доступ к базовому объекту <xref:System.Drawing.Printing.PrintDocument.PrinterSettings%2A> , который позволяет задать такие параметры, как используемый принтер и количество печатаемых копий.</span><span class="sxs-lookup"><span data-stu-id="e1da2-132">The <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrinterSettings%2A> property provides access to an underlying <xref:System.Drawing.Printing.PrintDocument.PrinterSettings%2A> object that enables you to specify such settings as the printer to use and the number of copies to print.</span></span> <span data-ttu-id="e1da2-133">Можно также запрашивать возможности принтера, например цветность или двухстороннюю печать.</span><span class="sxs-lookup"><span data-stu-id="e1da2-133">You can also query the printer's capabilities, such as color or duplex support.</span></span> <span data-ttu-id="e1da2-134">Это свойство не отображается в окне **Свойства** ; доступ к нему может осуществляться только из кода.</span><span class="sxs-lookup"><span data-stu-id="e1da2-134">This property does not appear in the **Properties** window; it can be accessed only from code.</span></span>  
  
 <span data-ttu-id="e1da2-135">Свойство <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Form%2A> используется для указания формы для печати при программном вызове компонента <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-135">The <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Form%2A> property is used to specify the form to print when you invoke the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component programmatically.</span></span> <span data-ttu-id="e1da2-136">Если компонент добавляется в форму во время разработки, эта форма используется по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="e1da2-136">If the component is added to a form at design time, that form is the default.</span></span>  
  
 <span data-ttu-id="e1da2-137">К основным событиям компонента <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> относятся следующие.</span><span class="sxs-lookup"><span data-stu-id="e1da2-137">Key events for the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component include the following:</span></span>  
  
-   <span data-ttu-id="e1da2-138">Событие<xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.BeginPrint> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-138"><xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.BeginPrint> event.</span></span> <span data-ttu-id="e1da2-139">Происходит при вызове метода <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> и перед печатью первой страницы документа.</span><span class="sxs-lookup"><span data-stu-id="e1da2-139">Occurs when the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> method is called and before the first page of the document prints.</span></span>  
  
-   <span data-ttu-id="e1da2-140">Событие<xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.EndPrint> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-140"><xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.EndPrint> event.</span></span> <span data-ttu-id="e1da2-141">Происходит после вывода на печать последней страницы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-141">Occurs after the last page is printed.</span></span>  
  
-   <span data-ttu-id="e1da2-142">Событие<xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.QueryPageSettings> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-142"><xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.QueryPageSettings> event.</span></span> <span data-ttu-id="e1da2-143">Происходит непосредственно перед печатью каждой страницы.</span><span class="sxs-lookup"><span data-stu-id="e1da2-143">Occurs immediately before each page is printed.</span></span>  
  
### <a name="remarks"></a><span data-ttu-id="e1da2-144">Примечания</span><span class="sxs-lookup"><span data-stu-id="e1da2-144">Remarks</span></span>  
 <span data-ttu-id="e1da2-145">Если форма содержит текст или графику, созданную методами <xref:System.Drawing.Graphics> , используйте базовый метод <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> (`Print()`) для печати.</span><span class="sxs-lookup"><span data-stu-id="e1da2-145">If a form contains text or graphics drawn by <xref:System.Drawing.Graphics> methods, use the basic <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> (`Print()`) method to print it.</span></span> <span data-ttu-id="e1da2-146">Графика может не отображаться в некоторых операционных системах при использовании перегруженного метода <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-146">Graphics may not render on some operating systems when the overloaded <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A> method is used.</span></span>  
  
 <span data-ttu-id="e1da2-147">Если ширина формы превышает ширину бумаги в принтере, правая часть формы может быть обрезана.</span><span class="sxs-lookup"><span data-stu-id="e1da2-147">If the width of a form is wider than the width of the paper in the printer, the right side of the form might be cut off.</span></span> <span data-ttu-id="e1da2-148">При разработке форм для печати убедитесь, что они умещаются на листе стандартного формата.</span><span class="sxs-lookup"><span data-stu-id="e1da2-148">When you design forms for printing, make sure that the form fits on standard-sized paper.</span></span>  
  
## <a name="example"></a><span data-ttu-id="e1da2-149">Пример</span><span class="sxs-lookup"><span data-stu-id="e1da2-149">Example</span></span>  
 <span data-ttu-id="e1da2-150">В следующем примере демонстрируется типичное использование компонента <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> .</span><span class="sxs-lookup"><span data-stu-id="e1da2-150">The following example shows a common use of the <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm> component.</span></span>  
  
```  
' Visual Basic.  
Dim pf As New PrintForm  
pf.Form = Me  
pf.PrintAction = PrintToPrinter  
pf.Print()  
```  
  
## <a name="see-also"></a><span data-ttu-id="e1da2-151">См. также</span><span class="sxs-lookup"><span data-stu-id="e1da2-151">See Also</span></span>  
 <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.Print%2A>  
 <xref:Microsoft.VisualBasic.PowerPacks.Printing.PrintForm.PrintAction%2A>  
 [<span data-ttu-id="e1da2-152">Практическое руководство. Печать формы с помощью компонента PrintForm</span><span class="sxs-lookup"><span data-stu-id="e1da2-152">How to: Print a Form by Using the PrintForm Component</span></span>](../../../visual-basic/developing-apps/printing/how-to-print-a-form-by-using-the-printform-component.md)  
 [<span data-ttu-id="e1da2-153">Практическое руководство. Печать клиентской области формы</span><span class="sxs-lookup"><span data-stu-id="e1da2-153">How to: Print the Client Area of a Form</span></span>](../../../visual-basic/developing-apps/printing/how-to-print-the-client-area-of-a-form.md)  
 [<span data-ttu-id="e1da2-154">Практическое руководство. Печать клиентской и неклиентской области формы</span><span class="sxs-lookup"><span data-stu-id="e1da2-154">How to: Print Client and Non-Client Areas of a Form</span></span>](../../../visual-basic/developing-apps/printing/how-to-print-client-and-non-client-areas-of-a-form.md)  
 [<span data-ttu-id="e1da2-155">Практическое руководство. Печать прокручиваемой формы</span><span class="sxs-lookup"><span data-stu-id="e1da2-155">How to: Print a Scrollable Form</span></span>](../../../visual-basic/developing-apps/printing/how-to-print-a-scrollable-form.md)
