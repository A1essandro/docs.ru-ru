---
title: Многопоточные приложения (Visual Basic)
ms.date: 07/20/2015
ms.assetid: 02b0444b-2e68-4f2c-bc28-28c046004017
ms.openlocfilehash: ab4b8d1c77ae75aee6f2cf459258766f88d86abe
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33650482"
---
# <a name="multithreaded-applications-visual-basic"></a>Многопоточные приложения (Visual Basic)
С помощью Visual Basic можно писать приложения, которые выполняют несколько задач одновременно. Задачи, которые потенциально могут задержать выполнение других задач, выполняются в отдельных потоках; такой способ организации работы приложения называется *многопоточностью* или *свободным созданием потоков*.  
  
 Приложения, использующие многопоточность, более оперативно реагируют на действия пользователя, поскольку пользовательский интерфейс остается активным, в то время как задачи, требующие интенсивной работы процессора, выполняются в других потоках. Многопоточность также эффективна при создании масштабируемых приложений, поскольку пользователь может добавлять потоки при увеличении рабочей нагрузки.  
  
## <a name="creating-and-using-threads"></a>Создание и использование потоков  
 Если требуется больший контроль над поведением потоков приложения, можно управлять потоками самостоятельно. Однако необходимо иметь в виду, что написание правильных многопоточных приложений может быть сложной задачей. Приложение может перестать отвечать на запросы или могут возникать временные ошибки, вызванные конфликтами. Дополнительные сведения см. в разделе [Потокобезопасные компоненты](http://msdn.microsoft.com/library/4f7c7377-a782-4bd0-aaa3-9db8c12945ee).  
  
 Новый поток создается путем объявления переменной типа <xref:System.Threading.Thread> и вызова конструктора, которому предоставляется имя процедуры или метода, которые требуется выполнить в новом потоке. Ниже приведен пример кода.  
  
```vb  
Dim newThread As New System.Threading.Thread(AddressOf AMethod)  
```  
  
### <a name="starting-and-stopping-threads"></a>Запуск и остановка потоков  
 Чтобы начать выполнение нового потока, используйте метод <xref:System.Threading.Thread.Start%2A>, как показано в следующем коде.  
  
```vb  
newThread.Start()  
```  
  
 Чтобы остановить выполнение потока, используйте метод <xref:System.Threading.Thread.Abort%2A>, как показано в следующем коде.  
  
```vb  
newThread.Abort()  
```  
  
 Помимо запуска и остановки, вы также можете приостанавливать потоки с помощью метода <xref:System.Threading.Thread.Sleep%2A> или <xref:System.Threading.Thread.Suspend%2A>, возобновлять приостановленный поток с помощью метода <xref:System.Threading.Thread.Resume%2A>, а также уничтожать поток, используя метод <xref:System.Threading.Thread.Abort%2A>.  
  
### <a name="thread-methods"></a>Методы управления потоками  
 В следующей таблице приводятся методы, с помощью которых можно управлять отдельными потоками.  
  
|Метод|Действие|  
|------------|------------|  
|<xref:System.Threading.Thread.Start%2A>|Запускает поток.|  
|<xref:System.Threading.Thread.Sleep%2A>|Приостанавливает поток на определенное время.|  
|<xref:System.Threading.Thread.Suspend%2A>|Приостанавливает поток, когда он достигает безопасной точки.|  
|<xref:System.Threading.Thread.Abort%2A>|Останавливает поток, когда он достигает безопасной точки.|  
|<xref:System.Threading.Thread.Resume%2A>|Возобновляет работу приостановленного потока.|  
|<xref:System.Threading.Thread.Join%2A>|Приостанавливает текущий поток до тех пор, пока не будет завершен другой поток. При заданном времени ожидания этот метод возвращает значение `True` при условии, что другой поток закончится за это время.|  
  
### <a name="safe-points"></a>Безопасные точки  
 Названия этих методов говорят сами за себя, однако концепция *безопасных точек* может оказаться новой для пользователя. Безопасные точки располагаются в тех местах кода, в которых среда CLR может безопасно выполнить автоматическую *сборку мусора* — процесс уничтожения неиспользуемых переменных и освобождения памяти. При вызове методов потока <xref:System.Threading.Thread.Abort%2A> или <xref:System.Threading.Thread.Suspend%2A> среда CLR анализирует код и определяет подходящее место для остановки потока.  
  
### <a name="thread-properties"></a>Свойства потока  
 Потоки также имеют несколько полезных свойств, которые приведены в следующей таблице.  
  
|Свойство.|Значение|  
|--------------|-----------|  
|<xref:System.Threading.Thread.IsAlive%2A>|Содержит значение `True`, если поток активен.|  
|<xref:System.Threading.Thread.IsBackground%2A>|Возвращает или задает логическое значение, которое указывает, является ли поток (должен ли являться) фоновым потоком. Фоновые потоки отличаются от основного потока лишь тем, что они не влияют на завершение процесса. Когда обработка всех основных потоков закончена, общеязыковая среда выполнения завершает процесс, применяя метод <xref:System.Threading.Thread.Abort%2A> к тем фоновым потокам, которые еще продолжают существовать.|  
|<xref:System.Threading.Thread.Name%2A>|Возвращает или задает имя потока. Наиболее часто используется для обнаружения отдельных потоков при отладке.|  
|<xref:System.Threading.Thread.Priority%2A>|Возвращает или задает значение, которое используется операционной системой для установки приоритетов потоков.|  
|<xref:System.Threading.Thread.ThreadState%2A>|Содержит значение, описывающее состояние или состояния потока.|  
  
## <a name="thread-priorities"></a>Приоритеты потоков  
 Каждый поток имеет приоритетное свойство, которое определяет, какую часть процессорного времени он должен занять при выполнении. Операционная система выделяет более длинные отрезки времени на потоки с высоким приоритетом и более короткие отрезки времени потоки с низким приоритетом. Новые потоки создаются со значением `Normal`, однако вы можете присвоить свойству <xref:System.Threading.Thread.Priority%2A> любое значение из перечисления <xref:System.Threading.ThreadPriority>.  
  
 Подробное описание приоритетов потоков см. в разделе <xref:System.Threading.ThreadPriority>.  
  
## <a name="foreground-and-background-threads"></a>Основные и фоновые потоки  
 *Основной поток* выполняется бесконечно, тогда как *фоновый поток* останавливается сразу после остановки последнего основного потока. Для определения или изменения фонового статуса потока можно использовать свойство <xref:System.Threading.Thread.IsBackground%2A>.  
  
## <a name="see-also"></a>См. также  
 <xref:System.Threading.Thread>  
 [Синхронизация потоков (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/thread-synchronization.md)  
 [Параметры и возвращаемые значения для многопоточных процедур (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/parameters-and-return-values-for-multithreaded-procedures.md)  
 [Threading (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/index.md) (Работа с потоками (Visual Basic))
