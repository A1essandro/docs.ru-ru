---
title: "Пошаговое руководство: Внедрение типов из управляемых сборок в Visual Studio (Visual Basic) | Документы Microsoft"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
ms.assetid: 56ed12ba-adff-4e9c-a668-7fcba80c4795
caps.latest.revision: 3
author: stevehoag
ms.author: shoag
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: Machine Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: adc58e081cd9b874a841d84b11d92cbffb6ba6b8
ms.contentlocale: ru-ru
ms.lasthandoff: 03/13/2017

---
# <a name="walkthrough-embedding-types-from-managed-assemblies-in-visual-studio-visual-basic"></a><span data-ttu-id="57171-102">Пошаговое руководство: Внедрение типов из управляемых сборок в Visual Studio (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="57171-102">Walkthrough: Embedding Types from Managed Assemblies in Visual Studio (Visual Basic)</span></span>
<span data-ttu-id="57171-103">При внедрении информации о типе из управляемой сборки со строгими именами могут слабую типами в приложении для достижения независимости версий.</span><span class="sxs-lookup"><span data-stu-id="57171-103">If you embed type information from a strong-named managed assembly, you can loosely couple types in an application to achieve version independence.</span></span> <span data-ttu-id="57171-104">То есть программы могут записываться в использовать типы из нескольких версий управляемой библиотеки без повторной компиляции для каждой версии.</span><span class="sxs-lookup"><span data-stu-id="57171-104">That is, your program can be written to use types from multiple versions of a managed library without having to be recompiled for each version.</span></span>  
  
 <span data-ttu-id="57171-105">Внедрение типа часто используется с COM-взаимодействием, например приложение, которое использует объекты автоматизации Microsoft Office.</span><span class="sxs-lookup"><span data-stu-id="57171-105">Type embedding is frequently used with COM interop, such as an application that uses automation objects from Microsoft Office.</span></span> <span data-ttu-id="57171-106">Внедрение данных о типе позволяет одному построению программы работать с различными версиями Microsoft Office на разных компьютерах.</span><span class="sxs-lookup"><span data-stu-id="57171-106">Embedding type information enables the same build of a program to work with different versions of Microsoft Office on different computers.</span></span> <span data-ttu-id="57171-107">Тем не менее можно также использовать тип внедрение с полностью управляемое решение.</span><span class="sxs-lookup"><span data-stu-id="57171-107">However, you can also use type embedding with a fully managed solution.</span></span>  
  
 <span data-ttu-id="57171-108">Сведения о типе может быть внедрен из сборки, которая имеет следующие характеристики:</span><span class="sxs-lookup"><span data-stu-id="57171-108">Type information can be embedded from an assembly that has the following characteristics:</span></span>  
  
-   <span data-ttu-id="57171-109">Сборка предоставляет по крайней мере один открытый интерфейс.</span><span class="sxs-lookup"><span data-stu-id="57171-109">The assembly exposes at least one public interface.</span></span>  
  
-   <span data-ttu-id="57171-110">Внедренные интерфейсы отмечены `ComImport` атрибут и `Guid` атрибута (и уникальный идентификатор GUID).</span><span class="sxs-lookup"><span data-stu-id="57171-110">The embedded interfaces are annotated with a `ComImport` attribute and a `Guid` attribute (and a unique GUID).</span></span>  
  
-   <span data-ttu-id="57171-111">Сборка отмечена `ImportedFromTypeLib` атрибут или `PrimaryInteropAssembly` атрибут и уровня сборки `Guid` атрибута.</span><span class="sxs-lookup"><span data-stu-id="57171-111">The assembly is annotated with the `ImportedFromTypeLib` attribute or the `PrimaryInteropAssembly` attribute, and an assembly-level `Guid` attribute.</span></span> <span data-ttu-id="57171-112">(По умолчанию шаблоны проектов Visual Basic включают уровня сборки `Guid` атрибута.)</span><span class="sxs-lookup"><span data-stu-id="57171-112">(By default, Visual Basic project templates include an assembly-level `Guid` attribute.)</span></span>  
  
 <span data-ttu-id="57171-113">После указания открытых интерфейсов, которые могут быть внедрены, можно создать классы среды выполнения, которые реализуют эти интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="57171-113">After you have specified the public interfaces that can be embedded, you can create runtime classes that implement those interfaces.</span></span> <span data-ttu-id="57171-114">Клиентская программа встраивает сведения о типе для этих интерфейсов во время разработки, ссылаясь на сборку, содержащую открытые интерфейсы и параметр `Embed Interop Types` ссылку на свойство `True`.</span><span class="sxs-lookup"><span data-stu-id="57171-114">A client program can then embed the type information for those interfaces at design time by referencing the assembly that contains the public interfaces and setting the `Embed Interop Types` property of the reference to `True`.</span></span> <span data-ttu-id="57171-115">Это эквивалентно с помощью компилятора командной строки и ссылки на сборки с помощью `/link` параметр компилятора.</span><span class="sxs-lookup"><span data-stu-id="57171-115">This is equivalent to using the command line compiler and referencing the assembly by using the `/link` compiler option.</span></span> <span data-ttu-id="57171-116">Клиентская программа может затем загрузить экземпляры объектов среды выполнения, типизированного как эти интерфейсы.</span><span class="sxs-lookup"><span data-stu-id="57171-116">The client program can then load instances of your runtime objects typed as those interfaces.</span></span> <span data-ttu-id="57171-117">При создании новой версии сборки со строгими именами среды выполнения, клиентская программа не нужно повторно компилировать с обновленной сборкой среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="57171-117">If you create a new version of your strong-named runtime assembly, the client program does not have to be recompiled with the updated runtime assembly.</span></span> <span data-ttu-id="57171-118">Вместо этого клиентская программа будет использовать любой сборки среды выполнения доступна версия, используя внедренные данные о типе для открытых интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="57171-118">Instead, the client program continues to use whichever version of the runtime assembly is available to it, using the embedded type information for the public interfaces.</span></span>  
  
 <span data-ttu-id="57171-119">Поскольку основная функция внедрения типа — поддержка внедрения информации о типе из сборок взаимодействия COM, при внедрении информации о типе в полностью управляемое решение, применяются следующие ограничения:</span><span class="sxs-lookup"><span data-stu-id="57171-119">Because the primary function of type embedding is to support embedding of type information from COM interop assemblies, the following limitations apply when you embed type information in a fully managed solution:</span></span>  
  
-   <span data-ttu-id="57171-120">Внедряются только атрибуты, специфичные для COM-взаимодействия; другие атрибуты игнорируются.</span><span class="sxs-lookup"><span data-stu-id="57171-120">Only attributes specific to COM interop are embedded; other attributes are ignored.</span></span>  
  
-   <span data-ttu-id="57171-121">Если тип использует универсальные параметры и тип универсального параметра является внедренным типом, этот тип не может использоваться через границы сборок.</span><span class="sxs-lookup"><span data-stu-id="57171-121">If a type uses generic parameters and the type of the generic parameter is an embedded type, that type cannot be used across an assembly boundary.</span></span> <span data-ttu-id="57171-122">Примеры использования через границы сборок включают вызов метода из другой сборки или тип является производным от типа, определенного в другой сборке.</span><span class="sxs-lookup"><span data-stu-id="57171-122">Examples of crossing an assembly boundary include calling a method from another assembly or a deriving a type from a type defined in another assembly.</span></span>  
  
-   <span data-ttu-id="57171-123">Константы не внедряются.</span><span class="sxs-lookup"><span data-stu-id="57171-123">Constants are not embedded.</span></span>  
  
-   <span data-ttu-id="57171-124"><xref:System.Collections.Generic.Dictionary%602?displayProperty=fullName>Класс не поддерживает внедренный тип в качестве ключа.</xref:System.Collections.Generic.Dictionary%602?displayProperty=fullName></span><span class="sxs-lookup"><span data-stu-id="57171-124">The <xref:System.Collections.Generic.Dictionary%602?displayProperty=fullName> class does not support an embedded type as a key.</span></span> <span data-ttu-id="57171-125">Можно реализовать собственный тип словаря для поддержки внедренного типа в качестве ключа.</span><span class="sxs-lookup"><span data-stu-id="57171-125">You can implement your own dictionary type to support an embedded type as a key.</span></span>  
  
 <span data-ttu-id="57171-126">В этом пошаговом руководстве необходимо следующее:</span><span class="sxs-lookup"><span data-stu-id="57171-126">In this walkthrough, you will do the following:</span></span>  
  
-   <span data-ttu-id="57171-127">Создайте сборку строгим именем, которая имеет открытый интерфейс, содержащий сведения о типе, который может быть внедрен.</span><span class="sxs-lookup"><span data-stu-id="57171-127">Create a strong-named assembly that has a public interface that contains type information that can be embedded.</span></span>  
  
-   <span data-ttu-id="57171-128">Создание сборки со строгим именем, которая реализует открытый интерфейс.</span><span class="sxs-lookup"><span data-stu-id="57171-128">Create a strong-named runtime assembly that implements that public interface.</span></span>  
  
-   <span data-ttu-id="57171-129">Создание клиентской программы, которая включает сведения о типе из открытого интерфейса и создает экземпляр класса из сборки среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="57171-129">Create a client program that embeds the type information from the public interface and creates an instance of the class from the runtime assembly.</span></span>  
  
-   <span data-ttu-id="57171-130">Изменение и повторное построение сборки среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="57171-130">Modify and rebuild the runtime assembly.</span></span>  
  
-   <span data-ttu-id="57171-131">Запустите программу клиента, чтобы увидеть, что новая версия сборки среды выполнения используется без повторной компиляции клиентской программы.</span><span class="sxs-lookup"><span data-stu-id="57171-131">Run the client program to see that the new version of the runtime assembly is being used without having to recompile the client program.</span></span>  
  
[!INCLUDE[note_settings_general](../../../../csharp/language-reference/compiler-messages/includes/note_settings_general_md.md)]  
  
## <a name="creating-an-interface"></a><span data-ttu-id="57171-132">Создание интерфейса</span><span class="sxs-lookup"><span data-stu-id="57171-132">Creating an Interface</span></span>  
  
#### <a name="to-create-the-type-equivalence-interface-project"></a><span data-ttu-id="57171-133">Создание проекта интерфейса эквивалентности типа</span><span class="sxs-lookup"><span data-stu-id="57171-133">To create the type equivalence interface project</span></span>  
  
1.  <span data-ttu-id="57171-134">В Visual Studio на **файл** наведите указатель мыши на **New** и нажмите кнопку **проекта**.</span><span class="sxs-lookup"><span data-stu-id="57171-134">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="57171-135">В **новый проект** в диалоговом **типы проектов** область, убедитесь, что **Windows** выбран.</span><span class="sxs-lookup"><span data-stu-id="57171-135">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="57171-136">Выберите **библиотеки классов** в **шаблоны** области.</span><span class="sxs-lookup"><span data-stu-id="57171-136">Select **Class Library** in the **Templates** pane.</span></span> <span data-ttu-id="57171-137">В **имя** введите `TypeEquivalenceInterface`, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-137">In the **Name** box, type `TypeEquivalenceInterface`, and then click **OK**.</span></span> <span data-ttu-id="57171-138">Создан новый проект.</span><span class="sxs-lookup"><span data-stu-id="57171-138">The new project is created.</span></span>  
  
3.  <span data-ttu-id="57171-139">В **обозревателе решений**, щелкните правой кнопкой мыши файл Class1.vb и выберите **переименование**.</span><span class="sxs-lookup"><span data-stu-id="57171-139">In **Solution Explorer**, right-click the Class1.vb file and click **Rename**.</span></span> <span data-ttu-id="57171-140">Переименуйте файл `ISampleInterface.vb` и нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="57171-140">Rename the file to `ISampleInterface.vb` and press ENTER.</span></span> <span data-ttu-id="57171-141">Переименование файла также Переименуйте класс в `ISampleInterface`.</span><span class="sxs-lookup"><span data-stu-id="57171-141">Renaming the file will also rename the class to `ISampleInterface`.</span></span> <span data-ttu-id="57171-142">Этот класс будет представлять открытый интерфейс для класса.</span><span class="sxs-lookup"><span data-stu-id="57171-142">This class will represent the public interface for the class.</span></span>  
  
4.  <span data-ttu-id="57171-143">Щелкните правой кнопкой мыши проект TypeEquivalenceInterface и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="57171-143">Right-click the TypeEquivalenceInterface project and click **Properties**.</span></span> <span data-ttu-id="57171-144">Откройте вкладку **Компиляция**.</span><span class="sxs-lookup"><span data-stu-id="57171-144">Click the **Compile** tab.</span></span> <span data-ttu-id="57171-145">Задать выходной путь к местоположению на компьютере разработчика, такие как `C:\TypeEquivalenceSample`.</span><span class="sxs-lookup"><span data-stu-id="57171-145">Set the output path to a valid location on your development computer, such as `C:\TypeEquivalenceSample`.</span></span> <span data-ttu-id="57171-146">Это расположение также будет использоваться позже в этом пошаговом руководстве.</span><span class="sxs-lookup"><span data-stu-id="57171-146">This location will also be used in a later step in this walkthrough.</span></span>  
  
5.  <span data-ttu-id="57171-147">Не выходя свойства проекта, откройте **подписи** вкладки.</span><span class="sxs-lookup"><span data-stu-id="57171-147">While still editing the project properties, click the **Signing** tab.</span></span> <span data-ttu-id="57171-148">Выберите **подписать сборку** параметр.</span><span class="sxs-lookup"><span data-stu-id="57171-148">Select the **Sign the assembly** option.</span></span> <span data-ttu-id="57171-149">В **выберите файл ключей строгого имени** выберите ** <New...> **.</New...></span><span class="sxs-lookup"><span data-stu-id="57171-149">In the **Choose a strong name key file** list, click **<New...>**.</span></span> <span data-ttu-id="57171-150">В **имя файла ключа** введите `key.snk`.</span><span class="sxs-lookup"><span data-stu-id="57171-150">In the **Key file name** box, type `key.snk`.</span></span> <span data-ttu-id="57171-151">Очистить **защитить мой файл ключей паролем** флажок.</span><span class="sxs-lookup"><span data-stu-id="57171-151">Clear the **Protect my key file with a password** check box.</span></span> <span data-ttu-id="57171-152">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-152">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="57171-153">Откройте файл ISampleInterface.vb.</span><span class="sxs-lookup"><span data-stu-id="57171-153">Open the ISampleInterface.vb file.</span></span> <span data-ttu-id="57171-154">Добавьте следующий код в файле класса ISampleInterface для создания интерфейса ISampleInterface.</span><span class="sxs-lookup"><span data-stu-id="57171-154">Add the following code to the ISampleInterface class file to create the ISampleInterface interface.</span></span>  
  
<span data-ttu-id="57171-155"><CodeContentPlaceHolder>0</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="57171-155"><CodeContentPlaceHolder>0</CodeContentPlaceHolder></span></span>  
7.  <span data-ttu-id="57171-156">На **средства** меню, щелкните **создать Guid**.</span><span class="sxs-lookup"><span data-stu-id="57171-156">On the **Tools** menu, click **Create Guid**.</span></span> <span data-ttu-id="57171-157">В **создать GUID** диалоговом нажмите кнопку **формат реестра** и нажмите кнопку **копирования**.</span><span class="sxs-lookup"><span data-stu-id="57171-157">In the **Create GUID** dialog box, click **Registry Format** and then click **Copy**.</span></span> <span data-ttu-id="57171-158">Нажмите кнопку **Выход**.</span><span class="sxs-lookup"><span data-stu-id="57171-158">Click **Exit**.</span></span>  
  
8.  <span data-ttu-id="57171-159">В `Guid` атрибут, удалите образец GUID и вставьте идентификатор GUID, скопированный из **создать GUID** диалоговое окно.</span><span class="sxs-lookup"><span data-stu-id="57171-159">In the `Guid` attribute, delete the sample GUID and paste in the GUID that you copied from the **Create GUID** dialog box.</span></span> <span data-ttu-id="57171-160">Удалите фигурные скобки ({}) из скопированного GUID.</span><span class="sxs-lookup"><span data-stu-id="57171-160">Remove the braces ({}) from the copied GUID.</span></span>  
  
9. <span data-ttu-id="57171-161">На **проекта** меню, щелкните **Показать все файлы**.</span><span class="sxs-lookup"><span data-stu-id="57171-161">On the **Project** menu, click **Show All Files**.</span></span>  
  
10. <span data-ttu-id="57171-162">В **обозревателе решений**, разверните **Мой проект** папки.</span><span class="sxs-lookup"><span data-stu-id="57171-162">In **Solution Explorer**, expand the **My Project** folder.</span></span> <span data-ttu-id="57171-163">Дважды щелкните файл AssemblyInfo.vb.</span><span class="sxs-lookup"><span data-stu-id="57171-163">Double-click the AssemblyInfo.vb.</span></span> <span data-ttu-id="57171-164">Добавьте следующий атрибут к файлу.</span><span class="sxs-lookup"><span data-stu-id="57171-164">Add the following attribute to the file.</span></span>  
  
<span data-ttu-id="57171-165"><CodeContentPlaceHolder>1</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="57171-165"><CodeContentPlaceHolder>1</CodeContentPlaceHolder></span></span>  
     <span data-ttu-id="57171-166">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="57171-166">Save the file.</span></span>  
  
11. <span data-ttu-id="57171-167">Сохраните проект.</span><span class="sxs-lookup"><span data-stu-id="57171-167">Save the project.</span></span>  
  
12. <span data-ttu-id="57171-168">Щелкните правой кнопкой мыши проект TypeEquivalenceInterface и нажмите кнопку **сборки**.</span><span class="sxs-lookup"><span data-stu-id="57171-168">Right-click the TypeEquivalenceInterface project and click **Build**.</span></span> <span data-ttu-id="57171-169">DLL-файла библиотеки классов компилируется и сохранен на выходной путь построения (например, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="57171-169">The class library .dll file is compiled and saved to the specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
## <a name="creating-a-runtime-class"></a><span data-ttu-id="57171-170">Создание класса среды выполнения</span><span class="sxs-lookup"><span data-stu-id="57171-170">Creating a Runtime Class</span></span>  
  
#### <a name="to-create-the-type-equivalence-runtime-project"></a><span data-ttu-id="57171-171">Создание проекта среды выполнения эквивалентности типа</span><span class="sxs-lookup"><span data-stu-id="57171-171">To create the type equivalence runtime project</span></span>  
  
1.  <span data-ttu-id="57171-172">В Visual Studio на **файл** наведите указатель мыши на **New** и нажмите кнопку **проекта**.</span><span class="sxs-lookup"><span data-stu-id="57171-172">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="57171-173">В **новый проект** в диалоговом **типы проектов** область, убедитесь, что **Windows** выбран.</span><span class="sxs-lookup"><span data-stu-id="57171-173">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="57171-174">Выберите **библиотеки классов** в **шаблоны** области.</span><span class="sxs-lookup"><span data-stu-id="57171-174">Select **Class Library** in the **Templates** pane.</span></span> <span data-ttu-id="57171-175">В **имя** введите `TypeEquivalenceRuntime`, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-175">In the **Name** box, type `TypeEquivalenceRuntime`, and then click **OK**.</span></span> <span data-ttu-id="57171-176">Создан новый проект.</span><span class="sxs-lookup"><span data-stu-id="57171-176">The new project is created.</span></span>  
  
3.  <span data-ttu-id="57171-177">В **обозревателе решений**, щелкните правой кнопкой мыши файл Class1.vb и выберите **переименование**.</span><span class="sxs-lookup"><span data-stu-id="57171-177">In **Solution Explorer**, right-click the Class1.vb file and click **Rename**.</span></span> <span data-ttu-id="57171-178">Переименуйте файл `SampleClass.vb` и нажмите клавишу ВВОД.</span><span class="sxs-lookup"><span data-stu-id="57171-178">Rename the file to `SampleClass.vb` and press ENTER.</span></span> <span data-ttu-id="57171-179">Переименование файла также класс будет переименован в `SampleClass`.</span><span class="sxs-lookup"><span data-stu-id="57171-179">Renaming the file also renames the class to `SampleClass`.</span></span> <span data-ttu-id="57171-180">Этот класс будет реализовывать `ISampleInterface` интерфейса.</span><span class="sxs-lookup"><span data-stu-id="57171-180">This class will implement the `ISampleInterface` interface.</span></span>  
  
4.  <span data-ttu-id="57171-181">Щелкните правой кнопкой мыши проект TypeEquivalenceRuntime и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="57171-181">Right-click the TypeEquivalenceRuntime project and click **Properties**.</span></span> <span data-ttu-id="57171-182">Откройте вкладку **Компиляция**.</span><span class="sxs-lookup"><span data-stu-id="57171-182">Click the **Compile** tab.</span></span> <span data-ttu-id="57171-183">В то же расположение, которое используется в проекте TypeEquivalenceInterface, например, задайте для выходной путь `C:\TypeEquivalenceSample`.</span><span class="sxs-lookup"><span data-stu-id="57171-183">Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\TypeEquivalenceSample`.</span></span>  
  
5.  <span data-ttu-id="57171-184">Не выходя свойства проекта, откройте **подписи** вкладки.</span><span class="sxs-lookup"><span data-stu-id="57171-184">While still editing the project properties, click the **Signing** tab.</span></span> <span data-ttu-id="57171-185">Выберите **подписать сборку** параметр.</span><span class="sxs-lookup"><span data-stu-id="57171-185">Select the **Sign the assembly** option.</span></span> <span data-ttu-id="57171-186">В **выберите файл ключей строгого имени** выберите ** <New...> **.</New...></span><span class="sxs-lookup"><span data-stu-id="57171-186">In the **Choose a strong name key file** list, click **<New...>**.</span></span> <span data-ttu-id="57171-187">В **имя файла ключа** введите `key.snk`.</span><span class="sxs-lookup"><span data-stu-id="57171-187">In the **Key file name** box, type `key.snk`.</span></span> <span data-ttu-id="57171-188">Очистить **защитить мой файл ключей паролем** флажок.</span><span class="sxs-lookup"><span data-stu-id="57171-188">Clear the **Protect my key file with a password** check box.</span></span> <span data-ttu-id="57171-189">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-189">Click **OK**.</span></span>  
  
6.  <span data-ttu-id="57171-190">Щелкните правой кнопкой мыши проект TypeEquivalenceRuntime и нажмите кнопку **добавить ссылку**.</span><span class="sxs-lookup"><span data-stu-id="57171-190">Right-click the TypeEquivalenceRuntime project and click **Add Reference**.</span></span> <span data-ttu-id="57171-191">Щелкните **Обзор** вкладку и перейдите в папку выходных данных.</span><span class="sxs-lookup"><span data-stu-id="57171-191">Click the **Browse** tab and browse to the output path folder.</span></span> <span data-ttu-id="57171-192">Выберите файл TypeEquivalenceInterface.dll и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-192">Select the TypeEquivalenceInterface.dll file and click **OK**.</span></span>  
  
7.  <span data-ttu-id="57171-193">На **проекта** меню, щелкните **Показать все файлы**.</span><span class="sxs-lookup"><span data-stu-id="57171-193">On the **Project** menu, click **Show All Files**.</span></span>  
  
8.  <span data-ttu-id="57171-194">В **обозревателе решений**, разверните **ссылки** папки.</span><span class="sxs-lookup"><span data-stu-id="57171-194">In **Solution Explorer**, expand the **References** folder.</span></span> <span data-ttu-id="57171-195">Выберите ссылку TypeEquivalenceInterface.</span><span class="sxs-lookup"><span data-stu-id="57171-195">Select the TypeEquivalenceInterface reference.</span></span> <span data-ttu-id="57171-196">В окне свойств для ссылки на TypeEquivalenceInterface **версии** свойства **False**.</span><span class="sxs-lookup"><span data-stu-id="57171-196">In the Properties window for the TypeEquivalenceInterface reference, set the **Specific Version** property to **False**.</span></span>  
  
9. <span data-ttu-id="57171-197">Добавьте следующий код в файл класса SampleClass создание класса SampleClass.</span><span class="sxs-lookup"><span data-stu-id="57171-197">Add the following code to the SampleClass class file to create the SampleClass class.</span></span>  
  
<span data-ttu-id="57171-198"><CodeContentPlaceHolder>2</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="57171-198"><CodeContentPlaceHolder>2</CodeContentPlaceHolder></span></span>  
10. <span data-ttu-id="57171-199">Сохраните проект.</span><span class="sxs-lookup"><span data-stu-id="57171-199">Save the project.</span></span>  
  
11. <span data-ttu-id="57171-200">Щелкните правой кнопкой мыши проект TypeEquivalenceRuntime и нажмите кнопку **сборки**.</span><span class="sxs-lookup"><span data-stu-id="57171-200">Right-click the TypeEquivalenceRuntime project and click **Build**.</span></span> <span data-ttu-id="57171-201">DLL-файла библиотеки классов компилируется и сохранен на выходной путь построения (например, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="57171-201">The class library .dll file is compiled and saved to the specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
## <a name="creating-a-client-project"></a><span data-ttu-id="57171-202">Создание клиентского проекта</span><span class="sxs-lookup"><span data-stu-id="57171-202">Creating a Client Project</span></span>  
  
#### <a name="to-create-the-type-equivalence-client-project"></a><span data-ttu-id="57171-203">Создание проекта клиента эквивалентности типа</span><span class="sxs-lookup"><span data-stu-id="57171-203">To create the type equivalence client project</span></span>  
  
1.  <span data-ttu-id="57171-204">В Visual Studio на **файл** наведите указатель мыши на **New** и нажмите кнопку **проекта**.</span><span class="sxs-lookup"><span data-stu-id="57171-204">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="57171-205">В **новый проект** в диалоговом **типы проектов** область, убедитесь, что **Windows** выбран.</span><span class="sxs-lookup"><span data-stu-id="57171-205">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="57171-206">Выберите **консольное приложение** в **шаблоны** области.</span><span class="sxs-lookup"><span data-stu-id="57171-206">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="57171-207">В **имя** введите `TypeEquivalenceClient`, а затем нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-207">In the **Name** box, type `TypeEquivalenceClient`, and then click **OK**.</span></span> <span data-ttu-id="57171-208">Создан новый проект.</span><span class="sxs-lookup"><span data-stu-id="57171-208">The new project is created.</span></span>  
  
3.  <span data-ttu-id="57171-209">Щелкните правой кнопкой мыши проект TypeEquivalenceClient и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="57171-209">Right-click the TypeEquivalenceClient project and click **Properties**.</span></span> <span data-ttu-id="57171-210">Откройте вкладку **Компиляция**.</span><span class="sxs-lookup"><span data-stu-id="57171-210">Click the **Compile** tab.</span></span> <span data-ttu-id="57171-211">В то же расположение, которое используется в проекте TypeEquivalenceInterface, например, задайте для выходной путь `C:\TypeEquivalenceSample`.</span><span class="sxs-lookup"><span data-stu-id="57171-211">Set the output path to the same location you used in the TypeEquivalenceInterface project, for example, `C:\TypeEquivalenceSample`.</span></span>  
  
4.  <span data-ttu-id="57171-212">Щелкните правой кнопкой мыши проект TypeEquivalenceClient и нажмите кнопку **добавить ссылку**.</span><span class="sxs-lookup"><span data-stu-id="57171-212">Right-click the TypeEquivalenceClient project and click **Add Reference**.</span></span> <span data-ttu-id="57171-213">Щелкните **Обзор** вкладку и перейдите в папку выходных данных.</span><span class="sxs-lookup"><span data-stu-id="57171-213">Click the **Browse** tab and browse to the output path folder.</span></span> <span data-ttu-id="57171-214">Выберите файл TypeEquivalenceInterface.dll (не TypeEquivalenceRuntime.dll) и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="57171-214">Select the TypeEquivalenceInterface.dll file (not the TypeEquivalenceRuntime.dll) and click **OK**.</span></span>  
  
5.  <span data-ttu-id="57171-215">На **проекта** меню, щелкните **Показать все файлы**.</span><span class="sxs-lookup"><span data-stu-id="57171-215">On the **Project** menu, click **Show All Files**.</span></span>  
  
6.  <span data-ttu-id="57171-216">В **обозревателе решений**, разверните **ссылки** папки.</span><span class="sxs-lookup"><span data-stu-id="57171-216">In **Solution Explorer**, expand the **References** folder.</span></span> <span data-ttu-id="57171-217">Выберите ссылку TypeEquivalenceInterface.</span><span class="sxs-lookup"><span data-stu-id="57171-217">Select the TypeEquivalenceInterface reference.</span></span> <span data-ttu-id="57171-218">В окне свойств для ссылки на TypeEquivalenceInterface **Embed Interop Types** свойства **True**.</span><span class="sxs-lookup"><span data-stu-id="57171-218">In the Properties window for the TypeEquivalenceInterface reference, set the **Embed Interop Types** property to **True**.</span></span>  
  
7.  <span data-ttu-id="57171-219">Добавьте следующий код в файл Module1.vb для создания клиентской программы.</span><span class="sxs-lookup"><span data-stu-id="57171-219">Add the following code to the Module1.vb file to create the client program.</span></span>  
  
<span data-ttu-id="57171-220"><CodeContentPlaceHolder>3</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="57171-220"><CodeContentPlaceHolder>3</CodeContentPlaceHolder></span></span>  
8.  <span data-ttu-id="57171-221">Нажмите CTRL + F5, чтобы построить и запустить программу.</span><span class="sxs-lookup"><span data-stu-id="57171-221">Press CTRL+F5 to build and run the program.</span></span>  
  
## <a name="modifying-the-interface"></a><span data-ttu-id="57171-222">Изменение интерфейса</span><span class="sxs-lookup"><span data-stu-id="57171-222">Modifying the Interface</span></span>  
  
#### <a name="to-modify-the-interface"></a><span data-ttu-id="57171-223">Изменение интерфейса</span><span class="sxs-lookup"><span data-stu-id="57171-223">To modify the interface</span></span>  
  
1.  <span data-ttu-id="57171-224">В Visual Studio на **файл** наведите указатель мыши на **откройте**, а затем нажмите кнопку **решение или проект**.</span><span class="sxs-lookup"><span data-stu-id="57171-224">In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**.</span></span>  
  
2.  <span data-ttu-id="57171-225">В **открыть проект** диалоговое окно, щелкните правой кнопкой мыши проект TypeEquivalenceInterface и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="57171-225">In the **Open Project** dialog box, right-click the TypeEquivalenceInterface project, and then click **Properties**.</span></span> <span data-ttu-id="57171-226">Перейдите на вкладку **Приложение** .</span><span class="sxs-lookup"><span data-stu-id="57171-226">Click the **Application** tab.</span></span> <span data-ttu-id="57171-227">Щелкните **сведения о сборке** кнопки.</span><span class="sxs-lookup"><span data-stu-id="57171-227">Click the **Assembly Information** button.</span></span> <span data-ttu-id="57171-228">Изменение **версию сборки** и **версия файла** значения `2.0.0.0`.</span><span class="sxs-lookup"><span data-stu-id="57171-228">Change the **Assembly Version** and **File Version** values to `2.0.0.0`.</span></span>  
  
3.  <span data-ttu-id="57171-229">Откройте файл ISampleInterface.vb.</span><span class="sxs-lookup"><span data-stu-id="57171-229">Open the ISampleInterface.vb file.</span></span> <span data-ttu-id="57171-230">Добавьте следующую строку кода в интерфейс ISampleInterface.</span><span class="sxs-lookup"><span data-stu-id="57171-230">Add the following line of code to the ISampleInterface interface.</span></span>  
  
<span data-ttu-id="57171-231"><CodeContentPlaceHolder>4</CodeContentPlaceHolder></span><span class="sxs-lookup"><span data-stu-id="57171-231"><CodeContentPlaceHolder>4</CodeContentPlaceHolder></span></span>  
     <span data-ttu-id="57171-232">Сохраните файл.</span><span class="sxs-lookup"><span data-stu-id="57171-232">Save the file.</span></span>  
  
4.  <span data-ttu-id="57171-233">Сохраните проект.</span><span class="sxs-lookup"><span data-stu-id="57171-233">Save the project.</span></span>  
  
5.  <span data-ttu-id="57171-234">Щелкните правой кнопкой мыши проект TypeEquivalenceInterface и нажмите кнопку **сборки**.</span><span class="sxs-lookup"><span data-stu-id="57171-234">Right-click the TypeEquivalenceInterface project and click **Build**.</span></span> <span data-ttu-id="57171-235">Новая версия DLL-файла библиотеки классов компилируется и сохраняется в папке выходных данных построения (например, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="57171-235">A new version of the class library .dll file is compiled and saved in the specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
## <a name="modifying-the-runtime-class"></a><span data-ttu-id="57171-236">Изменение класса среды выполнения</span><span class="sxs-lookup"><span data-stu-id="57171-236">Modifying the Runtime Class</span></span>  
  
#### <a name="to-modify-the-runtime-class"></a><span data-ttu-id="57171-237">Изменение класса среды выполнения</span><span class="sxs-lookup"><span data-stu-id="57171-237">To modify the runtime class</span></span>  
  
1.  <span data-ttu-id="57171-238">В Visual Studio на **файл** наведите указатель мыши на **откройте**, а затем нажмите кнопку **решение или проект**.</span><span class="sxs-lookup"><span data-stu-id="57171-238">In Visual Studio, on the **File** menu, point to **Open**, and then click **Project/Solution**.</span></span>  
  
2.  <span data-ttu-id="57171-239">В **открыть проект** диалоговое окно, щелкните правой кнопкой мыши проект TypeEquivalenceRuntime и нажмите кнопку **свойства**.</span><span class="sxs-lookup"><span data-stu-id="57171-239">In the **Open Project** dialog box, right-click the TypeEquivalenceRuntime project and click **Properties**.</span></span> <span data-ttu-id="57171-240">Перейдите на вкладку **Приложение** .</span><span class="sxs-lookup"><span data-stu-id="57171-240">Click the **Application** tab.</span></span> <span data-ttu-id="57171-241">Щелкните **сведения о сборке** кнопки.</span><span class="sxs-lookup"><span data-stu-id="57171-241">Click the **Assembly Information** button.</span></span> <span data-ttu-id="57171-242">Изменение **версию сборки** и **версия файла** значения `2.0.0.0`.</span><span class="sxs-lookup"><span data-stu-id="57171-242">Change the **Assembly Version** and **File Version** values to `2.0.0.0`.</span></span>  
  
3.  <span data-ttu-id="57171-243">Откройте SampleClass.vbfile.</span><span class="sxs-lookup"><span data-stu-id="57171-243">Open the SampleClass.vbfile.</span></span> <span data-ttu-id="57171-244">Добавьте следующий код в класс SampleClass.</span><span class="sxs-lookup"><span data-stu-id="57171-244">Add the following lines of code to the SampleClass class.</span></span>  
  
```vb  
Public Function GetDate() As DateTime Implements ISampleInterface.GetDate  
    Return Now  
End Function  
```  
  
     Save the file.  
  
4.  <span data-ttu-id="57171-245">Сохраните проект.</span><span class="sxs-lookup"><span data-stu-id="57171-245">Save the project.</span></span>  
  
5.  <span data-ttu-id="57171-246">Щелкните правой кнопкой мыши проект TypeEquivalenceRuntime и нажмите кнопку **сборки**.</span><span class="sxs-lookup"><span data-stu-id="57171-246">Right-click the TypeEquivalenceRuntime project and click **Build**.</span></span> <span data-ttu-id="57171-247">Обновленная версия DLL-файла библиотеки классов компилируется и сохраняется в папке выходных данных ранее указанной сборки (например, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="57171-247">An updated version of the class library .dll file is compiled and saved in the previously specified build output path (for example, C:\TypeEquivalenceSample).</span></span>  
  
6.  <span data-ttu-id="57171-248">В проводнике откройте папку выходной файл (например, C:\TypeEquivalenceSample).</span><span class="sxs-lookup"><span data-stu-id="57171-248">In File Explorer, open the output path folder (for example, C:\TypeEquivalenceSample).</span></span> <span data-ttu-id="57171-249">Дважды щелкните TypeEquivalenceClient.exe для запуска программы.</span><span class="sxs-lookup"><span data-stu-id="57171-249">Double-click the TypeEquivalenceClient.exe to run the program.</span></span> <span data-ttu-id="57171-250">В программе отображается новая версия сборки TypeEquivalenceRuntime не выполнена.</span><span class="sxs-lookup"><span data-stu-id="57171-250">The program will reflect the new version of the TypeEquivalenceRuntime assembly without having been recompiled.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="57171-251">См. также</span><span class="sxs-lookup"><span data-stu-id="57171-251">See Also</span></span>  
 <span data-ttu-id="57171-252">[/ LINK (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/link.md) </span><span class="sxs-lookup"><span data-stu-id="57171-252">[/link (Visual Basic)](../../../../visual-basic/reference/command-line-compiler/link.md) </span></span>  
<span data-ttu-id="57171-253"> [Основные понятия программирования](../../../../visual-basic/programming-guide/concepts/index.md) </span><span class="sxs-lookup"><span data-stu-id="57171-253"> [Programming Concepts](../../../../visual-basic/programming-guide/concepts/index.md) </span></span>  
<span data-ttu-id="57171-254"> [Программирование с использованием сборок](http://msdn.microsoft.com/library/25918b15-701d-42c7-95fc-c290d08648d6) </span><span class="sxs-lookup"><span data-stu-id="57171-254"> [Programming with Assemblies](http://msdn.microsoft.com/library/25918b15-701d-42c7-95fc-c290d08648d6) </span></span>  
<span data-ttu-id="57171-255"> [Сборки и глобальный кэш сборок (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)</span><span class="sxs-lookup"><span data-stu-id="57171-255"> [Assemblies and the Global Assembly Cache (Visual Basic)](../../../../visual-basic/programming-guide/concepts/assemblies-gac/index.md)</span></span>

