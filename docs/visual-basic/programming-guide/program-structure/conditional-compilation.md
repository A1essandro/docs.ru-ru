---
title: Условная компиляция в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- conditional compilation [Visual Basic], about conditional compilation
- compilation [Visual Basic], conditional
ms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848
ms.openlocfilehash: 496df36242c6b43e7e3ec94ce675d11177e8b466
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="conditional-compilation-in-visual-basic"></a>Условная компиляция в Visual Basic
В *условной компиляции*, определенной блоки кода в программе компилируются, пока другие атрибуты игнорируются.  
  
 Например, может потребоваться написать инструкций отладки, которые сравнивают скорость различные подходы к той же задачи программирования, или может потребоваться локализации приложения для нескольких языков. Условная компиляция инструкции предназначены для выполнения во время компиляции, а не во время выполнения.  
  
 Блоки кода для условной компиляции с `#If...Then...#Else` директивы. Например, для создания французском и немецком языках версии одного приложения из того же исходного кода, необходимо внедрить сегменты кода для конкретной платформы в `#If...Then` операторов с использованием предопределенных констант `FrenchVersion` и `GermanVersion`. В следующем примере показано, как:  
  
 [!code-vb[VbVbalrConditionalComp#5](../../../visual-basic/language-reference/directives/codesnippet/VisualBasic/conditional-compilation_1.vb)]  
  
 Если задать значение `FrenchVersion` для константы условной компиляции `True` во время компиляции, компилируется условный код для французской версии. Если задать значение `GermanVersion` константа, которая `True`, компилятор использует немецкую версию. Если не задан ни один `True`, код в последнем `Else` блок.  
  
> [!NOTE]
>  Автоматическое завершение будет не работает при редактировании кода и использовании директив условной компиляции, если код не является частью текущей ветви.  
  
## <a name="declaring-conditional-compilation-constants"></a>Объявление константы условной компиляции  
 Константы условной компиляции можно задать одним из трех способов:  
  
-   В **в конструкторе проектов**  
  
-   В командной строке при использовании компилятора командной строки  
  
-   В коде  
  
 Константы условной компиляции находятся в отдельной области и не доступен из обычного кода. Константа условной компиляции относится зависит от способа его задания. В следующей таблице перечислены области константы, объявленные с помощью каждого из трех описанных выше методов.  
  
|Способ задания константы|Область действия констант|  
|---|---|  
|**Конструктор проектов**|Открыта для всех файлов в проекте|  
|Командная строка|Открыта для всех файлов, передаваемые компилятору командной строки|  
|`#Const` инструкции в коде|Внутри файла, в котором она объявлена|  
  
|Для задания констант в конструкторе проектов|  
|---|  
|-Перед созданием исполняемого файла, задайте константы **конструктора проектов** , выполнив действия, описанные в [управление проектом и свойства решения](/visualstudio/ide/managing-project-and-solution-properties).|  
  
|Для задания констант в командной строке|  
|---|  
|-Используйте **/d** вставьте константы условной компиляции, как показано в следующем примере:<br />     `vbc MyProj.vb /d:conFrenchVersion=–1:conANSI=0`<br />     Без пробела между **/d** коммутатор и что первая константа. Дополнительные сведения см. в разделе [/ define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md).<br />     Объявления из командной строки переопределяют объявления в **конструктора проектов**, но не удаляют их. Задайте аргументы в **конструктора проектов** остаются в силе для последующих компиляциях.<br />     При написании константы в коде, нет строгого правил по их расположению, однако их область действия всего модуля, в котором они объявлены.|  
  
|Для задания констант в коде|  
|---|  
|-Установите константы в блоке объявления модуля, в котором они используются. Это помогает поддерживать код и облегчить чтение.|  
  
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание|  
|---|---|  
|[Соглашения о структуре программы и коде](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)|Рекомендации по упрощению чтение и обслуживание кода.|  
  
## <a name="reference"></a>Ссылка  
 [Директива #Const](../../../visual-basic/language-reference/directives/const-directive.md)  
  
 [Директивы #If...Then...#Else](../../../visual-basic/language-reference/directives/if-then-else-directives.md)  
  
 [/ define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md)
