---
title: Анонимные типы (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: 451fe45c9b5efbeb64b1066d6ba8e5f9b27300c2
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33656260"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="b1db4-102">Анонимные типы (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="b1db4-102">Anonymous Types (Visual Basic)</span></span>
<span data-ttu-id="b1db4-103">Visual Basic поддерживает анонимные типы, которые позволяют создавать объекты без написания определения класса для типа данных.</span><span class="sxs-lookup"><span data-stu-id="b1db4-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="b1db4-104">Вместо этого компилятор создает класс для вас.</span><span class="sxs-lookup"><span data-stu-id="b1db4-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="b1db4-105">Класс не имеет имени, наследует непосредственно от <xref:System.Object>и содержит свойства, которые указаны при объявлении объекта.</span><span class="sxs-lookup"><span data-stu-id="b1db4-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="b1db4-106">Так как имя типа данных не указан, он называется *анонимного типа*.</span><span class="sxs-lookup"><span data-stu-id="b1db4-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="b1db4-107">В следующем примере объявляется и создается переменная `product` как экземпляр анонимного типа, который имеет два свойства `Name` и `Price`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_1.vb)]  
  
 <span data-ttu-id="b1db4-108">Объект *выражение запроса* использует анонимные типы для объединения столбцов данных, выбранных по запросу.</span><span class="sxs-lookup"><span data-stu-id="b1db4-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="b1db4-109">Невозможно определить тип результата заранее, так как невозможно предсказать, столбцы, которые может выбрать определенный запрос.</span><span class="sxs-lookup"><span data-stu-id="b1db4-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="b1db4-110">Анонимные типы позволяют написать запрос, выбирающий любое количество столбцов, в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="b1db4-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="b1db4-111">Компилятор создает тип данных, который соответствует указанным свойствам и заданном порядке.</span><span class="sxs-lookup"><span data-stu-id="b1db4-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="b1db4-112">В следующих примерах `products` приведен список объектов продукта, каждый из которых имеет много свойств.</span><span class="sxs-lookup"><span data-stu-id="b1db4-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="b1db4-113">Переменная `namePriceQuery` содержит определение запроса, который при выполнении возвращает коллекцию экземпляров анонимного типа с двумя свойствами `Name` и `Price`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_2.vb)]  
  
 <span data-ttu-id="b1db4-114">Переменная `nameQuantityQuery` содержит определение запроса, который при выполнении возвращает коллекцию экземпляров анонимного типа с двумя свойствами `Name` и `OnHand`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_3.vb)]  
  
 <span data-ttu-id="b1db4-115">Дополнительные сведения о коде, созданном компилятором для анонимного типа см. в разделе [определение анонимного типа](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="b1db4-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
>  <span data-ttu-id="b1db4-116">Имя анонимного типа будет создан компилятором и могут различаться для разных компиляций.</span><span class="sxs-lookup"><span data-stu-id="b1db4-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="b1db4-117">Код должен использовать или не зависит от имени анонимного типа, так как имя может измениться при повторной компиляции проекта.</span><span class="sxs-lookup"><span data-stu-id="b1db4-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="b1db4-118">Объявление анонимного типа</span><span class="sxs-lookup"><span data-stu-id="b1db4-118">Declaring an Anonymous Type</span></span>  
 <span data-ttu-id="b1db4-119">При объявлении экземпляра анонимного типа используется список инициализаторов для указания свойств типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="b1db4-120">Можно указать только свойства при объявлении анонимного типа, не другие элементы класса, например методы или события.</span><span class="sxs-lookup"><span data-stu-id="b1db4-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="b1db4-121">В следующем примере `product1` представляет собой экземпляр анонимного типа, который имеет два свойства: `Name` и `Price`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_4.vb)]  
  
 <span data-ttu-id="b1db4-122">Если назначить свойства как ключевые свойства, их можно использовать для сравнения на равенство двух экземпляров анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="b1db4-123">Однако значения ключевых свойств не может изменяться.</span><span class="sxs-lookup"><span data-stu-id="b1db4-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="b1db4-124">В разделе Основные свойства далее в этом разделе для получения дополнительной информации.</span><span class="sxs-lookup"><span data-stu-id="b1db4-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="b1db4-125">Обратите внимание, что объявление экземпляра анонимного типа как объявление экземпляра именованного типа с помощью инициализатора объекта:</span><span class="sxs-lookup"><span data-stu-id="b1db4-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_5.vb)]  
  
 <span data-ttu-id="b1db4-126">Дополнительные сведения о других способах задания свойств анонимного типа см. в разделе [как: определить имена свойств и типов в объявлениях анонимных типов](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="b1db4-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="b1db4-127">Ключевые свойства</span><span class="sxs-lookup"><span data-stu-id="b1db4-127">Key Properties</span></span>  
 <span data-ttu-id="b1db4-128">Ключевые свойства отличаются от неключевые свойства фундаментальные способами:</span><span class="sxs-lookup"><span data-stu-id="b1db4-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
-   <span data-ttu-id="b1db4-129">Чтобы определить, равны ли два экземпляра, сравниваются только значения ключевых свойств.</span><span class="sxs-lookup"><span data-stu-id="b1db4-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
-   <span data-ttu-id="b1db4-130">Значения ключевых свойств доступны только для чтения и не может быть изменено.</span><span class="sxs-lookup"><span data-stu-id="b1db4-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
-   <span data-ttu-id="b1db4-131">Только ключевые значения свойства включаются в алгоритме созданный компилятором хэш-код для анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="b1db4-132">Равенство</span><span class="sxs-lookup"><span data-stu-id="b1db4-132">Equality</span></span>  
 <span data-ttu-id="b1db4-133">Экземпляры анонимных типов могут быть равны только в том случае, если они являются экземплярами одного анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="b1db4-134">Компилятор обрабатывает два экземпляра как экземпляры того же типа, при соблюдении следующих условий:</span><span class="sxs-lookup"><span data-stu-id="b1db4-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
-   <span data-ttu-id="b1db4-135">Они объявляются в той же сборке.</span><span class="sxs-lookup"><span data-stu-id="b1db4-135">They are declared in the same assembly.</span></span>  
  
-   <span data-ttu-id="b1db4-136">Все свойства имеют те же имена, те же возвращаемые типы и объявляются в том же порядке.</span><span class="sxs-lookup"><span data-stu-id="b1db4-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="b1db4-137">Имя сравнения регистр не учитывается.</span><span class="sxs-lookup"><span data-stu-id="b1db4-137">Name comparisons are not case-sensitive.</span></span>  
  
-   <span data-ttu-id="b1db4-138">Те же свойства в каждом помечаются как ключевые свойства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-138">The same properties in each are marked as key properties.</span></span>  
  
-   <span data-ttu-id="b1db4-139">По крайней мере одно свойство в каждое объявление является свойством ключа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="b1db4-140">Экземпляр анонимного типа, который не имеет ключевого свойства равен только самому себе.</span><span class="sxs-lookup"><span data-stu-id="b1db4-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_6.vb)]  
  
 <span data-ttu-id="b1db4-141">Два экземпляра одного анонимного типа равны, если равны значения их ключевых свойств.</span><span class="sxs-lookup"><span data-stu-id="b1db4-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="b1db4-142">Следующие примеры иллюстрируют способ проверки равенства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_7.vb)]  
  
### <a name="read-only-values"></a><span data-ttu-id="b1db4-143">Значения, доступные только для чтения</span><span class="sxs-lookup"><span data-stu-id="b1db4-143">Read-Only Values</span></span>  
 <span data-ttu-id="b1db4-144">Невозможно изменить значения ключевых свойств.</span><span class="sxs-lookup"><span data-stu-id="b1db4-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="b1db4-145">Например, в `prod8` в предыдущем примере `Name` и `Price` поля являются `read-only`, но `OnHand` может быть изменено.</span><span class="sxs-lookup"><span data-stu-id="b1db4-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_8.vb)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="b1db4-146">Анонимные типы из выражений запросов</span><span class="sxs-lookup"><span data-stu-id="b1db4-146">Anonymous Types from Query Expressions</span></span>  
 <span data-ttu-id="b1db4-147">Выражения запросов не всегда требуют создания анонимных типов.</span><span class="sxs-lookup"><span data-stu-id="b1db4-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="b1db4-148">Если это возможно, они используют существующий тип для хранения данных столбца.</span><span class="sxs-lookup"><span data-stu-id="b1db4-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="b1db4-149">Это происходит, когда запрос возвращает либо все записи из источника данных или только одно поле из каждой записи.</span><span class="sxs-lookup"><span data-stu-id="b1db4-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="b1db4-150">В следующих примерах кода `customers` — это коллекция объектов `Customer` класса.</span><span class="sxs-lookup"><span data-stu-id="b1db4-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="b1db4-151">Класс имеет много свойств, и может включать один или несколько из них в результатах запроса в любом порядке.</span><span class="sxs-lookup"><span data-stu-id="b1db4-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="b1db4-152">В первых двух примерах анонимные типы не требуется, так как запросы выбирают элементы из именованных типов:</span><span class="sxs-lookup"><span data-stu-id="b1db4-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
-   <span data-ttu-id="b1db4-153">`custs1` содержит коллекцию строк, поскольку `cust.Name` является строкой.</span><span class="sxs-lookup"><span data-stu-id="b1db4-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_9.vb)]  
  
-   <span data-ttu-id="b1db4-154">`custs2` содержит коллекцию `Customer` объектов, так как каждый элемент `customers` — `Customer` объекта, а весь элемент выбран в запросе.</span><span class="sxs-lookup"><span data-stu-id="b1db4-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_10.vb)]  
  
 <span data-ttu-id="b1db4-155">Однако соответствующие именованные типы доступны не всегда.</span><span class="sxs-lookup"><span data-stu-id="b1db4-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="b1db4-156">Можно выбрать имена клиентов и адреса для одной цели, идентификаторы клиентов и расположения для другого и имена клиентов, адреса и журнал заказов клиентов для третьего.</span><span class="sxs-lookup"><span data-stu-id="b1db4-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="b1db4-157">Анонимные типы позволяют выбрать любое сочетание свойств, в любом порядке, без предварительного объявления нового именованного типа для хранения результатов.</span><span class="sxs-lookup"><span data-stu-id="b1db4-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="b1db4-158">Вместо этого компилятор создает анонимный тип для каждой группы свойств.</span><span class="sxs-lookup"><span data-stu-id="b1db4-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="b1db4-159">Следующий запрос выбирает только имя и ИД клиента из каждого `Customer` объекта в `customers`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="b1db4-160">Таким образом компилятор создает анонимный тип, который содержит только эти два свойства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_11.vb)]  
  
 <span data-ttu-id="b1db4-161">Имена и типы данных свойств в анонимном типе, взяты из аргументов `Select`, `cust.Name` и `cust.ID`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="b1db4-162">Свойства в анонимный тип, созданный по запросу всегда являются ключевыми свойствами.</span><span class="sxs-lookup"><span data-stu-id="b1db4-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="b1db4-163">Когда `custs3` выполняется в следующих `For Each` цикла, результат представляет собой коллекцию экземпляров анонимного типа с двумя ключевыми свойствами `Name` и `ID`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_12.vb)]  
  
 <span data-ttu-id="b1db4-164">Элементы в коллекции, представленной `custs3` строго типизированы, можно использовать IntelliSense для просмотра доступных свойств и для проверки их типов.</span><span class="sxs-lookup"><span data-stu-id="b1db4-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="b1db4-165">Дополнительные сведения см. в разделе [Знакомство с LINQ в Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="b1db4-165">For more information, see [Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="b1db4-166">Принятие решения об использовании анонимные типы</span><span class="sxs-lookup"><span data-stu-id="b1db4-166">Deciding Whether to Use Anonymous Types</span></span>  
 <span data-ttu-id="b1db4-167">Прежде чем создавать объект как экземпляр анонимного класса, убедитесь, что это наиболее подходящий вариант.</span><span class="sxs-lookup"><span data-stu-id="b1db4-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="b1db4-168">Например если вы хотите создать временный объект, содержащий связанные данные, а не нужен для других полей и методов, которые могут содержать полный класс, анонимный тип — это хорошее решение.</span><span class="sxs-lookup"><span data-stu-id="b1db4-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="b1db4-169">Анонимные типы также являются удобным различные наборы свойств для каждого объявления, или если вы хотите изменить порядок свойств.</span><span class="sxs-lookup"><span data-stu-id="b1db4-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="b1db4-170">Тем не менее если проект содержит несколько объектов, которые имеют те же свойства в определенном порядке, можно объявить их проще с помощью именованного типа с помощью конструктора класса.</span><span class="sxs-lookup"><span data-stu-id="b1db4-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="b1db4-171">Например, с соответствующим конструктором, проще объявить несколько экземпляров `Product` класса не требуется объявлять несколько экземпляров анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_13.vb)]  
  
 <span data-ttu-id="b1db4-172">Является еще одним преимуществом использования именованных типов, компилятор может перехватить случайную опечатку имени свойства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="b1db4-173">В предыдущих примерах `firstProd2`, `secondProd2`, и `thirdProd2` должны быть экземплярами одного анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="b1db4-174">Однако, если случайно объявить `thirdProd2` в одном из следующих способов, его тип будет отличаться от `firstProd2` и `secondProd2`.</span><span class="sxs-lookup"><span data-stu-id="b1db4-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](../../../../visual-basic/language-reference/modifiers/codesnippet/VisualBasic/anonymous-types_14.vb)]  
  
 <span data-ttu-id="b1db4-175">Более того существуют ограничения на использование анонимных типов, которые не применяются к экземплярам именованных типов.</span><span class="sxs-lookup"><span data-stu-id="b1db4-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="b1db4-176">`firstProd2`, `secondProd2`, и `thirdProd2` являются экземплярами одного анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="b1db4-177">Однако имя для общего анонимного типа недоступен и не может находиться там, где ожидается имя типа в коде.</span><span class="sxs-lookup"><span data-stu-id="b1db4-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="b1db4-178">Например анонимный тип не может использоваться для определения сигнатуры метода, для объявления других переменных или полей или в любом объявлении типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="b1db4-179">В результате анонимные типы не подходит при наличии совместное использование информации в методы.</span><span class="sxs-lookup"><span data-stu-id="b1db4-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="b1db4-180">Определение анонимного типа</span><span class="sxs-lookup"><span data-stu-id="b1db4-180">An Anonymous Type Definition</span></span>  
 <span data-ttu-id="b1db4-181">В ответ на объявление экземпляра анонимного типа компилятор создает определение нового класса, который содержит указанные свойства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="b1db4-182">Если анонимный тип содержит по крайней мере одно ключевое свойство, определение переопределяет три члена, унаследованные от <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, и <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="b1db4-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="b1db4-183">Код, созданный для проверки равенства и определения значения хэш-кода рассматривает только ключевые свойства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="b1db4-184">Если анонимный тип не содержит ключевых свойств, только <xref:System.Object.ToString%2A> переопределяется.</span><span class="sxs-lookup"><span data-stu-id="b1db4-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="b1db4-185">Явно именованные свойства анонимного типа не могут конфликтовать с этими созданными методами.</span><span class="sxs-lookup"><span data-stu-id="b1db4-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="b1db4-186">Другими словами, нельзя использовать `.Equals`, `.GetHashCode`, или `.ToString` для имени свойства.</span><span class="sxs-lookup"><span data-stu-id="b1db4-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="b1db4-187">Определения анонимного типа, которые имеют по крайней мере одно ключевое свойство, также реализуют <xref:System.IEquatable%601?displayProperty=nameWithType> интерфейса, где `T` тип анонимного типа.</span><span class="sxs-lookup"><span data-stu-id="b1db4-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="b1db4-188">Дополнительные сведения о коде, созданном компилятором, и функциональные возможности переопределенных методов см. в разделе [определение анонимного типа](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="b1db4-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b1db4-189">См. также</span><span class="sxs-lookup"><span data-stu-id="b1db4-189">See Also</span></span>  
 [<span data-ttu-id="b1db4-190">Инициализаторы объектов. Именованные и анонимные типы</span><span class="sxs-lookup"><span data-stu-id="b1db4-190">Object Initializers: Named and Anonymous Types</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)  
 [<span data-ttu-id="b1db4-191">Вывод локального типа</span><span class="sxs-lookup"><span data-stu-id="b1db4-191">Local Type Inference</span></span>](../../../../visual-basic/programming-guide/language-features/variables/local-type-inference.md)  
 <span data-ttu-id="b1db4-192">[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md) (Знакомство с LINQ в Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="b1db4-192">[Introduction to LINQ in Visual Basic](../../../../visual-basic/programming-guide/language-features/linq/introduction-to-linq.md)</span></span>  
 [<span data-ttu-id="b1db4-193">Практическое руководство. Выведение имен свойств и типов в объявлениях анонимных типов</span><span class="sxs-lookup"><span data-stu-id="b1db4-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)  
 [<span data-ttu-id="b1db4-194">Определение анонимного типа</span><span class="sxs-lookup"><span data-stu-id="b1db4-194">Anonymous Type Definition</span></span>](../../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)  
 [<span data-ttu-id="b1db4-195">Key</span><span class="sxs-lookup"><span data-stu-id="b1db4-195">Key</span></span>](../../../../visual-basic/language-reference/modifiers/key.md)
