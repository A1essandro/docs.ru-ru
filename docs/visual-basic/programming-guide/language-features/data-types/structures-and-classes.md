---
title: "Структуры и классы (Visual Basic) | Документы Microsoft"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures
- classes [Visual Basic]
- structures, compared to classes
- structures, structure variables
- structure variables
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
caps.latest.revision: 21
author: stevehoag
ms.author: shoag
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: e7402ec0fcfc279470d39a4919d3b5ec8b5d9dff
ms.lasthandoff: 03/13/2017

---
# <a name="structures-and-classes-visual-basic"></a>Структуры и классы (Visual Basic)
[!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)]унифицирован синтаксис структур и классов, в результате чего обе сущности поддерживают большинство тех же функций. Тем не менее существуют важные различия между структурами и классами.  
  
 Классы имеют преимущество ссылочных типов — ссылки более эффективна, чем передача переменной структуры с его данными. С другой стороны структур не требуется выделение памяти в куче глобального.  
  
 Так как не может наследовать от структуры, структуры можно использовать только для объектов, которые не обязательно должны быть расширен. Используйте структуры, если объект, который вы хотите создать экземпляр небольшой размер и принимать во внимание характеристики производительности классов и структур.  
  
## <a name="similarities"></a>Сходство  
 Структуры и классы схожи в следующих отношениях:  
  
-   Оба *контейнер* типов, то есть содержат другие типы в качестве членов.  
  
-   Оба имеют членов, включая конструкторы, методы, свойства, поля, константы, перечисления, события и обработчики событий. Однако не следует путать эти члены, объявленные с *элементы* структуры.  
  
-   Их элементы могут иметь индивидуальные уровни доступа. Например, может быть объявлен один член `Public` и другим `Private`.  
  
-   Они могут реализовывать интерфейсы.  
  
-   Они имеют общие конструкторы с параметрами или без параметров.  
  
-   Они могут предоставлять *по умолчанию свойство*, если это свойство принимает хотя бы один параметр.  
  
-   Они могут объявлять и создавать события и могут объявлять делегаты.  
  
## <a name="differences"></a>Различия  
 Структуры и классы отличаются следующими особенностями:  
  
-   Структуры являются *типы значений*; классы являются *ссылочные типы*. Переменная типа структуры содержит данные структуры, а чем содержащий ссылку на данные в виде типа класса.  
  
-   Структуры используют расположение стека; классы используют память в куче.  
  
-   Все элементы структуры, `Public` по умолчанию; класс переменные и константы- `Private` по умолчанию, а другие члены класса являются `Public` по умолчанию. Такое поведение членов класса обеспечивает совместимость с системой Visual Basic 6.0, значений по умолчанию.  
  
-   Структуры должны иметь по крайней мере один не совместно переменную или без общего доступа элемента события; класс может быть пустым.  
  
-   Элементы структуры не могут объявляться как `Protected`; члены класса могут.  
  
-   Процедура структуры может обрабатывать события только в том случае, если это [Shared](../../../../visual-basic/language-reference/modifiers/shared.md) `Sub` процедура и только с помощью параметра [оператор AddHandler](../../../../visual-basic/language-reference/statements/addhandler-statement.md); любая процедура класса может обработать событие, используя либо [обрабатывает](../../../../visual-basic/language-reference/statements/handles-clause.md) ключевое слово или `AddHandler` инструкции. Дополнительные сведения см. в разделе [события](../../../../visual-basic/programming-guide/language-features/events/index.md).  
  
-   Объявления переменных структуры нельзя указать инициализаторы или исходные размеры массивов; возможность объявления переменных класса.  
  
-   Структуры неявно наследуют от <xref:System.ValueType?displayProperty=fullName>класса и не может наследоваться от любого другого типа; классы могут наследовать от любых классов, отличных от <xref:System.ValueType?displayProperty=fullName>.</xref:System.ValueType?displayProperty=fullName> </xref:System.ValueType?displayProperty=fullName>  
  
-   Структуры не наследуются; классы являются.  
  
-   Структуры никогда не завершаются, поэтому общеязыковой среды выполнения (CLR) никогда не вызывает <xref:System.Object.Finalize%2A>метод для структур; классы завершаются сборщиком мусора (GC), который вызывает <xref:System.Object.Finalize%2A>для класса, когда обнаруживает, что не осталось активных ссылок.</xref:System.Object.Finalize%2A> </xref:System.Object.Finalize%2A>  
  
-   Структуры не требуется конструктор; для класса требуется.  
  
-   Структуры могут иметь не общие конструкторы, только если они принимают параметры; классы могут иметь их с параметрами или без параметров.  
  
 Каждая структура имеет неявный открытый конструктор без параметров. Этот конструктор инициализирует элементы структуры данных к значениям по умолчанию. Не удалось переопределить это поведение.  
  
## <a name="instances-and-variables"></a>Экземпляры и переменные  
 Поскольку структуры являются типами значений, каждая переменная структуры постоянно привязана к отдельному экземпляру структуры. Классы являются ссылочными типами, и переменная объекта может ссылаться на различные экземпляры класса в разное время. Это различие влияет на использование структур и классов следующим образом:  
  
-   **Инициализация.** Переменная структуры неявно содержит инициализацию элементов с помощью структуры конструктор без параметров. Таким образом `Dim s As struct1` эквивалентно `Dim s As struct1 = New struct1()`.  
  
-   **Присваивание переменных.** Когда одна переменная структуры присваивается другой или экземпляр структуры передается в аргумент процедуры, текущие значения всех элементов переменной копируются в новую структуру. Когда переменная объекта присваивается другой или передается в процедуру, копируется только указатель ссылки.  
  
-   **Назначение ничего.** Можно назначить значение [ничего](../../../../visual-basic/language-reference/nothing.md) в структуру переменной, но экземпляр продолжает оставаться связанным с переменной. Можно по-прежнему вызывать его методы и доступ к ее элементам данных, хотя элементы переменной заново инициализируются назначением.  
  
     Напротив, если задано значение переменной объекта `Nothing`, она не связана ни с каким экземпляром класса и доступ к любым элементам через переменную невозможно, пока не будет присвоен другой экземпляр.  
  
-   **Несколько экземпляров.** Переменной объекта может иметь разные экземпляры класса назначены в различные моменты времени, и несколько переменных объекта может ссылаться на один экземпляр класса в то же время. Изменения, внесенные в значения членов класса, влияют на эти члены при доступе через другую переменную, указывающую на тот же экземпляр.  
  
     Элементы структуры изолированы в пределах своего экземпляра. Изменения в их значения не отражаются в любой других переменных структуры, даже в других экземплярах того же `Structure` объявления.  
  
-   **Проверки на равенство.** Проверки равенства двух структур должна выполняться с параметром-элемент теста. Две переменные объекта могут сравниваться с помощью <xref:System.Object.Equals%2A>метод.</xref:System.Object.Equals%2A> <xref:System.Object.Equals%2A>Определяет, указывают ли две переменные на один экземпляр.</xref:System.Object.Equals%2A>  
  
## <a name="see-also"></a>См. также  
 [Типы данных](../../../../visual-basic/programming-guide/language-features/data-types/index.md)   
 [Составные типы данных](../../../../visual-basic/programming-guide/language-features/data-types/composite-data-types.md)   
 [Типы значений и ссылочные типы](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)   
 [Структуры](../../../../visual-basic/programming-guide/language-features/data-types/structures.md)   
 [Устранение неполадок типы данных](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)   
 [Структуры и другие элементы программирования](../../../../visual-basic/programming-guide/language-features/data-types/structures-and-other-programming-elements.md)   
 [Объекты и классы](../../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)
