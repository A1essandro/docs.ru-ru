---
title: Структуры и классы (Visual Basic)
ms.custom: ''
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology:
- devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: cf72fb0a7a34d45774cb9a58c037ebcb1c05288f
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="structures-and-classes-visual-basic"></a>Структуры и классы (Visual Basic)
Visual Basic объединяет синтаксис структур и классов, в результате чего обе сущности поддерживают большинство тех же функций. Однако существуют важные различия между структуры и классы.  
  
 Классы имеют преимущество ссылочных типов — ссылки более эффективна, чем передача переменной структуры со всеми данными. С другой стороны структуры не требуют выделения памяти в куче глобального.  
  
 Так как не может наследовать от структуры, структуры можно использовать только для объектов, которые не обязательно должны быть расширен. Используйте структуры, если объект, который вы хотите создать экземпляр небольшой размер и принимать во внимание характеристики производительности классы и структуры.  
  
## <a name="similarities"></a>Сходства  
 Структуры и классы схожи в следующих отношениях.  
  
-   Оба этих параметра соответствуют *контейнера* типов, то есть содержат другие типы в качестве членов.  
  
-   Оба имеют членов, включая конструкторы, методы, свойства, поля, константы, перечисления, события и обработчики событий. Однако не следует путать эти элементы с объявленным *элементы* структуры.  
  
-   Их элементы могут иметь индивидуальные уровни доступа. Например, один элемент можно объявить `Public` и другой `Private`.  
  
-   Они могут реализовывать интерфейсы.  
  
-   Они имеют общие конструкторы с параметрами или без.  
  
-   Они могут предоставлять *свойство по умолчанию*, если это свойство принимает хотя бы один параметр.  
  
-   Они могут объявлять и создавать события и могут объявлять делегаты.  
  
## <a name="differences"></a>Различия  
 Структуры и классы отличаются следующими особенностями:  
  
-   Структуры являются *типы значений*; классы являются *ссылочные типы*. Переменная типа структуры содержит данные структуры, вместо содержащий ссылку на данные в виде типа класса.  
  
-   Структуры используют расположение стека; классы используют память в куче.  
  
-   Все элементы структуры, `Public` по умолчанию; класс переменные и константы, `Private` по умолчанию, а другие члены класса являются `Public` по умолчанию. Это поведение для членов класса обеспечивает совместимость с системой Visual Basic 6.0, значений по умолчанию.  
  
-   Структура должна иметь по крайней мере один не совместно переменную или без общего доступа элемент события; класс может быть пустым.  
  
-   Элементы структуры не могут объявляться как `Protected`; члены класса могут.  
  
-   Процедура структуры может обрабатывать события только в том случае, если это [Shared](../../../../visual-basic/language-reference/modifiers/shared.md) `Sub` процедура и только с помощью параметра [оператор AddHandler](../../../../visual-basic/language-reference/statements/addhandler-statement.md); любая процедура класса может обработать событие, используя либо [ Обрабатывает](../../../../visual-basic/language-reference/statements/handles-clause.md) ключевое слово или `AddHandler` инструкции. Дополнительные сведения см. в статье [Events (Visual Basic)](../../../../visual-basic/programming-guide/language-features/events/index.md) (События в Visual Basic).  
  
-   Объявления переменных структуры нельзя указать инициализаторы или исходные размеры массивов; возможность объявления переменных класса.  
  
-   Структуры неявно наследуют от <xref:System.ValueType?displayProperty=nameWithType> класса и не может наследовать из любого другого типа; классы могут наследовать от любых классов, отличных от <xref:System.ValueType?displayProperty=nameWithType>.  
  
-   Структуры не наследуются; классы являются.  
  
-   Структуры никогда не завершаются, поэтому общеязыковой среды выполнения (CLR) никогда не вызывает <xref:System.Object.Finalize%2A> метод для структур; классы завершаются сборщиком мусора (GC), который вызывает <xref:System.Object.Finalize%2A> для класса, когда обнаруживает, что не активных ссылок остальные.  
  
-   Структуры не требуется конструктор. для класса требуется.  
  
-   Структуры могут иметь конструкторы, не используемые совместно только в том случае, если они принимают параметры; классы могут иметь их с параметрами или без.  
  
 Каждая структура имеет неявный открытый конструктор без параметров. Этот конструктор инициализирует элементы структуры данных в значения по умолчанию. Не удалось переопределить это поведение.  
  
## <a name="instances-and-variables"></a>Экземпляры и переменные  
 Поскольку структуры являются типами значений, каждая переменная структуры постоянно привязан к отдельному экземпляру структуры. Однако классы — ссылочными типами, и переменная объекта может ссылаться на различные экземпляры класса в разное время. Это различие влияет на использование структур и классов следующим образом:  
  
-   **Инициализация.** Переменная структуры неявно содержит инициализацию элементов с помощью конструктора без параметров структуры. Таким образом `Dim s As struct1` эквивалентно `Dim s As struct1 = New struct1()`.  
  
-   **Присваивание переменных.** Когда одна переменная структуры присваивается другой или экземпляр структуры передается в аргумент процедуры, текущие значения всех элементов переменной копируются в новую структуру. Когда переменная объекта присваивается другой или передается в процедуру, копируется только указатель ссылки.  
  
-   **Назначение никаких действий.** Может быть присвоено значение [ничего](../../../../visual-basic/language-reference/nothing.md) к структуре переменной, но экземпляр продолжает быть связанным с переменной. Можно по-прежнему вызывать его методы и доступ к ее элементам данных, хотя элементы переменной инициализируются с назначением.  
  
     В отличие от этого, если значение переменной объекта `Nothing`, она не связана ни с каким экземпляром класса и доступ к любым элементам через переменную невозможно, пока не будет присвоен другой экземпляр.  
  
-   **Несколько экземпляров.** Переменная объекта может иметь разные экземпляры класса назначены в разные моменты времени, и несколько переменных объекта могут ссылаться на один экземпляр класса, в то же время. Изменения, внесенные в значения членов класса влияет на эти члены при доступе через другую переменную, указывающую на тот же экземпляр.  
  
     Элементы структуры изолированы в пределах своего экземпляра. Изменения их значения не отражаются в любые другие переменные структуры, даже в других экземплярах одной и той же `Structure` объявления.  
  
-   **Равенство.** Проверки равенства двух структур должна выполняться с тестом по элементам. Две переменные объекта можно сравнивать с помощью <xref:System.Object.Equals%2A> метод. <xref:System.Object.Equals%2A> Определяет, указывают ли две переменные с тем же экземпляром.  
  
## <a name="see-also"></a>См. также  
 [Типы данных](../../../../visual-basic/programming-guide/language-features/data-types/index.md)  
 [Составные типы данных](../../../../visual-basic/programming-guide/language-features/data-types/composite-data-types.md)  
 [Типы значений и ссылочные типы](../../../../visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types.md)  
 [Структуры](../../../../visual-basic/programming-guide/language-features/data-types/structures.md)  
 [Устранение неполадок, связанных с типами данных](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)  
 [Структуры и другие элементы программирования](../../../../visual-basic/programming-guide/language-features/data-types/structures-and-other-programming-elements.md)  
 [Объекты и классы](../../../../visual-basic/programming-guide/language-features/objects-and-classes/index.md)
