---
title: Разрешение перегрузки (Visual Basic)
ms.custom: ''
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology:
- devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- Visual Basic code, procedures
- overload resolution
- procedures [Visual Basic], overloading
- procedures [Visual Basic], calling
- procedure overloading [Visual Basic], overload resolution
- signatures [Visual Basic], procedure
- overloads [Visual Basic], resolution
ms.assetid: 766115d1-4352-45fb-859f-6063e0de0ec0
caps.latest.revision: 21
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: e62560d853c95bc4bba6ba829d8579ee4388858e
ms.sourcegitcommit: 86adcc06e35390f13c1e372c36d2e044f1fc31ef
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="overload-resolution-visual-basic"></a>Разрешение перегрузки (Visual Basic)
Когда компилятор Visual Basic обнаруживает вызов процедуры, которая определена в нескольких перегруженных версиях, компилятор должен решить, какую из перегрузок метода для вызова. Это делается путем выполнения следующих шагов:  
  
1.  **Специальные возможности.** Это устраняет ни одной перегрузке с уровнем доступа, который предотвращает его вызов вызывающий код.  
  
2.  **Число параметров.** Это устраняет все перегрузку, которая определяет разное число параметров, чем задано в вызове.  
  
3.  **Типы данных параметров.** Компилятор предпочтительнее использует методы экземпляра через методы расширения. Если метод экземпляра обнаруживается, что требует только расширяющие преобразования, чтобы сопоставить вызов процедуры, удаляются все методы расширения, и компилятор продолжает использовать только кандидаты метода экземпляра. Если такой метод экземпляр не найден, он продолжает выполнение экземпляра и методы расширения.  
  
     На этом шаге она также аннулирует ни одной перегрузке, для которых типы данных аргументов вызова не может быть преобразованы в типы параметров, определенные в этой перегрузке.  
  
4.  **Сужающие преобразования.** Это устраняет все перегрузка, которая требует сужающего преобразования от типов аргументов вызова в типы определенных параметров. Это верно ли переключатель проверки типа ([оператор Option Strict](../../../../visual-basic/language-reference/statements/option-strict-statement.md)) является `On` или `Off`.  
  
5.  **Наименьшее расширение.** Компилятор считает, что оставшиеся перегрузки парами. Для каждой пары он сравнивает типы данных определенных параметров. Если в одну из перегрузок все типы расширяются до соответствующих типов в другой, компилятор исключает последнюю. Другими словами он остается перегрузка, которая требует наименьший объем расширения.  
  
6.  **Единственный вариант.** Компилятор продолжает рассматривать перегрузки попарно до только одна перегрузка остается, и он разрешает вызов этой перегрузки. Если компилятор не может уменьшить перегрузки единственный вариант, он создает ошибку.  
  
 На следующем рисунке процесс, который определяет, какой набор перегруженных версий для вызова.  
  
 ![Схема потока перегруженного процесса разрешения](./media/overloadres.gif "OverloadRes")  
Для перегруженных версий, разрешение  
  
 Следующий пример иллюстрирует этот процесс разрешения перегрузки.  
  
 [!code-vb[VbVbcnProcedures#62](./codesnippet/VisualBasic/overload-resolution_1.vb)]  
  
 [!code-vb[VbVbcnProcedures#63](./codesnippet/VisualBasic/overload-resolution_2.vb)]  
  
 В первом вызове компилятор устраняет первую перегрузку, так как тип первого аргумента (`Short`) сужается к типу соответствующего параметра (`Byte`). Затем исключаются третья перегрузка, так как каждый тип аргумента во второй перегрузке (`Short` и `Single`) может быть расширен до соответствующего типа в третьей перегрузке (`Integer` и `Single`). Вторая перегрузка требует меньшего расширения, поэтому компилятор использует его для вызова.  
  
 Во втором вызове компилятор не может устранить зависимости от сужения перегрузок. Она также аннулирует третьей перегрузке по той же причине, что и первый вызов, так как он может вызвать вторую перегрузку с меньшим расширением типов аргументов. Однако компилятор не может разрешить между первой и второй перегрузок. Каждая имеет один определенный тип параметра, может быть расширен до соответствующего типа в другой (`Byte` для `Short`, но `Single` для `Double`). Поэтому компилятор создает ошибку разрешения перегрузки.  
  
## <a name="overloaded-optional-and-paramarray-arguments"></a>Перегрузка необязательных аргументов и массива аргументов  
 Если две перегрузки процедуры имеют одинаковые сигнатуры, за исключением того, что последний параметр объявляется [необязательно](../../../../visual-basic/language-reference/modifiers/optional.md) в одном и [ParamArray](../../../../visual-basic/language-reference/modifiers/paramarray.md) в другой, компилятор разрешает вызов процедуры, как выглядит следующим образом:  
  
|Если задан как последний аргумент при вызове|Компилятор вызывает перегрузку, объявление аргумента в качестве последнего|  
|---|---|  
|Нет значения (аргумент опущен)|`Optional`|  
|Одно значение|`Optional`|  
|Два или несколько значений в список с разделителями запятыми|`ParamArray`|  
|Массив любой длины (включая пустой массив)|`ParamArray`|  
  
## <a name="see-also"></a>См. также  
 [Необязательные параметры](./optional-parameters.md)  
 [Массивы параметров](./parameter-arrays.md)  
 [Перегрузка процедур](./procedure-overloading.md)  
 [Рекомендации по устранению неполадок](./troubleshooting-procedures.md)  
 [Практическое руководство. Определение различных версий процедуры](./how-to-define-multiple-versions-of-a-procedure.md)  
 [Практическое руководство. Вызов перегруженной процедуры](./how-to-call-an-overloaded-procedure.md)  
 [Практическое руководство. Перегрузка процедуры, которая принимает один необязательный параметр](./how-to-overload-a-procedure-that-takes-optional-parameters.md)  
 [Практическое руководство. Перегрузка процедуры, принимающей неопределенное число параметров](./how-to-overload-a-procedure-that-takes-an-indefinite-number-of-parameters.md)  
 [Вопросы, связанные с перегрузкой процедур](./considerations-in-overloading-procedures.md)  
 [Перегрузки](../../../../visual-basic/language-reference/modifiers/overloads.md)  
 [Методы расширения](./extension-methods.md)
