---
title: Возвращаемые значения ref (Visual Basic)
ms.date: 04/28/2017
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: c2979359f0ffafe46a62696485bbb87b211c1704
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="support-for-reference-return-values-visual-basic"></a><span data-ttu-id="5c516-102">Поддержка для возвращаемого значения ссылок (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="5c516-102">Support for reference return values (Visual Basic)</span></span>

<span data-ttu-id="5c516-103">Начиная с 7.0 C#, язык C# поддерживает *ссылаться на возвращаемые значения*.</span><span class="sxs-lookup"><span data-stu-id="5c516-103">Starting with C# 7.0, the C# language supports *reference return values*.</span></span> <span data-ttu-id="5c516-104">Чтобы лучше понять возвращаемого значения ссылок является они противоположность аргументы, переданные по ссылке в метод.</span><span class="sxs-lookup"><span data-stu-id="5c516-104">One way to understand reference return values is that they are the opposite of arguments that are passed by reference to a method.</span></span> <span data-ttu-id="5c516-105">При изменении аргумент, переданный по ссылке изменения отражаются в значение переменной в вызывающем объекте.</span><span class="sxs-lookup"><span data-stu-id="5c516-105">When an argument passed by reference is modified, the changes are reflected in value of the variable on the caller.</span></span> <span data-ttu-id="5c516-106">Метод возвращает значение ссылки предоставляет вызывающему, изменения, сделанные к возвращаемому значению ссылку вызывающим отражаются в данных вызываемого метода.</span><span class="sxs-lookup"><span data-stu-id="5c516-106">When an method provides a reference return value to a caller, modifications made to the reference return value by the caller are reflected in the called method's data.</span></span>

<span data-ttu-id="5c516-107">Visual Basic запрещается для автора методов со ссылкой на возвращаемые значения, но он позволяет использовать возвращаемые значения ссылки.</span><span class="sxs-lookup"><span data-stu-id="5c516-107">Visual Basic does not allow you to author methods with reference return values, but it does allow you to consume reference return values.</span></span> <span data-ttu-id="5c516-108">Другими словами можно вызвать метод с возвращаемым значением ссылки и изменять это возвращаемое значение и изменения к возвращаемому значению ссылка, отражаются в данных вызываемого метода.</span><span class="sxs-lookup"><span data-stu-id="5c516-108">In other words, you can call a method with a reference return value and modify that return value, and changes to the reference return value are reflected in the called method's data.</span></span>

## <a name="modifying-the-ref-return-value-directly"></a><span data-ttu-id="5c516-109">Непосредственное изменение ссылок на возвращаемое значение</span><span class="sxs-lookup"><span data-stu-id="5c516-109">Modifying the ref return value directly</span></span>

<span data-ttu-id="5c516-110">Для методов, всегда завершиться успешно и не имеют `ByRef` параметров, возвращаемое значение ссылки можно изменить непосредственно.</span><span class="sxs-lookup"><span data-stu-id="5c516-110">For methods that always succeed and have no `ByRef` parameters, you can modify the reference return value directly.</span></span> <span data-ttu-id="5c516-111">Для этого необходимо назначить новое значение для выражений, которые возвращает возвращаемое значение ссылки.</span><span class="sxs-lookup"><span data-stu-id="5c516-111">You do this by assigning the new value to the expressions that returns the reference return value.</span></span> 

<span data-ttu-id="5c516-112">В следующем примере C# определяются `NumericValue.IncrementValue` метод, который увеличивает внутреннего значения и возвращает его как ссылку возвращаемое значение.</span><span class="sxs-lookup"><span data-stu-id="5c516-112">The following C# example defines a `NumericValue.IncrementValue` method that increments an internal value and returns it as a reference return value.</span></span> 

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

<span data-ttu-id="5c516-113">Ссылка возвращаемое значение изменяется в вызывающем объекте, в следующем примере Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="5c516-113">The reference return value is then modified by the caller in the following Visual Basic example.</span></span> <span data-ttu-id="5c516-114">Обратите внимание, что в строке с `NumericValue.IncrementValue` вызов метода не присваивать значения метода.</span><span class="sxs-lookup"><span data-stu-id="5c516-114">Note that the line with the `NumericValue.IncrementValue` method call does not assign a value to the method.</span></span> <span data-ttu-id="5c516-115">Вместо этого он присваивает значение ссылки значение, возвращаемое методом.</span><span class="sxs-lookup"><span data-stu-id="5c516-115">Instead, it assigns a value to the reference return value returned by the method.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a><span data-ttu-id="5c516-116">Использование вспомогательного метода</span><span class="sxs-lookup"><span data-stu-id="5c516-116">Using a helper method</span></span>

<span data-ttu-id="5c516-117">В других случаях непосредственное изменение ссылок возвращаемое значение вызова метода может не всегда быть желательными.</span><span class="sxs-lookup"><span data-stu-id="5c516-117">In other cases, modifying the reference return value of a method call directly may not always be desirable.</span></span> <span data-ttu-id="5c516-118">Например метод поиска, который возвращает строку, могут не всегда найти совпадение.</span><span class="sxs-lookup"><span data-stu-id="5c516-118">For example, a search method that returns a string may not always find a match.</span></span> <span data-ttu-id="5c516-119">В этом случае требуется изменить возвращаемое значение ссылку только в том случае, если поиск прошел успешно.</span><span class="sxs-lookup"><span data-stu-id="5c516-119">In that case, you want to modify the reference return value only if the search is successful.</span></span>

<span data-ttu-id="5c516-120">В следующем примере C# показан этот сценарий.</span><span class="sxs-lookup"><span data-stu-id="5c516-120">The following C# example illustrates this scenario.</span></span> <span data-ttu-id="5c516-121">Он определяет `Sentence` класса, написанного на языке C# включает в себя `FindNext` метод, который находит следующее слово в предложение, которое начинается с указанной подстроки.</span><span class="sxs-lookup"><span data-stu-id="5c516-121">It defines a `Sentence` class written in C# includes a `FindNext` method that finds the next word in a sentence that begins with a specified substring.</span></span> <span data-ttu-id="5c516-122">Строка возвращается как значение, возвращаемое по ссылке, а переменная `Boolean`, переданная в метод по ссылке, показывает, дал ли поиск какие-то результаты.</span><span class="sxs-lookup"><span data-stu-id="5c516-122">The string is returned as a reference return value, and a `Boolean` variable passed by reference to the method indicates whether the search was successful.</span></span> <span data-ttu-id="5c516-123">Справочник по возвращаемое значение указывает, что вызывающий объект может не только для чтения возвращаемого значения; Он также можно изменить его, и эти изменения отражаются в данных, содержащихся в внутренне `Sentence` класса.</span><span class="sxs-lookup"><span data-stu-id="5c516-123">The reference return value indicates that the caller can not only read the returned value; he or she can also modify it, and that modification is reflected in the data contained internally in the `Sentence` class.</span></span>

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

<span data-ttu-id="5c516-124">Непосредственное изменение ссылка на возвращаемое значение в этом случае не надежные, так как вызов метода не сможет найти соответствие и возвращает первое слово в предложении.</span><span class="sxs-lookup"><span data-stu-id="5c516-124">Directly modifying the reference return value in this case is not reliable, since the method call may fail to find a match and return the first word in the sentence.</span></span> <span data-ttu-id="5c516-125">В этом случае вызывающий объект случайно изменит первым словом предложения.</span><span class="sxs-lookup"><span data-stu-id="5c516-125">In that case, the caller will inadvertently modify the first word of the sentence.</span></span> <span data-ttu-id="5c516-126">Это может предотвратить возвращение вызывающим `null` (или `Nothing` в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="5c516-126">This could be prevented by the caller returning a `null` (or `Nothing` in Visual Basic).</span></span> <span data-ttu-id="5c516-127">Но в этом случае предпринимается попытка изменить строку, значение которого является `Nothing` вызывает <xref:System.NullReferenceException>.</span><span class="sxs-lookup"><span data-stu-id="5c516-127">But in that case, attempting to modify a string whose value is `Nothing` throws a <xref:System.NullReferenceException>.</span></span> <span data-ttu-id="5c516-128">Если удается избежать возвращения вызывающему объекту <xref:System.String.Empty?displayProperty=nameWithType>, но это требует, чтобы вызывающий объект определяет строковой переменной, значение которого является <xref:System.String.Empty?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="5c516-128">If could also be prevented by the caller returning <xref:System.String.Empty?displayProperty=nameWithType>, but this requires that the caller define a string variable whose value is <xref:System.String.Empty?displayProperty=nameWithType>.</span></span> <span data-ttu-id="5c516-129">Хотя вызывающий объект может изменить эту строку, изменение сам бессмысленно, поскольку измененная строка не имеет отношения к слова в предложении, хранящихся в `Sentence` класса.</span><span class="sxs-lookup"><span data-stu-id="5c516-129">While the caller can modify that string, the modification itself serves no purpose, since the modified string has no relationship to the words in the sentence stored by the `Sentence` class.</span></span>

<span data-ttu-id="5c516-130">Для обработки этого сценария рекомендуется передать возвращаемое значение ссылки по ссылке на вспомогательный метод.</span><span class="sxs-lookup"><span data-stu-id="5c516-130">The best way to handle this scenario is to pass the reference return value by reference to a helper method.</span></span> <span data-ttu-id="5c516-131">Вспомогательный метод затем содержит логику для определения успешного вызова метода и, если они были, чтобы изменить ссылку возвращаемое значение.</span><span class="sxs-lookup"><span data-stu-id="5c516-131">The helper method then contains the logic to determine whether the method call succeeded and, if it did, to modify the reference return value.</span></span> <span data-ttu-id="5c516-132">Ниже приведены возможные реализации.</span><span class="sxs-lookup"><span data-stu-id="5c516-132">The following example provides a possible implementation.</span></span>

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a><span data-ttu-id="5c516-133">См. также</span><span class="sxs-lookup"><span data-stu-id="5c516-133">See also</span></span>

<span data-ttu-id="5c516-134">[Передача аргументов по значению и по ссылке](passing-arguments-by-value-and-by-reference.md) </span><span class="sxs-lookup"><span data-stu-id="5c516-134">[Passing arguments by value and by reference](passing-arguments-by-value-and-by-reference.md) </span></span>  
[<span data-ttu-id="5c516-135">Процедуры в Visual Basic</span><span class="sxs-lookup"><span data-stu-id="5c516-135">Procedures in Visual Basic</span></span>](index.md)   


