---
title: "Возвращаемые значения ref (Visual Basic)"
ms.custom: 
ms.date: 04/28/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- variables [Visual Basic]
- ref return values [Visual Basic]
- ref returns [Visual Basic]
ms.assetid: 5ef0cc69-eb3a-4a67-92a2-78585f223cb5
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 560607f7aa304b25314daabeef3952e6bbef7426
ms.sourcegitcommit: 7e99f66ef09d2903e22c789c67ff5a10aa953b2f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/18/2017
---
# <a name="support-for-reference-return-values-visual-basic"></a>Поддержка для возвращаемого значения ссылок (Visual Basic)

Начиная с 7 C#, язык C# поддерживает *ссылаться на возвращаемые значения*. Чтобы лучше понять возвращаемого значения ссылок является они противоположность аргументы, переданные по ссылке в метод. При изменении аргумент, переданный по ссылке изменения отражаются в значение переменной в вызывающем объекте. Метод возвращает значение ссылки предоставляет вызывающему, изменения, сделанные к возвращаемому значению ссылку вызывающим отражаются в данных вызываемого метода.

Visual Basic запрещается для автора методов со ссылкой на возвращаемые значения, но он позволяет использовать возвращаемые значения ссылки. Другими словами можно вызвать метод с возвращаемым значением ссылки и изменять это возвращаемое значение и изменения к возвращаемому значению ссылка, отражаются в данных вызываемого метода.

## <a name="modifying-the-ref-return-value-directly"></a>Непосредственное изменение ссылок на возвращаемое значение

Для методов, всегда завершиться успешно и не имеют `ByRef` параметров, возвращаемое значение ссылки можно изменить непосредственно. Для этого необходимо назначить новое значение для выражений, которые возвращает возвращаемое значение ссылки. 

В следующем примере C# определяются `NumericValue.IncrementValue` метод, который увеличивает внутреннего значения и возвращает его как ссылку возвращаемое значение. 

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/ref-returns1.cs)]

Ссылка возвращаемое значение изменяется в вызывающем объекте, в следующем примере Visual Basic. Обратите внимание, что в строке с `NumericValue.IncrementValue` вызов метода не присваивать значения метода. Вместо этого он присваивает значение ссылки значение, возвращаемое методом.

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/programming-guide/language-features/procedures/use-ref-returns1.vb)]

## <a name="using-a-helper-method"></a>Использование вспомогательного метода

В других случаях непосредственное изменение ссылок возвращаемое значение вызова метода может не всегда быть желательными. Например метод поиска, который возвращает строку, могут не всегда найти совпадение. В этом случае требуется изменить возвращаемое значение ссылку только в том случае, если поиск прошел успешно.

В следующем примере C# показан этот сценарий. Он определяет `Sentence` класса, написанного на языке C# включает в себя `FindNext` метод, который находит следующее слово в предложение, которое начинается с указанной подстроки. Строка возвращается как значение, возвращаемое по ссылке, а переменная `Boolean`, переданная в метод по ссылке, показывает, дал ли поиск какие-то результаты. Справочник по возвращаемое значение указывает, что вызывающий объект может не только для чтения возвращаемого значения; Он также можно изменить его, и эти изменения отражаются в данных, содержащихся в внутренне `Sentence` класса.

[!code-csharp[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-returns.cs)]

Непосредственное изменение ссылка на возвращаемое значение в этом случае не надежные, так как вызов метода не сможет найти соответствие и возвращает первое слово в предложении. В этом случае вызывающий объект случайно изменит первым словом предложения. Это может предотвратить возвращение вызывающим `null` (или `Nothing` в Visual Basic). Но в этом случае предпринимается попытка изменить строку, значение которого является `Nothing` вызывает <xref:System.NullReferenceException>. Если удается избежать возвращения вызывающему объекту <xref:System.String.Empty?displayProperty=nameWithType>, но это требует, чтобы вызывающий объект определяет строковой переменной, значение которого является <xref:System.String.Empty?displayProperty=nameWithType>. Хотя вызывающий объект может изменить эту строку, изменение сам бессмысленно, поскольку измененная строка не имеет отношения к слова в предложении, хранящихся в `Sentence` класса.

Для обработки этого сценария рекомендуется передать возвращаемое значение ссылки по ссылке на вспомогательный метод. Вспомогательный метод затем содержит логику для определения успешного вызова метода и, если они были, чтобы изменить ссылку возвращаемое значение. Ниже приведены возможные реализации.

[!code-vb[Ref-Return](../../../../../samples/snippets/visualbasic/getting-started/ref-return-helper.vb#1)]

## <a name="see-also"></a>См. также

[Передача аргументов по значению и по ссылке](passing-arguments-by-value-and-by-reference.md)   
[Процедуры в Visual Basic](index.md)   


