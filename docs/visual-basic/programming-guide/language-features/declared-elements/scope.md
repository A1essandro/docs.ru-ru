---
title: "Область видимости в Visual Basic"
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- module scope [Visual Basic]
- scope [Visual Basic], levels
- module level
- procedures [Visual Basic], scope
- declared elements [Visual Basic], scope
- namespaces [Visual Basic], scope
- scope [Visual Basic], declared elements
- scope [Visual Basic], about scope
- levels of scope [Visual Basic]
- block scope [Visual Basic]
- scope [Visual Basic], Visual Basic
- procedure scope [Visual Basic]
ms.assetid: 208106fe-79c9-4eec-93c6-55f08548895f
caps.latest.revision: "17"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: a9bfda19b9f5ee96d45a0322541b35dfab7635d7
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="scope-in-visual-basic"></a>Область видимости в Visual Basic
*Область* объявленного элемента — это набор всех элементов кода, на него можно ссылаться без уточнения его имени или получения его с помощью [оператор Imports (пространство имен .NET и тип)](../../../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md). Элемент может иметь область на одном из следующих уровней:  
  
|Уровень|Описание|  
|-----------|-----------------|  
|Область действия блока|Доступно только в коде блока, в котором она объявлена|  
|Область действия процедуры|Доступен в коде в рамках процедуры, в котором она объявлена.|  
|Область действия модуля|Доступен в коде в пределах модуля, класса или структуры, в котором она объявлена.|  
|Область видимости пространства имен|Доступен в коде в пространстве имен, в котором она объявлена.|  
  
 Эти уровни области изменяются от узкой (блока) до самой широкой (пространства имен), где *узкой областью* означает наименьшее множество кода, который может обращаться к элементу без уточнения. Дополнительные сведения см. в разделе «Уровни область» на этой странице.  
  
## <a name="specifying-scope-and-defining-variables"></a>Указание области и определение переменных  
 Укажите область действия элемента, при ее объявлении. Область может зависеть от следующих факторов:  
  
-   Область (блок, процедура, модуля, класса или структуры), в которой объявляется элемент  
  
-   Пространства имен, содержащего объявление элемента  
  
-   Уровень доступа, объявленный элемент  
  
 Будьте внимательны при определении переменных с одинаковыми именами, но разными областями действия, так как это может привести к непредвиденным результатам. Для получения дополнительной информации см. [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md).  
  
## <a name="levels-of-scope"></a>Уровни области действия  
 Программный элемент доступен во всей области, в котором она объявлена. Весь код в одном регионе может ссылаться на элемент неполного имени.  
  
### <a name="block-scope"></a>Область видимости блока  
 Блок — это набор инструкций, заключенная в начальными и конечными операторы объявления, например следующие:  
  
-   `Do` и `Loop`.  
  
-   `For`[`Each`] и`Next`  
  
-   `If` и `End If`.  
  
-   `Select` и `End Select`.  
  
-   `SyncLock` и `End SyncLock`.  
  
-   `Try` и `End Try`.  
  
-   `While` и `End While`.  
  
-   `With` и `End With`.  
  
 Если объявить переменную в блоке, его можно использовать только внутри этого блока. В следующем примере область целочисленной переменной `cube` — это блок между `If` и `End If`, и вы больше не может ссылаться на `cube` операторами блока.  
  
```  
If n < 1291 Then  
    Dim cube As Integer  
    cube = n ^ 3  
End If  
```  
  
> [!NOTE]
>  Даже если с блоком ограничен областью действия переменной, время существования по-прежнему всей процедуры. При вводе блока несколько раз во время процедуры, переменная каждого блока сохраняет свое предыдущее значение. Чтобы избежать непредвиденных результатов, в таком случае, имеет смысл инициализации переменных в начале блока.  
  
### <a name="procedure-scope"></a>Область действия процедуры  
 Элемент, объявленный внутри процедуры недоступен вне этой процедуры. Его можно использовать только процедура, содержащая объявление. Переменные на этом уровне также называются *локальные переменные*. Они объявляются с [оператор Dim](../../../../visual-basic/language-reference/statements/dim-statement.md), независимо от [статических](../../../../visual-basic/language-reference/modifiers/static.md) ключевое слово.  
  
 Область действия процедуры и блока тесно связаны. При объявлении переменной внутри процедуры, но вне любого блока в рамках этой процедуры можно представить переменная имеет область видимости блока, где блоком является всю процедуру.  
  
> [!NOTE]
>  Все локальные элементы, даже если они являются `Static` переменные, являющиеся собственными для процедуры, в котором они отображаются. Нельзя объявить элемент с использованием [открытый](../../../../visual-basic/language-reference/modifiers/public.md) ключевое слово в процедуре.  
  
### <a name="module-scope"></a>Область действия модуля  
 Для удобства один термин *уровне модуля* одинаково применимо для модулей, классов и структур. Можно объявлять элементы этого уровня, поместив в операторе объявления вне любой процедуры или блока, но внутри модуля, класса или структуры.  
  
 При объявлении на уровне модуля, выбранного уровня доступа определяет область. Пространство имен, содержащее модуля, класса или структуры также влияет на область.  
  
 Элементы, для которых объявляется [закрытый](../../../../visual-basic/language-reference/modifiers/private.md) уровень доступа, доступны для каждой процедуры в этом модуле, но не для кода в другом модуле. `Dim` Инструкции на уровне модуля по умолчанию имеет значение `Private` , если вы не используете любого ключевого слова уровня доступа. Тем не менее, выполненные области и уровень доступа более очевидным с помощью `Private` ключевое слово в `Dim` инструкции.  
  
 В следующем примере все процедуры, определенные в модуле может ссылаться на строковую переменную `strMsg`. Если вызывается вторая процедура, он отображает содержимое строковой переменной `strMsg` в диалоговом окне.  
  
```  
' Put the following declaration at module level (not in any procedure).  
Private strMsg As String  
' Put the following Sub procedure in the same module.  
Sub initializePrivateVariable()  
    strMsg = "This variable cannot be used outside this module."  
End Sub  
' Put the following Sub procedure in the same module.  
Sub usePrivateVariable()  
    MsgBox(strMsg)  
End Sub  
```  
  
### <a name="namespace-scope"></a>Область видимости пространства имен  
 При объявлении элемента на уровне модуля с [Friend](../../../../visual-basic/language-reference/modifiers/friend.md) или [открытый](../../../../visual-basic/language-reference/modifiers/public.md) ключевое слово, он становится доступным для всех процедур из пространства имен, в котором объявлен элемент. Учитывая следующие изменения в предыдущем примере строковая переменная `strMsg` можно ссылаться из кода в любом месте в пространстве имен ее объявления.  
  
```  
' Include this declaration at module level (not inside any procedure).  
Public strMsg As String  
```  
  
 Область видимости пространства имен включает вложенные пространства имен. Элемент, доступный в пределах пространства имен доступно также в любое пространство имен, вложенных в это пространство имен.  
  
 Если проект не содержит [оператор Namespace](../../../../visual-basic/language-reference/statements/namespace-statement.md)s, весь проект находится в том же пространстве имен. В этом случае область пространства имен может рассматриваться как область проекта. `Public`элементы модуля, класса или структуры также доступны в любой проект, который ссылается на соответствующий проект.  
  
## <a name="choice-of-scope"></a>Выбор области действия  
 При объявлении переменной, вам необходимо иметь в виду следующие моменты при выборе ее области действия.  
  
### <a name="advantages-of-local-variables"></a>Преимущества локальных переменных  
 Локальные переменные являются хорошим выбором для любого типа временных вычислений по следующим причинам:  
  
-   **Предотвращение конфликтов имен.** Имена локальных переменных не приводит к конфликту. Например, можно создать несколько разных процедур, содержащих переменную с именем `intTemp`. В течение каждого `intTemp` объявлен как локальная переменная, каждая процедура распознает только свою собственную версию из `intTemp`. Любая процедура может изменить значение собственной локальной переменной `intTemp` без влияния на `intTemp` переменных в других процедур.  
  
-   **Потребление памяти.** Локальные переменные потребляют память только во время выполнения процедуры. Их память освобождается, когда процедура возвращает в вызывающий код. В отличие от этого [Shared](../../../../visual-basic/language-reference/modifiers/shared.md) и [статических](../../../../visual-basic/language-reference/modifiers/static.md) переменные потребление ресурсов памяти, пока не завершится работа приложения, поэтому следует использовать их только при необходимости. *Переменные экземпляра* потребляют память, пока их экземпляр продолжает существовать, что делает их менее эффективными, чем локальные переменные, но потенциально более эффективными, чем `Shared` или `Static` переменных.  
  
### <a name="minimizing-scope"></a>Сокращение области действия  
 Как правило, при объявлении любая переменная или константа, он является хорошим стилем программирования сокращать ее область насколько это возможно (узкая — область видимости блока). Это помогает освободить ресурсы памяти и сводит к минимуму вероятность коде недопустимой переменной. Аналогичным образом, следует объявить переменную [статических](../../../../visual-basic/language-reference/modifiers/static.md) только когда это необходимо сохранить ее значение между вызовами процедур.  
  
## <a name="see-also"></a>См. также  
 [Характеристики объявленных элементов](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-characteristics.md)  
 [Практическое руководство. Управление областью действия переменной](../../../../visual-basic/programming-guide/language-features/declared-elements/how-to-control-the-scope-of-a-variable.md)  
 [Время существования в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/lifetime.md)  
 [Уровни доступа в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)  
 [Ссылки на объявленные элементы](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)  
 [Объявление переменных](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)
