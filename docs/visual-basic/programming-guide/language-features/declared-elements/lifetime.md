---
title: Время существования в Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- static variables [Visual Basic], lifetime
- static variables [Visual Basic], Visual Basic
- declared elements [Visual Basic], lifetime
- Shared variable lifetime [Visual Basic]
- lifetime [Visual Basic], declared elements
- lifetime [Visual Basic], Visual Basic
- lifetime [Visual Basic]
ms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7
ms.openlocfilehash: d32639f1c392d53a7e9f6258440b6c0925d27a5d
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33654233"
---
# <a name="lifetime-in-visual-basic"></a>Время существования в Visual Basic
*Время существования* объявленного элемента — это период времени, во время которого он доступен для использования. Переменные являются только элементы, которые имеют время жизни. Для этой цели компилятор обрабатывает параметры процедуры, и функция возвращает в качестве особые случаи переменных. Срок жизни переменной представляет период времени, в течение которого может иметь значение. Его значение может меняться со временем, но он всегда содержит некоторое значение.  
  
## <a name="different-lifetimes"></a>Различные сроки существования  
 Объект *переменной-члена* (объявленные на уровне модуля, вне любой процедуры) обычно имеет то же время существования, как элемент, в котором она объявлена. Не являющаяся общей переменная объявлена в классе или структуре существует как отдельная копия для каждого экземпляра класса или структуры, в котором она объявлена. Каждая такая переменная имеет одинаковое время существования экземпляра. Однако `Shared` переменная имеет сроком существования, который длится в течение работы приложения.  
  
 Объект *локальной переменной* (объявленные внутри процедуры) существует только во время выполнения процедуры, в котором она объявлена. Это также относится к аргументам этой процедуры и значениям, возвращаемым функциями. Однако если процедура вызывает другие процедуры, значения локальных переменных сохраняются во время работы вызываемых процедур.  
  
## <a name="beginning-of-lifetime"></a>Начало времени существования  
 Время существования локальной переменной начинается при передаче управления процедуры, в котором она объявлена. Каждой локальной переменной инициализируется значением по умолчанию для его типа данных, как только начинается процедура запущена. Когда в процедуре встречается `Dim` инструкция, определяющая исходные значения, он задает эти переменные те значения, даже если ваш код уже назначены другие значения.  
  
 Каждый член структурной переменной инициализируется, как если бы он был отдельной переменной. Аналогичным образом каждый элемент массива инициализируется по отдельности.  
  
 Переменные, объявленные в блоке внутри процедуры (например, `For` цикла), инициализируются при входе в процедуру. Инициализация вступают в силу независимо от того, имеется ли ваш код, когда-либо выполняется блок.  
  
## <a name="end-of-lifetime"></a>Окончание времени существования  
 По окончании выполнения процедуры значения ее локальных переменных не сохраняются, и Visual Basic освобождает память. При очередном вызове процедуры, все ее локальные переменные создаются заново и повторно инициализированы.  
  
 При экземпляра класса или структуры, не являющиеся общими переменные теряют их память и их значения. Каждый новый экземпляр класса или структуры, создает и повторно инициализирует ее не совместно переменные. Однако `Shared` переменные сохраняются, пока не завершится работа приложения.  
  
## <a name="extension-of-lifetime"></a>Продление срока жизни  
 Если объявить локальную переменную с `Static` ключевое слово, время существования превышает время выполнения процедуры. В следующей таблице показано, как объявление процедуры определяет, как долго `Static` переменная существует.  
  
|Расположение процедуры и совместное использование|Начинается время существования статической переменной|Заканчивается время существования статической переменной|  
|------------------------------------|-------------------------------------|-----------------------------------|  
|В модуле (совместно используемые по умолчанию)|Первый раз при вызове процедуры|При остановке приложения|  
|В классе `Shared` (процедура не является членом экземпляра)|Первый раз процедура вызывается на определенном экземпляре или на само имя класса или структуры|При остановке приложения|  
|В экземпляре класса не `Shared` (процедура является членом экземпляра)|Первый раз при вызове процедуры для определенного экземпляра|Если этот экземпляр освобождается для сборки мусора (GC)|  
  
## <a name="static-variables-of-the-same-name"></a>Статические переменные с тем же именем  
 Можно объявить статические переменные с тем же именем в более чем одной процедуры. После этого компилятор Visual Basic рассматривает каждую из таких переменных как отдельный элемент. Инициализация одной из этих переменных не влияет на значения остальных. То же самое происходит, если определить процедуру с набором перегрузок и объявления статической переменной с тем же именем в каждой перегрузке.  
  
## <a name="containing-elements-for-static-variables"></a>Содержание элементов для статических переменных  
 Можно объявить статическую локальную переменную в пределах класса, то есть внутри процедуры в этом классе. Однако нельзя объявлять статическую локальную переменную в структуре как член структуры или как локальную переменную процедуры в этой структуре.  
  
## <a name="example"></a>Пример  
  
### <a name="description"></a>Описание  
 В следующем примере объявляется переменная с [статических](../../../../visual-basic/language-reference/modifiers/static.md) ключевое слово. (Обратите внимание, что нет необходимости `Dim` ключевое слово при [оператор Dim](../../../../visual-basic/language-reference/statements/dim-statement.md) использует модификатор, например `Static`.)  
  
### <a name="code"></a>Код  
 [!code-vb[VbVbalrKeywords#13](../../../../visual-basic/language-reference/codesnippet/VisualBasic/lifetime_1.vb)]  
  
### <a name="comments"></a>Комментарии  
 В предыдущем примере переменной `applesSold` продолжает существовать после процедуры `runningTotal` возвращает в вызывающий код. В следующий раз `runningTotal` вызове `applesSold` сохраняет ранее вычисленное значение.  
  
 Если `applesSold` была объявлена без использования `Static`, предыдущие накопленные значения не сохраняются между вызовами `runningTotal`. В следующий раз `runningTotal` был вызван `applesSold` будет заново, инициализируется значением 0, и `runningTotal` просто возвращала бы то же значение, с которым была вызвана.  
  
### <a name="compiling-the-code"></a>Компиляция кода  
 Можно инициализировать значение статической локальной переменной в рамках его объявления. При объявлении массива `Static`, можно инициализировать его ранг (число измерений), длину каждого измерения и значения отдельных элементов.  
  
### <a name="security"></a>Безопасность  
 В приведенном выше примере можно создать тот же срок существования путем объявления `applesSold` на уровне модуля. Если область действия переменной изменена таким образом, тем не менее, процедура будет больше нет эксклюзивного доступа к нему. Поскольку другие процедуры может получить доступ к `applesSold` и измените его значение, промежуточных итогов ненадежными, а код может быть более сложным в обслуживании.  
  
## <a name="see-also"></a>См. также  
 [Общие](../../../../visual-basic/language-reference/modifiers/shared.md)  
 [Nothing](../../../../visual-basic/language-reference/nothing.md)  
 [Имена объявленных элементов](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)  
 [Ссылки на объявленные элементы](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)  
 [Область в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)  
 [Уровни доступа в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)  
 [Переменные](../../../../visual-basic/programming-guide/language-features/variables/index.md)  
 [Объявление переменных](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)  
 [Устранение неполадок, связанных с типами данных](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)  
 [Статические](../../../../visual-basic/language-reference/modifiers/static.md)
