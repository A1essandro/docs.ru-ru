---
title: "Время существования в Visual Basic | Документы Microsoft"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- static variables, lifetime
- static variables, Visual Basic
- declared elements, lifetime
- Shared variable lifetime
- lifetime, declared elements
- lifetime, Visual Basic
- lifetime
ms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7
caps.latest.revision: 14
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: fa0cbdf4a8fe5e8fc41e4e4f373c79451fb7b75f
ms.lasthandoff: 03/13/2017

---
# <a name="lifetime-in-visual-basic"></a>Время существования в Visual Basic
*Время существования* объявленного элемента — это период времени, во время которого он доступен для использования. Переменные, только элементы, которые имеют время жизни. Для этой цели компилятор обрабатывает параметры процедуры и функция возвращает как особые виды переменных. Время жизни переменной представляет период времени, в течение которого она может иметь значение. Его значение может меняться со временем, но он всегда содержит некоторое значение.  
  
## <a name="different-lifetimes"></a>Различные жизненные циклы  
 Объект *переменной-члена* (объявленные на уровне модуля, вне любой процедуры) обычно имеет то же время существования, как элемент, в котором она объявлена. Неиспользуемый переменной, объявленной в классе или структуре существует как отдельная копия для каждого экземпляра класса или структуры, в котором она объявлена. Каждая такая переменная имеет то же время существования экземпляра. Однако `Shared` переменная имеет сроком существования, который длится в течение работы приложения.  
  
 Объект *локальной переменной* (объявленные внутри процедуры) существует только во время выполнения процедуры, в котором она объявлена. Это также относится к аргументам этой процедуры и значениям, возвращаемым функциями. Однако если процедура вызывает другие процедуры, значения ее локальных переменных сохраняются во время выполнения вызванной процедуры.  
  
## <a name="beginning-of-lifetime"></a>Начало времени существования  
 Время существования локальной переменной начинается при передаче управления процедуры, в котором она объявлена. Каждой локальной переменной инициализируется значением по умолчанию для его типа данных, как только начинается процедура запущена. Когда в процедуре встречается `Dim` инструкция, определяющая исходные значения, он устанавливает эти переменные для этих значений, даже если код уже назначены другие значения.  
  
 Каждый член структурной переменной инициализируется, как если бы он был отдельной переменной. Аналогичным образом каждый элемент массива инициализируется отдельно.  
  
 Переменные, объявленные в блоке внутри процедуры (такие как `For` цикл), инициализируются при входе в процедуру. Инициализация вступают в силу ли код никогда не исполняет блока.  
  
## <a name="end-of-lifetime"></a>Окончание времени существования  
 Когда процедура завершается, значения ее локальных переменных не сохраняются, и [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] освобождает память. В следующий раз, вызвать процедуру, все ее локальные переменные создаются заново и повторно инициализированы.  
  
 При экземпляра класса или структуры, не являющиеся общими переменные теряют их память и их значения. Каждый новый экземпляр класса или структуры создает и повторно инициализирует не совместно переменные. Однако `Shared` переменные сохраняются, пока не завершится работа приложения.  
  
## <a name="extension-of-lifetime"></a>Продление срока жизни  
 Если объявить локальную переменную с `Static` ключевое слово, ее время существования будет дольше времени выполнения процедуры. В следующей таблице показано, как объявление процедуры определяет, как долго `Static` переменная существует.  
  
|Расположение процедуры и совместное использование|Начинается время существования статической переменной|Заканчивается время существования статической переменной|  
|------------------------------------|-------------------------------------|-----------------------------------|  
|В модуле (общем по умолчанию)|Первый раз при вызове процедуры|При остановке приложения|  
|В классе `Shared` (процедура не является членом экземпляра)|Первый раз при вызове процедуры на определенном экземпляре или на само имя класса или структуры|При остановке приложения|  
|В экземпляре класса не `Shared` (процедура является членом экземпляра)|Первый раз при вызове процедуры для определенного экземпляра|Когда экземпляр освобождается для сборки мусора (GC)|  
  
## <a name="static-variables-of-the-same-name"></a>Статические переменные с тем же именем  
 Можно объявить статические переменные с тем же именем в более чем одной процедуры. После этого, [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] компилятор считает каждую из этих переменных как отдельный элемент. Инициализация одной из этих переменных не влияет на значения остальных. Это же правило применяется при определении процедуры с набором перегрузок и объявлении статической переменной с тем же именем в каждой перегрузке.  
  
## <a name="containing-elements-for-static-variables"></a>Содержание элементов для статических переменных  
 Можно объявить статическую локальную переменную в пределах класса, то есть внутри процедуры в этом классе. Однако нельзя объявлять статическую локальную переменную в структуре как член структуры или как локальную переменную процедуры в этой структуре.  
  
## <a name="example"></a>Пример  
  
### <a name="description"></a>Описание  
 В следующем примере объявляется переменная с [статических](../../../../visual-basic/language-reference/modifiers/static.md) ключевое слово. (Обратите внимание, что нет необходимости `Dim` ключевое слово при [оператора Dim](../../../../visual-basic/language-reference/statements/dim-statement.md) использует модификатор, например `Static`.)  
  
### <a name="code"></a>Код  
 [!code-vb[VbVbalrKeywords&#13;](../../../../visual-basic/language-reference/codesnippet/VisualBasic/lifetime_1.vb)]  
  
### <a name="comments"></a>Комментарии  
 В предыдущем примере переменной `applesSold` продолжает существовать после процедуры `runningTotal` возвращается вызывающему коду. В следующий раз `runningTotal` вызывается, `applesSold` сохраняет ранее вычисленное значение.  
  
 Если `applesSold` была объявлена без использования `Static`, предыдущие накопленные значения не сохраняются по вызовов `runningTotal`. В следующий раз `runningTotal` был вызван `applesSold` бы заново, принимая значение 0, и `runningTotal` просто возвращала бы то же значение, с помощью которого он был вызван.  
  
### <a name="compiling-the-code"></a>Компиляция кода  
 Можно инициализировать значение статической локальной переменной при ее объявлении. При объявлении массива `Static`, можно инициализировать его ранг (размерность), длина каждого из измерений и значения отдельных элементов.  
  
### <a name="security"></a>Безопасность  
 В предыдущем примере можно создать тот же срок существования путем объявления `applesSold` на уровне модуля. Если изменить область действия переменной таким образом, тем не менее, процедура будет больше не нужно монопольный доступ к нему. Поскольку другие процедуры может получить доступ к `applesSold` и измените его значение, значения с накоплением ненадежными, а код может быть более сложным в обслуживании.  
  
## <a name="see-also"></a>См. также  
 [Общие](../../../../visual-basic/language-reference/modifiers/shared.md)   
 [Никаких действий](../../../../visual-basic/language-reference/nothing.md)   
 [Имена объявленных элементов](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)   
 [Ссылки на объявленные элементы](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)   
 [Область видимости в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)   
 [Уровни доступа в Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)   
 [Переменные](../../../../visual-basic/programming-guide/language-features/variables/index.md)   
 [Объявление переменных](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)   
 [Устранение неполадок типы данных](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)   
 [Статические](../../../../visual-basic/language-reference/modifiers/static.md)
