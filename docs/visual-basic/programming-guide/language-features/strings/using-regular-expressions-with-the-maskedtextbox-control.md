---
title: "Использование регулярных выражений в элементе управления MaskedTextBox в Visual Basic | Документы Microsoft"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- strings [Visual Basic], regular expressions
- strings [Visual Basic], masked edit
ms.assetid: 2a048fb0-7053-487d-b2c5-ffa5e22ed6f9
caps.latest.revision: 10
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: 66f61eed8bc8431392d7216ffb799b221489f332
ms.contentlocale: ru-ru
ms.lasthandoff: 04/12/2017

---
# <a name="using-regular-expressions-with-the-maskedtextbox-control-in-visual-basic"></a><span data-ttu-id="740ea-102">Использование регулярных выражений в элементе управления MaskedTextBox в Visual Basic</span><span class="sxs-lookup"><span data-stu-id="740ea-102">Using Regular Expressions with the MaskedTextBox Control in Visual Basic</span></span>
<span data-ttu-id="740ea-103">В этом примере демонстрируется преобразование простых регулярных выражений для работы с <xref:System.Windows.Forms.MaskedTextBox>управления.</xref:System.Windows.Forms.MaskedTextBox></span><span class="sxs-lookup"><span data-stu-id="740ea-103">This example demonstrates how to convert simple regular expressions to work with the <xref:System.Windows.Forms.MaskedTextBox> control.</span></span>  
  
## <a name="description-of-the-masking-language"></a><span data-ttu-id="740ea-104">Описание языка масок</span><span class="sxs-lookup"><span data-stu-id="740ea-104">Description of the Masking Language</span></span>  
 <span data-ttu-id="740ea-105">Стандартный <xref:System.Windows.Forms.MaskedTextBox>язык маски основана на используется `Masked Edit` управления [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] 6.0 и должен быть знаком пользователям, переходящим с этой платформы.</xref:System.Windows.Forms.MaskedTextBox></span><span class="sxs-lookup"><span data-stu-id="740ea-105">The standard <xref:System.Windows.Forms.MaskedTextBox> masking language is based on the one used by the `Masked Edit` control in [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] 6.0 and should be familiar to users migrating from that platform.</span></span>  
  
 <span data-ttu-id="740ea-106"><xref:System.Windows.Forms.MaskedTextBox.Mask%2A>Свойства <xref:System.Windows.Forms.MaskedTextBox>управления задает используемые маски ввода.</xref:System.Windows.Forms.MaskedTextBox> </xref:System.Windows.Forms.MaskedTextBox.Mask%2A></span><span class="sxs-lookup"><span data-stu-id="740ea-106">The <xref:System.Windows.Forms.MaskedTextBox.Mask%2A> property of the <xref:System.Windows.Forms.MaskedTextBox> control specifies what input mask to use.</span></span> <span data-ttu-id="740ea-107">Маска должна быть строкой, состоящей из одного или нескольких элементов маски из следующей таблицы.</span><span class="sxs-lookup"><span data-stu-id="740ea-107">The mask must be a string composed of one or more of the masking elements from the following table.</span></span>  
  
|<span data-ttu-id="740ea-108">Элемент маски</span><span class="sxs-lookup"><span data-stu-id="740ea-108">Masking element</span></span>|<span data-ttu-id="740ea-109">Описание</span><span class="sxs-lookup"><span data-stu-id="740ea-109">Description</span></span>|<span data-ttu-id="740ea-110">Элемент регулярного выражения</span><span class="sxs-lookup"><span data-stu-id="740ea-110">Regular expression element</span></span>|  
|---------------------|-----------------|--------------------------------|  
|<span data-ttu-id="740ea-111">0</span><span class="sxs-lookup"><span data-stu-id="740ea-111">0</span></span>|<span data-ttu-id="740ea-112">Любой цифре от 0 до 9.</span><span class="sxs-lookup"><span data-stu-id="740ea-112">Any single digit between 0 and 9.</span></span> <span data-ttu-id="740ea-113">Требуется объект.</span><span class="sxs-lookup"><span data-stu-id="740ea-113">Entry required.</span></span>|<span data-ttu-id="740ea-114">\d</span><span class="sxs-lookup"><span data-stu-id="740ea-114">\d</span></span>|  
|<span data-ttu-id="740ea-115">9</span><span class="sxs-lookup"><span data-stu-id="740ea-115">9</span></span>|<span data-ttu-id="740ea-116">Цифра или пробел.</span><span class="sxs-lookup"><span data-stu-id="740ea-116">Digit or space.</span></span> <span data-ttu-id="740ea-117">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="740ea-117">Entry optional.</span></span>|<span data-ttu-id="740ea-118">[ \d]?</span><span class="sxs-lookup"><span data-stu-id="740ea-118">[ \d]?</span></span>|  
|#|<span data-ttu-id="740ea-119">Цифра или пробел.</span><span class="sxs-lookup"><span data-stu-id="740ea-119">Digit or space.</span></span> <span data-ttu-id="740ea-120">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="740ea-120">Entry optional.</span></span> <span data-ttu-id="740ea-121">Если эта позиция оставлено пустым в маске, отображается как пробел.</span><span class="sxs-lookup"><span data-stu-id="740ea-121">If this position is left blank in the mask, it will be rendered as a space.</span></span> <span data-ttu-id="740ea-122">Плюс (+) и минус (-) допускаются знаки.</span><span class="sxs-lookup"><span data-stu-id="740ea-122">Plus (+) and minus (-) signs are allowed.</span></span>|<span data-ttu-id="740ea-123">[ \d+-]?</span><span class="sxs-lookup"><span data-stu-id="740ea-123">[ \d+-]?</span></span>|  
|<span data-ttu-id="740ea-124">L</span><span class="sxs-lookup"><span data-stu-id="740ea-124">L</span></span>|<span data-ttu-id="740ea-125">Буквы в коде ASCII.</span><span class="sxs-lookup"><span data-stu-id="740ea-125">ASCII letter.</span></span> <span data-ttu-id="740ea-126">Требуется объект.</span><span class="sxs-lookup"><span data-stu-id="740ea-126">Entry required.</span></span>|<span data-ttu-id="740ea-127">[a-zA-Z]</span><span class="sxs-lookup"><span data-stu-id="740ea-127">[a-zA-Z]</span></span>|  
|<span data-ttu-id="740ea-128">?</span><span class="sxs-lookup"><span data-stu-id="740ea-128">?</span></span>|<span data-ttu-id="740ea-129">Буквы в коде ASCII.</span><span class="sxs-lookup"><span data-stu-id="740ea-129">ASCII letter.</span></span> <span data-ttu-id="740ea-130">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="740ea-130">Entry optional.</span></span>|<span data-ttu-id="740ea-131">[a-zA-Z]?</span><span class="sxs-lookup"><span data-stu-id="740ea-131">[a-zA-Z]?</span></span>|  
|&|<span data-ttu-id="740ea-132">Символ.</span><span class="sxs-lookup"><span data-stu-id="740ea-132">Character.</span></span> <span data-ttu-id="740ea-133">Требуется объект.</span><span class="sxs-lookup"><span data-stu-id="740ea-133">Entry required.</span></span>|<span data-ttu-id="740ea-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo]}</span><span class="sxs-lookup"><span data-stu-id="740ea-134">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]</span></span>|  
|<span data-ttu-id="740ea-135">C</span><span class="sxs-lookup"><span data-stu-id="740ea-135">C</span></span>|<span data-ttu-id="740ea-136">Символ.</span><span class="sxs-lookup"><span data-stu-id="740ea-136">Character.</span></span> <span data-ttu-id="740ea-137">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="740ea-137">Entry optional.</span></span>|<span data-ttu-id="740ea-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span><span class="sxs-lookup"><span data-stu-id="740ea-138">[\p{Ll}\p{Lu}\p{Lt}\p{Lm}\p{Lo}]?</span></span>|  
|<span data-ttu-id="740ea-139">А</span><span class="sxs-lookup"><span data-stu-id="740ea-139">A</span></span>|<span data-ttu-id="740ea-140">Буквенно-цифровых.</span><span class="sxs-lookup"><span data-stu-id="740ea-140">Alphanumeric.</span></span> <span data-ttu-id="740ea-141">Необязательный элемент.</span><span class="sxs-lookup"><span data-stu-id="740ea-141">Entry optional.</span></span>|<span data-ttu-id="740ea-142">\W</span><span class="sxs-lookup"><span data-stu-id="740ea-142">\W</span></span>|  
|<span data-ttu-id="740ea-143">.</span><span class="sxs-lookup"><span data-stu-id="740ea-143">.</span></span>|<span data-ttu-id="740ea-144">Язык и региональные параметры, соответствующие десятичный разделитель.</span><span class="sxs-lookup"><span data-stu-id="740ea-144">Culture-appropriate decimal placeholder.</span></span>|<span data-ttu-id="740ea-145">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-145">Not available.</span></span>|  
|<span data-ttu-id="740ea-146">,</span><span class="sxs-lookup"><span data-stu-id="740ea-146">,</span></span>|<span data-ttu-id="740ea-147">Соответствующий язык и региональные параметры тысяч разделитель.</span><span class="sxs-lookup"><span data-stu-id="740ea-147">Culture-appropriate thousands placeholder.</span></span>|<span data-ttu-id="740ea-148">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-148">Not available.</span></span>|  
|<span data-ttu-id="740ea-149">:</span><span class="sxs-lookup"><span data-stu-id="740ea-149">:</span></span>|<span data-ttu-id="740ea-150">Разделитель компонентов времени соответствующего языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="740ea-150">Culture-appropriate time separator.</span></span>|<span data-ttu-id="740ea-151">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-151">Not available.</span></span>|  
|/|<span data-ttu-id="740ea-152">Разделитель компонентов даты, соответствующего языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="740ea-152">Culture-appropriate date separator.</span></span>|<span data-ttu-id="740ea-153">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-153">Not available.</span></span>|  
|$|<span data-ttu-id="740ea-154">Символ валюты, соответствующий язык и региональные параметры.</span><span class="sxs-lookup"><span data-stu-id="740ea-154">Culture-appropriate currency symbol.</span></span>|<span data-ttu-id="740ea-155">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-155">Not available.</span></span>|  
|\<|<span data-ttu-id="740ea-156">Преобразует все последующие символы в нижний регистр.</span><span class="sxs-lookup"><span data-stu-id="740ea-156">Converts all characters that follow to lowercase.</span></span>|<span data-ttu-id="740ea-157">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-157">Not available.</span></span>|  
|>|<span data-ttu-id="740ea-158">Преобразует все последующие символы в верхний регистр.</span><span class="sxs-lookup"><span data-stu-id="740ea-158">Converts all characters that follow to uppercase.</span></span>|<span data-ttu-id="740ea-159">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-159">Not available.</span></span>|  
|<span data-ttu-id="740ea-160">&#124;</span><span class="sxs-lookup"><span data-stu-id="740ea-160">&#124;</span></span>|<span data-ttu-id="740ea-161">Отмена предыдущего изменения вверх или сместить.</span><span class="sxs-lookup"><span data-stu-id="740ea-161">Undoes a previous shift up or shift down.</span></span>|<span data-ttu-id="740ea-162">Недоступно.</span><span class="sxs-lookup"><span data-stu-id="740ea-162">Not available.</span></span>|  
|\|<span data-ttu-id="740ea-163">Замена символов маски, литерал.</span><span class="sxs-lookup"><span data-stu-id="740ea-163">Escapes a mask character, turning it into a literal.</span></span> <span data-ttu-id="740ea-164">«\\\\» является escape-последовательность для обратной косой черты.</span><span class="sxs-lookup"><span data-stu-id="740ea-164">"\\\\" is the escape sequence for a backslash.</span></span>|\|  
|<span data-ttu-id="740ea-165">Все остальные символы.</span><span class="sxs-lookup"><span data-stu-id="740ea-165">All other characters.</span></span>|<span data-ttu-id="740ea-166">Литералы.</span><span class="sxs-lookup"><span data-stu-id="740ea-166">Literals.</span></span> <span data-ttu-id="740ea-167">Маска-элементы отображаются внутри <xref:System.Windows.Forms.MaskedTextBox>.</xref:System.Windows.Forms.MaskedTextBox></span><span class="sxs-lookup"><span data-stu-id="740ea-167">All non-mask elements will appear as themselves within <xref:System.Windows.Forms.MaskedTextBox>.</span></span>|<span data-ttu-id="740ea-168">Все остальные символы.</span><span class="sxs-lookup"><span data-stu-id="740ea-168">All other characters.</span></span>|  
  
 <span data-ttu-id="740ea-169">Десятичный разделитель (.), разделитель тысяч (,), времени (:), даты (/) и символы валют ($) по умолчанию отображаются в соответствии с языком и региональными параметрами приложения.</span><span class="sxs-lookup"><span data-stu-id="740ea-169">The decimal (.), thousandths (,), time (:), date (/), and currency ($) symbols default to displaying those symbols as defined by the application's culture.</span></span> <span data-ttu-id="740ea-170">Можно принудительно отображать символы для других стран с помощью <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A>свойство.</xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A></span><span class="sxs-lookup"><span data-stu-id="740ea-170">You can force them to display symbols for another culture by using the <xref:System.Windows.Forms.MaskedTextBox.FormatProvider%2A> property.</span></span>  
  
## <a name="regular-expressions-and-masks"></a><span data-ttu-id="740ea-171">Регулярные выражения и маски</span><span class="sxs-lookup"><span data-stu-id="740ea-171">Regular Expressions and Masks</span></span>  
 <span data-ttu-id="740ea-172">Хотя можно использовать регулярные выражения и маски для проверки ввода данных пользователем, они не полностью эквивалентны.</span><span class="sxs-lookup"><span data-stu-id="740ea-172">Although you can use regular expressions and masks to validate user input, they are not completely equivalent.</span></span> <span data-ttu-id="740ea-173">Регулярные выражения могут выражать более сложные шаблоны, чем маски, но маски могут выражать те же сведения более четко и в формате соответствующего языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="740ea-173">Regular expressions can express more complex patterns than masks, but masks can express the same information more succinctly and in a culturally relevant format.</span></span>  
  
 <span data-ttu-id="740ea-174">В следующей таблице сравниваются четыре регулярных выражений и эквивалентные маску для каждого.</span><span class="sxs-lookup"><span data-stu-id="740ea-174">The following table compares four regular expressions and the equivalent mask for each.</span></span>  
  
|<span data-ttu-id="740ea-175">Регулярное выражение</span><span class="sxs-lookup"><span data-stu-id="740ea-175">Regular Expression</span></span>|<span data-ttu-id="740ea-176">Маска</span><span class="sxs-lookup"><span data-stu-id="740ea-176">Mask</span></span>|<span data-ttu-id="740ea-177">Примечания</span><span class="sxs-lookup"><span data-stu-id="740ea-177">Notes</span></span>|  
|------------------------|----------|-----------|  
|`\d{2}/\d{2}/\d{4}`|`00/00/0000`|<span data-ttu-id="740ea-178">`/` Символ в маске является логическим разделителем даты и отображается пользователю в качестве разделителя даты, подходящие для текущего языка и региональных параметров приложения.</span><span class="sxs-lookup"><span data-stu-id="740ea-178">The `/` character in the mask is a logical date separator, and it will appear to the user as the date separator appropriate to the application's current culture.</span></span>|  
|`\d{2}-[A-Z][a-z]{2}-\d{4}`|`00->L<LL-0000`|<span data-ttu-id="740ea-179">Дата (день, сокращенное наименование месяца и год) в формате США, в котором отображается сокращенное обозначение месяца трехбуквенный начальные прописные буквы, за которой следуют двух букв нижнего регистра.</span><span class="sxs-lookup"><span data-stu-id="740ea-179">A date (day, month abbreviation, and year) in United States format in which the three-letter month abbreviation is displayed with an initial uppercase letter followed by two lowercase letters.</span></span>|  
|`(\(\d{3}\)-)?\d{3}-d{4}`|`(999)-000-0000`|<span data-ttu-id="740ea-180">Номер телефона в США, необязательный код города.</span><span class="sxs-lookup"><span data-stu-id="740ea-180">United States phone number, area code optional.</span></span> <span data-ttu-id="740ea-181">Если пользователь не хочет вводить дополнительные символы, она может вводить пробелы или поместите указатель мыши непосредственно в позиции в маске, представленную первым 0.</span><span class="sxs-lookup"><span data-stu-id="740ea-181">If the user does not wish to enter the optional characters, she can either enter spaces or place the mouse pointer directly at the position in the mask represented by the first 0.</span></span>|  
|`$\d{6}.00`|`$999,999.00`|<span data-ttu-id="740ea-182">Значение валюты в диапазоне от 0 до 999999.</span><span class="sxs-lookup"><span data-stu-id="740ea-182">A currency value in the range of 0 to 999999.</span></span> <span data-ttu-id="740ea-183">Валюта, тысячные и десятичные знаки будут заменены во время выполнения с их эквивалентами для конкретного языка и региональных параметров.</span><span class="sxs-lookup"><span data-stu-id="740ea-183">The currency, thousandth, and decimal characters will be replaced at run-time with their culture-specific equivalents.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="740ea-184">См. также</span><span class="sxs-lookup"><span data-stu-id="740ea-184">See Also</span></span>  
 <span data-ttu-id="740ea-185"><xref:System.Windows.Forms.MaskedTextBox.Mask%2A></xref:System.Windows.Forms.MaskedTextBox.Mask%2A></span><span class="sxs-lookup"><span data-stu-id="740ea-185"><xref:System.Windows.Forms.MaskedTextBox.Mask%2A></span></span>   
 <span data-ttu-id="740ea-186"><xref:System.Windows.Forms.MaskedTextBox></xref:System.Windows.Forms.MaskedTextBox></span><span class="sxs-lookup"><span data-stu-id="740ea-186"><xref:System.Windows.Forms.MaskedTextBox></span></span>   
<span data-ttu-id="740ea-187"> [Проверка строк в Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md) </span><span class="sxs-lookup"><span data-stu-id="740ea-187"> [Validating Strings in Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/validating-strings.md) </span></span>  
<span data-ttu-id="740ea-188"> [Элемент управления MaskedTextBox](http://msdn.microsoft.com/library/235d6121-027d-481d-8d59-4f6794d15d0c)</span><span class="sxs-lookup"><span data-stu-id="740ea-188"> [MaskedTextBox Control](http://msdn.microsoft.com/library/235d6121-027d-481d-8d59-4f6794d15d0c)</span></span>
