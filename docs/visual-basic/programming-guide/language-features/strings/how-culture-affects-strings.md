---
title: "Влияние языка и региональных параметров на строки в Visual Basic"
ms.custom: 
ms.date: 07/20/2015
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: devlang-visual-basic
ms.topic: article
helpviewer_keywords:
- locale [Visual Basic], effect on strings
- strings [Visual Basic], locale dependence
ms.assetid: c4664444-ee0d-47bf-bef1-eaa3c54bdd7f
caps.latest.revision: "20"
author: dotnet-bot
ms.author: dotnetcontent
ms.openlocfilehash: b61f008edc446445fd5873b6138b64f29e0b8b8c
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="how-culture-affects-strings-in-visual-basic"></a>Влияние языка и региональных параметров на строки в Visual Basic
Эта страница справки рассматриваются как [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] использует сведения для выполнения строковых преобразований и сравнений, язык и региональные параметры.  
  
## <a name="when-to-use-culture-specific-strings"></a>Когда следует использовать строки, зависящие от языка и региональных параметров  
 Как правило следует использовать строки, зависящие от языка и региональных параметров для всех данных, отображаемых для и пользователям и использовать строки языка и региональных параметров для внутренних данных приложения.  
  
 Например если приложение запрашивает пользователям вводить даты в строку, следует ожидать, что пользователи для форматирования строки в соответствии с их язык и региональные параметры и приложения должны соответствующим образом преобразовать строку. Если приложение затем представляет эти данные в своем пользовательском интерфейсе, оно должно представлять их в язык и региональные параметры пользователя.  
  
 Тем не менее если приложение загружает данные на центральный сервер, следует отформатировать строки в соответствии с одного определенного языка и региональных параметров, во избежание путаницы между потенциально различные форматы даты.  
  
## <a name="culture-sensitive-functions"></a>Язык и региональные параметры функции  
 Все [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] функции преобразования строк (за исключением `Str` и `Val` функции) использовать языком и региональными параметрами информацию о, чтобы убедиться в том, что преобразования и сравнения подходят для языка и региональных параметров из пользователь приложения.  
  
 Ключ успешно с помощью функции преобразования строк в приложениях, работающих на компьютерах с различных региональных параметров — понять, какие функции использовать региональных параметров, а какие текущие настройки языка и региональных параметров. Обратите внимание, что параметры языка и региональных параметров приложения по умолчанию наследуются от параметров языка и региональных параметров операционной системы. Дополнительные сведения см. в разделе <xref:Microsoft.VisualBasic.Strings.Asc%2A>, <xref:Microsoft.VisualBasic.Strings.AscW%2A>, <xref:Microsoft.VisualBasic.Strings.Chr%2A>, <xref:Microsoft.VisualBasic.Strings.ChrW%2A>, <xref:Microsoft.VisualBasic.Strings.Format%2A>, <xref:Microsoft.VisualBasic.Conversion.Hex%2A>, <xref:Microsoft.VisualBasic.Conversion.Oct%2A>, и [функции преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md).  
  
 `Str` (Преобразование чисел в строки) и `Val` функции (преобразование строк в числа) не используйте данные язык и региональные параметры приложения при преобразовании между строками и числами. Вместо этого они распознает только точку (.) в качестве допустимого десятичного разделителя. Учитывающими аналогами этих функций:  
  
-   **Преобразования, использующие текущего языка и региональных параметров.** `CStr` И `Format` функции преобразования числа в строку и `CDbl` и `CInt` функции преобразования строки в число.  
  
-   **Преобразования, использующие определенного языка и региональных параметров.** Каждый числовой объект имеет `ToString(IFormatProvider)` метод, который преобразует число в строку и `Parse(String, IFormatProvider)` метод, который преобразует строку в число. Например `Double` тип предоставляет <xref:System.Double.ToString%28System.IFormatProvider%29> и <xref:System.Double.Parse%28System.String%2CSystem.IFormatProvider%29> методы.  
  
 Дополнительные сведения см. в разделах <xref:Microsoft.VisualBasic.Conversion.Str%2A> и <xref:Microsoft.VisualBasic.Conversion.Val%2A>.  
  
## <a name="using-a-specific-culture"></a>С помощью определенного языка и региональных параметров  
 Предположим, что вы разрабатываете приложение, которое отправляет дату (в формате строки) для веб-службы. В этом случае приложение должно использовать определенного языка и региональных параметров для преобразования строк. Чтобы проиллюстрировать, почему это происходит, рассмотрим результат использования даты <xref:System.DateTime.ToString> метод: Если приложение использует этот метод для форматирования даты 4 июля 2005 г., он возвращает «7/4/2005 12:00:00 AM» при запуске с английского языка США (en US), но возвращает» 04.07.2005 00:00:00» при запуске с культурой немецкий (de-DE).  
  
 Если необходимо выполнить преобразование строк в формате конкретного языка и региональных параметров, следует использовать `CultureInfo` класс, который встроен в [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)]. Можно создать новую `CultureInfo` объект для определенного языка и региональных параметров, передав имя культуры <xref:System.Globalization.CultureInfo.%23ctor%2A> конструктор. Поддерживаются следующие коды языков перечислены в <xref:System.Globalization.CultureInfo> класс страницы справки.  
  
 Кроме того, можно получить экземпляр *инвариантного языка и региональных параметров* из <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> свойство. Инвариантный язык и региональные параметры основан на английский язык и региональные параметры, но существуют некоторые различия. Например инвариантного языка и региональных параметров указывает 24-часовом формате, а не в 12-часовом формате.  
  
 Чтобы преобразовать дату в строку культуры, передайте <xref:System.Globalization.CultureInfo> объект даты <xref:System.DateTime.ToString%28System.IFormatProvider%29> метод. Например, следующий код отображает «07/04/2005 00:00:00» независимо от того, параметры языка и региональных параметров приложения.  
  
 [!code-vb[VbVbalrConcepts#1](../../../../visual-basic/programming-guide/language-features/operators-and-expressions/codesnippet/VisualBasic/how-culture-affects-strings_1.vb)]  
  
> [!NOTE]
>  Литералы даты всегда интерпретируются в соответствии со английского языка и региональных параметров.  
  
## <a name="comparing-strings"></a>Сравнение строк  
 Существуют две важные ситуации, когда необходимы сравнения строк:  
  
-   **Сортировка данных для отображения для пользователя.** Использование операций с учетом текущего языка и региональных параметров, поэтому строки сортируются соответствующим образом.  
  
-   **Определение, если две строки внутри приложения точно соответствовать (обычно по соображениям безопасности).** Используйте операции, не учитывайте текущего языка и региональных параметров.  
  
 Можно использовать оба вида сравнения с [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] <xref:Microsoft.VisualBasic.Strings.StrComp%2A> функции. Укажите необязательное `Compare` аргумент для управления типом сравнения: `Text` для большинства ввода и вывода `Binary` для определения точных совпадений.  
  
 `StrComp` Функция возвращает целое число, показывающее связь между двумя сравниваемыми строками на основе порядка сортировки. Положительное значение для результата указывает, что первая строка больше второй строки. Отрицательный результат указывает меньше первой строки, а нулевое значение отражает равенство между строками.  
  
 [!code-vb[VbVbalrStrings#22](../../../../visual-basic/language-reference/functions/codesnippet/VisualBasic/how-culture-affects-strings_2.vb)]  
  
 Можно также использовать [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] партнер `StrComp` функция, <xref:System.String.Compare%2A?displayProperty=nameWithType> метод. Это статический перегруженный метод базового строкового класса. В следующем примере показано, как используется этот метод:  
  
 [!code-vb[VbVbalrStrings#48](../../../../visual-basic/language-reference/functions/codesnippet/VisualBasic/how-culture-affects-strings_3.vb)]  
  
 Для более точного контроля над выполнением сравнения можно использовать дополнительные перегрузки <xref:System.String.Compare%2A> метод. С <xref:System.String.Compare%2A?displayProperty=nameWithType> метод, можно использовать `comparisonType` аргумент, чтобы указать, какой тип сравнения для использования.  
  
|Значение для `comparisonType` аргумент|Тип сравнения|Время использования|  
|---|---|---|  
|`Ordinal`|Сравнение, основанное на байтов, составляющих строку.|Используйте это значение при сравнении: идентификаторы с учетом регистра, параметры безопасности или других нелингвистических идентификаторов, где байты должны точно совпадать.|  
|`OrdinalIgnoreCase`|Сравнение, основанное на байтов, составляющих строку.<br /><br /> `OrdinalIgnoreCase`использует сведения инвариантного языка и региональных параметров для определения того, два символа отличаются только регистром.|Используйте это значение при сравнении: идентификаторы без учета регистра, параметры, относящиеся к безопасности и данных, хранящихся в Windows.|  
|`CurrentCulture` или `CurrentCultureIgnoreCase`|Сравнение, основанное на интерпретации строк в текущей культуре.|Эти значения следует использовать при сравнении: данных, отображаемых для пользователя, большинства пользовательского ввода и других данных, требующих лингвистической интерпретации.|  
|`InvariantCulture` или `InvariantCultureIgnoreCase`|Сравнение, основанное на интерпретации строк в инвариантного языка и региональных параметров.<br /><br /> Это отличается от `Ordinal` и `OrdinalIgnoreCase`, так как инвариантный язык и региональные параметры символов находится вне диапазона допустимых считает эквивалентными инвариантными символами.|Эти значения можно используйте только при сравнении сохраняемых данных или Отображение лингвистических данных, требующее фиксированного порядка сортировки.|  
  
### <a name="security-considerations"></a>Вопросы безопасности  
 Если приложение принимает решений по безопасности на основе результата сравнения или операциями изменения регистра, то эта операция должна выполняться <xref:System.String.Compare%2A?displayProperty=nameWithType> и передайте `Ordinal` или `OrdinalIgnoreCase` для `comparisonType` аргумент.  
  
## <a name="see-also"></a>См. также  
 <xref:System.Globalization.CultureInfo>  
 [Знакомство со строками в Visual Basic](../../../../visual-basic/programming-guide/language-features/strings/introduction-to-strings.md)  
 [Функции преобразования типов](../../../../visual-basic/language-reference/functions/type-conversion-functions.md)
