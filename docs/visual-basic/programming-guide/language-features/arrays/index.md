---
title: "Массивы в Visual Basic"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
f1_keywords:
- vb.Array
dev_langs:
- VB
helpviewer_keywords:
- arrays [Visual Basic]
- Visual Basic, arrays
ms.assetid: dbf29737-b589-4443-bee6-a27588d9c67e
caps.latest.revision: 47
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- ru-ru
- zh-cn
- zh-tw
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: HT
ms.sourcegitcommit: ef6d1bf9a7153f7adf635d13b4dcfb7647ed2e33
ms.openlocfilehash: 0da1ce5160ede4486ca0ff555cd02c8d0a9efcd3
ms.contentlocale: ru-ru
ms.lasthandoff: 07/29/2017

---
# <a name="arrays-in-visual-basic"></a><span data-ttu-id="bbea7-102">Массивы в Visual Basic</span><span class="sxs-lookup"><span data-stu-id="bbea7-102">Arrays in Visual Basic</span></span>
<span data-ttu-id="bbea7-103">Массив — это набор значений, логически связанных друг с другом, например число учеников в каждом классе школы.</span><span class="sxs-lookup"><span data-stu-id="bbea7-103">An array is a set of values that are logically related to each other, such as the number of students in each grade in a grammar school.</span></span>  <span data-ttu-id="bbea7-104">Если вам нужна справка по массивам в Visual Basic для приложений (VBA), см. [справочник по языку](https://msdn.microsoft.com/library/office/gg264383\(v=office.14\).aspx).</span><span class="sxs-lookup"><span data-stu-id="bbea7-104">If you are looking for help on arrays in Visual Basic for Applications (VBA), see the [language reference](https://msdn.microsoft.com/library/office/gg264383\(v=office.14\).aspx).</span></span>  
  
 <span data-ttu-id="bbea7-105">С помощью массива можно ссылаться на эти связанные значения по одному имени и использовать номер, называемый индексом, чтобы отличать элементы друг от друга.</span><span class="sxs-lookup"><span data-stu-id="bbea7-105">By using an array, you can refer to these related values by the same name, and use a number that’s called an index or subscript to tell them apart.</span></span> <span data-ttu-id="bbea7-106">Отдельные значения называются элементами массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-106">The individual values are called the elements of the array.</span></span> <span data-ttu-id="bbea7-107">Они составляют непрерывную последовательность от индекса 0 до наибольшего значения индекса.</span><span class="sxs-lookup"><span data-stu-id="bbea7-107">They’re contiguous from index 0 through the highest index value.</span></span>  
  
 <span data-ttu-id="bbea7-108">В отличие от массива, переменная, содержащая одиночное значение, называется *скалярной* переменной.</span><span class="sxs-lookup"><span data-stu-id="bbea7-108">In contrast to an array, a variable that contain a single value is called a *scalar* variable.</span></span>  
  
 <span data-ttu-id="bbea7-109">Несколько простых примеров перед подробным описанием:</span><span class="sxs-lookup"><span data-stu-id="bbea7-109">Some quick examples before explanation:</span></span>  
  
```vb  
'Declare a single-dimension array of 5 values  
Dim numbers(4) As Integer   
  
'Declare a single-dimension array and set array element values  
Dim numbers = New Integer() {1, 2, 4, 8}  
  
'Redefine the size of an existing array retaining the current values  
ReDim Preserve numbers(15)  
  
'Redefine the size of an existing array, resetting the values  
ReDim numbers(15)  
  
'Declare a multi-dimensional array  
Dim matrix(5, 5) As Double  
  
'Declare a multi-dimensional array and set array element values  
Dim matrix = New Integer(4, 4) {{1, 2}, {3, 4}, {5, 6}, {7, 8}}  
  
'Declare a jagged array  
Dim sales()() As Double = New Double(11)() {}  
```  
  
 <span data-ttu-id="bbea7-110">**Содержание раздела**</span><span class="sxs-lookup"><span data-stu-id="bbea7-110">**In this topic**</span></span>  
  
-   [<span data-ttu-id="bbea7-111">Элементы простого массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-111">Array Elements in a Simple Array</span></span>](#BKMK_ArrayElements)  
  
-   [<span data-ttu-id="bbea7-112">Создание массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-112">Creating an Array</span></span>](#BKMK_CreatingAnArray)  
  
-   [<span data-ttu-id="bbea7-113">Сохранение значений в массиве</span><span class="sxs-lookup"><span data-stu-id="bbea7-113">Storing Values in an Array</span></span>](#BKMK_StoringValues)  
  
-   [<span data-ttu-id="bbea7-114">Заполнение массива начальными значениями</span><span class="sxs-lookup"><span data-stu-id="bbea7-114">Populating an Array with Initial Values</span></span>](#BKMK_Populating)  
  
    -   [<span data-ttu-id="bbea7-115">Вложенные литералы массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-115">Nested Array Literals</span></span>](#BKMK_NestedArrayLiterals)  
  
-   [<span data-ttu-id="bbea7-116">Перебор массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-116">Iterating Through an Array</span></span>](#BKMK_Iterating)  
  
-   [<span data-ttu-id="bbea7-117">Массивы как возвращаемые значения и параметры</span><span class="sxs-lookup"><span data-stu-id="bbea7-117">Arrays as Return Values and Parameters</span></span>](#BKMK_ReturnValues)  
  
-   [<span data-ttu-id="bbea7-118">Массивы массивов</span><span class="sxs-lookup"><span data-stu-id="bbea7-118">Jagged Arrays</span></span>](#BKMK_JaggedArrays)  
  
-   [<span data-ttu-id="bbea7-119">Массивы нулевой длины</span><span class="sxs-lookup"><span data-stu-id="bbea7-119">Zero-Length Arrays</span></span>](#BKMK_ZeroLength)  
  
-   [<span data-ttu-id="bbea7-120">Размер массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-120">Array Size</span></span>](#BKMK_ArraySize)  
  
-   [<span data-ttu-id="bbea7-121">Типы массивов и другие типы</span><span class="sxs-lookup"><span data-stu-id="bbea7-121">Array Types and Other Types</span></span>](#BKMK_ArrayTypes)  
  
-   [<span data-ttu-id="bbea7-122">Коллекции как альтернатива массивам</span><span class="sxs-lookup"><span data-stu-id="bbea7-122">Collections as an Alternative to Arrays</span></span>](#BKMK_Collections)  
  
##  <span data-ttu-id="bbea7-123"><a name="BKMK_ArrayElements"></a> Элементы простого массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-123"><a name="BKMK_ArrayElements"></a> Array Elements in a Simple Array</span></span>  
 <span data-ttu-id="bbea7-124">В приведенном ниже примере объявляется переменная массива для хранения числа учеников в каждом классе школы.</span><span class="sxs-lookup"><span data-stu-id="bbea7-124">The following example declares an array variable to hold the number of students in each grade in a grammar school.</span></span>  
  
 <span data-ttu-id="bbea7-125">[!code-vb[VbVbalrArrays#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#2)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-125">[!code-vb[VbVbalrArrays#2](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#2)]</span></span>  
  
 <span data-ttu-id="bbea7-126">Массив `students` в предыдущем примере содержит семь элементов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-126">The array `students` in the preceding example contains seven elements.</span></span> <span data-ttu-id="bbea7-127">Индексы элементов находятся в диапазоне от 0 до 6.</span><span class="sxs-lookup"><span data-stu-id="bbea7-127">The indexes of the elements range from 0 through 6.</span></span> <span data-ttu-id="bbea7-128">Использовать массив проще, чем объявлять семь отдельных переменных.</span><span class="sxs-lookup"><span data-stu-id="bbea7-128">Having this array is simpler than declaring seven variables.</span></span>  
  
 <span data-ttu-id="bbea7-129">На рисунке ниже показан массив `students`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-129">The following illustration shows the array `students`.</span></span> <span data-ttu-id="bbea7-130">Для каждого элемента массива:</span><span class="sxs-lookup"><span data-stu-id="bbea7-130">For each element of the array:</span></span>  
  
-   <span data-ttu-id="bbea7-131">индекс элемента представляет школьный класс (индекс 0 представляет детский сад);</span><span class="sxs-lookup"><span data-stu-id="bbea7-131">The index of the element represents the grade (index 0 represents kindergarten).</span></span>  
  
-   <span data-ttu-id="bbea7-132">значение, содержащееся в элементе, представляет число учеников в этом классе.</span><span class="sxs-lookup"><span data-stu-id="bbea7-132">The value that’s contained in the element represents the number of students in that grade.</span></span>  
  
 <span data-ttu-id="bbea7-133">![Изображение массива, где показано количество учеников](../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif "ArrayExampleSchool")</span><span class="sxs-lookup"><span data-stu-id="bbea7-133">![Picture of array showing numbers of students](../../../../visual-basic/programming-guide/language-features/arrays/media/arrayexampleschool.gif "ArrayExampleSchool")</span></span>  
<span data-ttu-id="bbea7-134">Элементы массива students</span><span class="sxs-lookup"><span data-stu-id="bbea7-134">Elements of the "students" array</span></span>  
  
 <span data-ttu-id="bbea7-135">В приведенном ниже примере показано обращение к первому, второму и последнему элементам массива `students`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-135">The following example shows how to refer to the first, second, and last element of the array `students`.</span></span>  
  
 <span data-ttu-id="bbea7-136">[!code-vb[VbVbalrArrays#3](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#3)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-136">[!code-vb[VbVbalrArrays#3](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#3)]</span></span>  
  
 <span data-ttu-id="bbea7-137">Можно ссылаться на массив в целом, используя только имя переменной массива без индексов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-137">You can refer to the array as a whole by using just the array variable name without indexes.</span></span>  
  
 <span data-ttu-id="bbea7-138">Массив `students` в предыдущем примере имеет один индекс и считается одномерным.</span><span class="sxs-lookup"><span data-stu-id="bbea7-138">The array `students` in the preceding example uses one index and is said to be one-dimensional.</span></span> <span data-ttu-id="bbea7-139">Массив, имеющий более одного индекса, называется многомерным.</span><span class="sxs-lookup"><span data-stu-id="bbea7-139">An array that uses more than one index or subscript is called multidimensional.</span></span> <span data-ttu-id="bbea7-140">Дополнительные сведения см. далее в этом разделе и в разделе [Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-140">For more information, see the rest of this topic and [Array Dimensions in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md).</span></span>  
  
##  <span data-ttu-id="bbea7-141"><a name="BKMK_CreatingAnArray"></a> Создание массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-141"><a name="BKMK_CreatingAnArray"></a> Creating an Array</span></span>  
 <span data-ttu-id="bbea7-142">Размер массива можно задать несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="bbea7-142">You can define the size of an array several ways.</span></span> <span data-ttu-id="bbea7-143">Можно указать размер при объявлении массива, как показано в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="bbea7-143">You can supply the size when the array is declared, as the following example shows.</span></span>  
  
 <span data-ttu-id="bbea7-144">[!code-vb[VbVbalrArrays#12](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#12)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-144">[!code-vb[VbVbalrArrays#12](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#12)]</span></span>  
  
 <span data-ttu-id="bbea7-145">Кроме того, можно указать размер массива при его создании с помощью предложения `New` , как показано в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="bbea7-145">You can also use a `New` clause to supply the size of an array when it’s created, as the following example shows.</span></span>  
  
 <span data-ttu-id="bbea7-146">[!code-vb[VbVbalrArrays#11](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#11)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-146">[!code-vb[VbVbalrArrays#11](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#11)]</span></span>  
  
 <span data-ttu-id="bbea7-147">Если массив уже существует, его размер можно переопределить с помощью оператора `Redim` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-147">If you have an existing array, you can redefine its size by using the `Redim` statement.</span></span> <span data-ttu-id="bbea7-148">Можно указать, что оператор `Redim` должен сохранить значения, уже имеющиеся в массиве, или создать пустой массив.</span><span class="sxs-lookup"><span data-stu-id="bbea7-148">You can specify that the `Redim` statement should keep the values that are in the array, or you can specify that it create an empty array.</span></span> <span data-ttu-id="bbea7-149">В приведенном ниже примере показаны различные варианты использования оператора `Redim` для изменения размера существующего массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-149">The following example shows different uses of the `Redim` statement to modify the size of an existing array.</span></span>  
  
 <span data-ttu-id="bbea7-150">[!code-vb[VbVbalrArrays#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#13)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-150">[!code-vb[VbVbalrArrays#13](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#13)]</span></span>  
  
 <span data-ttu-id="bbea7-151">Дополнительные сведения см. в статье [ReDim Statement (Visual Basic)](../../../../visual-basic/language-reference/statements/redim-statement.md) (Инструкция ReDim (Visual Basic)).</span><span class="sxs-lookup"><span data-stu-id="bbea7-151">For more information, see [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md).</span></span>  
  
##  <span data-ttu-id="bbea7-152"><a name="BKMK_StoringValues"></a> Сохранение значений в массиве</span><span class="sxs-lookup"><span data-stu-id="bbea7-152"><a name="BKMK_StoringValues"></a> Storing Values in an Array</span></span>  
 <span data-ttu-id="bbea7-153">К любой позиции в массиве можно получить доступ, используя индекс типа `Integer`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-153">You can access each location in an array by using an index of type `Integer`.</span></span> <span data-ttu-id="bbea7-154">Вы можете сохранять и извлекать значения массива, ссылаясь на позицию в нем с помощью индекса, заключенного в скобки.</span><span class="sxs-lookup"><span data-stu-id="bbea7-154">You can store and retrieve values in an array by referencing each array location by using its index enclosed in parentheses.</span></span> <span data-ttu-id="bbea7-155">Индексы многомерных массивов разделяются запятыми (,).</span><span class="sxs-lookup"><span data-stu-id="bbea7-155">Indexes for multi-dimensional arrays are separated by commas (,).</span></span> <span data-ttu-id="bbea7-156">Для каждого измерения массива требуется один индекс.</span><span class="sxs-lookup"><span data-stu-id="bbea7-156">You need one index for each array dimension.</span></span> <span data-ttu-id="bbea7-157">В приведенном ниже примере показаны некоторые операторы, которые сохраняют значения в массивах.</span><span class="sxs-lookup"><span data-stu-id="bbea7-157">The following example shows some statements that store values in arrays.</span></span>  
  
 <span data-ttu-id="bbea7-158">[!code-vb[VbVbalrArrays#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#5)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-158">[!code-vb[VbVbalrArrays#5](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#5)]</span></span>  
  
 <span data-ttu-id="bbea7-159">В приведенном ниже примере показаны некоторые операторы, которые получают значения из массивов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-159">The following example shows some statements that get values from arrays.</span></span>  
  
 <span data-ttu-id="bbea7-160">[!code-vb[VbVbalrArrays#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#6)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-160">[!code-vb[VbVbalrArrays#6](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#6)]</span></span>  
  
##  <span data-ttu-id="bbea7-161"><a name="BKMK_Populating"></a> Заполнение массива начальными значениями</span><span class="sxs-lookup"><span data-stu-id="bbea7-161"><a name="BKMK_Populating"></a> Populating an Array with Initial Values</span></span>  
 <span data-ttu-id="bbea7-162">С помощью литерала массива можно создать массив, содержащий начальный набор значений.</span><span class="sxs-lookup"><span data-stu-id="bbea7-162">By using an array literal, you can create an array that contains an initial set of values.</span></span> <span data-ttu-id="bbea7-163">Литерал массива состоит из списка разделенных запятыми значений, заключенных в фигурные скобки (`{}`).</span><span class="sxs-lookup"><span data-stu-id="bbea7-163">An array literal consists of a list of comma-separated values that are enclosed in braces (`{}`).</span></span>  
  
 <span data-ttu-id="bbea7-164">При создании массива с помощью литерала массива можно либо указать тип массива, либо использовать определение типа для задания типа массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-164">When you create an array by using an array literal, you can either supply the array type or use type inference to determine the array type.</span></span> <span data-ttu-id="bbea7-165">В приведенном ниже коде показаны обе возможности.</span><span class="sxs-lookup"><span data-stu-id="bbea7-165">The following code shows both options.</span></span>  
  
 <span data-ttu-id="bbea7-166">[!code-vb[VbVbalrCollectionInitializers#3](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#3)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-166">[!code-vb[VbVbalrCollectionInitializers#3](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#3)]</span></span>  
  
 <span data-ttu-id="bbea7-167">При использовании определении типа тип массива определяется главным типом в списке значений, предоставленным для литерала массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-167">When you use type inference, the type of the array is determined by the dominant type in the list of values that’s supplied for the array literal.</span></span> <span data-ttu-id="bbea7-168">Главный тип — это уникальный тип, до которого могут быть расширены все другие типы литерала массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-168">The dominant type is a unique type to which all other types in the array literal can widen.</span></span> <span data-ttu-id="bbea7-169">Если такой уникальный тип нельзя определить, то главным будет тип, до которого можно сузить все другие типы массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-169">If this unique type can’t be determined, the dominant type is the unique type to which all other types in the array can narrow.</span></span> <span data-ttu-id="bbea7-170">Если ни один из указанных уникальных типов нельзя определить, главным типом будет `Object`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-170">If neither of these unique types can be determined, the dominant type is `Object`.</span></span> <span data-ttu-id="bbea7-171">Например, если список значений для литерала массива содержит значения типов `Integer`, `Long`и `Double`, результирующий массив будет иметь тип `Double`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-171">For example, if the list of values that’s supplied to the array literal contains values of type `Integer`, `Long`, and `Double`, the resulting array is of type `Double`.</span></span> <span data-ttu-id="bbea7-172">Типы `Integer` и `Long` расширяются только до типа `Double`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-172">Both `Integer` and `Long` widen only to `Double`.</span></span> <span data-ttu-id="bbea7-173">Поэтому `Double` является главным типом.</span><span class="sxs-lookup"><span data-stu-id="bbea7-173">Therefore, `Double` is the dominant type.</span></span> <span data-ttu-id="bbea7-174">Для получения дополнительной информации см. [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-174">For more information, see [Widening and Narrowing Conversions](../../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md).</span></span> <span data-ttu-id="bbea7-175">Эти правила определения применимы для вывода типов массивов, которые являются локальными переменными, определенными в члене класса.</span><span class="sxs-lookup"><span data-stu-id="bbea7-175">These inference rules apply to types that are inferred for arrays that are local variables that are defined in a class member.</span></span> <span data-ttu-id="bbea7-176">Несмотря на то что вы можете использовать литералы массива при создании переменных уровня класса, использовать определение типа на уровне класса нельзя.</span><span class="sxs-lookup"><span data-stu-id="bbea7-176">Although you can use array literals when you create class-level variables, you can’t use type inference at the class level.</span></span> <span data-ttu-id="bbea7-177">В результате литералы массива, заданные на уровне класса, определяют тип значений, указанных для литерала массива, как `Object`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-177">As a result, array literals that are specified at the class level infer the values that are supplied for the array literal as type `Object`.</span></span>  
  
 <span data-ttu-id="bbea7-178">Можно явно задать тип элементов в массиве, созданном с помощью литерала массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-178">You can explicitly specify the type of the elements in an array that’s created by using an array literal.</span></span> <span data-ttu-id="bbea7-179">В таком случае значения литерала массива должны расширяться до типа элементов массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-179">In this case, the values in the array literal must widen to the type of the elements of the array.</span></span> <span data-ttu-id="bbea7-180">В приведенном ниже примере кода создается массив типа `Double` из списка целых чисел.</span><span class="sxs-lookup"><span data-stu-id="bbea7-180">The following code example creates an array of type `Double` from a list of integers.</span></span>  
  
 <span data-ttu-id="bbea7-181">[!code-vb[VbVbalrCollectionInitializers#4](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#4)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-181">[!code-vb[VbVbalrCollectionInitializers#4](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#4)]</span></span>  
  
###  <span data-ttu-id="bbea7-182"><a name="BKMK_NestedArrayLiterals"></a> Вложенные литералы массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-182"><a name="BKMK_NestedArrayLiterals"></a> Nested Array Literals</span></span>  
 <span data-ttu-id="bbea7-183">Многомерный массив можно создать с помощью вложенных литералов массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-183">You can create a multidimensional array by using nested array literals.</span></span> <span data-ttu-id="bbea7-184">Вложенные литералы массива должны иметь измерение и число измерений, называемое рангом, соответствующее результирующему массиву.</span><span class="sxs-lookup"><span data-stu-id="bbea7-184">Nested array literals must have a dimension and number of dimensions, or rank, that’s consistent with the resulting array.</span></span> <span data-ttu-id="bbea7-185">В приведенном ниже примере кода создается двухмерный массив целых чисел с помощью литерала массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-185">The following code example creates a two-dimensional array of integers by using an array literal.</span></span>  
  
 <span data-ttu-id="bbea7-186">[!code-vb[VbVbalrCollectionInitializers#7](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#7)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-186">[!code-vb[VbVbalrCollectionInitializers#7](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#7)]</span></span>  
  
 <span data-ttu-id="bbea7-187">В предыдущем примере возникла бы ошибка, если бы число элементов во вложенных литералах массива не совпадало.</span><span class="sxs-lookup"><span data-stu-id="bbea7-187">In the previous example, an error would occur if the number of elements in the nested array literals didn’t match.</span></span> <span data-ttu-id="bbea7-188">Ошибка также возникла бы, если бы переменная массива была объявлена явно не двухмерной.</span><span class="sxs-lookup"><span data-stu-id="bbea7-188">An error would also occur if you explicitly declared the array variable to be other than two-dimensional.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bbea7-189">Избежать ошибки при указании вложенных литералов массива с различными измерениями можно, заключив внутренние литералы массива в круглые скобки.</span><span class="sxs-lookup"><span data-stu-id="bbea7-189">You can avoid an error when you supply nested array literals of different dimensions by enclosing the inner array literals in parentheses.</span></span> <span data-ttu-id="bbea7-190">Скобки требуют принудительного вычисления выражения литерала массива, а полученные значения используются со внешним литералом массива, как показано в приведенном ниже коде.</span><span class="sxs-lookup"><span data-stu-id="bbea7-190">The parentheses force the array literal expression to be evaluated, and the resulting values are used with the outer array literal, as the following code shows.</span></span>  
  
 <span data-ttu-id="bbea7-191">[!code-vb[VbVbalrCollectionInitializers#11](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#11)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-191">[!code-vb[VbVbalrCollectionInitializers#11](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#11)]</span></span>  
  
 <span data-ttu-id="bbea7-192">При создании многомерного массива с помощью вложенных литералов массива можно использовать определение типа.</span><span class="sxs-lookup"><span data-stu-id="bbea7-192">When you create a multidimensional array by using nested array literals, you can use type inference.</span></span> <span data-ttu-id="bbea7-193">При использовании определения типа определяемый тип является главным для всех значений всех литералов массива какого-либо уровня вложенности.</span><span class="sxs-lookup"><span data-stu-id="bbea7-193">When you use type inference, the inferred type is the dominant type for all the values in all the array literals for a nesting level.</span></span> <span data-ttu-id="bbea7-194">В приведенном ниже примере кода создается двухмерный массив типа `Double` из значений типа `Integer` и `Double`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-194">The following code example creates a two-dimensional array of type `Double` from values that are of type `Integer` and `Double`.</span></span>  
  
 <span data-ttu-id="bbea7-195">[!code-vb[VbVbalrCollectionInitializers#8](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#8)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-195">[!code-vb[VbVbalrCollectionInitializers#8](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrCollectionInitializers/VB/Module1.vb#8)]</span></span>  
  
 <span data-ttu-id="bbea7-196">Дополнительные примеры можно найти в статье [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md) (Практическое руководство. Инициализация переменной массива в Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="bbea7-196">For additional examples, see [How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md).</span></span>  
  
##  <span data-ttu-id="bbea7-197"><a name="BKMK_Iterating"></a> Перебор массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-197"><a name="BKMK_Iterating"></a> Iterating Through an Array</span></span>  
 <span data-ttu-id="bbea7-198">При переборе массива вы получаете доступ к каждому его элементу от наименьшего индекса до наибольшего.</span><span class="sxs-lookup"><span data-stu-id="bbea7-198">When you iterate through an array, you access each element in the array from the lowest index to the highest index.</span></span>  
  
 <span data-ttu-id="bbea7-199">Приведенный выше пример кода выполняет перебор одномерного массива с помощью [оператора For...Next](../../../../visual-basic/language-reference/statements/for-next-statement.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-199">The following example iterates through a one-dimensional array by using the [For...Next Statement](../../../../visual-basic/language-reference/statements/for-next-statement.md).</span></span> <span data-ttu-id="bbea7-200">Метод <xref:System.Array.GetUpperBound%2A> возвращает максимально допустимое значение индекса.</span><span class="sxs-lookup"><span data-stu-id="bbea7-200">The <xref:System.Array.GetUpperBound%2A> method returns the highest value that the index can have.</span></span> <span data-ttu-id="bbea7-201">Наименьшее значение индекса всегда равно 0.</span><span class="sxs-lookup"><span data-stu-id="bbea7-201">The lowest index value is always 0.</span></span>  
  
 <span data-ttu-id="bbea7-202">[!code-vb[VbVbalrArrays#41](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#41)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-202">[!code-vb[VbVbalrArrays#41](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#41)]</span></span>  
  
 <span data-ttu-id="bbea7-203">В приведенном ниже примере выполняется перебор многомерного массива с помощью оператора `For...Next` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-203">The following example iterates through a multidimensional array by using a `For...Next` statement.</span></span> <span data-ttu-id="bbea7-204">Метод <xref:System.Array.GetUpperBound%2A> имеет параметр, который определяет измерение.</span><span class="sxs-lookup"><span data-stu-id="bbea7-204">The <xref:System.Array.GetUpperBound%2A> method has a parameter that specifies the dimension.</span></span> <span data-ttu-id="bbea7-205">`GetUpperBound(0)` возвращает максимальное значение индекса для первого измерения, а `GetUpperBound(1)` возвращает максимальное значение индекса для второго измерения.</span><span class="sxs-lookup"><span data-stu-id="bbea7-205">`GetUpperBound(0)` returns the high index value for the first dimension, and `GetUpperBound(1)` returns the high index value for the second dimension.</span></span>  
  
 <span data-ttu-id="bbea7-206">[!code-vb[VbVbalrArrays#42](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#42)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-206">[!code-vb[VbVbalrArrays#42](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#42)]</span></span>  
  
 <span data-ttu-id="bbea7-207">Приведенный выше пример кода выполняет перебор одномерного массива с помощью [оператора For Each...Next](../../../../visual-basic/language-reference/statements/for-each-next-statement.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-207">The following example iterates through a one-dimensional array by using a [For Each...Next Statement](../../../../visual-basic/language-reference/statements/for-each-next-statement.md).</span></span>  
  
 <span data-ttu-id="bbea7-208">[!code-vb[VbVbalrArrays#43](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#43)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-208">[!code-vb[VbVbalrArrays#43](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#43)]</span></span>  
  
 <span data-ttu-id="bbea7-209">В приведенном ниже примере выполняется перебор многомерного массива с помощью оператора `For Each...Next` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-209">The following example iterates through a multidimensional array by using a `For Each...Next` statement.</span></span> <span data-ttu-id="bbea7-210">Однако возможности управления элементами многомерного массива будут шире при использовании вложенного оператора `For…Next` , как в предыдущем примере, вместо оператора `For Each…Next` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-210">However, you have more control over the elements of a multidimensional array if you use a nested `For…Next` statement, as in a previous example, instead of a `For Each…Next` statement.</span></span>  
  
 <span data-ttu-id="bbea7-211">[!code-vb[VbVbalrArrays#44](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#44)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-211">[!code-vb[VbVbalrArrays#44](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#44)]</span></span>  
  
##  <span data-ttu-id="bbea7-212"><a name="BKMK_ReturnValues"></a> Массивы как возвращаемые значения и параметры</span><span class="sxs-lookup"><span data-stu-id="bbea7-212"><a name="BKMK_ReturnValues"></a> Arrays as Return Values and Parameters</span></span>  
 <span data-ttu-id="bbea7-213">Чтобы вернуть массив из процедуры `Function`, укажите тип данных массива и число измерений в качестве типа возвращаемого значения [оператора Function](../../../../visual-basic/language-reference/statements/function-statement.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-213">To return an array from a `Function` procedure, specify the array data type and the number of dimensions as the return type of the [Function Statement](../../../../visual-basic/language-reference/statements/function-statement.md).</span></span> <span data-ttu-id="bbea7-214">Внутри функции объявите локальную переменную массива с тем же числом измерений и типом данных.</span><span class="sxs-lookup"><span data-stu-id="bbea7-214">Within the function, declare a local array variable with same data type and number of dimensions.</span></span> <span data-ttu-id="bbea7-215">В [оператор Return](../../../../visual-basic/language-reference/statements/return-statement.md) включите локальную переменную массива без скобок.</span><span class="sxs-lookup"><span data-stu-id="bbea7-215">In the [Return Statement](../../../../visual-basic/language-reference/statements/return-statement.md), include the local array variable without parentheses.</span></span>  
  
 <span data-ttu-id="bbea7-216">Чтобы задать массив в качестве параметра процедуры `Sub` или `Function` , определите параметр как массив с указанными типом данных и количеством измерений.</span><span class="sxs-lookup"><span data-stu-id="bbea7-216">To specify an array as a parameter to a `Sub` or `Function` procedure, define the parameter as an array with a specified data type and number of dimensions.</span></span> <span data-ttu-id="bbea7-217">В вызове процедуры отправьте переменную массива с тем же типом данных и количеством измерений.</span><span class="sxs-lookup"><span data-stu-id="bbea7-217">In the call to the procedure, send an array variable with the same data type and number of dimensions.</span></span>  
  
 <span data-ttu-id="bbea7-218">В приведенном ниже примере функция `GetNumbers` возвращает `Integer()`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-218">In the following example, the `GetNumbers` function returns an `Integer()`.</span></span> <span data-ttu-id="bbea7-219">Этот тип массива — одномерный массив типа `Integer`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-219">This array type is a one dimensional array of type `Integer`.</span></span> <span data-ttu-id="bbea7-220">Процедура `ShowNumbers` принимает аргумент `Integer()` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-220">The `ShowNumbers` procedure accepts an `Integer()` argument.</span></span>  
  
 <span data-ttu-id="bbea7-221">[!code-vb[VbVbalrArrays#51](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#51)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-221">[!code-vb[VbVbalrArrays#51](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#51)]</span></span>  
  
 <span data-ttu-id="bbea7-222">В приведенном ниже примере функция `GetNumbersMultiDim` возвращает `Integer(,)`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-222">In the following example, the `GetNumbersMultiDim` function returns an `Integer(,)`.</span></span> <span data-ttu-id="bbea7-223">Этот тип массива — двухмерный массив типа `Integer`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-223">This array type is a two dimensional array of type `Integer`.</span></span>  <span data-ttu-id="bbea7-224">Процедура `ShowNumbersMultiDim` принимает аргумент `Integer(,)` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-224">The `ShowNumbersMultiDim` procedure accepts an `Integer(,)` argument.</span></span>  
  
 <span data-ttu-id="bbea7-225">[!code-vb[VbVbalrArrays#52](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#52)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-225">[!code-vb[VbVbalrArrays#52](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#52)]</span></span>  
  
##  <span data-ttu-id="bbea7-226"><a name="BKMK_JaggedArrays"></a> Массивы массивов</span><span class="sxs-lookup"><span data-stu-id="bbea7-226"><a name="BKMK_JaggedArrays"></a> Jagged Arrays</span></span>  
 <span data-ttu-id="bbea7-227">Массив, который содержит другие массивы как элементы, называется массивом массивов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-227">An array that holds other arrays as elements is known as an array of arrays or a jagged array.</span></span> <span data-ttu-id="bbea7-228">Массив массивов и каждый элемент в нем могут иметь одно или несколько измерений.</span><span class="sxs-lookup"><span data-stu-id="bbea7-228">A jagged array and each element in a jagged array can have one or more dimensions.</span></span> <span data-ttu-id="bbea7-229">Иногда структура данных в приложении является двухмерной, но не прямоугольной.</span><span class="sxs-lookup"><span data-stu-id="bbea7-229">Sometimes the data structure in your application is two-dimensional but not rectangular.</span></span>  
  
 <span data-ttu-id="bbea7-230">В приведенном ниже примере имеется массив месяцев, каждый элемент которого представляет собой массив дней.</span><span class="sxs-lookup"><span data-stu-id="bbea7-230">The following example has an array of months, each element of which is an array of days.</span></span> <span data-ttu-id="bbea7-231">Так как число дней в разных месяцах различно, элементы не образуют прямоугольный двухмерный массив.</span><span class="sxs-lookup"><span data-stu-id="bbea7-231">Because different months have different numbers of days, the elements don’t form a rectangular two-dimensional array.</span></span> <span data-ttu-id="bbea7-232">Поэтому вместо многомерного массива используется массив массивов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-232">Therefore, a jagged array is used instead of a multidimensional array.</span></span>  
  
 <span data-ttu-id="bbea7-233">[!code-vb[VbVbalrArrays#21](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#21)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-233">[!code-vb[VbVbalrArrays#21](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#21)]</span></span>  
  
##  <span data-ttu-id="bbea7-234"><a name="BKMK_ZeroLength"></a> Массивы нулевой длины</span><span class="sxs-lookup"><span data-stu-id="bbea7-234"><a name="BKMK_ZeroLength"></a> Zero-Length Arrays</span></span>  
 <span data-ttu-id="bbea7-235">Массив без элементов также называется массивом нулевой длины.</span><span class="sxs-lookup"><span data-stu-id="bbea7-235">An array that contains no elements is also called a zero-length array.</span></span> <span data-ttu-id="bbea7-236">Переменная, содержащая массив нулевой длины, не имеет значения `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-236">A variable that holds a zero-length array doesn’t have the value `Nothing`.</span></span> <span data-ttu-id="bbea7-237">Чтобы создать массив без элементов, объявите одно из измерений массива равным –1, как показано в примере ниже.</span><span class="sxs-lookup"><span data-stu-id="bbea7-237">To create an array that has no elements, declare one of the array's dimensions to be -1, as the following example shows.</span></span>  
  
 <span data-ttu-id="bbea7-238">[!code-vb[VbVbalrArrays#14](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#14)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-238">[!code-vb[VbVbalrArrays#14](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#14)]</span></span>  
  
 <span data-ttu-id="bbea7-239">Массив нулевой длины может потребоваться создать в указанных ниже случаях.</span><span class="sxs-lookup"><span data-stu-id="bbea7-239">You might need to create a zero-length array under the following circumstances:</span></span>  
  
-   <span data-ttu-id="bbea7-240">Без риска возникновения исключения <xref:System.NullReferenceException> код должен обращаться к членам класса <xref:System.Array> , таким как <xref:System.Array.Length%2A> или <xref:System.Array.Rank%2A>, или вызывать функцию [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] , такую как <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span><span class="sxs-lookup"><span data-stu-id="bbea7-240">Without risking a <xref:System.NullReferenceException> exception, your code must access members of the <xref:System.Array> class, such as <xref:System.Array.Length%2A> or <xref:System.Array.Rank%2A>, or call a [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] function such as <xref:Microsoft.VisualBasic.Information.UBound%2A>.</span></span>  
  
-   <span data-ttu-id="bbea7-241">Нужно сделать соответствующий код проще, не выполняя проверку на значение `Nothing` как особый случай.</span><span class="sxs-lookup"><span data-stu-id="bbea7-241">You want to keep the consuming code simpler by not having to check for `Nothing` as a special case.</span></span>  
  
-   <span data-ttu-id="bbea7-242">Код взаимодействует с интерфейсом API, который требует передачи массива нулевой длины в одну или несколько процедур или возвращает массив нулевой длины из одной или нескольких процедур.</span><span class="sxs-lookup"><span data-stu-id="bbea7-242">Your code interacts with an application programming interface (API) that either requires you to pass a zero-length array to one or more procedures or returns a zero-length array from one or more procedures.</span></span>  
  
##  <span data-ttu-id="bbea7-243"><a name="BKMK_ArraySize"></a> Размер массива</span><span class="sxs-lookup"><span data-stu-id="bbea7-243"><a name="BKMK_ArraySize"></a> Array Size</span></span>  
 <span data-ttu-id="bbea7-244">Размер массива является произведением длин всех его измерений.</span><span class="sxs-lookup"><span data-stu-id="bbea7-244">The size of an array is the product of the lengths of all its dimensions.</span></span> <span data-ttu-id="bbea7-245">Он представляет собой общее число элементов, в данный момент содержащихся в массиве.</span><span class="sxs-lookup"><span data-stu-id="bbea7-245">It represents the total number of elements currently contained in the array.</span></span>  
  
 <span data-ttu-id="bbea7-246">В приведенном ниже примере показано объявление трехмерного массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-246">The following example declares a three-dimensional array.</span></span>  
  
```vb
Dim prices(3, 4, 5) As Long  
```  
  
 <span data-ttu-id="bbea7-247">Общий размер массива в переменной `prices` составляет (3 + 1) x (4 + 1) x (5 + 1) = 120.</span><span class="sxs-lookup"><span data-stu-id="bbea7-247">The overall size of the array in variable `prices` is (3 + 1) x (4 + 1) x (5 + 1) = 120.</span></span>  
  
 <span data-ttu-id="bbea7-248">Размер массива можно определить с помощью свойства <xref:System.Array.Length%2A>.</span><span class="sxs-lookup"><span data-stu-id="bbea7-248">You can find the size of an array by using the <xref:System.Array.Length%2A> property.</span></span> <span data-ttu-id="bbea7-249">Длину каждого измерения многомерного массива можно получить с помощью метода <xref:System.Array.GetLength%2A> .</span><span class="sxs-lookup"><span data-stu-id="bbea7-249">You can find the length of each dimension of a multi-dimensional array by using the <xref:System.Array.GetLength%2A> method.</span></span>  
  
 <span data-ttu-id="bbea7-250">Вы можете изменять размер переменной массива, присваивая ей новый объект массива или используя оператор `ReDim` .</span><span class="sxs-lookup"><span data-stu-id="bbea7-250">You can resize an array variable by assigning a new array object to it or by using the `ReDim` statement.</span></span>  
  
 <span data-ttu-id="bbea7-251">Существует ряд особенностей, о которых следует помнить при работе с размером массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-251">There are several things to keep in mind when dealing with the size of an array.</span></span>  
  
|||  
|---|---|  
|<span data-ttu-id="bbea7-252">Длина измерения</span><span class="sxs-lookup"><span data-stu-id="bbea7-252">Dimension Length</span></span>|<span data-ttu-id="bbea7-253">Индекс каждого измерения начинается с 0, что означает, что его диапазон от 0 до верхней границы.</span><span class="sxs-lookup"><span data-stu-id="bbea7-253">The index of each dimension is 0-based, which means it ranges from 0 through its upper bound.</span></span> <span data-ttu-id="bbea7-254">Таким образом, длина данного измерения на 1 больше его объявленной верхней границы.</span><span class="sxs-lookup"><span data-stu-id="bbea7-254">Therefore, the length of a given dimension is greater by 1 than the declared upper bound for that dimension.</span></span>|  
|<span data-ttu-id="bbea7-255">Ограничения длины</span><span class="sxs-lookup"><span data-stu-id="bbea7-255">Length Limits</span></span>|<span data-ttu-id="bbea7-256">Длина каждого измерения массива ограничена максимальным значением типа данных `Integer`, которое составляет (2 ^ 31) - 1.</span><span class="sxs-lookup"><span data-stu-id="bbea7-256">The length of every dimension of an array is limited to the maximum value of the `Integer` data type, which is (2 ^ 31) - 1.</span></span> <span data-ttu-id="bbea7-257">Однако общий размер массива также ограничен доступной памятью в системе.</span><span class="sxs-lookup"><span data-stu-id="bbea7-257">However, the total size of an array is also limited by the memory available on your system.</span></span> <span data-ttu-id="bbea7-258">При попытке инициализировать массив, размер которого превышает объем доступной оперативной памяти, среда CLR создает исключение <xref:System.OutOfMemoryException> .</span><span class="sxs-lookup"><span data-stu-id="bbea7-258">If you attempt to initialize an array that exceeds the amount of available RAM, the common language runtime throws an <xref:System.OutOfMemoryException> exception.</span></span>|  
|<span data-ttu-id="bbea7-259">Размер и размер элемента</span><span class="sxs-lookup"><span data-stu-id="bbea7-259">Size and Element Size</span></span>|<span data-ttu-id="bbea7-260">Размер массива не зависит от типа его элементов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-260">An array's size is independent of the data type of its elements.</span></span> <span data-ttu-id="bbea7-261">Размер всегда представляет общее число элементов, а не число байтов, занимаемое массивом при хранении.</span><span class="sxs-lookup"><span data-stu-id="bbea7-261">The size always represents the total number of elements, not the number of bytes that they consume in storage.</span></span>|  
|<span data-ttu-id="bbea7-262">Затраты памяти</span><span class="sxs-lookup"><span data-stu-id="bbea7-262">Memory Consumption</span></span>|<span data-ttu-id="bbea7-263">Небезопасно делать какие-либо предположения относительно способа хранения массива в памяти.</span><span class="sxs-lookup"><span data-stu-id="bbea7-263">It is not safe to make any assumptions regarding how an array is stored in memory.</span></span> <span data-ttu-id="bbea7-264">Хранение зависит от разрядности платформы, поэтому один и тот же массив может занимать больше памяти в 64-разрядных системах, чем в 32-разрядных.</span><span class="sxs-lookup"><span data-stu-id="bbea7-264">Storage varies on platforms of different data widths, so the same array can consume more memory on a 64-bit system than on a 32-bit system.</span></span> <span data-ttu-id="bbea7-265">В зависимости от конфигурации системы при инициализации массива среда CLR может использовать такие способы хранения, как упаковка элементов максимально близко друг к другу или выравнивание всех элементов по естественным аппаратным границам памяти.</span><span class="sxs-lookup"><span data-stu-id="bbea7-265">Depending on system configuration when you initialize an array, the common language runtime (CLR) can assign storage either to pack elements as close together as possible, or to align them all on natural hardware boundaries.</span></span> <span data-ttu-id="bbea7-266">Кроме того, массив нуждается в хранении служебной информации, и размер этой информации возрастает при добавлении каждого измерения.</span><span class="sxs-lookup"><span data-stu-id="bbea7-266">Also, an array requires a storage overhead for its control information, and this overhead increases with each added dimension.</span></span>|  
  
##  <span data-ttu-id="bbea7-267"><a name="BKMK_ArrayTypes"></a> Типы массивов и другие типы</span><span class="sxs-lookup"><span data-stu-id="bbea7-267"><a name="BKMK_ArrayTypes"></a> Array Types and Other Types</span></span>  
 <span data-ttu-id="bbea7-268">Каждый массив имеет тип данных, но этот тип отличается от типа данных его элементов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-268">Every array has a data type, but it differs from the data type of its elements.</span></span> <span data-ttu-id="bbea7-269">Не существует единого типа данных, подходящего для всех массивов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-269">There is no single data type for all arrays.</span></span> <span data-ttu-id="bbea7-270">Вместо этого тип данных массива определяется числом измерений ( *рангом*) массива и типом данных его элементов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-270">Instead, the data type of an array is determined by the number of dimensions, or *rank*, of the array, and the data type of the elements in the array.</span></span> <span data-ttu-id="bbea7-271">Две переменные массивов имеют один тип, только если массивы одного ранга и содержат данные одного и того же типа.</span><span class="sxs-lookup"><span data-stu-id="bbea7-271">Two array variables are considered to be of the same data type only when they have the same rank and their elements have the same data type.</span></span> <span data-ttu-id="bbea7-272">Длины измерений массива не влияют на его тип данных.</span><span class="sxs-lookup"><span data-stu-id="bbea7-272">The lengths of the dimensions in an array do not influence the array data type.</span></span>  
  
 <span data-ttu-id="bbea7-273">Каждый массив наследуется от класса <xref:System.Array?displayProperty=fullName>, и вы можете объявить переменную типа `Array`, но не можете создать массив типа `Array`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-273">Every array inherits from the <xref:System.Array?displayProperty=fullName> class, and you can declare a variable to be of type `Array`, but you cannot create an array of type `Array`.</span></span> <span data-ttu-id="bbea7-274">Кроме того, [оператор ReDim`Array` не может работать с переменной, объявленной с типом ](../../../../visual-basic/language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-274">Also, the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md) cannot operate on a variable declared as type `Array`.</span></span> <span data-ttu-id="bbea7-275">По этой причине и в целях строгой типизации рекомендуется объявлять каждый массив как конкретный тип, например `Integer` , как в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="bbea7-275">For these reasons, and for type safety, it is advisable to declare every array as a specific type, such as `Integer` in the preceding example.</span></span>  
  
 <span data-ttu-id="bbea7-276">Выяснить тип данных массива или его элементов можно несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="bbea7-276">You can find out the data type of either an array or its elements in several ways.</span></span>  
  
-   <span data-ttu-id="bbea7-277">Можно вызвать метод <xref:System.Object.GetType%2A?displayProperty=fullName> для переменной, чтобы получить объект <xref:System.Type> типа переменной времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="bbea7-277">You can call the <xref:System.Object.GetType%2A?displayProperty=fullName> method on the variable to receive a <xref:System.Type> object for the run-time type of the variable.</span></span> <span data-ttu-id="bbea7-278">Объект <xref:System.Type> содержит подробные сведения в своих свойствах и методах.</span><span class="sxs-lookup"><span data-stu-id="bbea7-278">The <xref:System.Type> object holds extensive information in its properties and methods.</span></span>  
  
-   <span data-ttu-id="bbea7-279">Можно передать переменную в функцию <xref:Microsoft.VisualBasic.Information.TypeName%2A> , чтобы получить объект `String` , содержащий имя типа времени выполнения.</span><span class="sxs-lookup"><span data-stu-id="bbea7-279">You can pass the variable to the <xref:Microsoft.VisualBasic.Information.TypeName%2A> function to receive a `String` containing the name of run-time type.</span></span>  
  
-   <span data-ttu-id="bbea7-280">Можно передать переменную в функцию <xref:Microsoft.VisualBasic.Information.VarType%2A> для получения значения `VariantType` , представляющего классификацию типа переменной.</span><span class="sxs-lookup"><span data-stu-id="bbea7-280">You can pass the variable to the <xref:Microsoft.VisualBasic.Information.VarType%2A> function to receive a `VariantType` value representing the type classification of the variable.</span></span>  
  
 <span data-ttu-id="bbea7-281">В приведенном ниже примере вызывается функция `TypeName` для определения типа массива и типа элементов в массиве.</span><span class="sxs-lookup"><span data-stu-id="bbea7-281">The following example calls the `TypeName` function to determine the type of the array and the type of the elements in the array.</span></span> <span data-ttu-id="bbea7-282">Массив имеет тип `Integer(,)` , а элементы массива относятся к типу `Integer`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-282">The array type is `Integer(,)` and the elements in the array are of type `Integer`.</span></span>  
  
 <span data-ttu-id="bbea7-283">[!code-vb[VbVbalrArrays#15](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#15)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-283">[!code-vb[VbVbalrArrays#15](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#15)]</span></span>  
  
##  <span data-ttu-id="bbea7-284"><a name="BKMK_Collections"></a> Коллекции как альтернатива массивам</span><span class="sxs-lookup"><span data-stu-id="bbea7-284"><a name="BKMK_Collections"></a> Collections as an Alternative to Arrays</span></span>  
 <span data-ttu-id="bbea7-285">Массивы удобнее всего использовать для создания фиксированного числа строго типизированных объектов и работы с ними.</span><span class="sxs-lookup"><span data-stu-id="bbea7-285">Arrays are most useful for creating and working with a fixed number of strongly typed objects.</span></span> <span data-ttu-id="bbea7-286">Коллекции предоставляют более гибкий способ работы с группами объектов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-286">Collections provide a more flexible way to work with groups of objects.</span></span> <span data-ttu-id="bbea7-287">В отличие от массивов, коллекция, с которой вы работаете, может расти или уменьшаться динамически при необходимости.</span><span class="sxs-lookup"><span data-stu-id="bbea7-287">Unlike arrays, the group of objects that you work with can grow and shrink dynamically as the needs of the application change.</span></span>  
  
 <span data-ttu-id="bbea7-288">Если нужно изменить размер массива, используйте [оператор ReDim](../../../../visual-basic/language-reference/statements/redim-statement.md).</span><span class="sxs-lookup"><span data-stu-id="bbea7-288">If you need to change the size of an array, you must use the [ReDim Statement](../../../../visual-basic/language-reference/statements/redim-statement.md).</span></span> <span data-ttu-id="bbea7-289">При этом [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] создает новый массив и освобождает предыдущий для уничтожения.</span><span class="sxs-lookup"><span data-stu-id="bbea7-289">When you do this, [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] creates a new array and releases the previous array for disposal.</span></span> <span data-ttu-id="bbea7-290">Это занимает время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bbea7-290">This takes execution time.</span></span> <span data-ttu-id="bbea7-291">Поэтому, если число элементов при работе изменяется часто или нельзя предсказать максимальное число необходимых элементов, при использовании коллекции можно получить большую производительность.</span><span class="sxs-lookup"><span data-stu-id="bbea7-291">Therefore, if the number of items you are working with changes frequently, or you cannot predict the maximum number of items you need, you might obtain better performance using a collection.</span></span>  
  
 <span data-ttu-id="bbea7-292">Некоторые коллекции допускают назначение ключа любому объекту, который добавляется в коллекцию, чтобы в дальнейшем можно было быстро извлечь связанный с ключом объект из коллекции.</span><span class="sxs-lookup"><span data-stu-id="bbea7-292">For some collections, you can assign a key to any object that you put into the collection so that you can quickly retrieve the object by using the key.</span></span>  
  
 <span data-ttu-id="bbea7-293">Если коллекция содержит элементы только одного типа данных, можно использовать один из классов в пространстве имен <xref:System.Collections.Generic?displayProperty=fullName> .</span><span class="sxs-lookup"><span data-stu-id="bbea7-293">If your collection contains elements of only one data type, you can use one of the classes in the <xref:System.Collections.Generic?displayProperty=fullName> namespace.</span></span> <span data-ttu-id="bbea7-294">Универсальная коллекция обеспечивает строгую типизацию, так что в нее нельзя добавить другие типы данных.</span><span class="sxs-lookup"><span data-stu-id="bbea7-294">A generic collection enforces type safety so that no other data type can be added to it.</span></span> <span data-ttu-id="bbea7-295">При извлечении элемента из универсальной коллекции не нужно определять или преобразовывать его тип данных.</span><span class="sxs-lookup"><span data-stu-id="bbea7-295">When you retrieve an element from a generic collection, you do not have to determine its data type or convert it.</span></span>  
  
 <span data-ttu-id="bbea7-296">Более подробную информацию о коллекциях см. в статье [Коллекции](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span><span class="sxs-lookup"><span data-stu-id="bbea7-296">For more information about collections, see [Collections](http://msdn.microsoft.com/library/e76533a9-5033-4a0b-b003-9c2be60d185b).</span></span>  
  
### <a name="example"></a><span data-ttu-id="bbea7-297">Пример</span><span class="sxs-lookup"><span data-stu-id="bbea7-297">Example</span></span>  
 <span data-ttu-id="bbea7-298">В приведенном ниже примере используется универсальный класс <xref:System.Collections.Generic.List%601?displayProperty=fullName> платформы [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] для создания коллекции-списка объектов `Customer`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-298">The following example uses the [!INCLUDE[dnprdnshort](~/includes/dnprdnshort-md.md)] generic class <xref:System.Collections.Generic.List%601?displayProperty=fullName> to create a list collection of `Customer` objects.</span></span>  
  
 <span data-ttu-id="bbea7-299">[!code-vb[VbVbalrArrays#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#1)]</span><span class="sxs-lookup"><span data-stu-id="bbea7-299">[!code-vb[VbVbalrArrays#1](../../../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrArrays/VB/Class1.vb#1)]</span></span>  
  
 <span data-ttu-id="bbea7-300">В объявлении коллекции `CustomerFile` указано, что она может содержать только элементы типа `Customer`.</span><span class="sxs-lookup"><span data-stu-id="bbea7-300">The declaration of the `CustomerFile` collection specifies that it can contain elements only of type `Customer`.</span></span> <span data-ttu-id="bbea7-301">Она также имеет исходную емкость 200 элементов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-301">It also provides for an initial capacity of 200 elements.</span></span> <span data-ttu-id="bbea7-302">Процедура `AddNewCustomer` проверяет новый элемент на допустимость и затем добавляет его к коллекции.</span><span class="sxs-lookup"><span data-stu-id="bbea7-302">The procedure `AddNewCustomer` checks the new element for validity and then adds it to the collection.</span></span> <span data-ttu-id="bbea7-303">Процедура `PrintCustomers` использует цикл `For Each` для перебора коллекции и отображения ее элементов.</span><span class="sxs-lookup"><span data-stu-id="bbea7-303">The procedure `PrintCustomers` uses a `For Each` loop to traverse the collection and display its elements.</span></span>  
  
## <a name="related-topics"></a><span data-ttu-id="bbea7-304">Связанные разделы</span><span class="sxs-lookup"><span data-stu-id="bbea7-304">Related Topics</span></span>  
  
|<span data-ttu-id="bbea7-305">Термин</span><span class="sxs-lookup"><span data-stu-id="bbea7-305">Term</span></span>|<span data-ttu-id="bbea7-306">Определение</span><span class="sxs-lookup"><span data-stu-id="bbea7-306">Definition</span></span>|  
|----------|----------------|  
|[<span data-ttu-id="bbea7-307">Array Dimensions in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="bbea7-307">Array Dimensions in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/array-dimensions.md)|<span data-ttu-id="bbea7-308">Объяснение ранга и измерений в массиве.</span><span class="sxs-lookup"><span data-stu-id="bbea7-308">Explains rank and dimensions in arrays.</span></span>|  
|<span data-ttu-id="bbea7-309">[How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md) (Практическое руководство. Инициализация переменной массива в Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="bbea7-309">[How to: Initialize an Array Variable in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-initialize-an-array-variable.md)</span></span>|<span data-ttu-id="bbea7-310">Описывается заполнение массивов начальными значениями.</span><span class="sxs-lookup"><span data-stu-id="bbea7-310">Describes how to populate arrays with initial values.</span></span>|  
|<span data-ttu-id="bbea7-311">[How to: Sort An Array in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-sort-an-array.md) (Практическое руководство. Сортировка массива в Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="bbea7-311">[How to: Sort An Array in Visual Basic](../../../../visual-basic/programming-guide/language-features/arrays/how-to-sort-an-array.md)</span></span>|<span data-ttu-id="bbea7-312">Показано, как сортировать элементы массива в алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="bbea7-312">Shows how to sort the elements of an array alphabetically.</span></span>|  
|[<span data-ttu-id="bbea7-313">Практическое руководство. Присвоение одного массива другому</span><span class="sxs-lookup"><span data-stu-id="bbea7-313">How to: Assign One Array to Another Array</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/how-to-assign-one-array-to-another-array.md)|<span data-ttu-id="bbea7-314">Описываются правила и действия для присвоения массива другой переменной массива.</span><span class="sxs-lookup"><span data-stu-id="bbea7-314">Describes the rules and steps for assigning an array to another array variable.</span></span>|  
|[<span data-ttu-id="bbea7-315">Устранение неполадок, связанных с массивами</span><span class="sxs-lookup"><span data-stu-id="bbea7-315">Troubleshooting Arrays</span></span>](../../../../visual-basic/programming-guide/language-features/arrays/troubleshooting-arrays.md)|<span data-ttu-id="bbea7-316">Рассматриваются некоторые общие проблемы, возникающие при работе с массивами.</span><span class="sxs-lookup"><span data-stu-id="bbea7-316">Discusses some common problems that arise when working with arrays.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="bbea7-317">См. также</span><span class="sxs-lookup"><span data-stu-id="bbea7-317">See Also</span></span>  
 <span data-ttu-id="bbea7-318"><xref:System.Array></span><span class="sxs-lookup"><span data-stu-id="bbea7-318"><xref:System.Array></span></span>   
 <span data-ttu-id="bbea7-319">[Оператор Dim](../../../../visual-basic/language-reference/statements/dim-statement.md) </span><span class="sxs-lookup"><span data-stu-id="bbea7-319">[Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md) </span></span>  
 [<span data-ttu-id="bbea7-320">Оператор reDim</span><span class="sxs-lookup"><span data-stu-id="bbea7-320">ReDim Statement</span></span>](../../../../visual-basic/language-reference/statements/redim-statement.md)

