---
title: "Синтаксис запросов и синтаксис методов в LINQ (C#)"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-csharp
ms.topic: article
dev_langs:
- CSharp
helpviewer_keywords:
- LINQ [C#], query syntax vs. method syntax
- queries [LINQ in C#], syntax comparisons
ms.assetid: eedd6dd9-fec2-428c-9581-5b8783810ded
caps.latest.revision: 30
author: BillWagner
ms.author: wiwagn
translation.priority.ht:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- ru-ru
- zh-cn
- zh-tw
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: 35ad7e9b086f36ca92974fdea197da4c513c8a51
ms.contentlocale: ru-ru
ms.lasthandoff: 07/28/2017

---
# <a name="query-syntax-and-method-syntax-in-linq-c"></a><span data-ttu-id="df191-102">Синтаксис запросов и синтаксис методов в LINQ (C#)</span><span class="sxs-lookup"><span data-stu-id="df191-102">Query Syntax and Method Syntax in LINQ (C#)</span></span>
<span data-ttu-id="df191-103">Большинство запросов в вводной документации к LINQ ([!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]) написано с использованием декларативного синтаксиса запросов LINQ.</span><span class="sxs-lookup"><span data-stu-id="df191-103">Most queries in the introductory Language Integrated Query ([!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)]) documentation are written by using the LINQ declarative query syntax.</span></span> <span data-ttu-id="df191-104">Однако синтаксис запроса должен быть преобразован в вызовы методов для среды CLR .NET, когда код компилируется.</span><span class="sxs-lookup"><span data-stu-id="df191-104">However, the query syntax must be translated into method calls for the .NET common language runtime (CLR) when the code is compiled.</span></span> <span data-ttu-id="df191-105">Эти вызовы метода вызывают стандартные операторы запросов, которые имеют такие имена, как `Where`, `Select`, `GroupBy`, `Join`, `Max` и `Average`.</span><span class="sxs-lookup"><span data-stu-id="df191-105">These method calls invoke the standard query operators, which have names such as `Where`, `Select`, `GroupBy`, `Join`, `Max`, and `Average`.</span></span> <span data-ttu-id="df191-106">Вместо синтаксиса запросов для их вызова можно использовать синтаксис методов.</span><span class="sxs-lookup"><span data-stu-id="df191-106">You can call them directly by using method syntax instead of query syntax.</span></span>  
  
 <span data-ttu-id="df191-107">Синтаксис запросов и синтаксис методов семантически идентичны, но многие пользователи найдут синтаксис запросов более простым и более удобным для чтения.</span><span class="sxs-lookup"><span data-stu-id="df191-107">Query syntax and method syntax are semantically identical, but many people find query syntax simpler and easier to read.</span></span> <span data-ttu-id="df191-108">Некоторые запросы должны быть выражены как вызовы методов.</span><span class="sxs-lookup"><span data-stu-id="df191-108">Some queries must be expressed as method calls.</span></span> <span data-ttu-id="df191-109">Например, необходимо использовать вызов метода для выражения запроса, который возвращает число элементов, соответствующих указанным критериям.</span><span class="sxs-lookup"><span data-stu-id="df191-109">For example, you must use a method call to express a query that retrieves the number of elements that match a specified condition.</span></span> <span data-ttu-id="df191-110">Вызов метода также необходимо использовать для запроса, который получает элемент с максимальным значением в исходной последовательности.</span><span class="sxs-lookup"><span data-stu-id="df191-110">You also must use a method call for a query that retrieves the element that has the maximum value in a source sequence.</span></span> <span data-ttu-id="df191-111">В справочной документации по стандартным операторам запросов в пространствах имен <xref:System.Linq> обычно применяется синтаксис методов.</span><span class="sxs-lookup"><span data-stu-id="df191-111">The reference documentation for the standard query operators in the <xref:System.Linq> namespace generally uses method syntax.</span></span> <span data-ttu-id="df191-112">В связи с этим даже на начальном этапе работы с запросами [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] полезно иметь представление о том, как использовать синтаксис методов в самих запросах и выражениях запросов.</span><span class="sxs-lookup"><span data-stu-id="df191-112">Therefore, even when getting started writing [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] queries, it is useful to be familiar with how to use method syntax in queries and in query expressions themselves.</span></span>  
  
## <a name="standard-query-operator-extension-methods"></a><span data-ttu-id="df191-113">Методы расширения стандартных операторов запросов</span><span class="sxs-lookup"><span data-stu-id="df191-113">Standard Query Operator Extension Methods</span></span>  
 <span data-ttu-id="df191-114">В следующем примере показано простое *выражение запроса* и семантически эквивалентный ему запрос, написанный как *запрос, основанный на методе*.</span><span class="sxs-lookup"><span data-stu-id="df191-114">The following example shows a simple *query expression* and the semantically equivalent query written as a *method-based query*.</span></span>  
  
 <span data-ttu-id="df191-115">[!code-cs[csLINQGettingStarted#22](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/query-syntax-and-method-syntax-in-linq_1.cs)]</span><span class="sxs-lookup"><span data-stu-id="df191-115">[!code-cs[csLINQGettingStarted#22](../../../../csharp/programming-guide/concepts/linq/codesnippet/CSharp/query-syntax-and-method-syntax-in-linq_1.cs)]</span></span>  
  
 <span data-ttu-id="df191-116">Оба примера дают одинаковый результат.</span><span class="sxs-lookup"><span data-stu-id="df191-116">The output from the two examples is identical.</span></span> <span data-ttu-id="df191-117">Видно, что тип переменной запроса в обеих формах одинаковый: <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="df191-117">You can see that the type of the query variable is the same in both forms: <xref:System.Collections.Generic.IEnumerable%601>.</span></span>  
  
 <span data-ttu-id="df191-118">Чтобы разобраться в запросе, основанном на методе, изучим его более подробно.</span><span class="sxs-lookup"><span data-stu-id="df191-118">To understand the method-based query, let's examine it more closely.</span></span> <span data-ttu-id="df191-119">Обратите внимание на то, что в правой части выражения предложение `where` теперь выражается как метод экземпляра в объекта `numbers`, который, как вы, наверное, помните, имеет тип `IEnumerable<int>`.</span><span class="sxs-lookup"><span data-stu-id="df191-119">On the right side of the expression, notice that the `where` clause is now expressed as an instance method on the `numbers` object, which as you will recall has a type of `IEnumerable<int>`.</span></span> <span data-ttu-id="df191-120">Если вы знакомы с универсальным интерфейсом <xref:System.Collections.Generic.IEnumerable%601>, то знаете, что в нем отсутствует метод `Where`.</span><span class="sxs-lookup"><span data-stu-id="df191-120">If you are familiar with the generic <xref:System.Collections.Generic.IEnumerable%601> interface, you know that it does not have a `Where` method.</span></span> <span data-ttu-id="df191-121">При этом, вызвав список завершения IntelliSense в Visual Studio IDE, вы увидите не только метод `Where`, но и многие другие методы, такие как `Select`, `SelectMany`, `Join` и `Orderby`.</span><span class="sxs-lookup"><span data-stu-id="df191-121">However, if you invoke the IntelliSense completion list in the Visual Studio IDE, you will see not only a `Where` method, but many other methods such as `Select`, `SelectMany`, `Join`, and `Orderby`.</span></span> <span data-ttu-id="df191-122">Все это — стандартные операторы запросов.</span><span class="sxs-lookup"><span data-stu-id="df191-122">These are all the standard query operators.</span></span>  
  
 <span data-ttu-id="df191-123">![Стандартные операторы запросов в Intellisense](../../../../csharp/programming-guide/concepts/linq/media/standardqueryops.png "StandardQueryOps")</span><span class="sxs-lookup"><span data-stu-id="df191-123">![Standard Query Operators in Intellisense](../../../../csharp/programming-guide/concepts/linq/media/standardqueryops.png "StandardQueryOps")</span></span>  
  
 <span data-ttu-id="df191-124">Может показаться, что класс <xref:System.Collections.Generic.IEnumerable%601> был переопределен и включает дополнительные методы, однако это не так.</span><span class="sxs-lookup"><span data-stu-id="df191-124">Although it looks as if <xref:System.Collections.Generic.IEnumerable%601> has been redefined to include these additional methods, in fact this is not the case.</span></span> <span data-ttu-id="df191-125">Стандартные операторы запросов реализуются как новый тип метода, который называется *методы расширения*.</span><span class="sxs-lookup"><span data-stu-id="df191-125">The standard query operators are implemented as a new kind of method called *extension methods*.</span></span> <span data-ttu-id="df191-126">Эти методы "расширяют" существующий тип и могут вызываться так, как если бы они являлись методами экземпляра для этого типа.</span><span class="sxs-lookup"><span data-stu-id="df191-126">Extensions methods "extend" an existing type; they can be called as if they were instance methods on the type.</span></span> <span data-ttu-id="df191-127">Стандартные операторы запроса расширяют <xref:System.Collections.Generic.IEnumerable%601>, и поэтому вы можете написать `numbers.Where(...)`.</span><span class="sxs-lookup"><span data-stu-id="df191-127">The standard query operators extend <xref:System.Collections.Generic.IEnumerable%601> and that is why you can write `numbers.Where(...)`.</span></span>  
  
 <span data-ttu-id="df191-128">Чтобы приступить к использованию [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], о методах расширения достаточно знать только то, как ввести их в область действия в приложении, используя директивы `using`.</span><span class="sxs-lookup"><span data-stu-id="df191-128">To get started using [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], all that you really have to know about extension methods is how to bring them into scope in your application by using the correct `using` directives.</span></span> <span data-ttu-id="df191-129">С точки зрения приложения метод расширения и обычные методы экземпляров одинаковы.</span><span class="sxs-lookup"><span data-stu-id="df191-129">From your application's point of view, an extension method and a regular instance method are the same.</span></span>  
  
 <span data-ttu-id="df191-130">Дополнительные сведения о методах расширения см. в разделе [Методы расширения](../../../../csharp/programming-guide/classes-and-structs/extension-methods.md).</span><span class="sxs-lookup"><span data-stu-id="df191-130">For more information about extension methods, see [Extension Methods](../../../../csharp/programming-guide/classes-and-structs/extension-methods.md).</span></span> <span data-ttu-id="df191-131">Дополнительные сведения о стандартных операторах запросов см. в разделе [Общие сведения о стандартных операторах запроса (C#)](../../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="df191-131">For more information about standard query operators, see [Standard Query Operators Overview (C#)](../../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).</span></span> <span data-ttu-id="df191-132">Некоторые поставщики [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], такие как [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] и [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], помимо <xref:System.Collections.Generic.IEnumerable%601> реализуют собственные стандартные операторы запросов и дополнительные методы расширения для других типов.</span><span class="sxs-lookup"><span data-stu-id="df191-132">Some [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] providers, such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] and [!INCLUDE[sqltecxlinq](~/includes/sqltecxlinq-md.md)], implement their own standard query operators and additional extension methods for other types besides <xref:System.Collections.Generic.IEnumerable%601>.</span></span>  
  
## <a name="lambda-expressions"></a><span data-ttu-id="df191-133">Лямбда-выражения</span><span class="sxs-lookup"><span data-stu-id="df191-133">Lambda Expressions</span></span>  
 <span data-ttu-id="df191-134">В предыдущем примере обратите внимание на то, что условное выражение (`num % 2 == 0`) передается в метод `Where` как встроенный аргумент: `Where(num => num % 2 == 0).`. Это встроенное выражение называется лямбда-выражением.</span><span class="sxs-lookup"><span data-stu-id="df191-134">In the previous example, notice that the conditional expression (`num % 2 == 0`) is passed as an in-line argument to the `Where` method: `Where(num => num % 2 == 0).` This inline expression is called a lambda expression.</span></span> <span data-ttu-id="df191-135">Это удобный способ написания кода, который иначе пришлось бы записывать более громоздко: как анонимный метод, универсальный метод-делегат или дерево выражения.</span><span class="sxs-lookup"><span data-stu-id="df191-135">It is a convenient way to write code that would otherwise have to be written in more cumbersome form as an anonymous method or a generic delegate or an expression tree.</span></span> <span data-ttu-id="df191-136">В C# `=>` представляет собой лямбда-оператор, который читается как "переходит в".</span><span class="sxs-lookup"><span data-stu-id="df191-136">In C# `=>` is the lambda operator, which is read as "goes to".</span></span> <span data-ttu-id="df191-137">`num` слева от оператора — входная переменная, которая соответствует переменной `num` в выражении запроса.</span><span class="sxs-lookup"><span data-stu-id="df191-137">The `num` on the left of the operator is the input variable which corresponds to `num` in the query expression.</span></span> <span data-ttu-id="df191-138">Компилятор может вывести тип `num`, поскольку известно, что `numbers` является универсальным типом <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="df191-138">The compiler can infer the type of `num` because it knows that `numbers` is a generic <xref:System.Collections.Generic.IEnumerable%601> type.</span></span> <span data-ttu-id="df191-139">Тело лямбда-выражения — точно такое же, как выражение в синтаксисе запроса или в любом другом выражении или операторе C#, и может включать вызовы метода и другие сложные логические выражения.</span><span class="sxs-lookup"><span data-stu-id="df191-139">The body of the lambda is just the same as the expression in query syntax or in any other C# expression or statement; it can include method calls and other complex logic.</span></span> <span data-ttu-id="df191-140">"Возвращаемое значение" — результат выражения.</span><span class="sxs-lookup"><span data-stu-id="df191-140">The "return value" is just the expression result.</span></span>  
  
 <span data-ttu-id="df191-141">Чтобы приступить к использованию [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], активно использовать лямбда-выражения необязательно.</span><span class="sxs-lookup"><span data-stu-id="df191-141">To get started using [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], you do not have to use lambdas extensively.</span></span> <span data-ttu-id="df191-142">При этом одни запросы могут быть выражены с помощью синтаксиса запроса, в то время как другие требуют лямбда-выражений.</span><span class="sxs-lookup"><span data-stu-id="df191-142">However, certain queries can only be expressed in method syntax and some of those require lambda expressions.</span></span> <span data-ttu-id="df191-143">После знакомства с лямбда-выражениями станет понятно, что они являются мощными и гибкими элементами в арсенале элементов [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)].</span><span class="sxs-lookup"><span data-stu-id="df191-143">After you become more familiar with lambdas, you will find that they are a powerful and flexible tool in your [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] toolbox.</span></span> <span data-ttu-id="df191-144">Дополнительные сведения см. в разделе [Лямбда-выражения](../../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="df191-144">For more information, see [Lambda Expressions](../../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md).</span></span>  
  
## <a name="composability-of-queries"></a><span data-ttu-id="df191-145">Совместимость запросов</span><span class="sxs-lookup"><span data-stu-id="df191-145">Composability of Queries</span></span>  
 <span data-ttu-id="df191-146">Обратите внимание на то, что в представленном выше примере кода метод `OrderBy` вызывается с помощью оператора точки при вызове `Where`.</span><span class="sxs-lookup"><span data-stu-id="df191-146">In the previous code example, note that the `OrderBy` method is invoked by using the dot operator on the call to `Where`.</span></span> <span data-ttu-id="df191-147">`Where` создает отфильтрованную последовательность, а затем `Orderby` ее сортирует.</span><span class="sxs-lookup"><span data-stu-id="df191-147">`Where` produces a filtered sequence, and then `Orderby` operates on that sequence by sorting it.</span></span> <span data-ttu-id="df191-148">Поскольку запросы возвращают `IEnumerable`, объедините их в синтаксис метода, собрав вызовы методов в цепочку.</span><span class="sxs-lookup"><span data-stu-id="df191-148">Because queries return an `IEnumerable`, you compose them in method syntax by chaining the method calls together.</span></span> <span data-ttu-id="df191-149">Компилятор выполняет это действие в фоновом режиме, когда вы пишете запросы, используя синтаксис запросов.</span><span class="sxs-lookup"><span data-stu-id="df191-149">This is what the compiler does behind the scenes when you write queries by using query syntax.</span></span> <span data-ttu-id="df191-150">А поскольку в переменной запроса результаты запроса не сохраняются, его можно в любое время изменить или использовать как базу для нового запроса даже после выполнения.</span><span class="sxs-lookup"><span data-stu-id="df191-150">And because a query variable does not store the results of the query, you can modify it or use it as the basis for a new query at any time, even after it has been executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="df191-151">См. также</span><span class="sxs-lookup"><span data-stu-id="df191-151">See Also</span></span>  
 [<span data-ttu-id="df191-152">Приступая к работе с LINQ в C#</span><span class="sxs-lookup"><span data-stu-id="df191-152">Getting Started with LINQ in C#</span></span>](../../../../csharp/programming-guide/concepts/linq/getting-started-with-linq.md)

