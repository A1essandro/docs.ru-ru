---
title: Руководство по программированию на C#. Преимущества универсальных шаблонов
ms.custom: seodec18
ms.date: 07/20/2015
helpviewer_keywords:
- generics [C#], benefits
ms.assetid: 80f037cd-9ea7-48be-bfc1-219bfb2d4277
ms.openlocfilehash: f97d3ce7a67638719d02c31879c00679405118bc
ms.sourcegitcommit: bdd930b5df20a45c29483d905526a2a3e4d17c5b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/11/2018
ms.locfileid: "53245016"
---
# <a name="benefits-of-generics-c-programming-guide"></a>Преимущества универсальных шаблонов (Руководство по программированию на C#)
Универсальные шаблоны позволяют обойти ограничение, существовавшее в более ранних версиях общеязыковой среды выполнения (CLR) и языка C#, из-за которого обобщение реализовывалось путем приведения типов к универсальному базовому типу <xref:System.Object> или из него. Создавая универсальный класс, вы можете создать коллекцию, которая будет типобезопасной во время компиляции.  
  
 Ограничение на использование классов коллекции, не являющихся универсальными, можно продемонстрировать на примере небольшой программы, в которой используется класс коллекции <xref:System.Collections.ArrayList> из библиотеки классов платформы .NET. В экземпляре класса <xref:System.Collections.ArrayList> можно хранить любой тип ссылок или значений.  
  
 [!code-csharp[csProgGuideGenerics#4](../../../csharp/programming-guide/generics/codesnippet/CSharp/benefits-of-generics_1.cs)]  
  
 Тем не менее его применение имеет свои недостатки. Любые типы значений или ссылочные типы, которые добавляются в <xref:System.Collections.ArrayList>, неявно приводятся с повышением к типу <xref:System.Object>. Если элементы представляют собой типы значений, их необходимо упаковывать при добавлении в список и распаковывать при извлечении из него. Выполнение операций приведения, упаковки-преобразования и распаковки-преобразования отрицательно сказывается на производительности, причем последние две операции при работе с большими коллекциями могут приводить к ее заметному снижению.  
  
 Еще одно ограничение связано с отсутствием проверки типов во время компиляции. Поскольку <xref:System.Collections.ArrayList> приводит все элементы к типу <xref:System.Object>, во время компиляции невозможно предотвратить выполнение действий, схожих с приведенными ниже, из клиентского кода:  
  
 [!code-csharp[csProgGuideGenerics#5](../../../csharp/programming-guide/generics/codesnippet/CSharp/benefits-of-generics_2.cs)]  
  
 Несмотря на то, что объединение строк `ints` в единый объект <xref:System.Collections.ArrayList> полностью приемлемо, а при создании разнородной коллекции нередко выполняется намеренно, в большинстве случаев это повлечет за собой ошибку программирования, которая может быть выявлена только во время выполнения.  
  
 В версиях 1.0 и 1.1 языка C# исключить опасность, связанную с использованием обобщенного кода классов коллекций из библиотеки базовых классов платформы .NET Framework, можно было только путем написания собственных коллекций нужного типа. Естественно, из-за невозможности использовать такой класс для работы с несколькими типами данных утрачивались преимущества обобщения, поскольку в этом случае требовалось создавать отдельный класс для каждого хранящегося типа.  
  
 Для <xref:System.Collections.ArrayList> и схожих с ним классов было необходимо, чтобы в клиентском коде для каждого экземпляра задавался конкретный тип данных, который будет использоваться. Это помогло бы исключить необходимость в приведении с повышением к типу <xref:System.Object> и позволило бы обеспечить проверку типов компилятором. Другими словами, для <xref:System.Collections.ArrayList> требуется параметр типа. Именно с этой целью были реализованы универсальные шаблоны. В универсальной коллекции <xref:System.Collections.Generic.List%601> в пространстве имен <xref:System.Collections.Generic> та же операция добавления элементов в коллекцию выглядит следующим образом:  
  
 [!code-csharp[csProgGuideGenerics#6](../../../csharp/programming-guide/generics/codesnippet/CSharp/benefits-of-generics_3.cs)]  
  
 В клиентском коде в <xref:System.Collections.Generic.List%601> по сравнению с <xref:System.Collections.ArrayList> добавлен только аргумент типа для объявления и создания экземпляра. После этого незначительного усложнения кода стало возможным создание списка, который не только безопаснее <xref:System.Collections.ArrayList>, но и обрабатывается значительно быстрее его, особенно если его элементы представляют собой типы значений.  
  
## <a name="see-also"></a>См. также

- <xref:System.Collections.Generic>  
- [Руководство по программированию на C#](../../../csharp/programming-guide/index.md)  
- [Введение в универсальные шаблоны](../../../csharp/programming-guide/generics/introduction-to-generics.md)  
- [Упаковка-преобразование и распаковка-преобразование](../../../csharp/programming-guide/types/boxing-and-unboxing.md)  
- [Когда следует использовать универсальные коллекции](../../../standard/collections/when-to-use-generic-collections.md)  
- [Рекомендации по использованию коллекций](../../../standard/design-guidelines/guidelines-for-collections.md)   
