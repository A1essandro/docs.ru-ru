---
title: "Создание и генерация исключений (Руководство по программированию C#) | Microsoft Docs"
ms.date: "2015-07-20"
ms.prod: ".net"
ms.technology: 
  - "devlang-csharp"
ms.topic: "article"
dev_langs: 
  - "CSharp"
helpviewer_keywords: 
  - "перехват исключений [C#]"
  - "исключения [C#], создание"
  - "исключения [C#], создание"
  - "создание исключений [C#]"
ms.assetid: 6bbba495-a115-4c6d-90cc-1f4d7b5f39e2
caps.latest.revision: 28
author: "BillWagner"
ms.author: "wiwagn"
caps.handback.revision: 28
---
# Создание и генерация исключений (Руководство по программированию C#)
Исключения позволяют обозначить, что во время выполнения программы произошла ошибка.  Объекты исключений, описывающие ошибку, создаются и затем *генерируются* с ключевым словом [throw](../../../csharp/language-reference/keywords/throw.md).  Далее во время выполнения происходит поиск наиболее совместимого обработчика исключений.  
  
 Программисты должны генерировать исключения при выполнении одного или нескольких из следующих условий:  
  
-   Метод не способен выполнить свои определенные функции.  
  
     Например, если значение параметры метода является недопустимым:  
  
     [!code-cs[csProgGuideExceptions#12](../../../csharp/programming-guide/exceptions/codesnippet/csharp/creating-and-throwing-ex_1.cs)]  
  
-   На основе состояния объекта выполнен неправильный вызов объекта.  
  
     В качестве примера можно привести попытку записи в файл, доступный только для чтения.  В случаях, когда состояние объекта не допускает выполнения операции, генерируется экземпляр <xref:System.InvalidOperationException> или объекта на основе наследования этого класса.  Далее показан пример метода, генерирующий объект <xref:System.InvalidOperationException>:  
  
     [!code-cs[csProgGuideExceptions#13](../../../csharp/programming-guide/exceptions/codesnippet/csharp/creating-and-throwing-ex_2.cs)]  
  
-   Когда исключение вызывает аргумент метода.  
  
     В этом случае, должно быть перехвачено исходное исключение и создан экземпляр <xref:System.ArgumentException>.  Исходное исключение должно быть передано конструктору <xref:System.ArgumentException> в качестве параметра <xref:System.Exception.InnerException%2A>:  
  
     [!code-cs[csProgGuideExceptions#14](../../../csharp/programming-guide/exceptions/codesnippet/csharp/creating-and-throwing-ex_3.cs)]  
  
 Исключения содержат свойство с именем <xref:System.Exception.StackTrace%2A>.  Строка содержит имя методов в текущем стеке вызовов вместе с именем файла и номером строки, в которой было сгенерировано исключение для каждого метода.  Объект <xref:System.Exception.StackTrace%2A> создается автоматически средой CLR из точки оператора `throw`, так что исключения должны генерироваться из той точки, где должна начинаться трассировка стека.  
  
 Все исключения содержат свойство с именем <xref:System.Exception.Message%2A>.  Эта строка должно содержать сообщение с объяснением причин исключения.  Обратите внимание, что секретные сведения не следует помещать в текст сообщения.  Кроме <xref:System.Exception.Message%2A>, <xref:System.ArgumentException> содержит свойство с именем <xref:System.ArgumentException.ParamName%2A>, которому необходимо присвоить имя аргумента, вызвавшего генерацию исключения.  В случае с установщиком свойств, свойству <xref:System.ArgumentException.ParamName%2A> должно быть присвоено значение `value`.  
  
 Открытые и защищенные члены\-методы должны генерировать исключения каждый раз, когда не удается выполнить назначенные им функции.  Генерируемый класс исключения должен быть самым определенным доступным исключением, удовлетворяющим условиям ошибки.  Эти исключения должны документироваться в составе функций класса, а производные классы или обновления исходного класса должны сохранять то же поведение для обеспечения обратной совместимости.  
  
## Чего следует избегать при генерации исключений  
 Ниже приводятся рекомендации по тому, чего следует избегать при генерации исключений:  
  
-   Исключения не рекомендуется использовать для изменения потока программы в рамках обычного выполнения.  Исключения используются только для сообщения о состояниях ошибки и их обработки.  
  
-   Исключения не должны возвращаться в качестве возвращаемого значения или параметра вместо генерации.  
  
-   Не рекомендуется специально генерировать <xref:System.Exception?displayProperty=fullName>, <xref:System.SystemException?displayProperty=fullName>, <xref:System.NullReferenceException?displayProperty=fullName> или <xref:System.IndexOutOfRangeException?displayProperty=fullName> из собственного исходного кода.  
  
-   Не рекомендуется создавать исключения, которые могут быть сгенерированы в режиме отладки, а не в режиме выпуска.  Чтобы определить ошибки времени выполнения на этапе разработки, используйте Debug Assert.  
  
## Определение классов исключений  
 Программы могут генерировать предопределенный класс исключений в пространстве имен <xref:System> \(если специально не обозначено иное\), или создавать собственные классы исключений путем наследования от <xref:System.Exception>.  Производные классы должны определять, по меньшей мере, четыре конструктора: один конструктор по умолчанию, один конструктор, задающий свойство сообщения, и еще один, задающий свойства <xref:System.Exception.Message%2A> и <xref:System.Exception.InnerException%2A>.  Четвертый конструктор служит для сериализации исключения.  Новые классы исключений должны быть сериализуемыми.  Примеры.  
  
 [!code-cs[csProgGuideExceptions#15](../../../csharp/programming-guide/exceptions/codesnippet/csharp/creating-and-throwing-ex_4.cs)]  
  
 Новые свойства следует добавлять к классу исключений только в том случае, если данные в них могут помочь в разрешении исключения.  При добавлении новых свойств в производный класс исключений, `ToString()` должно быть перезаписано для возврата добавленных сведений.  
  
## Спецификация языка C\#  
 [!INCLUDE[CSharplangspec](../../../csharp/language-reference/keywords/includes/csharplangspec-md.md)]  
  
## См. также  
 [Руководство по программированию на C\#](../../../csharp/programming-guide/index.md)   
 [Исключения и обработка исключений](../../../csharp/programming-guide/exceptions/exceptions-and-exception-handling.md)   
 [Иерархия исключений](../Topic/Exception%20Hierarchy.md)   
 [Обработка исключений](../../../csharp/programming-guide/exceptions/exception-handling.md)