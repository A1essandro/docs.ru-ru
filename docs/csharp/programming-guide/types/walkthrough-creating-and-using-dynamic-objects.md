---
title: "Пошаговое руководство. Создание и использование динамических объектов (C# и Visual Basic)"
ms.date: 2015-07-20
ms.prod: .net
ms.technology:
- devlang-csharp
ms.topic: article
dev_langs:
- CSharp
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
caps.latest.revision: 22
author: BillWagner
ms.author: wiwagn
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: HT
ms.sourcegitcommit: d74c1d0760d4e776c2cf4c7dea1dac060c85a83c
ms.openlocfilehash: 19701ede37845249cf4d50a34eb4ab487cdeb76b
ms.contentlocale: ru-ru
ms.lasthandoff: 09/05/2017

---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="49b9b-102">Пошаговое руководство. Создание и использование динамических объектов (C# и Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="49b9b-102">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>
<span data-ttu-id="49b9b-103">Динамические объекты предоставляют такие элементы, как свойства и методы, во время выполнения, а не во время компиляции.</span><span class="sxs-lookup"><span data-stu-id="49b9b-103">Dynamic objects expose members such as properties and methods at run time, instead of in at compile time.</span></span> <span data-ttu-id="49b9b-104">Это позволяет создавать объекты для работы со структурами, не соответствующими статическому типу или формату.</span><span class="sxs-lookup"><span data-stu-id="49b9b-104">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="49b9b-105">Например, можно использовать динамический объект для ссылки на модель DOM HTML, которая может содержать любую комбинацию допустимых элементов и атрибутов разметки HTML.</span><span class="sxs-lookup"><span data-stu-id="49b9b-105">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="49b9b-106">Поскольку каждый документ HTML является уникальным, элементы для конкретного документа HTML определяются во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="49b9b-106">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="49b9b-107">Наиболее распространенный способ ссылки на атрибут элемента HTML заключается в передаче имени этого атрибута в метод `GetProperty` элемента.</span><span class="sxs-lookup"><span data-stu-id="49b9b-107">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="49b9b-108">Для ссылки на атрибут `id` элемента HTML `<div id="Div1">` следует сначала получить ссылку на элемент `<div>`, а затем использовать `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-108">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="49b9b-109">При использовании динамического объекта можно сослаться на атрибут `id` в виде `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-109">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>  
  
 <span data-ttu-id="49b9b-110">Динамические объекты обеспечивают удобный доступ к динамическим языкам, таким как IronPython и IronRuby.</span><span class="sxs-lookup"><span data-stu-id="49b9b-110">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="49b9b-111">С помощью динамического объекта можно ссылаться на динамический скрипт, интерпретируемый во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="49b9b-111">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>  
  
 <span data-ttu-id="49b9b-112">Ссылка на динамический объект выполняется с помощью позднего связывания.</span><span class="sxs-lookup"><span data-stu-id="49b9b-112">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="49b9b-113">В C# тип объектов с поздним связыванием указывается как `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-113">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="49b9b-114">В [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] тип объектов с поздним связыванием указывается как `Object`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-114">In [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="49b9b-115">Дополнительные сведения см. в разделах [dynamic](../../../csharp/language-reference/keywords/dynamic.md) и [Раннее и позднее связывание](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="49b9b-115">For more information, see [dynamic](../../../csharp/language-reference/keywords/dynamic.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>  
  
 <span data-ttu-id="49b9b-116">Вы можете создавать настраиваемые динамические объекты, используя классы из пространства имен <xref:System.Dynamic?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="49b9b-116">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=fullName> namespace.</span></span> <span data-ttu-id="49b9b-117">Например, можно создать объект <xref:System.Dynamic.ExpandoObject> и задать члены этого объекта во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="49b9b-117">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="49b9b-118">Также можно создать собственный тип, наследующий класс <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="49b9b-118">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="49b9b-119">Затем для обеспечения динамических функциональных возможностей во время выполнения можно переопределить члены класса <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="49b9b-119">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>  
  
 <span data-ttu-id="49b9b-120">В данном пошаговом руководстве демонстрируется выполнение следующих задач:</span><span class="sxs-lookup"><span data-stu-id="49b9b-120">In this walkthrough you will perform the following tasks:</span></span>  
  
-   <span data-ttu-id="49b9b-121">Создание пользовательского объекта, который динамически предоставляет содержимое текстового файла в виде свойств объекта.</span><span class="sxs-lookup"><span data-stu-id="49b9b-121">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>  
  
-   <span data-ttu-id="49b9b-122">Создание проекта, использующего библиотеку `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-122">Create a project that uses an `IronPython` library.</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="49b9b-123">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="49b9b-123">Prerequisites</span></span>  
 <span data-ttu-id="49b9b-124">Для выполнения инструкций этого пошагового руководства потребуется установить IronPython 2.6.1 для .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="49b9b-124">You need IronPython 2.6.1 for .NET 4.0 to complete this walkthrough.</span></span> <span data-ttu-id="49b9b-125">IronPython 2.6.1 для .NET 4.0 можно скачать со страницы [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span><span class="sxs-lookup"><span data-stu-id="49b9b-125">You can download IronPython 2.6.1 for .NET 4.0 from [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span></span>  
  
[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]  
  
## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="49b9b-126">Создание пользовательского динамического объекта</span><span class="sxs-lookup"><span data-stu-id="49b9b-126">Creating a Custom Dynamic Object</span></span>  
 <span data-ttu-id="49b9b-127">В первом проекте, создаваемом в данном пошаговом руководстве, определяется пользовательский динамический объект, выполняющий поиск по содержимому текстового файла.</span><span class="sxs-lookup"><span data-stu-id="49b9b-127">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="49b9b-128">Текст для поиска задается именем динамического свойства.</span><span class="sxs-lookup"><span data-stu-id="49b9b-128">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="49b9b-129">Например, если в вызывающем коде указано `dynamicFile.Sample`, динамический класс возвращает общий список строк, содержащий все строки из файла, которые начинаются со слова "Sample".</span><span class="sxs-lookup"><span data-stu-id="49b9b-129">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="49b9b-130">При поиске не учитывается регистр.</span><span class="sxs-lookup"><span data-stu-id="49b9b-130">The search is case-insensitive.</span></span> <span data-ttu-id="49b9b-131">Динамический класс также поддерживает два дополнительных аргумента.</span><span class="sxs-lookup"><span data-stu-id="49b9b-131">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="49b9b-132">Первый аргумент — это значение перечисления параметра поиска, задающее, где динамический класс должен искать соответствия: в начале строки, в конце строки или в любом месте строки.</span><span class="sxs-lookup"><span data-stu-id="49b9b-132">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="49b9b-133">Второй аргумент задает, что динамический класс должен перед поиском отсекать начальные и конечные пробелы в каждой строке.</span><span class="sxs-lookup"><span data-stu-id="49b9b-133">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="49b9b-134">Например, если в вызывающем коде указано `dynamicFile.Sample(StringSearchOption.Contains)`, динамический класс выполняет поиск слова "Sample" в любом месте строки.</span><span class="sxs-lookup"><span data-stu-id="49b9b-134">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="49b9b-135">Если в вызывающем коде указано `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, динамический класс выполняет поиск слова "Sample" в начале каждой строки и не удаляет начальные и конечные пробелы в строках.</span><span class="sxs-lookup"><span data-stu-id="49b9b-135">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="49b9b-136">По умолчанию динамический класс выполняет поиск соответствия в начале каждой строки, предварительно удаляя начальные и конечные пробелы.</span><span class="sxs-lookup"><span data-stu-id="49b9b-136">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>  
  
#### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="49b9b-137">Создание пользовательского динамического класса</span><span class="sxs-lookup"><span data-stu-id="49b9b-137">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="49b9b-138">Запустите [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)].</span><span class="sxs-lookup"><span data-stu-id="49b9b-138">Start [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)].</span></span>  
  
2.  <span data-ttu-id="49b9b-139">В меню **Файл** выберите пункт **Создать** , а затем команду **Проект**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-139">On the **File** menu, point to **New** and then click **Project**.</span></span>  
  
3.  <span data-ttu-id="49b9b-140">Убедитесь, что в диалоговом окне **Создание проекта** в области **Типы проектов** выбран пункт **Windows**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-140">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="49b9b-141">В области **Шаблоны** выберите пункт **Консольное приложение**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-141">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="49b9b-142">В поле **Имя** введите `DynamicSample` и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-142">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="49b9b-143">Проект создан.</span><span class="sxs-lookup"><span data-stu-id="49b9b-143">The new project is created.</span></span>  
  
4.  <span data-ttu-id="49b9b-144">Щелкните правой кнопкой мыши проект DynamicSample, выберите пункт **Добавить**, а затем щелкните **Класс**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-144">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="49b9b-145">В поле **Имя** введите `ReadOnlyFile` и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-145">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="49b9b-146">Будет добавлен новый файл, содержащий класс ReadOnlyFile.</span><span class="sxs-lookup"><span data-stu-id="49b9b-146">A new file is added that contains the ReadOnlyFile class.</span></span>  
  
5.  <span data-ttu-id="49b9b-147">В верхней части файла ReadOnlyFile.cs или ReadOnlyFile.vb добавьте следующий код для импорта пространств имен <xref:System.IO?displayProperty=fullName> и <xref:System.Dynamic?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="49b9b-147">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=fullName> and <xref:System.Dynamic?displayProperty=fullName> namespaces.</span></span>  
  
     <span data-ttu-id="49b9b-148">[!code-cs[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_1.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-148">[!code-cs[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_1.cs)]</span></span>

     <span data-ttu-id="49b9b-149">[!code-vb[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-149">[!code-vb[VbDynamicWalkthrough#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_1.vb)]</span></span>  
  
6.  <span data-ttu-id="49b9b-150">Пользовательский динамический объект использует перечисление для определения условия поиска.</span><span class="sxs-lookup"><span data-stu-id="49b9b-150">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="49b9b-151">Перед оператором класса добавьте следующее определение перечисления.</span><span class="sxs-lookup"><span data-stu-id="49b9b-151">Before the class statement, add the following enum definition.</span></span>  
  
     <span data-ttu-id="49b9b-152">[!code-cs[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_2.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-152">[!code-cs[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_2.cs)]</span></span>

     <span data-ttu-id="49b9b-153">[!code-vb[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_2.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-153">[!code-vb[VbDynamicWalkthrough#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_2.vb)]</span></span>  
  
7.  <span data-ttu-id="49b9b-154">Обновите оператор класса, чтобы он наследовал класс `DynamicObject`, как показано в следующем примере кода.</span><span class="sxs-lookup"><span data-stu-id="49b9b-154">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>  
  
     <span data-ttu-id="49b9b-155">[!code-cs[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_3.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-155">[!code-cs[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_3.cs)]</span></span>

     <span data-ttu-id="49b9b-156">[!code-vb[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_3.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-156">[!code-vb[VbDynamicWalkthrough#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_3.vb)]</span></span>  
  
8.  <span data-ttu-id="49b9b-157">Добавьте в класс `ReadOnlyFile` следующий код, чтобы задать закрытое поле для пути к файлу и конструктор для класса `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-157">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>  
  
     <span data-ttu-id="49b9b-158">[!code-cs[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_4.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-158">[!code-cs[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_4.cs)]</span></span>
     
     <span data-ttu-id="49b9b-159">[!code-vb[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_4.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-159">[!code-vb[VbDynamicWalkthrough#4](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_4.vb)]</span></span>  
  
9. <span data-ttu-id="49b9b-160">Добавьте следующий метод `GetPropertyValue` в класс `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-160">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="49b9b-161">Метод `GetPropertyValue` принимает в качестве входных данных условие поиска и возвращает строки текстового файла, соответствующие этому условию.</span><span class="sxs-lookup"><span data-stu-id="49b9b-161">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="49b9b-162">Динамический метод, предоставленный классом `ReadOnlyFile`, вызывает метод `GetPropertyValue` для извлечения соответствующих результатов.</span><span class="sxs-lookup"><span data-stu-id="49b9b-162">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>  
  
     <span data-ttu-id="49b9b-163">[!code-cs[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_5.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-163">[!code-cs[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_5.cs)]</span></span>
     
     <span data-ttu-id="49b9b-164">[!code-vb[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_5.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-164">[!code-vb[VbDynamicWalkthrough#5](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_5.vb)]</span></span>  
  
10. <span data-ttu-id="49b9b-165">После метода `GetPropertyValue` добавьте следующий код, чтобы переопределить метод <xref:System.Dynamic.DynamicObject.TryGetMember%2A> класса <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="49b9b-165">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="49b9b-166">Метод <xref:System.Dynamic.DynamicObject.TryGetMember%2A> вызывается при запросе члена динамического класса без указания аргументов.</span><span class="sxs-lookup"><span data-stu-id="49b9b-166">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="49b9b-167">Аргумент `binder` содержит сведения об элементе, на который дается ссылка, а аргумент `result` ссылается на результат, возвращенный для указанного элемента.</span><span class="sxs-lookup"><span data-stu-id="49b9b-167">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="49b9b-168">Метод <xref:System.Dynamic.DynamicObject.TryGetMember%2A> возвращает логическое значение `true`, если запрошенный элемент существует. В противном случае возвращается `false`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-168">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
     <span data-ttu-id="49b9b-169">[!code-cs[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_6.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-169">[!code-cs[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_6.cs)]</span></span>
     
     <span data-ttu-id="49b9b-170">[!code-vb[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_6.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-170">[!code-vb[VbDynamicWalkthrough#6](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_6.vb)]</span></span>  
  
11. <span data-ttu-id="49b9b-171">После метода `TryGetMember` добавьте следующий код, чтобы переопределить метод <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> класса <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="49b9b-171">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="49b9b-172">Метод <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> вызывается при запросе члена динамического класса с аргументами.</span><span class="sxs-lookup"><span data-stu-id="49b9b-172">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="49b9b-173">Аргумент `binder` содержит сведения об элементе, на который дается ссылка, а аргумент `result` ссылается на результат, возвращенный для указанного элемента.</span><span class="sxs-lookup"><span data-stu-id="49b9b-173">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="49b9b-174">Аргумент `args` содержит массив аргументов, передаваемых в элемент.</span><span class="sxs-lookup"><span data-stu-id="49b9b-174">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="49b9b-175">Метод <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> возвращает логическое значение `true`, если запрошенный элемент существует. В противном случае возвращается `false`.</span><span class="sxs-lookup"><span data-stu-id="49b9b-175">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>  
  
     <span data-ttu-id="49b9b-176">Пользовательская версия метода `TryInvokeMember` ожидает, что первый аргумент будет значением из перечисления `StringSearchOption`, заданного на предыдущем шаге.</span><span class="sxs-lookup"><span data-stu-id="49b9b-176">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="49b9b-177">Метод `TryInvokeMember` ожидает, что второй аргумент будет логическим значением.</span><span class="sxs-lookup"><span data-stu-id="49b9b-177">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="49b9b-178">Если один или оба элемента имеют допустимые значения, они передаются в метод `GetPropertyValue` для получения результатов.</span><span class="sxs-lookup"><span data-stu-id="49b9b-178">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>  
  
     <span data-ttu-id="49b9b-179">[!code-cs[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_7.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-179">[!code-cs[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_7.cs)]</span></span>
     
     <span data-ttu-id="49b9b-180">[!code-vb[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_7.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-180">[!code-vb[VbDynamicWalkthrough#7](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_7.vb)]</span></span>  
  
12. <span data-ttu-id="49b9b-181">Сохраните и закройте файл.</span><span class="sxs-lookup"><span data-stu-id="49b9b-181">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="49b9b-182">Создание примера текстового файла</span><span class="sxs-lookup"><span data-stu-id="49b9b-182">To create a sample text file</span></span>  
  
1.  <span data-ttu-id="49b9b-183">Щелкните правой кнопкой мыши проект DynamicSample, выберите пункт **Добавить**, а затем щелкните **Новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-183">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="49b9b-184">На панели **Установленные шаблоны** выберите **Общие**, а затем шаблон **Текстовый файл**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-184">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="49b9b-185">В поле **Имя** оставьте имя по умолчанию TextFile1.txt и нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-185">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="49b9b-186">В проект добавится новый текстовый файл.</span><span class="sxs-lookup"><span data-stu-id="49b9b-186">A new text file is added to the project.</span></span>  
  
2.  <span data-ttu-id="49b9b-187">Скопируйте в файл TextFile1.txt следующий текст.</span><span class="sxs-lookup"><span data-stu-id="49b9b-187">Copy the following text to the TextFile1.txt file.</span></span>  
  
    ```  
    List of customers and suppliers  
  
    Supplier: Lucerne Publishing (http://www.lucernepublishing.com/)  
    Customer: Preston, Chris  
    Customer: Hines, Patrick  
    Customer: Cameron, Maria  
    Supplier: Graphic Design Institute (http://www.graphicdesigninstitute.com/)   
    Supplier: Fabrikam, Inc. (http://www.fabrikam.com/)   
    Customer: Seubert, Roxanne  
    Supplier: Proseware, Inc. (http://www.proseware.com/)   
    Customer: Adolphi, Stephan  
    Customer: Koch, Paul  
    ```  
  
3.  <span data-ttu-id="49b9b-188">Сохраните и закройте файл.</span><span class="sxs-lookup"><span data-stu-id="49b9b-188">Save and close the file.</span></span>  
  
#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="49b9b-189">Создание примера приложения, в котором применяется пользовательский динамический объект</span><span class="sxs-lookup"><span data-stu-id="49b9b-189">To create a sample application that uses the custom dynamic object</span></span>  
  
1.  <span data-ttu-id="49b9b-190">В **обозревателе решений** дважды щелкните файл Module1.vb, если используется [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], или файл Program.cs, если используется Visual C#.</span><span class="sxs-lookup"><span data-stu-id="49b9b-190">In **Solution Explorer**, double-click the Module1.vb file if you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)] or the Program.cs file if you are using Visual C#.</span></span>  
  
2.  <span data-ttu-id="49b9b-191">Добавьте следующий код в процедуру Main, чтобы создать экземпляр класса `ReadOnlyFile` для файла TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="49b9b-191">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="49b9b-192">В этом коде используется позднее связывание для вызова динамических элементов и извлечения строк текста, которые содержат строку "Customer".</span><span class="sxs-lookup"><span data-stu-id="49b9b-192">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>  
  
     <span data-ttu-id="49b9b-193">[!code-cs[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_8.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-193">[!code-cs[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_8.cs)]</span></span>
     
     <span data-ttu-id="49b9b-194">[!code-vb[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_8.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-194">[!code-vb[VbDynamicWalkthrough#8](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_8.vb)]</span></span>  
  
3.  <span data-ttu-id="49b9b-195">Сохраните файл и нажмите сочетание клавиш CTRL+F5 для сборки и запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="49b9b-195">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="49b9b-196">Вызов библиотеки динамического языка</span><span class="sxs-lookup"><span data-stu-id="49b9b-196">Calling a Dynamic Language Library</span></span>  
 <span data-ttu-id="49b9b-197">В следующем проекте, создаваемом в ходе данного пошагового руководства, осуществляется доступ к библиотеке, написанной на динамическом языке IronPython.</span><span class="sxs-lookup"><span data-stu-id="49b9b-197">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span> <span data-ttu-id="49b9b-198">Перед созданием этого проекта необходимо установить IronPython 2.6.1 для .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="49b9b-198">Before you create this project, you must have IronPython 2.6.1 for .NET 4.0 installed.</span></span> <span data-ttu-id="49b9b-199">IronPython 2.6.1 для .NET 4.0 можно скачать со страницы [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span><span class="sxs-lookup"><span data-stu-id="49b9b-199">You can download IronPython 2.6.1 for .NET 4.0 from [CodePlex](http://go.microsoft.com/fwlink/?LinkId=187223).</span></span>  
  
#### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="49b9b-200">Создание пользовательского динамического класса</span><span class="sxs-lookup"><span data-stu-id="49b9b-200">To create a custom dynamic class</span></span>  
  
1.  <span data-ttu-id="49b9b-201">В [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)] в меню **Файл** последовательно выберите пункты **Создать**, **Проект**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-201">In [!INCLUDE[vsprvs](~/includes/vsprvs-md.md)], on the **File** menu, point to **New** and then click **Project**.</span></span>  
  
2.  <span data-ttu-id="49b9b-202">Убедитесь, что в диалоговом окне **Создание проекта** в области **Типы проектов** выбран пункт **Windows**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-202">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="49b9b-203">В области **Шаблоны** выберите пункт **Консольное приложение**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-203">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="49b9b-204">В поле **Имя** введите `DynamicIronPythonSample` и нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-204">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="49b9b-205">Проект создан.</span><span class="sxs-lookup"><span data-stu-id="49b9b-205">The new project is created.</span></span>  
  
3.  <span data-ttu-id="49b9b-206">Если используется [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], щелкните правой кнопкой мыши проект DynamicIronPythonSample и выберите пункт **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-206">If you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="49b9b-207">Перейдите на вкладку **Ссылки**. Нажмите кнопку **Добавить**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-207">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="49b9b-208">Если используется Visual C#, в **обозревателе решений** щелкните правой кнопкой мыши папку **Ссылки** и выберите пункт **Добавить ссылку**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-208">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>  
  
4.  <span data-ttu-id="49b9b-209">На вкладке **Обзор** перейдите к папке, в которой установлены библиотеки IronPython.</span><span class="sxs-lookup"><span data-stu-id="49b9b-209">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="49b9b-210">Например, C:\Program Files\IronPython 2.6 for .NET 4.0.</span><span class="sxs-lookup"><span data-stu-id="49b9b-210">For example, C:\Program Files\IronPython 2.6 for .NET 4.0.</span></span> <span data-ttu-id="49b9b-211">Выберите библиотеки **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll** и **Microsoft.Dynamic.dll**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-211">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="49b9b-212">Нажмите кнопку **ОК**.</span><span class="sxs-lookup"><span data-stu-id="49b9b-212">Click **OK**.</span></span>  
  
5.  <span data-ttu-id="49b9b-213">Если используется [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], отредактируйте файл Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="49b9b-213">If you are using [!INCLUDE[vbprvb](~/includes/vbprvb-md.md)], edit the Module1.vb file.</span></span> <span data-ttu-id="49b9b-214">Если используется Visual C#, отредактируйте файл Program.cs.</span><span class="sxs-lookup"><span data-stu-id="49b9b-214">If you are using Visual C#, edit the Program.cs file.</span></span>  
  
6.  <span data-ttu-id="49b9b-215">В верхней части файла добавьте следующий код для импорта пространств имен `Microsoft.Scripting.Hosting` и `IronPython.Hosting` из библиотек IronPython.</span><span class="sxs-lookup"><span data-stu-id="49b9b-215">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>  
  
     <span data-ttu-id="49b9b-216">[!code-cs[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_9.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-216">[!code-cs[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_9.cs)]</span></span>
     
     <span data-ttu-id="49b9b-217">[!code-vb[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_9.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-217">[!code-vb[VbDynamicWalkthroughIronPython#1](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_9.vb)]</span></span>  
  
7.  <span data-ttu-id="49b9b-218">В методе Main добавьте следующий код, чтобы создать объект `Microsoft.Scripting.Hosting.ScriptRuntime`, в котором будут размещены библиотеки IronPython.</span><span class="sxs-lookup"><span data-stu-id="49b9b-218">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="49b9b-219">Объект `ScriptRuntime` загружает модуль библиотеки IronPython random.py.</span><span class="sxs-lookup"><span data-stu-id="49b9b-219">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>  
  
     <span data-ttu-id="49b9b-220">[!code-cs[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_10.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-220">[!code-cs[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_10.cs)]</span></span>
     
     <span data-ttu-id="49b9b-221">[!code-vb[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_10.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-221">[!code-vb[VbDynamicWalkthroughIronPython#2](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_10.vb)]</span></span>  
  
8.  <span data-ttu-id="49b9b-222">После указания в коде необходимости загрузки модуля random.py добавьте следующий код, чтобы создать массив целых чисел.</span><span class="sxs-lookup"><span data-stu-id="49b9b-222">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="49b9b-223">Массив передается методу `shuffle` модуля random.py, который произвольно сортирует значения в массиве.</span><span class="sxs-lookup"><span data-stu-id="49b9b-223">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>  
  
     <span data-ttu-id="49b9b-224">[!code-cs[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_11.cs)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-224">[!code-cs[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/CSharp/walkthrough-creating-and-using-dynamic-objects_11.cs)]</span></span>
     
     <span data-ttu-id="49b9b-225">[!code-vb[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_11.vb)]</span><span class="sxs-lookup"><span data-stu-id="49b9b-225">[!code-vb[VbDynamicWalkthroughIronPython#3](../../../csharp/programming-guide/types/codesnippet/VisualBasic/walkthrough-creating-and-using-dynamic-objects_11.vb)]</span></span>  
  
9. <span data-ttu-id="49b9b-226">Сохраните файл и нажмите сочетание клавиш CTRL+F5 для сборки и запуска приложения.</span><span class="sxs-lookup"><span data-stu-id="49b9b-226">Save the file and press CTRL+F5 to build and run the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="49b9b-227">См. также</span><span class="sxs-lookup"><span data-stu-id="49b9b-227">See Also</span></span>  
 <span data-ttu-id="49b9b-228"><xref:System.Dynamic?displayProperty=fullName></span><span class="sxs-lookup"><span data-stu-id="49b9b-228"><xref:System.Dynamic?displayProperty=fullName></span></span>   
 <span data-ttu-id="49b9b-229"><xref:System.Dynamic.DynamicObject?displayProperty=fullName></span><span class="sxs-lookup"><span data-stu-id="49b9b-229"><xref:System.Dynamic.DynamicObject?displayProperty=fullName></span></span>   
 <span data-ttu-id="49b9b-230">[Использование типа dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md) </span><span class="sxs-lookup"><span data-stu-id="49b9b-230">[Using Type dynamic](../../../csharp/programming-guide/types/using-type-dynamic.md) </span></span>  
 <span data-ttu-id="49b9b-231">[Раннее и позднее связывание](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md) </span><span class="sxs-lookup"><span data-stu-id="49b9b-231">[Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md) </span></span>  
 <span data-ttu-id="49b9b-232">[dynamic](../../../csharp/language-reference/keywords/dynamic.md) </span><span class="sxs-lookup"><span data-stu-id="49b9b-232">[dynamic](../../../csharp/language-reference/keywords/dynamic.md) </span></span>  
 [<span data-ttu-id="49b9b-233">Реализация динамических интерфейсов (внешний блог)</span><span class="sxs-lookup"><span data-stu-id="49b9b-233">Implementing Dynamic Interfaces (external blog)</span></span>](http://go.microsoft.com/fwlink/?LinkId=230895)

