---
title: "Интерполированные строки (C#)"
ms.date: 10/18/2017
ms.prod: .net
ms.technology: devlang-csharp
ms.topic: article
ms.assetid: 324f267e-1c61-431a-97ed-852c1530742d
caps.latest.revision: "9"
author: BillWagner
ms.author: wiwagn
ms.openlocfilehash: b8a1fe0be82a0e09d61c66ed463199ff626c9faa
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="interpolated-strings-c-reference"></a>Интерполированные строки (справочник по C#)

Используется для создания строк.  Интерполированное строковое выражение выглядит как строка шаблона, которая содержит *интерполированные выражения*.  Интерполированная строка возвращает строку, которая заменяет содержащиеся в ней интерполированные выражения строковыми представлениями. Эта функция доступна в C# 6 и более поздних версиях.

Аргументы интерполированной строки понять проще, чем [строку составного формата](../../../standard/base-types/composite-formatting.md#composite-format-string).  Например, интерполированная строка  
  
```csharp  
Console.WriteLine($"Name = {name}, hours = {hours:hh}");
```  
содержит два выражения интерполированные, «{name}» и «{час: hh}». Эквивалентная строка составного формата имеет следующий вид:

```csharp
Console.WriteLine("Name = {0}, hours = {1:hh}", name, hours); 
```  

Структура интерполированной строки выглядит следующим образом:  
  
```  
$"<text> {<interpolated-expression> [,<field-width>] [:<format-string>] } <text> ..."  
```  

где: 

- *field-width* — это целое число со знаком, указывающее количество символов в поле. Если оно является положительным, поле выравнивается по правому краю, если оно отрицательное — по левому краю. 

- *format-string* — это строка формата, соответствующая типу форматируемого объекта. Например, для значения <xref:System.DateTime> это может быть строка стандартного формата даты и времени, например "D" или "d".

> [!IMPORTANT]
> Не может иметь любой пробел между `$` и `"` , начинающегося в строке. Это приводит к ошибке времени компиляции.

 Интерполированную строку можно использовать везде, где допустимо применять строковый литерал.  Интерполированная строка вычисляется каждый раз, когда выполняется код с интерполированной строкой. Это позволяет разделить определение и вычисление интерполированной строки.  
  
 Чтобы включить в интерполированную строку фигурные скобки ("{" или "}"), используйте две фигурные скобки — "{{" или "}}".  Дополнительные сведения см в разделе «Неявные преобразования».  

Если интерполированная строка содержит другие символы со специальным значением в интерполированной строке, например, знак кавычки ("), двоеточие (:) или запятая (,), их необходимо экранировать, если они встречаются в обычном тексте, или они должны быть включены в выражение, разделенное круглыми скобками, если они являются языковыми элементами, включенными в интерполированное выражение. В следующем примере показано экранирование кавычек, чтобы включить их в результирующую строку, и использование скобок для разделения выражения `(age == 1 ? "" : "s")`, чтобы двоеточие не интерпретировалось как начало строки формата.

[!code-csharp[interpolated-strings4](../../../../samples/snippets/csharp/language-reference/keywords/interpolated-strings4.cs#1)]  

Буквально интерполируются строк, используемых `$` символов, за которым следует `@` символов. Дополнительные сведения о строках verbatim см. в разделе [строка](string.md) раздела. Следующий код является модификацией предыдущего фрагмента с помощью verbatim интерполированные строки:

[!code-csharp[interpolated-strings4](../../../../samples/snippets/csharp/language-reference/keywords/interpolated-strings5.cs#1)]  

Эти изменения необходимы, так как точные строки, которые не работают `\` escape-последовательности.

> [!IMPORTANT]
> `$` Токен должен находиться перед `@` маркера в интерполированные буквальная строка.


## <a name="implicit-conversions"></a>Неявные преобразования  

Существует три преобразования неявных типов из интерполированных строк.  

1. Преобразование интерполированной строки в <xref:System.String>. В следующем примере возвращается строка, интерполированные строковые выражения которой были заменены их строковыми представлениями. Пример:

   [!code-csharp[interpolated-strings1](../../../../samples/snippets/csharp/language-reference/keywords/interpolated-strings1.cs#1)]  

   Это окончательный результат интерпретации строк. Все вхождения двойных фигурных скобок ("{{" и "}}") преобразуются в одиночную фигурную скобку. 

2. Преобразование интерполированной строки в переменную <xref:System.IFormattable>, которая позволяет создавать несколько результирующих строк с содержимым для конкретного языка из одного экземпляра <xref:System.IFormattable>. Это полезно для включения правильных форматов чисел и дат для отдельных языков.  Все вхождения двойных фигурных скобок ("{{" и "}}") остаются двойными фигурными скобками до тех пор, пока строка не будет отформатирована путем явного или неявного вызова метода <xref:System.Object.ToString>.  Все заключенные в скобки выражения интерполяции преобразуются в {0}, \{1\} и т. д.  

   В следующем примере используется отражение для отображения членов, а также значений поля и свойства переменной <xref:System.IFormattable>, созданной из интерполированной строки. Он также передает <xref:System.IFormattable> переменной <xref:System.Console.WriteLine(System.String)?displayProperty=nameWithType> метод.

   [!code-csharp[interpolated-strings2](../../../../samples/snippets/csharp/language-reference/keywords/interpolated-strings2.cs#1)]  

   Обратите внимание, что интерполированную строку можно проверить только с помощью отражения. Если оно передается строка форматирования, такие как <xref:System.Console.WriteLine(System.String)>, разрешаются элементами форматирования и возвращаются в результирующую строку. 

3. Преобразование интерполированной строки в переменную <xref:System.FormattableString>, представляющую строку составного формата. Проверка строки составного формата и способа ее отрисовки в виде результирующей строки может, например, обеспечивать защиту от атак путем внедрения кода, если выполнялось построение запроса. <xref:System.FormattableString> также включает перегрузки <xref:System.FormattableString.ToString>, позволяющие создавать результирующие строки для <xref:System.Globalization.CultureInfo.InvariantCulture> и <xref:System.Globalization.CultureInfo.CurrentCulture>.  Все вхождения двойных фигурных скобок ("{{" и "}}") остаются двойными фигурными скобками, пока не будет выполнено форматирование.  Все заключенные в скобки выражения интерполяции преобразуются в {0}, \{1\} и т. д.  

   [!code-csharp[interpolated-strings3](../../../../samples/snippets/csharp/language-reference/keywords/interpolated-strings3.cs#1)]  

## <a name="language-specification"></a>Спецификация языка  
 [!INCLUDE[CSharplangspec](~/includes/csharplangspec-md.md)]  
  
## <a name="see-also"></a>См. также  
 <xref:System.IFormattable?displayProperty=nameWithType>  
 <xref:System.FormattableString?displayProperty=nameWithType>  
 [Справочник по C#](../../../csharp/language-reference/index.md)  
 [Руководство по программированию на C#](../../../csharp/programming-guide/index.md)
