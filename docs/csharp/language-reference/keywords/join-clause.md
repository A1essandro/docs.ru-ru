---
title: Предложение join (Справочник по C#)
ms.date: 07/20/2015
f1_keywords:
- join
- join_CSharpKeyword
helpviewer_keywords:
- join clause [C#]
- join keyword [C#]
ms.assetid: 76e9df84-092c-41a6-9537-c3f1cbd7f0fb
ms.openlocfilehash: a868c52cf753b1e4285586ec41c1993f519299d7
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="join-clause-c-reference"></a><span data-ttu-id="3f86c-102">Предложение join (Справочник по C#)</span><span class="sxs-lookup"><span data-stu-id="3f86c-102">join clause (C# Reference)</span></span>
<span data-ttu-id="3f86c-103">Предложение `join` удобно для связывания элементов из разных исходных последовательностей, не имеющих прямых связей в объектной модели.</span><span class="sxs-lookup"><span data-stu-id="3f86c-103">The `join` clause is useful for associating elements from different source sequences that have no direct relationship in the object model.</span></span> <span data-ttu-id="3f86c-104">Единственное требование заключается в том, что у элементов в каждом источнике должно быть общим некоторое значение, которое может быть проверено на равенство.</span><span class="sxs-lookup"><span data-stu-id="3f86c-104">The only requirement is that the elements in each source share some value that can be compared for equality.</span></span> <span data-ttu-id="3f86c-105">Например, у дистрибьютора может быть список поставщиков определенного продукта и список покупателей.</span><span class="sxs-lookup"><span data-stu-id="3f86c-105">For example, a food distributor might have a list of suppliers of a certain product, and a list of buyers.</span></span> <span data-ttu-id="3f86c-106">Предложение `join` может использоваться, например, для создания списка поставщиков и покупателей этого продукта, которые находятся в одном заданном регионе.</span><span class="sxs-lookup"><span data-stu-id="3f86c-106">A `join` clause can be used, for example, to create a list of the suppliers and buyers of that product who are all in the same specified region.</span></span>  
  
 <span data-ttu-id="3f86c-107">Предложение `join` принимает две исходные последовательности в качестве входных данных.</span><span class="sxs-lookup"><span data-stu-id="3f86c-107">A `join` clause takes two source sequences as input.</span></span> <span data-ttu-id="3f86c-108">Элементы в каждой последовательности должны являться свойством (или содержать свойство), которое можно сравнить с соответствующим свойством в другой последовательности.</span><span class="sxs-lookup"><span data-stu-id="3f86c-108">The elements in each sequence must either be or contain a property that can be compared to a corresponding property in the other sequence.</span></span> <span data-ttu-id="3f86c-109">Предложение `join` сравнивает указанные ключи на равенство с помощью специального ключевого слова `equals`.</span><span class="sxs-lookup"><span data-stu-id="3f86c-109">The `join` clause compares the specified keys for equality by using the special `equals` keyword.</span></span> <span data-ttu-id="3f86c-110">Все соединения, выполняемые предложением `join`, являются эквисоединениями.</span><span class="sxs-lookup"><span data-stu-id="3f86c-110">All joins performed by the `join` clause are equijoins.</span></span> <span data-ttu-id="3f86c-111">Форма выходных данных предложения `join` зависит от конкретного типа выполняемого соединения.</span><span class="sxs-lookup"><span data-stu-id="3f86c-111">The shape of the output of a `join` clause depends on the specific type of join you are performing.</span></span> <span data-ttu-id="3f86c-112">Ниже приведены три наиболее распространенных типа соединения:</span><span class="sxs-lookup"><span data-stu-id="3f86c-112">The following are three most common join types:</span></span>  
  
-   <span data-ttu-id="3f86c-113">внутреннее соединение,</span><span class="sxs-lookup"><span data-stu-id="3f86c-113">Inner join</span></span>  
  
-   <span data-ttu-id="3f86c-114">групповое соединение,</span><span class="sxs-lookup"><span data-stu-id="3f86c-114">Group join</span></span>  
  
-   <span data-ttu-id="3f86c-115">левое внешнее соединение.</span><span class="sxs-lookup"><span data-stu-id="3f86c-115">Left outer join</span></span>  
  
## <a name="inner-join"></a><span data-ttu-id="3f86c-116">Внутреннее соединение</span><span class="sxs-lookup"><span data-stu-id="3f86c-116">Inner Join</span></span>  
 <span data-ttu-id="3f86c-117">В следующем примере показано простое внутреннее эквисоединение.</span><span class="sxs-lookup"><span data-stu-id="3f86c-117">The following example shows a simple inner equijoin.</span></span> <span data-ttu-id="3f86c-118">По этому запросу создается прямая последовательность пар "название продукта/категория".</span><span class="sxs-lookup"><span data-stu-id="3f86c-118">This query produces a flat sequence of "product name / category" pairs.</span></span> <span data-ttu-id="3f86c-119">Одна и та же строка, обозначающая категорию, будет присутствовать в нескольких элементах.</span><span class="sxs-lookup"><span data-stu-id="3f86c-119">The same category string will appear in multiple elements.</span></span> <span data-ttu-id="3f86c-120">Если для элемента из `categories` нет соответствующего элемента в `products`, эта категория не будет отображаться в результатах.</span><span class="sxs-lookup"><span data-stu-id="3f86c-120">If an element from `categories` has no matching `products`, that category will not appear in the results.</span></span>  
  
 [!code-csharp[cscsrefQueryKeywords#24](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_1.cs)]  
  
 <span data-ttu-id="3f86c-121">Дополнительные сведения см. в разделе [Практическое руководство. Выполнение внутренних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md).</span><span class="sxs-lookup"><span data-stu-id="3f86c-121">For more information, see [How to: Perform Inner Joins](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md).</span></span>  
  
## <a name="group-join"></a><span data-ttu-id="3f86c-122">Group Join</span><span class="sxs-lookup"><span data-stu-id="3f86c-122">Group Join</span></span>  
 <span data-ttu-id="3f86c-123">Предложение `join` с выражением `into` называется групповым соединением.</span><span class="sxs-lookup"><span data-stu-id="3f86c-123">A `join` clause with an `into` expression is called a group join.</span></span>  
  
 [!code-csharp[cscsrefQueryKeywords#25](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_2.cs)]  
  
 <span data-ttu-id="3f86c-124">Групповое соединение создает иерархическую последовательность результатов, которая связывает элементы в левой исходной последовательности с одним или несколькими соответствующими элементами в правой исходной последовательности.</span><span class="sxs-lookup"><span data-stu-id="3f86c-124">A group join produces a hierarchical result sequence, which associates elements in the left source sequence with one or more matching elements in the right side source sequence.</span></span> <span data-ttu-id="3f86c-125">Групповое соединение не имеет эквивалента в терминах реляционной базы данных. По сути это последовательность массивов объектов.</span><span class="sxs-lookup"><span data-stu-id="3f86c-125">A group join has no equivalent in relational terms; it is essentially a sequence of object arrays.</span></span>  
  
 <span data-ttu-id="3f86c-126">Если для элементов в левом источнике не удается найти элементы из правой исходной последовательности, предложение `join` создаст пустой массив для этого элемента.</span><span class="sxs-lookup"><span data-stu-id="3f86c-126">If no elements from the right source sequence are found to match an element in the left source, the `join` clause will produce an empty array for that item.</span></span> <span data-ttu-id="3f86c-127">Таким образом, групповое соединение — это такое же внутреннее эквисоединение, за исключением того что последовательность результатов организуется в группы.</span><span class="sxs-lookup"><span data-stu-id="3f86c-127">Therefore, the group join is still basically an inner-equijoin except that the result sequence is organized into groups.</span></span>  
  
 <span data-ttu-id="3f86c-128">Если просто выбрать результаты группового соединения, можно получить доступ к элементам, но не определить ключ, по которому они совпадают.</span><span class="sxs-lookup"><span data-stu-id="3f86c-128">If you just select the results of a group join, you can access the items, but you cannot identify the key that they match on.</span></span> <span data-ttu-id="3f86c-129">Таким образом, удобнее будет выбирать результаты группового соединения в новый тип, который также имеет имя ключа, как показано в предыдущем примере.</span><span class="sxs-lookup"><span data-stu-id="3f86c-129">Therefore, it is generally more useful to select the results of the group join into a new type that also has the key name, as shown in the previous example.</span></span>  
  
 <span data-ttu-id="3f86c-130">Кроме того, результаты группового соединения можно использовать как генераторы других вложенных запросов:</span><span class="sxs-lookup"><span data-stu-id="3f86c-130">You can also, of course, use the result of a group join as the generator of another subquery:</span></span>  
  
 [!code-csharp[cscsrefQueryKeywords#26](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_3.cs)]  
  
 <span data-ttu-id="3f86c-131">Дополнительные сведения см. в разделе [Практическое руководство. Выполнение групповых соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md).</span><span class="sxs-lookup"><span data-stu-id="3f86c-131">For more information, see [How to: Perform Grouped Joins](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md).</span></span>  
  
## <a name="left-outer-join"></a><span data-ttu-id="3f86c-132">Left Outer Join</span><span class="sxs-lookup"><span data-stu-id="3f86c-132">Left Outer Join</span></span>  
 <span data-ttu-id="3f86c-133">В левом внешнем соединении возвращаются все элементы в левой исходной последовательности, даже если в правой последовательности нет соответствующих элементов.</span><span class="sxs-lookup"><span data-stu-id="3f86c-133">In a left outer join, all the elements in the left source sequence are returned, even if no matching elements are in the right sequence.</span></span> <span data-ttu-id="3f86c-134">Для выполнения левого внешнего соединения в [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] используйте метод `DefaultIfEmpty` в сочетании с групповым соединением для указания правого элемента по умолчанию, создаваемого, если левый элемент не имеет совпадений.</span><span class="sxs-lookup"><span data-stu-id="3f86c-134">To perform a left outer join in [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], use the `DefaultIfEmpty` method in combination with a group join to specify a default right-side element to produce if a left-side element has no matches.</span></span> <span data-ttu-id="3f86c-135">`null` можно использовать как значение по умолчанию для любого ссылочного типа, кроме того, можно указать определенный пользователем тип по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="3f86c-135">You can use `null` as the default value for any reference type, or you can specify a user-defined default type.</span></span> <span data-ttu-id="3f86c-136">В следующем примере показан определяемый пользователем тип по умолчанию:</span><span class="sxs-lookup"><span data-stu-id="3f86c-136">In the following example, a user-defined default type is shown:</span></span>  
  
 [!code-csharp[cscsrefQueryKeywords#27](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_4.cs)]  
  
 <span data-ttu-id="3f86c-137">Дополнительные сведения см. в разделе [Практическое руководство. Выполнение левых внешних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md).</span><span class="sxs-lookup"><span data-stu-id="3f86c-137">For more information, see [How to: Perform Left Outer Joins](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md).</span></span>  
  
## <a name="the-equals-operator"></a><span data-ttu-id="3f86c-138">Оператор равенства</span><span class="sxs-lookup"><span data-stu-id="3f86c-138">The equals operator</span></span>  
 <span data-ttu-id="3f86c-139">Предложение `join` выполняет эквисоединение.</span><span class="sxs-lookup"><span data-stu-id="3f86c-139">A `join` clause performs an equijoin.</span></span> <span data-ttu-id="3f86c-140">Другими словами совпадения могут основываться только на равенстве двух ключей.</span><span class="sxs-lookup"><span data-stu-id="3f86c-140">In other words, you can only base matches on the equality of two keys.</span></span> <span data-ttu-id="3f86c-141">Другие типы сравнений, такие как "больше чем" или "не равно" не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="3f86c-141">Other types of comparisons such as "greater than" or "not equals" are not supported.</span></span> <span data-ttu-id="3f86c-142">Чтобы гарантировать, что все соединения являются эквисоединениями, предложение `join` использует ключевое слово `equals` оператора `==`.</span><span class="sxs-lookup"><span data-stu-id="3f86c-142">To make clear that all joins are equijoins, the `join` clause uses the `equals` keyword instead of the `==` operator.</span></span> <span data-ttu-id="3f86c-143">Ключевое слово `equals` может использоваться только в предложении `join`, и оно отличается от оператора `==` одной важной особенностью.</span><span class="sxs-lookup"><span data-stu-id="3f86c-143">The `equals` keyword can only be used in a `join` clause and it differs from the `==` operator in one important way.</span></span> <span data-ttu-id="3f86c-144">В `equals` левый ключ использует внешнюю исходную последовательность, а правый ключ — внутренний источник.</span><span class="sxs-lookup"><span data-stu-id="3f86c-144">With `equals`, the left key consumes the outer source sequence, and the right key consumes the inner source.</span></span> <span data-ttu-id="3f86c-145">Внешний источник попадает в область только левой части `equals`, а внутренняя исходная последовательность — только в область правой части.</span><span class="sxs-lookup"><span data-stu-id="3f86c-145">The outer source is only in scope on the left side of `equals` and the inner source sequence is only in scope on the right side.</span></span>  
  
## <a name="non-equijoins"></a><span data-ttu-id="3f86c-146">Соединения, не являющиеся эквисоединениями</span><span class="sxs-lookup"><span data-stu-id="3f86c-146">Non-Equijoins</span></span>  
 <span data-ttu-id="3f86c-147">Соединения, не являющиеся эквисоединениями, перекрестные соединения и другие настраиваемые операции соединения можно выполнять с помощью нескольких предложений `from` для независимого ввода новых последовательностей в запрос.</span><span class="sxs-lookup"><span data-stu-id="3f86c-147">You can perform non-equijoins, cross joins, and other custom join operations by using multiple `from` clauses to introduce new sequences independently into a query.</span></span> <span data-ttu-id="3f86c-148">Дополнительные сведения см. в разделе [Практическое руководство. Выполнение пользовательских операций соединения](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-custom-join-operations.md).</span><span class="sxs-lookup"><span data-stu-id="3f86c-148">For more information, see [How to: Perform Custom Join Operations](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-custom-join-operations.md).</span></span>  
  
## <a name="joins-on-object-collections-vs-relational-tables"></a><span data-ttu-id="3f86c-149">Соединения коллекций объектов и реляционных таблиц</span><span class="sxs-lookup"><span data-stu-id="3f86c-149">Joins on object collections vs. relational tables</span></span>  
 <span data-ttu-id="3f86c-150">В выражении запроса [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] операции соединения выполняются для коллекций объектов.</span><span class="sxs-lookup"><span data-stu-id="3f86c-150">In a [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] query expression, join operations are performed on object collections.</span></span> <span data-ttu-id="3f86c-151">Коллекции объектов нельзя "соединять" точно так же, как две реляционные таблицы.</span><span class="sxs-lookup"><span data-stu-id="3f86c-151">Object collections cannot be "joined" in exactly the same way as two relational tables.</span></span> <span data-ttu-id="3f86c-152">В [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] явные предложения `join` требуются, только если две исходные последовательности не связаны каким-либо отношением.</span><span class="sxs-lookup"><span data-stu-id="3f86c-152">In [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)], explicit `join` clauses are only required when two source sequences are not tied by any relationship.</span></span> <span data-ttu-id="3f86c-153">При работе с [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] таблицы внешних ключей представлены в объектной модели как свойства основной таблицы.</span><span class="sxs-lookup"><span data-stu-id="3f86c-153">When working with [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], foreign key tables are represented in the object model as properties of the primary table.</span></span> <span data-ttu-id="3f86c-154">Например, в базе данных Northwind таблица Customer имеет связь типа "внешний ключ" с таблицей Orders.</span><span class="sxs-lookup"><span data-stu-id="3f86c-154">For example, in the Northwind database, the Customer table has a foreign key relationship with the Orders table.</span></span> <span data-ttu-id="3f86c-155">При сопоставлении таблиц с объектной моделью класс Customer имеет свойство Orders, содержащий коллекцию заказов, связанных с клиентом.</span><span class="sxs-lookup"><span data-stu-id="3f86c-155">When you map the tables to the object model, the Customer class has an Orders property that contains the collection of Orders associated with that Customer.</span></span> <span data-ttu-id="3f86c-156">Фактически соединение уже выполнено автоматически.</span><span class="sxs-lookup"><span data-stu-id="3f86c-156">In effect, the join has already been done for you.</span></span>  
  
 <span data-ttu-id="3f86c-157">Дополнительные сведения о создании запросов по связанным таблицам в контексте [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] см. в разделе [Практическое руководство. Сопоставление связей баз данных](../../../framework/data/adonet/sql/linq/how-to-map-database-relationships.md).</span><span class="sxs-lookup"><span data-stu-id="3f86c-157">For more information about querying across related tables in the context of [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], see [How to: Map Database Relationships](../../../framework/data/adonet/sql/linq/how-to-map-database-relationships.md).</span></span>  
  
## <a name="composite-keys"></a><span data-ttu-id="3f86c-158">Составные ключи</span><span class="sxs-lookup"><span data-stu-id="3f86c-158">Composite Keys</span></span>  
 <span data-ttu-id="3f86c-159">Равенство нескольких значений можно проверить с помощью составного ключа.</span><span class="sxs-lookup"><span data-stu-id="3f86c-159">You can test for equality of multiple values by using a composite key.</span></span> <span data-ttu-id="3f86c-160">Дополнительные сведения см. в разделе [Практическое руководство. Соединение с помощью составных ключей](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md).</span><span class="sxs-lookup"><span data-stu-id="3f86c-160">For more information, see [How to: Join by Using Composite Keys](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md).</span></span> <span data-ttu-id="3f86c-161">Составные ключи можно также использовать в предложении `group`.</span><span class="sxs-lookup"><span data-stu-id="3f86c-161">Composite keys can be also used in a `group` clause.</span></span>  
  
## <a name="example"></a><span data-ttu-id="3f86c-162">Пример</span><span class="sxs-lookup"><span data-stu-id="3f86c-162">Example</span></span>  
 <span data-ttu-id="3f86c-163">В следующем примере сравниваются результаты внутреннего соединения, группового соединения и левого внешнего соединения для одних и тех же исходных данных с использованием одинаковых совпадающих ключей.</span><span class="sxs-lookup"><span data-stu-id="3f86c-163">The following example compares the results of an inner join, a group join, and a left outer join on the same data sources by using the same matching keys.</span></span> <span data-ttu-id="3f86c-164">В эти примеры для уточнения результатов в окне консоли добавлен дополнительный код.</span><span class="sxs-lookup"><span data-stu-id="3f86c-164">Some extra code is added to these examples to clarify the results in the console display.</span></span>  
  
 [!code-csharp[cscsrefQueryKeywords#23](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_5.cs)]  
  
## <a name="remarks"></a><span data-ttu-id="3f86c-165">Примечания</span><span class="sxs-lookup"><span data-stu-id="3f86c-165">Remarks</span></span>  
 <span data-ttu-id="3f86c-166">Предложение `join`, за которым не следует `into`, преобразуется в вызов метода <xref:System.Linq.Enumerable.Join%2A>.</span><span class="sxs-lookup"><span data-stu-id="3f86c-166">A `join` clause that is not followed by `into` is translated into a <xref:System.Linq.Enumerable.Join%2A> method call.</span></span> <span data-ttu-id="3f86c-167">Предложение `join`, за которым следует `into`, преобразуется в вызов метода <xref:System.Linq.Enumerable.GroupJoin%2A>.</span><span class="sxs-lookup"><span data-stu-id="3f86c-167">A `join` clause that is followed by `into` is translated to a <xref:System.Linq.Enumerable.GroupJoin%2A> method call.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f86c-168">См. также</span><span class="sxs-lookup"><span data-stu-id="3f86c-168">See Also</span></span>  
 [<span data-ttu-id="3f86c-169">Ключевые слова запроса (LINQ)</span><span class="sxs-lookup"><span data-stu-id="3f86c-169">Query Keywords (LINQ)</span></span>](../../../csharp/language-reference/keywords/query-keywords.md)  
 [<span data-ttu-id="3f86c-170">Выражения запросов LINQ</span><span class="sxs-lookup"><span data-stu-id="3f86c-170">LINQ Query Expressions</span></span>](../../../csharp/programming-guide/linq-query-expressions/index.md)  
 [<span data-ttu-id="3f86c-171">Операции соединения</span><span class="sxs-lookup"><span data-stu-id="3f86c-171">Join Operations</span></span>](../../programming-guide/concepts/linq/join-operations.md)  
 [<span data-ttu-id="3f86c-172">предложение group</span><span class="sxs-lookup"><span data-stu-id="3f86c-172">group clause</span></span>](../../../csharp/language-reference/keywords/group-clause.md)  
 [<span data-ttu-id="3f86c-173">Практическое руководство. Выполнение левых внешних соединений</span><span class="sxs-lookup"><span data-stu-id="3f86c-173">How to: Perform Left Outer Joins</span></span>](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md)  
 [<span data-ttu-id="3f86c-174">Практическое руководство. Выполнение внутренних соединений</span><span class="sxs-lookup"><span data-stu-id="3f86c-174">How to: Perform Inner Joins</span></span>](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md)  
 [<span data-ttu-id="3f86c-175">Практическое руководство. Выполнение групповых соединений</span><span class="sxs-lookup"><span data-stu-id="3f86c-175">How to: Perform Grouped Joins</span></span>](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md)  
 [<span data-ttu-id="3f86c-176">Практическое руководство. Упорядочение результатов предложения соединения</span><span class="sxs-lookup"><span data-stu-id="3f86c-176">How to: Order the Results of a Join Clause</span></span>](../../../csharp/programming-guide/linq-query-expressions/how-to-order-the-results-of-a-join-clause.md)  
 [<span data-ttu-id="3f86c-177">Практическое руководство. Соединение с помощью составных ключей</span><span class="sxs-lookup"><span data-stu-id="3f86c-177">How to: Join by Using Composite Keys</span></span>](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md)  
 [<span data-ttu-id="3f86c-178">Практическое руководство. Установка образцов баз данных</span><span class="sxs-lookup"><span data-stu-id="3f86c-178">How to: Install Sample Databases</span></span>](/visualstudio/data-tools/installing-database-systems-tools-and-samples)
