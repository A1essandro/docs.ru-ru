---
title: "Предложение join (Справочник по C#)"
ms.date: 07/20/2015
ms.prod: .net
ms.technology: devlang-csharp
ms.topic: article
f1_keywords:
- join
- join_CSharpKeyword
helpviewer_keywords:
- join clause [C#]
- join keyword [C#]
ms.assetid: 76e9df84-092c-41a6-9537-c3f1cbd7f0fb
caps.latest.revision: "29"
author: BillWagner
ms.author: wiwagn
ms.openlocfilehash: 17c8f7f5ff6d1266421cdb87ae562028c61ae97f
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="join-clause-c-reference"></a>Предложение join (Справочник по C#)
Предложение `join` удобно для связывания элементов из разных исходных последовательностей, не имеющих прямых связей в объектной модели. Единственное требование заключается в том, что у элементов в каждом источнике должно быть общим некоторое значение, которое может быть проверено на равенство. Например, у дистрибьютора может быть список поставщиков определенного продукта и список покупателей. Предложение `join` может использоваться, например, для создания списка поставщиков и покупателей этого продукта, которые находятся в одном заданном регионе.  
  
 Предложение `join` принимает две исходные последовательности в качестве входных данных. Элементы в каждой последовательности должны являться свойством (или содержать свойство), которое можно сравнить с соответствующим свойством в другой последовательности. Предложение `join` сравнивает указанные ключи на равенство с помощью специального ключевого слова `equals`. Все соединения, выполняемые предложением `join`, являются эквисоединениями. Форма выходных данных предложения `join` зависит от конкретного типа выполняемого соединения. Ниже приведены три наиболее распространенных типа соединения:  
  
-   внутреннее соединение,  
  
-   групповое соединение,  
  
-   левое внешнее соединение.  
  
## <a name="inner-join"></a>Внутреннее соединение  
 В следующем примере показано простое внутреннее эквисоединение. По этому запросу создается прямая последовательность пар "название продукта/категория". Одна и та же строка, обозначающая категорию, будет присутствовать в нескольких элементах. Если для элемента из `categories` нет соответствующего элемента в `products`, эта категория не будет отображаться в результатах.  
  
 [!code-csharp[cscsrefQueryKeywords#24](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_1.cs)]  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Выполнение внутренних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md).  
  
## <a name="group-join"></a>Group Join  
 Предложение `join` с выражением `into` называется групповым соединением.  
  
 [!code-csharp[cscsrefQueryKeywords#25](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_2.cs)]  
  
 Групповое соединение создает иерархическую последовательность результатов, которая связывает элементы в левой исходной последовательности с одним или несколькими соответствующими элементами в правой исходной последовательности. Групповое соединение не имеет эквивалента в терминах реляционной базы данных. По сути это последовательность массивов объектов.  
  
 Если для элементов в левом источнике не удается найти элементы из правой исходной последовательности, предложение `join` создаст пустой массив для этого элемента. Таким образом, групповое соединение — это такое же внутреннее эквисоединение, за исключением того что последовательность результатов организуется в группы.  
  
 Если просто выбрать результаты группового соединения, можно получить доступ к элементам, но не определить ключ, по которому они совпадают. Таким образом, удобнее будет выбирать результаты группового соединения в новый тип, который также имеет имя ключа, как показано в предыдущем примере.  
  
 Кроме того, результаты группового соединения можно использовать как генераторы других вложенных запросов:  
  
 [!code-csharp[cscsrefQueryKeywords#26](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_3.cs)]  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Выполнение групповых соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md).  
  
## <a name="left-outer-join"></a>Left Outer Join  
 В левом внешнем соединении возвращаются все элементы в левой исходной последовательности, даже если в правой последовательности нет соответствующих элементов. Для выполнения левого внешнего соединения в [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] используйте метод `DefaultIfEmpty` в сочетании с групповым соединением для указания правого элемента по умолчанию, создаваемого, если левый элемент не имеет совпадений. `null` можно использовать как значение по умолчанию для любого ссылочного типа, кроме того, можно указать определенный пользователем тип по умолчанию. В следующем примере показан определяемый пользователем тип по умолчанию:  
  
 [!code-csharp[cscsrefQueryKeywords#27](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_4.cs)]  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Выполнение левых внешних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md).  
  
## <a name="the-equals-operator"></a>Оператор равенства  
 Предложение `join` выполняет эквисоединение. Другими словами совпадения могут основываться только на равенстве двух ключей. Другие типы сравнений, такие как "больше чем" или "не равно" не поддерживаются. Чтобы гарантировать, что все соединения являются эквисоединениями, предложение `join` использует ключевое слово `equals` оператора `==`. Ключевое слово `equals` может использоваться только в предложении `join`, и оно отличается от оператора `==` одной важной особенностью. В `equals` левый ключ использует внешнюю исходную последовательность, а правый ключ — внутренний источник. Внешний источник попадает в область только левой части `equals`, а внутренняя исходная последовательность — только в область правой части.  
  
## <a name="non-equijoins"></a>Соединения, не являющиеся эквисоединениями  
 Соединения, не являющиеся эквисоединениями, перекрестные соединения и другие настраиваемые операции соединения можно выполнять с помощью нескольких предложений `from` для независимого ввода новых последовательностей в запрос. Дополнительные сведения см. в разделе [Практическое руководство. Выполнение пользовательских операций соединения](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-custom-join-operations.md).  
  
## <a name="joins-on-object-collections-vs-relational-tables"></a>Соединения коллекций объектов и реляционных таблиц  
 В выражении запроса [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] операции соединения выполняются для коллекций объектов. Коллекции объектов нельзя "соединять" точно так же, как две реляционные таблицы. В [!INCLUDE[vbteclinq](~/includes/vbteclinq-md.md)] явные предложения `join` требуются, только если две исходные последовательности не связаны каким-либо отношением. При работе с [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] таблицы внешних ключей представлены в объектной модели как свойства основной таблицы. Например, в базе данных Northwind таблица Customer имеет связь типа "внешний ключ" с таблицей Orders. При сопоставлении таблиц с объектной моделью класс Customer имеет свойство Orders, содержащий коллекцию заказов, связанных с клиентом. Фактически соединение уже выполнено автоматически.  
  
 Дополнительные сведения о создании запросов по связанным таблицам в контексте [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] см. в разделе [Практическое руководство. Сопоставление связей баз данных](../../../framework/data/adonet/sql/linq/how-to-map-database-relationships.md).  
  
## <a name="composite-keys"></a>Составные ключи  
 Равенство нескольких значений можно проверить с помощью составного ключа. Дополнительные сведения см. в разделе [Практическое руководство. Соединение с помощью составных ключей](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md). Составные ключи можно также использовать в предложении `group`.  
  
## <a name="example"></a>Пример  
 В следующем примере сравниваются результаты внутреннего соединения, группового соединения и левого внешнего соединения для одних и тех же исходных данных с использованием одинаковых совпадающих ключей. В эти примеры для уточнения результатов в окне консоли добавлен дополнительный код.  
  
 [!code-csharp[cscsrefQueryKeywords#23](../../../csharp/language-reference/keywords/codesnippet/CSharp/join-clause_5.cs)]  
  
## <a name="remarks"></a>Примечания  
 Предложение `join`, за которым не следует `into`, преобразуется в вызов метода <xref:System.Linq.Enumerable.Join%2A>. Предложение `join`, за которым следует `into`, преобразуется в вызов метода <xref:System.Linq.Enumerable.GroupJoin%2A>.  
  
## <a name="see-also"></a>См. также  
 [Ключевые слова запроса (LINQ)](../../../csharp/language-reference/keywords/query-keywords.md)  
 [Выражения запросов LINQ](../../../csharp/programming-guide/linq-query-expressions/index.md)  
 [Операции соединения](../../programming-guide/concepts/linq/join-operations.md)  
 [предложение group](../../../csharp/language-reference/keywords/group-clause.md)  
 [Практическое руководство. Выполнение левых внешних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-left-outer-joins.md)  
 [Практическое руководство. Выполнение внутренних соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-inner-joins.md)  
 [Практическое руководство. Выполнение групповых соединений](../../../csharp/programming-guide/linq-query-expressions/how-to-perform-grouped-joins.md)  
 [Практическое руководство. Упорядочение результатов предложения соединения](../../../csharp/programming-guide/linq-query-expressions/how-to-order-the-results-of-a-join-clause.md)  
 [Практическое руководство. Соединение с помощью составных ключей](../../../csharp/programming-guide/linq-query-expressions/how-to-join-by-using-composite-keys.md)  
 [Практическое руководство. Установка образцов баз данных](/visualstudio/data-tools/installing-database-systems-tools-and-samples)
