---
title: "Отладка приложения Hello World на C# в Visual Studio 2017"
description: "Сведения об отладке в Visual Studio 2017 на примере приложения Hello World, написанного на C#"
keywords: ".NET Core, консольное приложение .NET Core, отладка .NET Core"
author: BillWagner
ms.author: wiwagn
ms.date: 10/24/2016
ms.topic: article
ms.prod: .net-core
ms.technology: devlang-csharp
ms.devlang: csharp
ms.assetid: cb213625-cc60-438b-9b9e-49aed0e4a974
translationtype: Human Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: 6a6a461984c140d180cf70cd7a1a33818a40b451
ms.lasthandoff: 03/13/2017

---

# <a name="debugging-your-c-hello-world-application-with-visual-studio-2017"></a>Отладка приложения Hello World на C# в Visual Studio 2017 #

Итак, вы уже создали и запустили простое консольное приложение с помощью инструкций из статьи [Building a C# Hello World application with .NET Core in Visual Studio 2017](.\with-visual-studio-2017.md) (Создание приложения Hello World на C# на основе .NET в Visual Studio 2017). Выполнив создание и компиляцию приложения, вы можете приступить к тестированию. Visual Studio включает широкий набор инструментальных средств, которые можно использовать для тестирования приложений и устранения неполадок. Давайте рассмотрим некоторые из них на примере отладки нашего приложения.

## <a name="debugging-in-debug-mode"></a>Отладка в режиме отладки ##

Режим отладки является одной из двух конфигураций сборки, включенных в Visual Studio по умолчанию. (Вторая конфигурация — это режим выпуска.) Используемая конфигурация сборки отображается на панели инструментов. Следующий рисунок показывает, что компиляция приложения выполняется в режиме отладки.

   ![Изображение](./media/debugmode.jpg)

Тестирование программы следует всегда начинать в режиме отладки. В этом режиме компилятор отключает значительную часть средств оптимизации и предоставляет более полные сведения в выходных данных, передаваемых от процесса сборки в файл базы данных символов (PDB-файл).

## <a name="setting-a-breakpoint"></a>Задание точки останова ##

Давайте попробуем выполнить программу в режиме отладки и использовать некоторые функции отладки.

1. Установите точку останова. Для этого наведите курсор на строку с текстом `Console.WriteLine("\nHello, {0}, on {1:d} at {1:t}", name, date);` и щелкните ее левое поле или выберите пункт меню **Отладка**, **Точка останова**. (Точка останова временно прерывает выполнение приложения *перед* тем, как будет выполнена отмеченная ею строка.) Как видно на следующем рисунке, строку с точкой останова Visual Studio обозначает подсветкой текста и красным кругом в ее левом поле.

   ![Изображение](./media/setbreakpoint_2017.jpg)

1. Запустите программу в режиме отладки, выбрав на панели инструментов кнопку HelloWorld с зеленой стрелкой, нажав клавишу F5 или выбрав пункт меню **Отладка**, **Начать отладку**.

1. Когда программа запросит имя, введите любую строку в окне консоли и нажмите клавишу ВВОД.

1. Выполнение программы остановится, когда будет достигнута точка останова, то есть перед выполнением метода `Console.WriteLine`. Окно Visual Studio будет выглядеть приблизительно так, как показано на рисунке. Обратите внимание, что окно **Видимые** отображает значения всех переменных, которые используются рядом с текущей строкой. (Окно **Локальные** отображает значения переменных, которые определены в текущем методе.)

   ![Изображение](./media/breakpoint_2017.jpg)

1. Давайте попробуем изменить значения переменных и посмотрим, как это повлияет на работу программы. Если **окно интерпретации** не отображается, откройте его, выбрав пункт меню **Отладка**, **Окна**, **Интерпретация**. **Окно интерпретации** позволяет взаимодействовать с отлаживаемым приложением.

1. Вы можете изменять значения переменных и отслеживать изменения. Введите в окно "Интерпретация" текст `name = "Yuma"` и нажмите клавишу ВВОД.

1. Введите в окно "Интерпретация" текст `date = new DateTime(2016,11,01,11,59,00)` и нажмите клавишу ВВОД.

   На следующем рисунке показан пример **окна интерпретации**:

   ![Изображение](./media/immediatewindow.jpg)

   В этом окне отображается значение строковой переменной и свойства значения @System.DateTime. Кроме того, значения переменных обновляются в окнах **Видимые** и **Локальные**.

1. Возобновите выполнение программы, нажав кнопку **Продолжить** на панели инструментов или выбрав пункт меню **Отладка**, **Продолжить**. В результате окно консоли должно выглядеть так, как на следующем изображении. Обратите внимание, что отображаемые в окне консоли значения совпадают с изменениями, произведенных в **окне интерпретации**.

   ![Изображение](./media/changed.jpg)

1. Нажмите любую клавишу, чтобы выйти из приложения и закрыть режим отладки.

## <a name="setting-a-conditional-breakpoint"></a>Установка условной точки останова ##

Мы теперь знаем, что программа правильно отображает строки, введенные пользователем. Но что произойдет, если пользователь ничего не введет? Мы можем проверить это, а заодно ознакомимся еще с одной функцией отладки — с условной точкой останова.

Чтобы проверить поведение программы в случае, когда пользователь не вводит текст, задайте условную точку останова следующим образом.

1. Щелкните правой кнопкой мыши красную точку, обозначающую точку останова. В контекстном меню выберите **Условия...**, чтобы открыть диалоговое окно **Параметры точки останова**, представленное на следующем рисунке.

   ![Изображение](./media/breakpoint_settings.jpg)

1. В текстовом поле с надписью "например, x == 5" введите следующий текст:

   ```csharp
   String.IsNullOrEmpty(name)
   ```

   Здесь мы проверяем условие выполнения. Также здесь можно указать счетчик, который прервет выполнения программы прежде, чем инструкция будет выполнена определенное число раз, или условие фильтра, которое прервет выполнение программы по определенным значениям атрибутов, например идентификатора потока, имени процесса и имени потока.

1. Нажмите кнопку **Закрыть**, чтобы закрыть диалоговое окно.

1. Запустите программу в режиме отладки.

1. Когда в окне консоли появится предложение ввести имя, просто нажмите клавишу ВВОД.

1. Теперь, поскольку выполняется указанное нами условие (`name` имеет значение `null` или [String.Empty](xref:System.String.Empty)), выполнение программы будет остановлено при достижении точки останова, то есть перед выполнением метода `Console.WriteLine`.

1. Выберите окно **Локальные**, в котором отображаются значения локальных переменных текущего метода (в нашем примере это метод `Main`).

1. Обратите внимание, что переменная `name` имеет значение "", то есть соответствует условию [String.Empty](xref:System.String.Empty). Убедитесь в этом, введя следующую инструкцию в **окне интерпретации**:

   ```csharp
   ? name == String.Empty
   ```

   На рисунке ниже показан результат.

   ![Изображение](./media/emptystring.jpg)

1. Нажмите кнопку **Продолжить** на панели инструментов, чтобы возобновить выполнение программы.

1. Нажмите любую клавишу, чтобы закрыть окно консоли и закрыть режим отладки.

1. Очистите точку останова. Для этого щелкните красную точку в левом поле окна с кодом или выберите пункт меню **Отладка**, **Точка останова**.

## <a name="stepping-through-a-program"></a>Пошаговое выполнение программы ##

Visual Studio позволяет выполнять программу пошагово, то есть поочередно выполнять по одной строке, отслеживая результат выполнения. Обычно для использования этой функции задают точку останова и затем пошагово выполняют небольшой фрагмент программного кода. Но наша программа и так невелика, поэтому давайте выполним ее целиком в этом режиме.

1. В строке меню выберите пункты **Отладка**, **Шаг с заходом** или нажмите клавишу F11. Visual Studio выделяет подсветкой текста строку, которая будет выполнена следующей, и отображает рядом с ней стрелку, как показано на следующем рисунке.

   ![Изображение](./media/step_into.jpg)

   На этом этапе окно **Видимые** демонстрирует, что в программе определена только одна переменная `args`. Так как мы еще не передали в программу аргументы командной строки, ее значением является пустой массив строк. Кроме того, Visual Studio открыла пустое окно консоли.

1. Выберите пункт меню **Отладка**, **Шаг с заходом** или нажмите клавишу F11. Visual Studio переместит подсветку на следующую строку. Как видно на рисунке, выполнение кода от предыдущей до текущей инструкции заняло 3 миллисекунды. У нас по прежнему определена только одна переменная `args`, и окно консоли также пока пусто.

   ![Изображение](./media/step_into_2.jpg)

1. Выберите пункт меню **Отладка**, **Шаг с заходом** или нажмите клавишу F11. Visual Studio подсвечивает инструкцию, которая содержит присваивание значения переменной `name`. В окне **Видимые** отображается, что `name` имеет значение `null`, а в окне консоли появилась строка "What is your name?" (Введите имя:).

1. Ответьте на этот запрос, введя строку в окно консоли и нажав клавишу ВВОД. Консоль никак не отреагирует на это, и введенная строка отображаться не будет, но метод [Console.ReadLine](xref:System.Console.ReadLine) получит введенные входные данные.

1. Выберите пункт меню **Отладка**, **Шаг с заходом** или нажмите клавишу F11. Visual Studio подсвечивает инструкцию, которая содержит присваивание значения переменной `date`. Окно **Видимые** отображает значение свойства [DateTime.Now](xref:System.DateTime.Now) и значение, которое вернул метод [Console.ReadLine](xref:System.Console.ReadLine). Также в окне консоли появится строка, введенная в ответ на запрос консоли для ввода данных.

1. Выберите пункт меню **Отладка**, **Шаг с заходом** или нажмите клавишу F11. Окно **Видимые** теперь отобразит значение переменной `date`, присвоенное на основе значения [DateTime.Now](xref:System.DateTime.Now). В окне консоли изменений не произошло.

1. Выберите пункт меню **Отладка**, **Шаг с заходом** или нажмите клавишу F11. Visual Studio вызывает метод [Console.WriteLine](xref:System.Console.WriteLine(System.String,System.Object,System.Object)). Значения переменных `date` и `name` отображаются в окне **Видимые**, а окно консоли отображает форматированную строку.

1. Выберите **Отладка**, **Шаг с выходом**, или нажмите клавишу F11, удерживая клавишу Shift. Пошаговое выполнение на этом прекратится. Окно консоли отображает сообщение и ожидает нажатия клавиши.

1. Нажмите любую клавишу, чтобы закрыть окно консоли и закрыть режим отладки.

## <a name="building-a-release-version"></a>Сборка версии выпуска ##

Когда вы завершите сборку приложения в режиме отладки, следует выполнить компиляцию и тестирование версии выпуска. Версию выпуска компилятор собирает с использованием методов оптимизации, которые изредка могут влиять на поведение приложения. Например, оптимизации компилятора для повышения производительности могут привести к состоянию конкуренции в асинхронных и многопоточных приложениях.

Чтобы собрать и протестировать версию выпуска для консольного приложения, измените конфигурацию сборки на панели инструментов их режима **отладки** в режим **выпуска**, как показано на следующем рисунке.

![Изображение](./media/release.jpg)

Когда вы нажмете клавишу F5 или выберете команду **Построить решение** из меню **Сборка**, Visual Studio скомпилирует версию выпуска для консольного приложения, которую вы сможете протестировать. Процесс запуска и тестирования выполняется так же, как и в режиме отладки.

Когда вы закончите отладку приложения, можно начать публикацию распространяемой версии приложения. Сведения об этом этапе процесса вы найдете в статье [Publishing the C# Hello World application with Visual Studio 2017](./publishing-with-visual-studio-2017.md) (Публикация приложения Hello World на C# в Visual Studio 2017).

