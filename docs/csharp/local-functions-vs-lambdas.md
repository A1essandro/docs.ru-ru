---
title: "Локальные функции или лямбда-выражения"
description: "Чем локальные функции могут быть лучше лямбда-выражений"
keywords: "C# .NET, .NET Core, новейшие возможности, новые локальные функции, лямбда-выражения"
author: BillWagner
ms.author: wiwagn
ms.date: 10/27/2016
ms.topic: article
ms.prod: visual-studio-dev-15
ms.technology: devlang-csharp
ms.devlang: csharp
ms.assetid: 368d1752-3659-489a-97b4-f15d87e49ae3
translationtype: Human Translation
ms.sourcegitcommit: a06bd2a17f1d6c7308fa6337c866c1ca2e7281c0
ms.openlocfilehash: bba2a8d183f928e298c452f6ec132f3eb9dffbd3
ms.lasthandoff: 03/13/2017

---

### <a name="local-functions-compared-to-lambda-expressions"></a>Сравнение локальных функций и лямбда-выражений

В некоторых случаях создавать и использовать лямбда-выражения можно, не создавая локальную функцию. Приведем пример асинхронного случая, который работает именно так:

[!code-csharp[TaskLambdaExample](../../samples/snippets/csharp/new-in-7/AsyncWork.cs#36_TaskLambdaExample "Метод с лямбда-выражением, возвращающий задачу")]

В то же время по ряду причин применение локальных функций может быть предпочтительнее, чем определение и вызов лямбда-выражений.

Во-первых, для лямбда-выражений компилятору необходимо создавать анонимный класс и экземпляр этого класса, в котором будут храниться все переменные, попавшие в замыкание. Замыкание для этого лямбда-выражения содержит переменные `address`, `index` и `name`. 

Во-вторых лямбда-выражения реализуются путем создания экземпляра делегата и вызова этого делегата. Локальные функции реализуются как вызовы методов.
Создание экземпляра, необходимое для лямбда-выражений, означает выделение дополнительной памяти, что в критически важном коде может ухудшить производительность.
Локальные функции не создают этой перегрузки.

В-третьих, локальные функции можно вызывать прежде, чем они будут определены. Лямбда-выражения перед определением необходимо объявлять. Это значит, что локальные функции проще использовать в рекурсивных алгоритмах:

[!code-csharp[LocalFunctionFactorial](../../samples/snippets/csharp/new-in-7/MathUtilities.cs#37_LocalFunctionFactorial "Рекурсивный факториал с использованием локальной функции")]

Сравните эту реализацию с версией, в которой используются лямбда-выражения:

[!code-csharp[26_LambdaFactorial](../../samples/snippets/csharp/new-in-7/MathUtilities.cs#38_LambdaFactorial "Рекурсивный факториал с использованием лямбда-выражений")]

Обратите внимание на то, что версия с использованием лямбда-выражения должна объявить и инициализировать лямбда-выражение `nthFactorial`, прежде чем его определить. В противном случае возникает ошибка компилятора, связанная со ссылкой на объект `nthFactorial`, который еще не был назначен.
Рекурсивные алгоритмы легче создавать, используя локальные функции. 

Локальные функции могут показаться избыточными для лямбда-выражений, поскольку обычно применяются иначе и в других целях.
Локальные функции более эффективны в случаях, когда вам нужно написать функцию, которая будет вызываться только из контекста другого метода.


