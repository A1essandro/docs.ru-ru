---
title: "Выполнение внутренних соединений"
description: "Выполнение внутренних соединений."
keywords: .NET, .NET Core, C#
author: BillWagner
manager: wpickett
ms.author: wiwagn
ms.date: 12/1/2016
ms.topic: article
ms.prod: .net-core
ms.technology: .net-core-technologies
ms.devlang: dotnet
ms.assetid: 45bceed6-f549-4114-a9b1-b44feb497742
ms.translationtype: HT
ms.sourcegitcommit: 306c608dc7f97594ef6f72ae0f5aaba596c936e1
ms.openlocfilehash: 2b73b954dbb090484a320302a3af72509fccd9d3
ms.contentlocale: ru-ru
ms.lasthandoff: 07/28/2017

---
# <a name="perform-inner-joins"></a><span data-ttu-id="541c9-104">Выполнение внутренних соединений</span><span class="sxs-lookup"><span data-stu-id="541c9-104">Perform inner joins</span></span>

<span data-ttu-id="541c9-105">В терминах реляционных баз данных *внутреннее соединение* формирует результирующий набор, в котором каждый элемент первой коллекции отображается по одному разу для каждого соответствующего элемента во второй коллекции.</span><span class="sxs-lookup"><span data-stu-id="541c9-105">In relational database terms, an *inner join* produces a result set in which each element of the first collection appears one time for every matching element in the second collection.</span></span> <span data-ttu-id="541c9-106">Если для элемента в первой коллекции нет соответствующих элементов, он не отображается в результирующем наборе.</span><span class="sxs-lookup"><span data-stu-id="541c9-106">If an element in the first collection has no matching elements, it does not appear in the result set.</span></span> <span data-ttu-id="541c9-107">Метод <xref:System.Linq.Enumerable.Join%2A>, который вызывается предложением `join` в C#, реализует внутреннее соединение.</span><span class="sxs-lookup"><span data-stu-id="541c9-107">The <xref:System.Linq.Enumerable.Join%2A> method, which is called by the `join` clause in C#, implements an inner join.</span></span>  
  
 <span data-ttu-id="541c9-108">В этом разделе показано выполнение четырех видов внутреннего соединения:</span><span class="sxs-lookup"><span data-stu-id="541c9-108">This topic shows you how to perform four variations of an inner join:</span></span>  
  
-   <span data-ttu-id="541c9-109">Простое внутреннее соединение, сопоставляющее элементы из двух источников данных на основе простого ключа.</span><span class="sxs-lookup"><span data-stu-id="541c9-109">A simple inner join that correlates elements from two data sources based on a simple key.</span></span>  
  
-   <span data-ttu-id="541c9-110">Внутреннее соединение, сопоставляющее элементы из двух источников данных на основе *составного* ключа.</span><span class="sxs-lookup"><span data-stu-id="541c9-110">An inner join that correlates elements from two data sources based on a *composite* key.</span></span> <span data-ttu-id="541c9-111">Составной ключ — это ключ, который состоит из нескольких значений, позволяющих сопоставлять элементы на основе сразу нескольких свойств.</span><span class="sxs-lookup"><span data-stu-id="541c9-111">A composite key, which is a key that consists of more than one value, enables you to correlate elements based on more than one property.</span></span>  
  
-   <span data-ttu-id="541c9-112">*Множественное соединение*, при котором несколько последовательных операций соединения добавляются друг к другу.</span><span class="sxs-lookup"><span data-stu-id="541c9-112">A *multiple join* in which successive join operations are appended to each other.</span></span>  
  
-   <span data-ttu-id="541c9-113">Внутреннее соединение, реализуемое с помощью группового соединения.</span><span class="sxs-lookup"><span data-stu-id="541c9-113">An inner join that is implemented by using a group join.</span></span>  
  
## <a name="example"></a><span data-ttu-id="541c9-114">Пример</span><span class="sxs-lookup"><span data-stu-id="541c9-114">Example</span></span>  
  
## <a name="simple-key-join-example"></a><span data-ttu-id="541c9-115">Пример соединения по простому ключу</span><span class="sxs-lookup"><span data-stu-id="541c9-115">Simple key join example</span></span>  
 <span data-ttu-id="541c9-116">В следующем примере создаются две коллекции, содержащие объекты двух определяемых пользователем типов, `Person` и `Pet`.</span><span class="sxs-lookup"><span data-stu-id="541c9-116">The following example creates two collections that contain objects of two user-defined types, `Person` and `Pet`.</span></span> <span data-ttu-id="541c9-117">Запрос включает предложение `join` в C# для сопоставления объектов `Person` с объектами `Pet`, где `Owner` — это `Person`.</span><span class="sxs-lookup"><span data-stu-id="541c9-117">The query uses the `join` clause in C# to match `Person` objects with `Pet` objects whose `Owner` is that `Person`.</span></span> <span data-ttu-id="541c9-118">Предложение `select` в C# определяет, как будут выглядеть результирующие объекты.</span><span class="sxs-lookup"><span data-stu-id="541c9-118">The `select` clause in C# defines how the resulting objects will look.</span></span> <span data-ttu-id="541c9-119">В этом примере результирующие объекты — это анонимные типы, состоящие из имени владельца и его домашнего животного.</span><span class="sxs-lookup"><span data-stu-id="541c9-119">In this example the resulting objects are anonymous types that consist of the owner's first name and the pet's name.</span></span>  
  
 <span data-ttu-id="541c9-120">[!code-cs[CsLINQProgJoining#1](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_1.cs)]</span><span class="sxs-lookup"><span data-stu-id="541c9-120">[!code-cs[CsLINQProgJoining#1](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_1.cs)]</span></span>  
  
 <span data-ttu-id="541c9-121">Обратите внимание на то, что объект `Person`, параметр `LastName` которого имеет значение "Huff", не отображается в результирующем наборе, поскольку нет объекта `Pet`, параметр `Pet.Owner` которого совпадает с этим объектом `Person`.</span><span class="sxs-lookup"><span data-stu-id="541c9-121">Note that the `Person` object whose `LastName` is "Huff" does not appear in the result set because there is no `Pet` object that has `Pet.Owner` equal to that `Person`.</span></span>  
  
## <a name="example"></a><span data-ttu-id="541c9-122">Пример</span><span class="sxs-lookup"><span data-stu-id="541c9-122">Example</span></span>  
  
## <a name="composite-key-join-example"></a><span data-ttu-id="541c9-123">Пример соединения по составному ключу</span><span class="sxs-lookup"><span data-stu-id="541c9-123">Composite key join example</span></span>  
 <span data-ttu-id="541c9-124">Вместо сопоставления элементов по одному единственному свойству можно воспользоваться составным ключом и сравнить элементы по нескольким свойствам.</span><span class="sxs-lookup"><span data-stu-id="541c9-124">Instead of correlating elements based on just one property, you can use a composite key to compare elements based on multiple properties.</span></span> <span data-ttu-id="541c9-125">Для этого задайте функцию селектора ключа для каждой коллекции, чтобы вернуть анонимный тип, состоящий из свойств, которые вы хотите сравнить.</span><span class="sxs-lookup"><span data-stu-id="541c9-125">To do this, specify the key selector function for each collection to return an anonymous type that consists of the properties you want to compare.</span></span> <span data-ttu-id="541c9-126">Если свойства помечаются, они должны иметь одинаковую метку в анонимном типе каждого ключа.</span><span class="sxs-lookup"><span data-stu-id="541c9-126">If you label the properties, they must have the same label in each key's anonymous type.</span></span> <span data-ttu-id="541c9-127">Кроме того, свойства должны отображаться в одинаковом порядке.</span><span class="sxs-lookup"><span data-stu-id="541c9-127">The properties must also appear in the same order.</span></span>  
  
 <span data-ttu-id="541c9-128">В следующем примере на основе списка объектов `Employee` и списка объектов `Student` определяется, какие работники также являются студентами.</span><span class="sxs-lookup"><span data-stu-id="541c9-128">The following example uses a list of `Employee` objects and a list of `Student` objects to determine which employees are also students.</span></span> <span data-ttu-id="541c9-129">Оба этих типа имеют свойства `FirstName` и `LastName` типа <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="541c9-129">Both of these types have a `FirstName` and a `LastName` property of type <xref:System.String>.</span></span> <span data-ttu-id="541c9-130">Функции, создающие ключи соединения из каждого элемента в списке, возвращают анонимный тип, состоящий из свойств `FirstName` и `LastName` каждого элемента.</span><span class="sxs-lookup"><span data-stu-id="541c9-130">The functions that create the join keys from each list's elements return an anonymous type that consists of the `FirstName` and `LastName` properties of each element.</span></span> <span data-ttu-id="541c9-131">Операция соединения сравнивает эти составные ключи на предмет равенства и возвращает пары объектов из каждого списка, в которых имя и фамилия совпадают.</span><span class="sxs-lookup"><span data-stu-id="541c9-131">The join operation compares these composite keys for equality and returns pairs of objects from each list where both the first name and the last name match.</span></span>  
  
 <span data-ttu-id="541c9-132">[!code-cs[CsLINQProgJoining#2](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_2.cs)]</span><span class="sxs-lookup"><span data-stu-id="541c9-132">[!code-cs[CsLINQProgJoining#2](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_2.cs)]</span></span>  
  
## <a name="example"></a><span data-ttu-id="541c9-133">Пример</span><span class="sxs-lookup"><span data-stu-id="541c9-133">Example</span></span>  
  
## <a name="multiple-join-example"></a><span data-ttu-id="541c9-134">Пример множественного соединения</span><span class="sxs-lookup"><span data-stu-id="541c9-134">Multiple join example</span></span>  
 <span data-ttu-id="541c9-135">Для выполнения множественного соединения можно соединять друг с другом любое количество операций соединения.</span><span class="sxs-lookup"><span data-stu-id="541c9-135">Any number of join operations can be appended to each other to perform a multiple join.</span></span> <span data-ttu-id="541c9-136">Каждое предложение `join` в C# сопоставляет указанный источник данных с результатами предыдущего соединения.</span><span class="sxs-lookup"><span data-stu-id="541c9-136">Each `join` clause in C# correlates a specified data source with the results of the previous join.</span></span>  
  
 <span data-ttu-id="541c9-137">В следующем примере создаются три коллекции: список объектов `Person`, список объектов `Cat` и список объектов `Dog`.</span><span class="sxs-lookup"><span data-stu-id="541c9-137">The following example creates three collections: a list of `Person` objects, a list of `Cat` objects, and a list of `Dog` objects.</span></span>  
  
 <span data-ttu-id="541c9-138">Первое предложение `join` в C# сопоставляет людей и кошек, сравнивая объекты `Person` `Cat.Owner`.</span><span class="sxs-lookup"><span data-stu-id="541c9-138">The first `join` clause in C# matches people and cats based on a `Person` object matching `Cat.Owner`.</span></span> <span data-ttu-id="541c9-139">Оно возвращает последовательность анонимных типов, содержащих объект `Person` и `Cat.Name`.</span><span class="sxs-lookup"><span data-stu-id="541c9-139">It returns a sequence of anonymous types that contain the `Person` object and `Cat.Name`.</span></span>  
  
 <span data-ttu-id="541c9-140">Второе предложение `join` в C# сопоставляет анонимные типы, возвращаемые первым соединением, с объектами `Dog` в предоставленном списке собак на основе ключа, состоящего из свойства `Owner` типа `Person` и первой буквы имени животного.</span><span class="sxs-lookup"><span data-stu-id="541c9-140">The second `join` clause in C# correlates the anonymous types returned by the first join with `Dog` objects in the supplied list of dogs, based on a composite key that consists of the `Owner` property of type `Person`, and the first letter of the animal's name.</span></span> <span data-ttu-id="541c9-141">Оно возвращает последовательность анонимных типов, содержащих свойства `Cat.Name` и `Dog.Name` из каждой совпадающей пары.</span><span class="sxs-lookup"><span data-stu-id="541c9-141">It returns a sequence of anonymous types that contain the `Cat.Name` and `Dog.Name` properties from each matching pair.</span></span> <span data-ttu-id="541c9-142">Поскольку это внутреннее соединение, возвращаются только объекты из первого источника данных, имеющие соответствие во втором источнике данных.</span><span class="sxs-lookup"><span data-stu-id="541c9-142">Because this is an inner join, only those objects from the first data source that have a match in the second data source are returned.</span></span>  
  
 <span data-ttu-id="541c9-143">[!code-cs[CsLINQProgJoining#3](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_3.cs)]</span><span class="sxs-lookup"><span data-stu-id="541c9-143">[!code-cs[CsLINQProgJoining#3](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_3.cs)]</span></span>  
  
## <a name="example"></a><span data-ttu-id="541c9-144">Пример</span><span class="sxs-lookup"><span data-stu-id="541c9-144">Example</span></span>  
  
## <a name="inner-join-by-using-grouped-join-example"></a><span data-ttu-id="541c9-145">Пример внутреннего соединения с использованием группового соединения</span><span class="sxs-lookup"><span data-stu-id="541c9-145">Inner join by using grouped join example</span></span>  
 <span data-ttu-id="541c9-146">В следующем примере показано, как реализовать внутреннее соединение с помощью группового соединения.</span><span class="sxs-lookup"><span data-stu-id="541c9-146">The following example shows you how to implement an inner join by using a group join.</span></span>  
  
 <span data-ttu-id="541c9-147">В `query1` список объектов `Person` группируется со списком объектов `Pet` на основе сравнения свойства объекта `Person` со свойством `Pet.Owner`.</span><span class="sxs-lookup"><span data-stu-id="541c9-147">In `query1`, the list of `Person` objects is group-joined to the list of `Pet` objects based on the `Person` matching the `Pet.Owner` property.</span></span> <span data-ttu-id="541c9-148">Групповое соединение создает коллекцию промежуточных групп, где каждая группа состоит из объекта `Person` и последовательности соответствующих ему объектов `Pet`.</span><span class="sxs-lookup"><span data-stu-id="541c9-148">The group join creates a collection of intermediate groups, where each group consists of a `Person` object and a sequence of matching `Pet` objects.</span></span>  
  
 <span data-ttu-id="541c9-149">Если в запрос добавляется второе предложение `from`, этот ряд последовательностей объединяется (или сводится) в одну более длинную последовательность.</span><span class="sxs-lookup"><span data-stu-id="541c9-149">By adding a second `from` clause to the query, this sequence of sequences is combined (or flattened) into one longer sequence.</span></span> <span data-ttu-id="541c9-150">Тип элементов конечной последовательности определяется предложением `select`.</span><span class="sxs-lookup"><span data-stu-id="541c9-150">The type of the elements of the final sequence is specified by the `select` clause.</span></span> <span data-ttu-id="541c9-151">В данном примере этот тип является анонимным и состоит из свойств `Person.FirstName` и `Pet.Name` для каждой совпадающей пары.</span><span class="sxs-lookup"><span data-stu-id="541c9-151">In this example, that type is an anonymous type that consists of the `Person.FirstName` and `Pet.Name` properties for each matching pair.</span></span>  
  
 <span data-ttu-id="541c9-152">Результат `query1` эквивалентен результирующему набору, который можно было бы получить, выполнив внутреннее соединение с помощью предложения `join` без предложения `into`.</span><span class="sxs-lookup"><span data-stu-id="541c9-152">The result of `query1` is equivalent to the result set that would have been obtained by using the `join` clause without the `into` clause to perform an inner join.</span></span> <span data-ttu-id="541c9-153">Переменная `query2` демонстрирует этот эквивалентный запрос.</span><span class="sxs-lookup"><span data-stu-id="541c9-153">The `query2` variable demonstrates this equivalent query.</span></span>  
  
 <span data-ttu-id="541c9-154">[!code-cs[CsLINQProgJoining#4](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_4.cs)]</span><span class="sxs-lookup"><span data-stu-id="541c9-154">[!code-cs[CsLINQProgJoining#4](../../../samples/snippets/csharp/concepts/linq/how-to-perform-inner-joins_4.cs)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="541c9-155">См. также</span><span class="sxs-lookup"><span data-stu-id="541c9-155">See also</span></span>  
 <span data-ttu-id="541c9-156"><xref:System.Linq.Enumerable.Join%2A></span><span class="sxs-lookup"><span data-stu-id="541c9-156"><xref:System.Linq.Enumerable.Join%2A></span></span>   
 <span data-ttu-id="541c9-157"><xref:System.Linq.Enumerable.GroupJoin%2A></span><span class="sxs-lookup"><span data-stu-id="541c9-157"><xref:System.Linq.Enumerable.GroupJoin%2A></span></span>   
 <span data-ttu-id="541c9-158">[Выполнение групповых соединений](perform-grouped-joins.md) </span><span class="sxs-lookup"><span data-stu-id="541c9-158">[Perform grouped joins](perform-grouped-joins.md) </span></span>  
 <span data-ttu-id="541c9-159">[Выполнение левых внешних соединений](perform-left-outer-joins.md) </span><span class="sxs-lookup"><span data-stu-id="541c9-159">[Perform left outer joins](perform-left-outer-joins.md) </span></span>  
 [<span data-ttu-id="541c9-160">Анонимные типы</span><span class="sxs-lookup"><span data-stu-id="541c9-160">Anonymous types</span></span>](../programming-guide/classes-and-structs/anonymous-types.md)   
 

