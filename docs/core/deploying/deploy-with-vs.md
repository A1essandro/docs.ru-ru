---
title: "Развертывание приложений .NET Core с помощью Visual Studio"
description: "Сведения о развертывании приложений .NET Core с помощью Visual Studio"
keywords: ".NET, .NET Core, разработка .NET Core"
author: rpetrusha
ms.author: ronpet
ms.date: 04/18/2017
ms.topic: article
ms.prod: .net-core
ms.devlang: dotnet
ms.assetid: 01049a21-fd50-4419-9ab2-0e4a2e091050
ms.translationtype: HT
ms.sourcegitcommit: b647c5dc4e565f9813212d75fab4a2e46c1a47b9
ms.openlocfilehash: 19f5234ce667b2064a1e5b3fb50222c1ef4fe2a5
ms.contentlocale: ru-ru
ms.lasthandoff: 09/12/2017

---

# <a name="deploying-net-core-apps-with-visual-studio"></a>Развертывание приложений .NET Core с помощью Visual Studio

Приложение .NET Core можно развернуть как *развертывание, зависящее от платформы*, которое содержит двоичные файлы приложений, но зависит от наличия .NET Core в целевой системе, или как *автономное развертывание*, которое содержит и приложение, и двоичные файлы .NET Core. Общие сведения о развертывании приложений .NET Core см. в разделе [Развертывание приложений .NET Core](index.md).

В разделах ниже содержатся сведения об использовании Microsoft Visual Studio для создания следующих типов развертывания:

- развертывание, зависящее от платформы;
- развертывание, зависящее от платформы, с зависимостями сторонних разработчиков;
- автономное развертывание;
- автономное развертывание с зависимостями сторонних разработчиков;

Сведения об использовании Visual Studio для разработки приложений .NET Core см. в разделе [Необходимые компоненты для .NET Core в Windows](../windows-prerequisites.md#prerequisites-with-visual-studio-2017).

## <a name="framework-dependent-deployment"></a>развертывание, зависящее от платформы;

Если развертывание, зависящее от платформы, не содержит зависимостей сторонних разработчиков, то необходимо просто выполнить сборку, протестировать и опубликовать приложение. Проиллюстрируем этот процесс на примере простого приложения, написанного на языке C#.  

1. создание проекта;

   Выберите **Файл** > **Создать** > **Проект**. В диалоговом окне **Новый проект** выберите **.NET Core** на панели типов проекта **Установленные**, а затем на центральной панели выберите шаблон **Консольное приложение (.NET Core)**. В поле **Имя** введите имя проекта, например "FDD". Нажмите кнопку **OK**.

1. Добавьте исходный код приложения.

   Откройте файл *Program.cs* в редакторе и замените автоматически созданный код приведенным ниже кодом. Он выводит запрос на ввод текста и отображает отдельные слова, введенные пользователем. Для разделения слов во введенном тексте в нем используется регулярное выражение `\w+`.

   [!code-cs[deployment#1](../../../samples/snippets/core/deploying/deployment-example.cs)]

1. Создайте отладочную сборку приложения.

   Выберите **Сборка** > **Собрать решение**. Также можно скомпилировать и выполнить отладочную сборку приложения, выбрав **Отладка** > **Начать отладку**.

1. Разверните приложение.

   Отладив и протестировав программу, создайте файлы, которые будут развертываться с приложением. Для публикации из Visual Studio выполните следующие действия.

      1. На панели инструментов измените конфигурацию решения с **Отладка** на **Выпуск**, чтобы собрать версию выпуска (а не отладочную версию) приложения.

      1. Щелкните правой кнопкой мыши проект (не решение) в **обозревателе решений** и выберите **Опубликовать**.

      1. На вкладке **Публикация** выберите **Опубликовать**. Visual Studio записывает файлы, которые составляют приложение, в локальную файловую систему.

      1. Теперь на вкладке **Публикация** отображается один профиль — **FolderProfile**. Параметры конфигурации профиля отображаются на вкладке в разделе **Сводка**.

   Итоговые файлы помещаются в каталог с именем `PublishOutput`, который находится в подкаталоге каталога *\bin\release* проекта.

Помимо файлов приложения, процесс публикации создает файл базы данных программы (PDB), который содержит отладочную информацию о приложении. Файл используется в основном для отладки исключений. Его можно не упаковывать вместе с файлами приложения. Однако его следует сохранить на случай, если потребуется выполнить отладку сборки выпуска приложения.

Любым способом разверните полный набор файлов приложения. Например, их можно упаковать в ZIP-файл, использовать простую команду `copy` или развернуть их с помощью любого установочного пакета на ваш выбор. После установки пользователи могут выполнять приложение с помощью команды `dotnet`, указав имя файла приложения, например `dotnet fdd.dll`.

Помимо двоичных файлов приложения, установщик должен либо включать в себя установщик общей платформы, либо проверять наличие платформы в процессе установки приложения.  Установка общей платформы требует наличия прав администратор или root, так как она производится на уровне всего компьютера.

## <a name="framework-dependent-deployment-with-third-party-dependencies"></a>развертывание, зависящее от платформы, с зависимостями сторонних разработчиков;

Для зависящего от платформы развертывания с одной или более зависимостями сторонних разработчиков требуется, чтобы зависимости были доступны в проекте. Перед сборкой приложения следует выполнить два дополнительных действия.

1. С помощью **диспетчера пакетов NuGet** добавьте ссылку на пакет NuGet в проект, а если пакет еще недоступен в системе, установите его. Чтобы открыть диспетчер пакетов, последовательно выберите **Сервис** > **Диспетчер пакетов NuGet** > **Управление пакетами NuGet для решения**.

1. Убедитесь, что `Newtonsoft.Json` установлен в системе, и если нет, установите его. На вкладке **Установленные** перечислены пакеты NuGet, установленные в системе. Если `Newtonsoft.Json` отсутствует в списке, откройте вкладку **Обзор** и введите "Newtonsoft.Json" в поле поиска. Выберите `Newtonsoft.Json` и в области справа выберите проект, прежде чем нажать кнопку **Установить**.

1. Если `Newtonsoft.Json` уже установлен в системе, добавьте его в проект, выбрав проект в правой области на вкладке **Управление пакетами для решения**.

Имейте в виду, что переносимость зависящего от платформы развертывания с зависимостями сторонних разработчиков напрямую зависит от переносимости этих зависимостей. Например, если библиотека стороннего разработчика поддерживает только Mac OS, приложение нельзя перенести в системы Windows. Это происходит, если зависимость стороннего разработчика сама зависит от машинного кода. Хорошим примером является [сервер Kestrel](http://docs.microsoft.com/aspnet/core/fundamentals/servers/kestrel), требующий собственной зависимости от [libuv](https://github.com/libuv/libuv). Когда зависящее от платформы развертывание создается для приложения с таким типом зависимости стороннего разработчика, опубликованные выходные данные содержат папку для каждого [идентификатора среды выполнения (RID)](../rid-catalog.md), поддерживаемого зависимостью (и имеющегося в ее пакете NuGet).

## <a name="simpleSelf"></a> Автономное развертывание без зависимостей сторонних разработчиков

Выполнение автономного развертывания без зависимостей сторонних разработчиков предполагает создание проекта, изменение файла *csproj*, сборку, тестирование и публикацию приложения. Проиллюстрируем этот процесс на примере простого приложения, написанного на языке C#. 

1. создание проекта;

   Выберите **Файл** > **Создать** > **Проект**. В диалоговом окне **Добавление нового проекта** выберите **.NET Core** на панели типов проекта **Установленные**, а затем на центральной панели выберите шаблон **Консольное приложение (.NET Core)**. В поле **Имя** введите имя проекта, например "SCD", а затем нажмите кнопку **ОК**.

1. Добавьте исходный код приложения.

   Откройте файл *Program.cs* в редакторе и замените автоматически созданный код приведенным ниже кодом. Он выводит запрос на ввод текста и отображает отдельные слова, введенные пользователем. Для разделения слов во введенном тексте в нем используется регулярное выражение `\w+`.

   [!code-cs[deployment#1](../../../samples/snippets/core/deploying/deployment-example.cs)]

1. Определите платформы, для которых будет предназначено приложение.

   1. Щелкните правой кнопкой мыши проект (не решение) в **обозревателе решений** и выберите **Изменить SCD.csproj**.

   1. В разделе `<PropertyGroup>` файла *csproj* создайте тег `<RuntimeIdentifiers>`, определяющий платформы, для которых предназначено приложение, и укажите идентификатор среды выполнения (RID) каждой целевой платформы. Обратите внимание, что для разделения идентификаторов RID необходимо добавлять точку с запятой. Список идентификаторов сред выполнения см. в [каталоге идентификаторов сред выполнения](../rid-catalog.md). 

   Например, приведенный ниже пример указывает, что приложение выполняется в 64-разрядной операционной системе Windows 10 и в 64-разрядной операционной системе OS X 10.11.

```xml
<PropertyGroup>
    <RuntimeIdentifiers>win10-x64;osx.10.11-x64</RuntimeIdentifiers>
</PropertyGroup>
```
   Также обратите внимание, что элемент `<RuntimeIdentifiers>` можно переносить в другие группы `<PropertyGroup>` в пределах файла *csproj*. Полный пример файла *csproj* будет приведен далее в этом разделе.

1. Создайте отладочную сборку приложения.

   Выберите **Сборка** > **Собрать решение**. Также можно скомпилировать и выполнить отладочную сборку приложения, выбрав **Отладка** > **Начать отладку**.

1. Опубликуйте приложение.

   Отладив и протестировав программу, создайте файлы, которые будут развертываться с приложением, для каждой целевой платформы.

   Для публикации приложения из Visual Studio выполните следующие действия.

      1. На панели инструментов измените конфигурацию решения с **Отладка** на **Выпуск**, чтобы собрать версию выпуска (а не отладочную версию) приложения.

      1. Щелкните правой кнопкой мыши проект (не решение) в **обозревателе решений** и выберите **Опубликовать**. 

      1. На вкладке **Публикация** выберите **Опубликовать**. Visual Studio записывает файлы, которые составляют приложение, в локальную файловую систему.

      1. Теперь на вкладке **Публикация** отображается один профиль — **FolderProfile**. Параметры конфигурации профиля отображаются на вкладке в разделе **Сводка**. Параметр **Целевая среда выполнения** определяет, какая среда выполнения была опубликована, а параметр **Целевое расположение** определяет, куда были записаны файлы автономного развертывания.

      1. По умолчанию Visual Studio записывает все опубликованные файлы в один каталог. Для удобства рекомендуется создать отдельные профили для каждой целевой среды выполнения и размещать опубликованные файлы в каталоге для определенной платформы. Это предполагает создание отдельного профиля публикации для каждой целевой платформы. Теперь выполните повторную сборку приложения для каждой платформы следующим образом.

         1. Выберите **Создать новый профиль** в диалоговом окне **Публикация**.

         1. В диалоговом окне **Выберите целевой объект публикации** измените расположение в поле **Выберите папку** на *bin\Release\PublishOutput\win10-x64*. Нажмите кнопку **ОК**.

         1. В списке профилей выберите новый профиль (**FolderProfile1**) и убедитесь, что параметр **Целевая среда выполнения** имеет значение `win10-x64`. В противном случае выберите **Параметры**. В диалоговом окне **Параметры профиля** измените значение параметра **Целевая среда выполнения** на `win10-x64`, а затем нажмите кнопку **Сохранить**. В противном случае нажмите кнопку **Отмена**.

         1. Выберите **Опубликовать**, чтобы опубликовать приложение для 64-разрядных платформ Windows 10.

         1. Выполните приведенные выше шаги еще раз, чтобы создать профиль для платформы `osx.10.11-x64`. Параметр **Целевое расположение** имеет значение *bin\Release\PublishOutput\osx.10.11-x64*, а параметр **Целевая среда выполнения** — `osx.10.11-x64`. Visual Studio присваивает этому профилю имя **FolderProfile2**.

      Обратите внимание на то, что каждое целевое расположение содержит полный набор файлов (как файлов приложения, так и всех файлов .NET Core), необходимых для запуска приложения.

Помимо файлов приложения, процесс публикации создает файл базы данных программы (PDB), который содержит отладочную информацию о приложении. Файл используется в основном для отладки исключений. Его можно не упаковывать вместе с файлами приложения. Однако его следует сохранить на случай, если потребуется выполнить отладку сборки выпуска приложения.

Разверните опубликованные файлы любым способом. Например, их можно упаковать в ZIP-файл, использовать простую команду `copy` или развернуть их с помощью любого установочного пакета на ваш выбор.

Ниже приведено полное содержимое файла *csproj* для этого проекта.

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>netcoreapp1.1</TargetFramework>
    <RuntimeIdentifiers>win10-x64;osx.10.11-x64</RuntimeIdentifiers>
  </PropertyGroup>
</Project>
```

## <a name="self-contained-deployment-with-third-party-dependencies"></a>автономное развертывание с зависимостями сторонних разработчиков;

Выполнение автономного развертывания с одной или несколькими зависимостями сторонних разработчиков предполагает добавление этих зависимостей. Перед сборкой приложения следует выполнить два дополнительных действия.

1. С помощью **диспетчера пакетов NuGet** добавьте ссылку на пакет NuGet в проект, а если пакет еще недоступен в системе, установите его. Чтобы открыть диспетчер пакетов, последовательно выберите **Сервис** > **Диспетчер пакетов NuGet** > **Управление пакетами NuGet для решения**.

1. Убедитесь, что `Newtonsoft.Json` установлен в системе, и если нет, установите его. На вкладке **Установленные** перечислены пакеты NuGet, установленные в системе. Если `Newtonsoft.Json` отсутствует в списке, откройте вкладку **Обзор** и введите "Newtonsoft.Json" в поле поиска. Выберите `Newtonsoft.Json` и в области справа выберите проект, прежде чем нажать кнопку **Установить**.

1. Если `Newtonsoft.Json` уже установлен в системе, добавьте его в проект, выбрав проект в правой области на вкладке **Управление пакетами для решения**.

Ниже приведено полное содержимое файла *csproj* для этого проекта:

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>netcoreapp1.1</TargetFramework>
    <RuntimeIdentifiers>win10-x64;osx.10.11-x64</RuntimeIdentifiers>
  </PropertyGroup>
  <ItemGroup>
    <PackageReference Include="Newtonsoft.Json" Version="10.0.2" />
  </ItemGroup>
</Project>
```

При развертывании приложения все зависимости сторонних разработчиков, используемые в нем, также содержатся в файлах приложения. Библиотеки сторонних разработчиков не требуются в системе, в которой выполняется приложение.

Имейте в виду, что автономное развертывание с библиотекой стороннего разработчика возможно только на платформах, которые поддерживаются этой библиотекой. Это похоже на наличие сторонних зависимостей с собственными зависимостями в развертывании, зависящем от платформы, где собственные зависимости существуют в целевой платформе, только если они были установлены в ней ранее.

# <a name="see-also"></a>См. также
[Развертывание приложений .NET Core](index.md)   
[Каталог идентификаторов сред выполнения (RID) в .NET Core](../rid-catalog.md)   

