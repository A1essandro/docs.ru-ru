---
title: Развертывание приложений .NET Core с помощью средств интерфейса командной строки
description: Сведения о развертывании приложений .NET Core с помощью средств интерфейса командной строки (CLI)
author: rpetrusha
ms.author: ronpet
ms.date: 04/18/2017
ms.openlocfilehash: 7b009068422686442ebff83b9400c365f34a3154
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="deploying-net-core-apps-with-command-line-interface-cli-tools"></a>Развертывание приложений .NET Core с помощью средств командной строки (CLI)

Приложение .NET Core можно развернуть как *развертывание, зависящее от платформы*, которое содержит двоичные файлы приложений, но зависит от наличия .NET Core в целевой системе, или как *автономное развертывание*, которое содержит и приложение, и двоичные файлы .NET Core. Общие сведения см. в разделе [Развертывание приложений .NET Core](index.md).

В разделах ниже содержатся сведения об использовании [средств интерфейса командной строки .NET Core](../tools/index.md) для создания следующих типов развертывания:

- развертывание, зависящее от платформы;
- развертывание, зависящее от платформы, с зависимостями сторонних разработчиков;
- автономное развертывание;
- Автономное развертывание с зависимостями сторонних разработчиков

При работе из командной строки можно использовать выбранный по своему усмотрению редактор кода. Если в качестве редактора используется [Visual Studio Code](https://code.visualstudio.com), можно открыть консоль командной строки в среде Visual Studio Code, выбрав **Вид** > **Интегрированный терминал**.

## <a name="framework-dependent-deployment"></a>развертывание, зависящее от платформы;

Если развертывание, зависящее от платформы, не содержит зависимостей сторонних разработчиков, то необходимо просто выполнить сборку, протестировать и опубликовать приложение. Проиллюстрируем этот процесс на примере простого приложения, написанного на языке C#. 

1. Создайте каталог проекта.

   Создайте каталог для проекта и сделайте его текущим каталогом.

1. создание проекта;

   В командной строке введите [dotnet new](../tools/dotnet-new.md), чтобы создать проект консольного приложения C# в этом каталоге.

1. Добавление исходного кода приложения.

   Откройте файл *Program.cs* в редакторе и замените автоматически созданный код приведенным ниже кодом. Он выводит запрос на ввод текста и отображает отдельные слова, введенные пользователем. Для разделения слов во введенном тексте в нем используется регулярное выражение `\w+`.

   [!code-csharp[deployment#1](../../../samples/snippets/core/deploying/deployment-example.cs)]

1. Обновление зависимостей и средств проекта.
 
   Запустите [dotnet restore](../tools/dotnet-restore.md) ([см. Примечание](#dotnet-restore-note)) для восстановления зависимостей, указанных в проекте.

1. Создание отладочной сборки приложения.

   Используйте команду [dotnet build](../tools/dotnet-build.md), чтобы построить приложение, или команду [dotnet run](../tools/dotnet-run.md), чтобы построить приложение и запустить его.

1. Развертывание приложения.

   После отладки и тестирования программы создайте развертывание с помощью следующей команды:

      ```console
      dotnet publish -f netcoreapp1.1 -c Release
      ```
   При этом создается версия выпуска приложения (а не отладочная версия). Итоговые файлы помещаются в каталог с именем *publish*, который находится в подкаталоге каталога *bin* проекта.

   Помимо файлов приложения, процесс публикации создает файл базы данных программы (PDB), который содержит отладочную информацию о приложении. Файл используется в основном для отладки исключений. Его можно не распространять вместе с файлами приложения. Однако его следует сохранить на случай, если потребуется выполнить отладку сборки выпуска приложения.

   Полный набор файлов приложения можно развернуть любым способом, каким вы хотите. Например, их можно упаковать в ZIP-файл, использовать простую команду `copy` или развернуть их с помощью любого установочного пакета на ваш выбор.

1. Запуск приложения

   После установки пользователи могут выполнять приложение с помощью команды `dotnet`, указав имя файла приложения, например `dotnet fdd.dll`.

   Помимо двоичных файлов приложения, установщик должен либо включать в себя установщик общей платформы, либо проверять наличие платформы в процессе установки приложения.  Установка общей платформы требует наличия прав администратора или прав root.

## <a name="framework-dependent-deployment-with-third-party-dependencies"></a>Развертывание, зависящее от платформы, с зависимостями сторонних разработчиков

Для зависящего от платформы развертывания с одной или более зависимостями сторонних разработчиков требуется, чтобы эти зависимости были доступны в проекте. Требуется выполнить два дополнительных шага, прежде чем запускать команду `dotnet restore` ([см. Примечание](#dotnet-restore-note)):

1. Добавьте ссылки на требуемые библиотеки сторонних разработчиков в раздел `<ItemGroup>` файла *csproj*. В следующем разделе `<ItemGroup>` в качестве библиотеки стороннего разработчика используется зависимость от [Json.NET](http://www.newtonsoft.com/json).

      ```xml
      <ItemGroup>
        <PackageReference Include="Newtonsoft.Json" Version="10.0.2" />
      </ItemGroup>
      ```

1. Скачайте пакет NuGet, содержащий зависимость стороннего разработчика, в систему, если вы этого еще не сделали. Чтобы скачать пакет, выполните команду `dotnet restore` ([см. примечание](#dotnet-restore-note)) после добавления зависимости. Так как зависимость разрешается из локального кэша NuGet во время публикации, она должна быть доступна в системе.

Имейте в виду, что переносимость зависящего от платформы развертывания с зависимостями сторонних разработчиков напрямую зависит от переносимости этих зависимостей. Например, если библиотека стороннего разработчика поддерживает только Mac OS, приложение нельзя перенести в системы Windows. Это происходит, если зависимость стороннего разработчика сама зависит от машинного кода. Хорошим примером является [сервер Kestrel](/aspnet/core/fundamentals/servers/kestrel), требующий собственной зависимости от [libuv](https://github.com/libuv/libuv). Когда зависящее от платформы развертывание создается для приложения с таким типом зависимости стороннего разработчика, опубликованные выходные данные содержат папку для каждого [идентификатора среды выполнения (RID)](../rid-catalog.md), поддерживаемого зависимостью (и имеющегося в ее пакете NuGet).

## <a name="simpleSelf"></a> Автономное развертывание без зависимостей сторонних разработчиков

Выполнение автономного развертывания без зависимостей сторонних разработчиков предполагает создание проекта, изменение файла *csproj*, сборку, тестирование и публикацию приложения. Проиллюстрируем этот процесс на примере простого приложения, написанного на языке C#. В примере показано создание автономного развертывания с помощью [dotnet utility](../tools/dotnet.md) из командной строки.

1. Создайте каталог для проекта.

   Создайте каталог для проекта и сделайте его текущим каталогом.

1. Создание проекта.

   В командной строке введите [dotnet new](../tools/dotnet-new.md), чтобы создать проект консольного приложения C# в этом каталоге.

1. Добавление исходного кода приложения.

   Откройте файл *Program.cs* в редакторе и замените автоматически созданный код приведенным ниже кодом. Он выводит запрос на ввод текста и отображает отдельные слова, введенные пользователем. Для разделения слов во введенном тексте в нем используется регулярное выражение `\w+`.

   [!code-csharp[deployment#1](../../../samples/snippets/core/deploying/deployment-example.cs)]

1. Определение платформ, для которых будет предназначено приложение.

   В разделе `<PropertyGroup>` файла *csproj* создайте тег `<RuntimeIdentifiers>`, определяющий платформы, для которых предназначено приложение, и укажите идентификатор среды выполнения (RID) для каждой целевой платформы. Обратите внимание, что для разделения идентификаторов RID необходимо добавлять точку с запятой. Список идентификаторов сред выполнения см. в [каталоге идентификаторов сред выполнения](../rid-catalog.md). 

   Например, приведенный ниже раздел `<PropertyGroup>` указывает, что приложение выполняется в 64-разрядной операционной системе Windows 10 и в 64-разрядной операционной системе OS X 10.11.

     ```xml
     <PropertyGroup>
         <RuntimeIdentifiers>win10-x64;osx.10.11-x64</RuntimeIdentifiers>
     </PropertyGroup>
     ```

   Обратите внимание, что элемент `<RuntimeIdentifiers>` может находиться в любом разделе `<PropertyGroup>` в файле *csproj*. Полный пример файла *csproj* будет приведен далее в этом разделе.

1. Обновление зависимостей и средств проекта.

   Запустите [dotnet restore](../tools/dotnet-restore.md) ([см. Примечание](#dotnet-restore-note)) для восстановления зависимостей, указанных в проекте.

1. Создание отладочной сборки приложения.

   Из командной строки запустите команду [dotnet build](../tools/dotnet-build.md).

1. Отладив и протестировав программу, создайте файлы, которые будут развертываться с приложением, для каждой целевой платформы.

   Используйте команду `dotnet publish` для обеих платформ, как показано ниже.

      ```console
      dotnet publish -c Release -r win10-x64
      dotnet publish -c Release -r osx.10.11-x64
      ```

   При этом создается версия выпуска приложения (а не отладочная версия) для каждой целевой платформы. Итоговые файлы помещаются в подкаталог с именем *publish*, который находится в подкаталоге *.\bin\Release\netcoreapp1.1 \<идентификатор_среды_выполнения>* каталога проекта. Обратите внимание на то, что каждый подкаталог содержит полный набор файлов (как файлов приложения, так и всех файлов .NET Core), необходимых для запуска приложения.

Помимо файлов приложения, процесс публикации создает файл базы данных программы (PDB), который содержит отладочную информацию о приложении. Файл используется в основном для отладки исключений. Его можно не упаковывать вместе с файлами приложения. Однако его следует сохранить на случай, если потребуется выполнить отладку сборки выпуска приложения.

Разверните опубликованные файлы любым способом. Например, их можно упаковать в ZIP-файл, использовать простую команду `copy` или развернуть их с помощью любого установочного пакета на ваш выбор.

Ниже приведено полное содержимое файла *csproj* для этого проекта.

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>netcoreapp1.1</TargetFramework>
    <RuntimeIdentifiers>win10-x64;osx.10.11-x64</RuntimeIdentifiers>
  </PropertyGroup>
</Project>
```

## <a name="self-contained-deployment-with-third-party-dependencies"></a>автономное развертывание с зависимостями сторонних разработчиков;

Выполнение автономного развертывания с одной или несколькими зависимостями сторонних разработчиков предполагает добавление этих зависимостей. Требуется выполнить два дополнительных шага, прежде чем запускать команду `dotnet restore` ([см. Примечание](#dotnet-restore-note)):

1. Добавьте ссылки на библиотеки сторонних разработчиков в раздел `<ItemGroup>` файла *csproj*. В следующем разделе `<ItemGroup>` в качестве библиотеки стороннего разработчика используется библиотека Json.NET.

    ```xml
      <ItemGroup>
        <PackageReference Include="Newtonsoft.Json" Version="10.0.2" />
      </ItemGroup>
    ```

1. Скачайте пакет NuGet, содержащий зависимость стороннего разработчика, в систему, если вы этого еще не сделали. Чтобы сделать зависимость доступной для приложения, выполните команду `dotnet restore` ([см. Примечание](#dotnet-restore-note)) после ее добавления. Так как зависимость разрешается из локального кэша NuGet во время публикации, она должна быть доступна в системе.

Ниже приведено полное содержимое файла *csproj* для этого проекта:

```xml
<Project Sdk="Microsoft.NET.Sdk">
  <PropertyGroup>
    <OutputType>Exe</OutputType>
    <TargetFramework>netcoreapp1.1</TargetFramework>
    <RuntimeIdentifiers>win10-x64;osx.10.11-x64</RuntimeIdentifiers>
  </PropertyGroup>
  <ItemGroup>
    <PackageReference Include="Newtonsoft.Json" Version="10.0.2" />
  </ItemGroup>
</Project>
```

При развертывании приложения все зависимости сторонних разработчиков, используемые в нем, также содержатся в файлах приложения. Библиотеки сторонних разработчиков не требуются в системе, в которой выполняется приложение.

Имейте в виду, что автономное развертывание с библиотекой стороннего разработчика возможно только на платформах, которые поддерживаются этой библиотекой. Это похоже на наличие сторонних зависимостей с собственными зависимостями в развертывании, зависящем от платформы, где собственные зависимости должны быть совместимы с платформой, на которой развертывается приложение.

<a name="dotnet-restore-note"></a>
[!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]

# <a name="see-also"></a>См. также

[Развертывание приложений .NET Core](index.md)   
[Каталог идентификаторов сред выполнения (RID) в .NET Core](../rid-catalog.md)   

