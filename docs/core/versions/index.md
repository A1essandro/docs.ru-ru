---
title: "Управление версиями .NET Core"
description: "Сведения о принципах работы управления версиями в .NET Core."
author: bleroy
ms.author: mairaw
ms.date: 08/25/2017
ms.topic: article
ms.prod: .net-core
ms.devlang: dotnet
ms.assetid: f6f684b1-1d2c-4105-8376-7c1959e23803
ms.workload: dotnetcore
ms.openlocfilehash: 369d280268123a69ae9458a2c47e45396728deb5
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/23/2017
---
# <a name="net-core-versioning"></a>Управление версиями .NET Core

.NET Core состоит из [пакетов NuGet](../packages.md), инструментов и платформ, которые распространяются как единое целое. Управление версиями для каждого из этих уровней платформы может осуществляться отдельно для повышения гибкости. Несмотря на высокую гибкость управления версиями, желательно согласованно управлять версиями платформы, чтобы сделать работу с продуктом понятнее.

Эта статья призвана прояснить, как именно осуществляется управление версиями для пакета SDK .NET Core и среды выполнения.

Существует множество разных частей, управление версиями для которых в .NET Core осуществляется раздельно. Однако, начиная с .NET Core 2.0, появляется удобный и понятный высокоуровневый номер версии, который все воспринимают как *версию* всего продукта .NET Core в целом. Остальная часть этого документа посвящена управлению версиями для всех этих компонентов. Эти сведения могут оказаться полезными, если вы являетесь, например, диспетчером пакетов.

## <a name="versioning-details"></a>Сведения об управлении версиями

Начиная с .NET Core 2.0, в имени файла скачиваемых материалов указывается номер версии. Были объединены следующие номера версии:

* Общая платформа и соответствующая среда выполнения.
* Пакет SDK для .NET Core и соответствующий CLI .NET Core.
* Метапакет `Microsoft.NETCore.App`.

Использование отдельного номера версии позволяет пользователям проще понять, какую версию пакета SDK требуется установить на компьютерах разработчиков и какая версия общей платформы потребуется при подготовке рабочей среды. При скачивании пакета SDK или среды выполнения отображаемый номер версии будет совпадать.

### <a name="installers"></a>Установщики

Начиная с .NET Core 2.0, скачиваемые файлы для [ежедневных сборок](https://github.com/dotnet/core-setup#daily-builds) и [выпусков](https://www.microsoft.com/net/download/core) соответствуют новой схеме именования, которая проще для понимания.
Пользовательский интерфейс установщика в этих скачиваемых материалах также был изменен, чтобы четко обозначить имена и версии устанавливаемых компонентов. В частности, названия теперь содержат тот же номер версии, что и имя скачиваемого файла.

#### <a name="file-name-format"></a>Формат имени файла

`[product]-[component]-[major].[minor].[patch]-[previewN]-[optional build #]-[rid].[file ext]`

Ниже приведено несколько примеров этого формата:

```
dotnet-runtime-2.0.4-macos.10.12-x64.pkg            # Mac runtime installer
dotnet-sdk-2.0.4-win10-x64.exe                      # Windows SDK installer
dotnet-sdk-2.0.4-fedora.24-x64.tar.gz               # Fedora 24 binary archive

#Ubuntu file set needed for the SDK
dotnet-host-2.0.4-ubuntu.16.04-x64.deb              # Host / muxer and host policy
dotnet-runtime-2.0.4-ubuntu.16.04-x64.deb           # runtime
dotnet-sdk-2.0.4-ubuntu.16.04-x64.deb               # SDK tools
```

Такой формат удобен для восприятия и четко указывает на то, какая это версия и где ее можно применять. Имя пакета среды выполнения включает `runtime`, а пакет SDK включает `SDK`.

#### <a name="ui-string-format"></a>Формат строки пользовательского интерфейса

Все описания веб-сайтов и строки пользовательского интерфейса в установщиках сделаны согласованными, точными и простыми. В следующей таблице приведено несколько примеров:

| Installer | Заголовок окна                          | Остальное содержимое установщика | Что устанавливается                               |
| :--       | :--                                   | :--                        | :--                                             |
| SDK       | Установщик пакета SDK для .NET Core 2.0 (x64)     | Пакет SDK для .NET Core 2.0.4        | Инструменты .NET Core 2.0.4 + среда выполнения .NET Core 2.0.4 |
| Среда выполнения   | Установщик среды выполнения для .NET Core 2.0 (x64) | Среда выполнения для .NET Core 2.0.4    | Среда выполнения для .NET Core 2.0.4                         |

Предварительные версии отличаются лишь немного:

| Installer | Заголовок окна                                    | Остальное содержимое установщика        | Что устанавливается                                                   |
| :--       | :--                                             | :--                               | :--                                                                 |
| SDK       | Установщик пакета SDK для предварительной версии 1 .NET Core 2.0 (x64)     | Пакет SDK для предварительной версии 1 .NET Core 2.0.0     | Инструменты для предварительной версии 1 .NET Core 2.0.0 + среда выполнения для предварительной версии 1 .NET Core 2.0.0 |
| Среда выполнения   | Установщик среды выполнения для предварительной версии 1 .NET Core 2.0 (x64) | Среда выполнения для предварительной версии 1 .NET Core 2.0.0 | Среда выполнения для предварительной версии 1 .NET Core 2.0.0                                   |

Выпуск пакета SDK может содержать несколько версий среды выполнения. В этом случае установщик UX выглядит следующим образом (отображается только версия пакета SDK, а установленные версии среды выполнения отображаются на странице сводки в конце процедуры установки в Windows и Mac):

| Installer | Заголовок окна                      | Остальное содержимое установщика                                   | Что устанавливается                                                         |
| :--       | :--                               | :--                                                          | :--                                                                       |
| SDK       | Установщик пакета SDK для .NET Core 2.1 (x64) | Пакет SDK для .NET Core 2.1.1 <br> Среда выполнения для .NET Core 2.1.1 <br> Среда выполнения для .NET Core 2.0.6 | Инструменты .NET Core 2.1.1 + среда выполнения .NET Core 2.1.1 + среда выполнения .NET Core 2.0.6 |

Также может возникнуть необходимость обновить инструменты .NET Core без изменения среды выполнения. В этом случае версия пакета SDK увеличивается (например, до 2.1.2), а среда выполнения учитывает это изменение при последующей поставке (например, в следующий раз среда выполнения и пакет SDK поставляются как 2.1.3).

### <a name="package-managers"></a>Диспетчеры пакетов

.NET Core может распространяться не только корпорацией Майкрософт. В частности, разработчики пакетов и владельцы дистрибутивов Linux могут добавлять пакеты .NET Core в свои диспетчеры пакетов. Рекомендации по именованию и управлению версиями таких пакетов см. в разделе [Упаковка дистрибутивов .NET Core](../build/distribution-packaging.md).

#### <a name="minimum-package-set"></a>Минимальный набор пакетов

* `dotnet-runtime-[major].[minor]` — среда выполнения с указанной версией (в диспетчере пакетов должна быть доступна только версия с последними исправлениями для этого сочетания основного и дополнительного номеров версий). Пакет обновляется до новых версий исправлений, но для основного и дополнительного номеров версий создаются отдельные пакеты.
 
  **Зависимости**: `dotnet-host`

* `dotnet-sdk` — пакет SDK последней версии. Команда `update` выполняет накат основного и дополнительного номеров версий, а также версий исправлений.

  **Зависимости** — последняя версия пакета `dotnet-sdk-[major].[minor]`.

* `dotnet-sdk-[major].[minor]` — пакет SDK с указанной версией. Указывается последняя включенная версия добавленных общих платформ, что позволит пользователям легко связать пакет SDK с общей платформой. Пакет обновляется до новых версий исправлений, но для основного и дополнительного номеров версий создаются отдельные пакеты.

  **Зависимости** — `dotnet-host`, одна или несколько сред выполнения `dotnet-runtime-[major].[minor]` (одна из них используется в коде пакета SDK, а остальные предназначены для сборки и запуска приложений пользователями).

* `dotnet-host` — основное приложение последней версии.

##### <a name="preview-versions"></a>Предварительные версии

Издатели пакетов могут посчитать нужным включить предварительные версии среды выполнения и пакета SDK. Эти предварительные версии не следует включать в пакет `dotnet-sdk` без управления версиями, но можно выпустить их в виде пакетов с управлением версиями. В именах таких пакетов к фрагменту основного и дополнительного номеров версий добавляется дополнительный маркер предварительной версии. Например, это может быть пакет `dotnet-sdk-2.0-preview1-final`.

### <a name="docker"></a>Docker

Общее соглашение об именовании тегов Docker заключается в размещении номера версии перед именем компонента. Это соглашение может продолжать использоваться. Текущие теги содержат только версию среды выполнения, как показано ниже.

* 1.0.8-runtime
* 1.0.8-sdk
* 2.0.4-runtime
* 2.0.4-sdk
* 2.1.1-runtime
* 2.1.1-sdk

Теги SDK должны обновляться, чтобы представлять версию пакета SDK, а не среды выполнения.

Может возникнуть и ситуация, когда требуется исправить инструменты .NET Core и повторно поставить уже существующую среду выполнения. В этом случае версия пакета SDK увеличивается (например, до 2.1.2), а среда выполнения учитывает это изменение при последующей поставке (например, в следующий раз среда выполнения и пакет SDK поставляются как 2.1.3).

## <a name="semantic-versioning"></a>Семантическое управление версиями

В .NET Core используется [Семантическое версионирование (SemVer)](http://semver.org/) с шаблоном номера версии `MAJOR.MINOR.PATCH`, различные части которого служат для описания степени и типа изменения.

```
MAJOR.MINOR.PATCH[-PRERELEASE-BUILDNUMBER]
```

Необязательные части `PRERELEASE` и `BUILDNUMBER` никогда не будут входить в поддерживаемые выпуски и существуют только для ночных сборок, которые локально создаются из исходных целевых объектов, и неподдерживаемых выпусков предварительной версии.

### <a name="how-version-numbers-are-incremented"></a>Как увеличиваются номера версии?

`MAJOR` увеличивается в следующих случаях:
  - Старая версия больше не поддерживается.
  - Присваивается более новая версия `MAJOR` существующей зависимости.
  - Значение параметра по умолчанию для совместимости изменяется на "off".

`MINOR` увеличивается в следующих случаях:
  - Добавляется контактная зона общедоступного API.
  - Добавляется новое поведение.
  - Присваивается более новая версия `MINOR` существующей зависимости.
  - Добавляется новая зависимость.
  
`PATCH` увеличивается в следующих случаях:
  - Вносятся исправления ошибок.
  - Добавляется поддержка новой платформы.
  - Присваивается более новая версия `PATCH` существующей зависимости.
  - Любое другое изменение, которое не относится к описанным выше случаям.

При наличии нескольких изменений увеличивается самый высокий элемент, затронутый отдельными изменениями, а следующие за ним сбрасываются до нуля. Например, когда `MAJOR` увеличивается, `MINOR` и `PATCH` сбрасываются в нуль. Когда `MINOR` увеличивается, `PATCH` сбрасываются в нуль, а `MAJOR` остается без изменений.

### <a name="preview-versions"></a>Предварительные версии

Для предварительных версий к номеру версии добавляется `-preview[number]-([build]|"final")`. Например, `2.0.0-preview1-final`.

### <a name="servicing-versions"></a>Сервисные версии

После выхода выпуска его ветви обычно перестают создавать ежедневные сборки и вместо них начинают формировать сервисные сборки. Для сервисных версий к номеру версии добавляется `-servicing-[number]`. Например, `2.0.1-servicing-006924`.

### <a name="lts-vs-current"></a>Сравнение LTS и Current

Для .NET Core существует две цепочки выпусков: Long Term Support (LTS) и Current. Это позволяет пользователям выбрать требуемый уровень стабильности и новых возможностей с сохранением поддержки.

- При LTS вы реже получаете новые возможности, но используете более зрелую платформу. Кроме того, LTS имеет более длительный период поддержки.
- При Current вы чаще получаете новые возможности и API, но вам предоставляется сокращенный срок для установки обновлений, а самих обновлений выпускается больше. Current также полностью поддерживается, но период поддержки короче, чем для LTS.

Версию "Current" можно повысить до LTS.

"LTS" и "Current" следует рассматривать как метки, которые мы размещаем для определенных выпусков, чтобы обозначить соответствующий уровень поддержки.

Дополнительные сведения см. в разделе [Справочные материалы по жизненному циклу поддержки .NET Core](https://www.microsoft.com/net/core/support).

## <a name="versioning-scheme-details"></a>Сведения о схеме управления версиями

.NET Core состоит из следующих компонентов:

- Основное приложение (также называется "мультиплексор"): `dotnet.exe` с библиотеками политики `hostfxr`.
- Пакет SDK (набор инструментов, который нужен на компьютере разработчика, но не в рабочей среде).
- Среда выполнения.
- Реализация общей платформы, распространяемая в виде пакетов. Управление версиями каждого пакета производится отдельно. Особенно это касается версий исправлений.
- Необязательный набор [метапакетов](../packages.md), которые ссылаются на мелкомодульные пакеты как на единую сущность с управлением версиями. Управление версиями метапакетов может осуществляться отдельно от управления версиями пакетов.

.NET Core также включает набор требуемых версий .NET Framework (например, `netstandard` или `netcoreapp`), представляющих расширяющийся набор интерфейсов API по мере увеличения номеров версии.

### <a name="net-standard"></a>.NET Standard

.NET Standard использует схему управления версиями `MAJOR.MINOR`. Уровень `PATCH` бесполезен для .NET Standard, так как он содержит набор контрактов, итерация по которым осуществляется реже, и не представляет те же требования к управлению версиями, что и фактическая реализация.

Нет никакой реальной связи между версиями .NET Standard и версиями .NET Core: .NET Core 2.0 реализует .NET Standard 2.0, но нет никакой гарантии, что будущие версии .NET Core будут соответствовать той же версии .NET Standard. .NET Core может предоставлять API, которые не определяются .NET Standard, и поэтому может предоставлять новые версии без потребности в новом .NET Standard. Концепция .NET Standard также применяется к другим целевым объектам, таким как .NET Framework или Mono, даже если она появилась одновременно с .NET Core.

### <a name="packages"></a>Пакеты

Для пакетов библиотек характерно независимое управление версиями. Пакеты, которые пересекаются со сборками .NET Framework System.\*, обычно используют версии 4.x, что соответствует схеме управления версиями .NET Framework 4.x (так сложилось исторически). Версии пакетов, которые не пересекаются с библиотеками .NET Framework (например, [`System.Reflection.Metadata`](https://www.nuget.org/packages/System.Reflection.Metadata)), обычно начинаются с 1.0 и увеличиваются с этого номера.

Пакеты, описываемые [`NETStandard.Library`](https://www.nuget.org/packages/NETStandard.Library), представляют собой особый случай, так как являются основой платформы.

Пакетам `NETStandard.Library` номера версий присваиваются как единому набору, так как между ними имеются зависимости на уровне реализации.

### <a name="metapackages"></a>Метапакеты

Управление версиями метапакетов .NET Core основано на версии .NET Core, к которой они относятся.

Например, метапакеты в .NET Core 2.1.3 должны иметь номера версии `MAJOR` и `MINOR`, равные 2.1.

Версия исправления для метапакета увеличивается при каждом обновлении какого-либо пакета, на который указывает ссылка. Версии исправлений не включают обновленную версию платформы. Поэтому метапакеты не соответствуют строго правилам SemVer, так как их схема управления версиями не представляет степень изменений в базовых пакетах, а связана в первую очередь с уровнем API. 

Сейчас существует два основных метапакета для .NET Core:

**Microsoft.NETCore.App**

- Версия 1.0 для .NET Core 1.0 (эти версии совпадают).
- Сопоставлен с платформой `netcoreapp`.
- Описывает платформы в распространяемом пакете .NET Core.

Примечание. [`Microsoft.NETCore.Portable.Compatibility`](https://www.nuget.org/packages/Microsoft.NETCore.Portable.Compatibility) — это другой метапакет .NET Core, обеспечивающий совместимость с реализацией платформы .NET, предшествующей .NET Standard. Он не сопоставлен с определенной платформой, поэтому управление версиями для него осуществляется как для пакета.

**NETStandard.Library**

[`NETStandard.Library`](https://www.nuget.org/packages/NETStandard.Library) описывает библиотеки, входящие в [.NET Standard](../../standard/library.md). Применяется ко всем реализациям .NET, которые поддерживают .NET Standard, например .NET Framework, .NET Core и Mono.

### <a name="target-frameworks"></a>Требуемые версии .NET Framework

Версии требуемых версий .NET Framework меняются при добавлении новых API. Версии исправлений для них не применяются, так как они представляют уровень API и не связаны с реализацией. Управление основным и дополнительным номером версии осуществляется согласно указанным выше правилам SemVer и в соответствии с номерами версий `MAJOR` и `MINOR` для реализующих их дистрибутивов .NET Core.

## <a name="versioning-in-practice"></a>Управление версиями на практике

Имя скачиваемого файла .NET Core содержит версию, например `dotnet-sdk-2.0.4-win10-x64.exe`.

В репозиториях .NET Core в GitHub ежедневно публикуются фиксации и запросы на вытягивание, вследствие чего появляется множество новых сборок библиотек. Создавать новые общедоступные версии .NET Core для каждого изменения нецелесообразно. Вместо этого изменения накапливаются в течение неопределенного периода времени (например, нескольких недель или месяцев), после чего выпускается новая общедоступная стабильная версия .NET Core.

Новая версия .NET Core может означать следующее:

- новые версии пакетов и метапакетов;
- новые версии различных платформ с добавлением новых интерфейсов API;
- новая версия распространяемого пакета .NET Core.

### <a name="shipping-a-patch-release"></a>Выпуск исправления

После выпуска основной версии .NET Core, например 2.0.0, в библиотеки .NET Core вносятся изменения для исправления ошибок, а также повышения производительности и надежности. Это означает, что новые API не добавляются. Различные метапакеты обновляются так, чтобы ссылаться на обновленные пакеты библиотек .NET Core. Версии метапакетов изменяются на уровне номера исправления (`MAJOR.MINOR.PATCH`). Требуемые версии .NET Framework никогда не обновляются в рамках выпусков исправлений. Выпускается новый распространяемый пакет .NET Core, номер версии которого соответствует версии метапакета `Microsoft.NETCore.App`.

### <a name="shipping-a-minor-release"></a>Выпуск дополнительной версии

После выпуска версии .NET Core c увеличенным номером версии `MAJOR` в библиотеки .NET Core добавляются новые интерфейсы API для поддержки новых сценариев. Различные метапакеты обновляются так, чтобы ссылаться на обновленные пакеты библиотек .NET Core. Версии метапакетов изменяются на уровне исправлений, при этом номера версии `MAJOR` и `MINOR` соответствуют новой версии платформы. Добавляются имена новых требуемых версий .NET Framework с новой версией `MAJOR.MINOR`, чтобы описать новые API (например, `netcoreapp2.1`). Выпускается новый распространяемый пакет .NET Core, номер версии которого соответствует версии метапакета `Microsoft.NETCore.App`.

### <a name="shipping-a-major-release"></a>Выпуск основной версии

При каждом выпуске новой основной версии .NET Core номер версии `MAJOR` увеличивается, а номер версии `MINOR` сбрасывается в нуль. Новая основная версия содержит по меньшей мере все API, добавленные в дополнительную версию после предыдущей основной версии. Новая основная версия должна поддерживать новые важные сценарии, а также может прекращать поддержку более старых платформ.

Различные метапакеты обновляются так, чтобы ссылаться на обновленные пакеты библиотек .NET Core. Версии метапакета [`Microsoft.NETCore.App`](https://www.nuget.org/packages/Microsoft.NETCore.App) и платформы `netcore` изменяются на уровне основного номера, соответствующего номеру версии `MAJOR` нового выпуска.

## <a name="see-also"></a>См. также
[Требуемые версии .NET Framework](../../standard/frameworks.md)   
[Упаковка дистрибутивов .NET Core](../build/distribution-packaging.md)   
[Справочные материалы по жизненному циклу поддержки .NET Core](https://www.microsoft.com/net/core/support)   
[Привязка версий .NET Core 2+](https://github.com/dotnet/designs/issues/3)   
