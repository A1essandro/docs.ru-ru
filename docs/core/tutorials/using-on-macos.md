---
title: "Начало работы с .NET Core в Mac OS"
description: "Начало работы с .NET Core в Mac OS с помощью Visual Studio Code"
keywords: .NET, .NET Core
author: bleroy
ms.author: mairaw
ms.date: 06/20/2016
ms.topic: article
ms.prod: .net-core
ms.devlang: dotnet
ms.assetid: 8ad82148-dac8-4b31-9128-b0e9610f4d9b
translationtype: Human Translation
ms.sourcegitcommit: 7ac95fa4b2aac81b2e8d33cedf2faf36a0bbf210
ms.openlocfilehash: 33d87c3236e5f592cd59eab77df1059ac089b88c

---

# <a name="getting-started-with-net-core-on-macos-using-visual-studio-code"></a>Начало работы с .NET Core в Mac OS с помощью Visual Studio Code

Авторы: [Bertrand Le Roy](https://github.com/bleroy) (Бертран ле Рой), [Phillip Carter](https://github.com/cartermp) (Филипп Картер), [Bill Wagner](https://github.com/billwagner) (Билл Вагнер)

При участии [Toni Solarin-Sodara](https://github.com/tsolarin) (Тони Соларин-Содара)

В этом документе приводится обзор действий и рабочего процесса для создания решения .NET Core с помощью [Visual Studio Code](http://code.visualstudio.com).
Вы узнаете, как создавать проекты и модульные тесты, использовать средства отладки и включать библиотеки сторонних разработчиков посредством [NuGet](http://nuget.org).

В этой статье используется Visual Studio Code в Mac OS. Где это необходимо, приводятся отличия для платформы Windows.

## <a name="prerequisites"></a>Предварительные требования

Прежде чем приступать к работе, необходимо установить [пакет SDK для .NET Core](https://www.microsoft.com/net/core), в настоящее время доступный в виде предварительного выпуска. Пакет SDK для .NET Core содержит последний выпуск платформы и среды выполнения .NET Core.

Также необходимо установить [Visual Studio Code](http://code.visualstudio.com).
В процессе изучения этой статьи вы также установите расширения, которые улучшат возможности разработки для .NET Core.

Ссылки на все эти компоненты можно найти на [домашней странице .NET](http://dot.net).

## <a name="getting-started"></a>Начало работы

Исходный код для этого учебника доступен на сайте [GitHub](https://github.com/dotnet/docs/tree/master/samples/core/getting-started/golden).

Запустите Visual Studio Code. Нажмите клавиши CTRL+"\`" (символ обратной кавычки), чтобы открыть встроенный терминал в VS Code. (Если хотите, вы можете использовать отдельное окно терминала.)

К моменту завершения учебника вы создадите три проекта: проект библиотеки, тесты для этого проекта и консольное приложение, использующее библиотеку. Для этих трех проектов будет использоваться стандартная структура папок. Благодаря этому средствам из пакета SDK для .NET Core будет понятна взаимосвязь между проектами с рабочим кодом и проектами с тестовым кодом. Это позволит повысить продуктивность при разработке.

Начнем с создания папок. В терминале создайте каталог golden. В нем создайте каталоги `src` и `test`. В каталоге `src` создайте каталоги `app` и `library`. В каталоге `test` создайте каталог `test-library`. Это можно сделать с помощью терминала в VS Code либо можно щелкнуть родительскую папку в VS Code и выбрать значок "Создать папку".

В VS Code откройте каталог golden. Это корневой каталог вашего решения.

Затем создайте файл `global.json` в корневом каталоге решения.
Файл `global.json` имеет следующее содержимое:

```json
{
    "projects": [
        "src",
        "test"
    ]
}
```

На данный момент дерево каталогов должно выглядеть так.


```
/golden
|__global.json
|__/src
   |__/app
   |__/library
|__/test
   |__/test-library
```

### <a name="writing-the-library"></a>Написание библиотеки

Ваша следующая задача — создать библиотеку. В окне терминала (встроенного терминала в VS Code или другого терминала) перейдите в каталог `golden/src/library` и введите команду `dotnet new -t lib`.
Будет создан проект библиотеки с двумя файлами: `project.json` и `Library.cs`.

`project.json` содержит следующие сведения:

```json
{
  "version": "1.0.0-*",
  "buildOptions": {
    "debugType": "portable"
  },
  "dependencies": {},
  "frameworks": {
    "netstandard1.6": {
      "dependencies": {
        "NETStandard.Library": "1.6.0"
      }
    }
  }
}
```


В этом проекте библиотеки будет использоваться представление JSON объектов, поэтому необходимо добавить ссылку на пакет NuGet `Newtonsoft.Json`. В файле `project.json` добавьте последнюю предварительную версию этого пакета в качестве зависимости:

```json
"dependencies": {
    "Newtonsoft.Json": "9.0.1-beta1"
},
```

После добавления этих зависимостей вам необходимо установить пакеты в рабочем пространстве. Выполните команду `dotnet restore`, чтобы обновить все зависимости, и запишите файл `project.lock.json` в каталог проекта. Этот файл содержит полное дерево зависимостей со всеми зависимостями в проекте. Считывать этот файл не нужно; он используется средствами из пакета SDK для .NET Core.

Теперь обновим код на языке C#. Давайте создадим класс `Thing`, который содержит один общий метод. Этот метод будет возвращать сумму двух чисел, но для этого он будет преобразовывать число в строку JSON, а затем десериализовывать ее. Переименуйте файл `Library.cs` в `Thing.cs`. Затем замените существующий код (шаблонного класса Class1) следующим кодом:

```csharp
using static Newtonsoft.Json.JsonConvert;

namespace Library
{
    public class Thing
    {
        public int Get(int left, int right) =>
            DeserializeObject<int>($"{left + right}");
    }
}
```

В нем используется ряд современных возможностей C#, таких как статические операторы using, члены, воплощающие выражения, и интерполированные строки. Сведения о них можно получить из [руководства по языку C#](../../csharp/index.md).

Теперь, когда вы обновили код, вы можете выполнить сборку библиотеки с помощью команды `dotnet build`.

Теперь у вас есть собранный файл `library.dll` в каталоге `golden/src/library/bin/Debug/netstandard1.6`.

### <a name="writing-the-test-project"></a>Написание тестового проекта

Давайте создадим тестовый проект для библиотеки, сборку которой вы выполнили. Перейдите в каталог `test/test-library`. Выполните команду `dotnet new -t xunittest`, чтобы создать тестовый проект. 

Вам потребуется добавить узел зависимости для библиотеки, которую вы создали в предыдущих шагах. Откройте файл `project.json` и измените раздел зависимостей следующим образом (включая узел `library`, который является последним узлом ниже):

```json
"dependencies": {
  "System.Runtime.Serialization.Primitives": "4.1.1",
  "xunit": "2.1.0",
  "dotnet-test-xunit": "1.0.0-rc2-192208-24",
  "library": {
    "target": "project"
  }
}
```

Узел `library` указывает, что эта зависимость должна разрешаться в проект в текущем рабочем пространстве. Если явно не указать это, существует возможность того, что сборка тестового проекта будет выполнена для пакета NuGet с тем же именем.

Теперь, когда зависимости правильно настроены, давайте создадим тесты для библиотеки. Откройте файл `Tests.cs` и замените его содержимое следующим кодом:

```csharp
using Library;
using Xunit;

namespace TestApp
{
    public class LibraryTests
    {
        [Fact]
        public void TestThing() {
            Assert.Equal(42, new Thing().Get(19, 23));
        }
    }
}
```

Теперь выполните команды `dotnet restore`, `dotnet build` и `dotnet test`.
Консольное средство выполнения тестов xUnit проведет один тест и сообщит о том, что он пройден. 

### <a name="writing-the-console-app"></a>Написание консольного приложения

В терминале перейдите в каталог `golden/src/app`. Выполните команду `dotnet new`, чтобы создать консольное приложение.

Консольное приложение использует библиотеку, которую вы создали и протестировали в предыдущих шагах. Это необходимо указать, отредактировав файл `project.json` и добавив соответствующую зависимость.  В узле `dependencies` добавьте узел `library` следующим образом:

```json
"dependencies": {
  "library": {
    "target": "project"
  }
}
```

Узел `project` важен здесь, так же как и в тестовой библиотеке. Он указывает на то, что это проект в текущем решении, а не пакет NuGet.

Выполните команду `dotnet restore`, чтобы восстановить все зависимости. Откройте файл `program.cs` и замените содержимое метода `Main` следующей строкой:

```csharp
WriteLine($"The answer is {new Thing().Get(19, 23)}");
```

В начало файла необходимо добавить пару директив `using`:

```csharp
using static System.Console;
using Library;
```

Затем выполните команду `dotnet build`. Она создаст сборки, после чего вы можете ввести `dotnet run`, чтобы запустить исполняемый файл.

### <a name="debugging-your-application"></a>Отладка приложения

Вы можете отладить код в VS Code с помощью расширения C#.
Для установки этого расширения нажмите клавишу `F1`, чтобы открыть палитру VS Code. Введите команду `ext install`, чтобы просмотреть список расширений. Выберите расширение C#. (Дополнительные сведения см. на странице [документации по расширению C# для Visual Studio Code](https://github.com/OmniSharp/omnisharp-vscode/blob/master/debugger.md).)

После установки расширения в VS Code появится запрос на перезапуск приложения для загрузки нового расширения. После установки расширения можно открыть вкладку отладчика (см. рисунок).

![Отладчик VS Code](./media/using-on-macos/vscodedebugger.png)


После запуска отладчика в VS Code появится указание настроить отладчик. При настройке создается каталог `.vscode` с двумя файлами: `tasks.json` и `launch.json`. Эти два файла определяют конфигурацию отладчика. В большинстве проектов этот каталог не включается в систему управления исходным кодом.
Он включен в образец, связанный с этим пошаговым руководством, чтобы вы видели изменения, которые необходимо внести.

Ваше решение содержит несколько проектов, поэтому вам потребуется изменить каждый из этих файлов для выполнения правильных команд. Сначала откройте файл `tasks.json`. Задача сборки по умолчанию выполняет команду `dotnet build` в исходном каталоге рабочего пространства. Вместо этого ее можно выполнить в каталоге `src/app`. Чтобы задать его в качестве текущего рабочего каталога, необходимо добавить узел `options`:

```json
"options": {
    "cwd": "${workspaceRoot}/src/app"
}
```

Далее необходимо открыть файл `launch.json` и изменить путь к программе. В разделе configurations вы увидите узел, описывающий программу. Он выглядит так.

```json
"program": "${workspaceRoot}/bin/Debug/<target-framework>/<project-name.dll>",
```

Его следует изменить следующим образом:

```json
"program": "${workspaceRoot}/src/app/bin/Debug/netcoreapp1.0/app.dll",
```

При использовании ОС Windows необходимо изменить файл `project.json` приложения (в каталоге `src/app`), чтобы создать переносимые файлы PDB (в Mac OS X и Linux это происходит автоматически).
Добавьте узел `debugType` внутри `buildOptions`. Узел `debugType` необходимо добавить в `project.json` как для папки `src/app`, так и для папки `src/library`.

```json
  "buildOptions": {
    "debugType": "portable"
  },
```

Установите точку останова в операторе `WriteLine` в методе `Main`. Для этого нажмите клавишу `F9` или щелкните мышью в левом поле напротив строки, в которой нужно установить точку останова. Откройте отладчик, щелкнув значок отладки в левой части экрана VS Code (см. рисунок). После этого нажмите кнопку "Воспроизвести", чтобы запустить приложение в режиме отладки.

Вы должны достичь точки останова. Выполните метод `Get` по шагам и убедитесь в том, что переданы правильные аргументы. Проверьте, равен ли результат 42.



<!--HONumber=Jan17_HO3-->


