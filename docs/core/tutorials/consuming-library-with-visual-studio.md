---
title: "Использование библиотеки классов для .NET Core в Visual Studio 2017"
description: "Информация о том, как вызывать члены библиотеки классов в Visual Studio 2017."
author: BillWagner
ms.author: wiwagn
ms.date: 08/07/2017
ms.topic: article
ms.prod: .net-core
dev_langs:
- csharp
- vb
ms.workload: dotnetcore
ms.openlocfilehash: 1525bd3f9d249fe39fd65b53bc8d1e8eddb09ab9
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/23/2017
---
# <a name="consuming-a-class-library-with-net-core-in-visual-studio-2017"></a>Использование библиотеки классов для .NET Core в Visual Studio 2017

Итак, вы создали библиотеку классов, проделав шаги, описанные в статье [Создание библиотеки классов на C# с помощью .NET Core в Visual Studio 2017](./library-with-visual-studio.md) или [Создание библиотеки классов на Visual Basic с помощью .NET Core в Visual Studio 2017](vb-library-with-visual-studio.md), протестировали ее, выполнив шаги в статье [Тестирование библиотеки классов с помощью .NET Core в Visual Studio 2017](testing-library-with-visual-studio.md), а затем создали версию выпуска этой библиотеки. Теперь пора предоставить ее для использования вызывающим объектам. Для этого существуют два способа:

* Если вся библиотека будет использоваться в одном решении (например, она является компонентом крупного приложения), достаточно включить библиотеку в проект этого решения.

* Если же библиотеку нужно сделать общедоступной, ее следует предоставлять как пакет NuGet.

## <a name="including-a-library-as-a-project-in-a-solution"></a>Включение библиотеки в решение в качестве проекта

Ранее вы включали модульные тесты в решение библиотеки классов. Теперь можно точно так же включить в это решение новое приложение. Например, библиотеку классов можно использовать в консольном приложении, которое будет предлагать пользователю ввести строку и определять, является ли первый символ этой строки символом верхнего регистра:

# <a name="ctabcsharp"></a>[C#](#tab/csharp)
1. Откройте решение `ClassLibraryProjects`, созданное в рамках статьи [Создание библиотеки классов с помощью C# и .NET Core в Visual Studio 2017](./library-with-visual-studio.md). В **обозревателе решений** щелкните правой кнопкой мыши решение **ClassLibraryProjects** и в контекстном меню выберите **Добавить** > **Новый проект**.

1. В диалоговом окне **Добавление нового проекта** разверните узел **Visual C#**, выберите узел **.NET Core**, а затем — шаблон проекта **Консольное приложение (.NET Core)**. В текстовом поле **Имя** введите "ShowCase", а затем нажмите кнопку **ОК**.

   ![Диалоговое окно "Добавление нового проекта"](./media/consuming-library-with-visual-studio/addnewproject.png)

1. В окне **Обозреватель решений** щелкните правой кнопкой мыши проект **ShowCase** и выберите команду **Назначить запускаемым проектом**. 

   ![Контекстное меню проекта ShowCase](./media/consuming-library-with-visual-studio/setstartupproject.png)

1. Изначально у этого проекта нет доступа к библиотеке классов. Чтобы позволить приложению вызывать методы из библиотеки классов, создайте ссылку на библиотеку классов. В окне **Обозреватель решений** щелкните правой кнопкой мыши узел **Зависимости** проекта `ShowCase` и выберите команду **Добавить ссылку**.

   ![Контекстное меню "Зависимости" проекта ShowCase](./media/consuming-library-with-visual-studio/addreference.png)

1. В диалоговом окне **Диспетчер ссылок** выберите проект библиотеки классов **StringLibrary**, а затем нажмите кнопку **ОК**.

   ![Диспетчер ссылок](./media/consuming-library-with-visual-studio/referencemanager.png)

1. В окне кода замените весь код файла *Program.cs* следующим текстом:

   [!CODE-csharp[UsingClassLib#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/showcase.cs)]

   Этот код использует свойство [Console.WindowHeight](xref:System.Console.WindowHeight), чтобы определить количество строк в окне консоли. Каждый раз, когда значение свойства [Console.CursorTop](xref:System.Console.CursorTop) достигает числа строк в окне консоли, код очищает окно консоли и повторно отображает сообщение для пользователя.

   Сама программа предлагает пользователю ввести строку. Она сообщает, начинается ли строка с символа верхнего регистра. Если пользователь нажимает клавишу ВВОД, не введя никакой строки, приложение завершает свою работу и окно консоли закрывается.

1. При необходимости можно изменить режим на панели инструментов, чтобы скомпилировать **отладочную** версию проекта `ShowCase`. Скомпилируйте и запустите программу, нажав зеленую стрелку на кнопке **ShowCase**.

   ![Изображение](./media/consuming-library-with-visual-studio/toolbar.png)
# <a name="visual-basictabvisual-basic"></a>[Visual Basic](#tab/visual-basic)
1. Откройте решение `ClassLibraryProjects`, созданное в рамках статьи [Создание библиотеки классов на Visual Basic с помощью .NET Core в Visual Studio 2017](vb-library-with-visual-studio.md). В **обозревателе решений** щелкните правой кнопкой мыши решение **ClassLibraryProjects** и в контекстном меню выберите **Добавить** > **Новый проект**.

1. В диалоговом окне **Добавление нового проекта** разверните узел **Visual Basic**, выберите узел **.NET Core**, а затем — шаблон проекта **Консольное приложение (.NET Core)**. В текстовом поле **Имя** введите "ShowCase", а затем нажмите кнопку **ОК**.

   ![Диалоговое окно "Добавление нового проекта"](./media/consuming-library-with-visual-studio/vb-addnewproject.png)

1. В окне **Обозреватель решений** щелкните правой кнопкой мыши проект **ShowCase** и выберите команду **Назначить запускаемым проектом**. 

   ![Контекстное меню проекта ShowCase](./media/consuming-library-with-visual-studio/setstartupproject.png)

1. Изначально у этого проекта нет доступа к библиотеке классов. Чтобы позволить приложению вызывать методы из библиотеки классов, создайте ссылку на библиотеку классов. В окне **Обозреватель решений** щелкните правой кнопкой мыши узел **Зависимости** проекта `ShowCase` и выберите команду **Добавить ссылку**.

   ![Контекстное меню "Зависимости" проекта ShowCase](./media/consuming-library-with-visual-studio/addreference.png)

1. В диалоговом окне **Диспетчер ссылок** выберите проект библиотеки классов **StringLibrary**, а затем нажмите кнопку **ОК**.

   ![Диспетчер ссылок](./media/consuming-library-with-visual-studio/referencemanager.png)

1. В окне кода замените весь код файла *Program.vb* следующим текстом:

    [!CODE-vb[UsingClassLib#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/showcase.vb)]

   Этот код использует свойство [Console.WindowHeight](xref:System.Console.WindowHeight), чтобы определить количество строк в окне консоли. Каждый раз, когда значение свойства [Console.CursorTop](xref:System.Console.CursorTop) достигает числа строк в окне консоли, код очищает окно консоли и повторно отображает сообщение для пользователя.

   Сама программа предлагает пользователю ввести строку. Она сообщает, начинается ли строка с символа верхнего регистра. Если пользователь нажимает клавишу ВВОД, не введя никакой строки, приложение завершает свою работу и окно консоли закрывается.

1. При необходимости можно изменить режим на панели инструментов, чтобы скомпилировать **отладочную** версию проекта `ShowCase`. Скомпилируйте и запустите программу, нажав зеленую стрелку на кнопке **ShowCase**.

   ![Изображение](./media/consuming-library-with-visual-studio/toolbar.png)
---

Чтобы отладить и опубликовать приложение, которое использует эту библиотеку, выполните действия из статей [Отладка приложения Hello World в Visual Studio 2017](debugging-with-visual-studio.md) и [Публикация приложения Hello World в Visual Studio 2017](publishing-with-visual-studio.md).

## <a name="distributing-the-library-in-a-nuget-package"></a>Распространение библиотеки в виде пакета NuGet

Библиотеку классов можно распространить и для других разработчиков, опубликовав ее в виде пакета NuGet. Visual Studio не поддерживает создание пакетов NuGet. Для создания пакета используйте [служебную программу командной строки](../../core/tools/dotnet.md) `dotnet` следующим образом:

1. Откройте окно консоли. Например, в текстовом поле **Задайте любой вопрос** на панели задач Windows введите `Command Prompt` (или `cmd` для краткости), а затем откройте окно консоли с помощью приложения **командной строки** или клавиши ВВОД, если оно выделено в результатах поиска.

1. Перейдите в каталог с проектом библиотеки. Если вы не меняли расположение файлов, проект размещается в каталоге *Documents\Visual Studio 2017\Projects\ClassLibraryProjects\StringLibrary*. Этот каталог содержит исходный код и файл проекта (*StringLibrary.csproj*).

1. Выполните команду `dotnet pack --no-build`. Служебная программа `dotnet` создаст пакет с расширением *.nupkg*.

   > [!TIP]
   > Если каталог, содержащий *dotnet.exe*, не находится в системном пути, найдите расположение этого файла, введя `where dotnet.exe` в окне консоли.

Дополнительные сведения о создании пакетов NuGet см. в статье [How to Create a NuGet Package with Cross Platform Tools](../../core/deploying/creating-nuget-packages.md) (Создание пакета NuGet с помощью кроссплатформенных средств).
