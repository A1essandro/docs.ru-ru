---
title: "Пакеты, метапакеты и платформы"
description: "Пакеты, метапакеты и платформы"
keywords: .NET, .NET Core
author: richlander
ms.author: mairaw
manager: wpickett
ms.date: 06/20/2016
ms.topic: article
ms.prod: .net-core
ms.technology: .net-core-technologies
ms.devlang: dotnet
ms.assetid: 609b0845-49e7-4864-957b-21ffe1b93bf2
translationtype: Human Translation
ms.sourcegitcommit: cb2e83b35b5a4aae14c89bcbdf26b064885a477a
ms.openlocfilehash: af6c83755068cc311b59c1a337898c177cc6d537

---

# <a name="packages-metapackages-and-frameworks"></a>Пакеты, метапакеты и платформы

.NET Core — это платформа, состоящая из пакетов NuGet. Для некоторых возможностей продукта лучше подходит мелкомодульное определение пакетов, а для других — крупномодульное. С учетом такой двойственности продукт распространяется в виде мелкомодульного набора пакетов, а затем описывается в виде более крупных блоков с помощью типа пакетов, неофициально называемого "метапакетами".

Каждый пакет .NET Core поддерживает выполнение в различных средах выполнения .NET, представленных платформами. Некоторые из них — это традиционные платформы, например пакет `net46` представляет платформу .NET Framework. Другой набор — это новые платформы, которые можно представить как "платформы на основе пакетов". Они образуют новую модель определения платформ. Платформы на основе пакетов полностью формируются и определяются как пакеты, благодаря чему создается тесная связь между пакетами и платформами.

## <a name="packages"></a>Пакеты

Платформа .NET Core разделяется на набор пакетов, которые предоставляют типы-примитивы, типы данных более высокого уровня, составные типы приложений и общие служебные программы. Каждый из этих пакетов представляет отдельную сборку с тем же именем. Например, [System.Runtime](https://www.nuget.org/packages/System.Runtime) содержит сборку System.Runtime.dll. 

Мелкомодульное определение пакетов имеет ряд преимуществ:

- Мелкомодульные пакеты могут выпускаться по собственному графику; необходимость в тестировании других пакетов сравнительно невелика.
- Мелкомодульные пакеты могут обеспечивать различную поддержку ОС и ЦП.
- Мелкомодульные пакеты могут иметь зависимости, относящиеся только к одной библиотеке.
- Приложения имеют меньший размер, так как пакеты, на которые нет ссылок, не включаются в распространяемый пакет приложения.

Некоторые из этих преимуществ реализуются только в определенных условиях. Например, пакеты NET Core обычно выпускаются по единому графику с одинаковой поддержкой платформ. В целях обслуживания исправления могут распространяться и устанавливаться как обновления для отдельных пакетов. Благодаря тому что исправление применяется к отдельной библиотеке, сокращается время его проверки и предоставления.

Ниже приведен список основных пакетов NuGet для .NET Core:

- [System.Runtime](https://www.nuget.org/packages/System.Runtime) — базовый пакет .NET Core, включающий [Object](http://docs.microsoft.com/dotnet/core/api/System.Object), [String](http://docs.microsoft.com/dotnet/core/api/System.String), [Array](http://docs.microsoft.com/dotnet/core/api/System.Array), [Action](http://docs.microsoft.com/dotnet/core/api/System.Action) и [IList&lt;T&gt;](http://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.IList-1).
- [System.Collections](https://www.nuget.org/packages/System.Collections) — набор универсальных коллекций, включая [List&lt;T&gt;](http://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.List-1) и [Dictionary&lt;K,V&gt;](http://docs.microsoft.com/dotnet/core/api/System.Collections.Generic.Dictionary-2).
- [System.Net.Http](https://www.nuget.org/packages/System.Net.Http) — набор типов для сетевого взаимодействия по протоколу HTTP, включая [HttpClient](http://docs.microsoft.com/dotnet/core/api/System.Net.Http.HttpClient) и [HttpResponseMessage](http://docs.microsoft.com/dotnet/core/api/System.Net.Http.HttpResponseMessage).
- [System.IO.FileSystem](https://www.nuget.org/packages/System.IO.FileSystem) — набор типов для чтения из локального или сетевого дискового хранилища и записи в него, включая [File](http://docs.microsoft.com/dotnet/core/api/System.IO.File) и [Directory](http://docs.microsoft.com/dotnet/core/api/System.IO.Directory).
- [System.Linq](https://www.nuget.org/packages/System.Linq) — набор типов для запроса объектов, включая Enumerable и [ILookup&lt;TKey, TElement&gt;](http://docs.microsoft.com/dotnet/core/api/System.Linq.ILookup-2).
- [System.Reflection](https://www.nuget.org/packages/System.Reflection) — набор типов для загрузки, проверки и активации типов, включая [Assembly](http://docs.microsoft.com/dotnet/core/api/System.Reflection.Assembly), [TypeInfo](http://docs.microsoft.com/dotnet/core/api/System.Reflection.TypeInfo) и [MethodInfo](http://docs.microsoft.com/dotnet/core/api/System.Reflection.MethodInfo).

Ссылки на пакеты указываются в файле project.json. В приведенном ниже примере используется ссылка на пакет [System.Runtime](https://www.nuget.org/packages/System.Runtime/). 

```json
{
  "dependencies": {
    "System.Runtime": "4.1.0"
  },
  "frameworks": {
    "netstandard1.6": {}
  }
}
```

В большинстве случаев не следует ссылаться на пакеты .NET Core более низкого уровня напрямую, так как в результате вам придется управлять слишком большим количеством пакетов. Вместо этого используется ссылка на метапакет.

## <a name="metapackages"></a>Метапакеты

Метапакеты — это принятое в NuGet соглашение для описания набора пакетов, каким-либо образом связанных друг с другом. Для представления набора пакетов в качестве метапакета пакеты делаются зависимыми. Метапакет также может определять платформу для набора пакетов путем указания соответствующей платформы. 

Ссылаясь на метапакет, вы, по сути, одним действием добавляете ссылку на каждый его зависимый пакет. Это означает, что все библиотеки в этих пакетах (ref или lib) доступны для IntelliSense (или аналогичного средства), а также для публикации приложения (только библиотеки lib). 

Примечание. Термины lib и ref относятся к папкам в пакетах NuGet. Папки ref описывают общедоступный интерфейс API пакета посредством метаданных сборки. Папки lib содержат реализацию этого общедоступного интерфейса API для данной платформы. 

Использование метапакетов дает следующие преимущества:

- позволяет пользователям легко ссылаться на большой набор мелкомодульных пакетов; 
- позволяет определять наборы пакетов (включая конкретные версии), которые тестируются и применяются как единое целое.

Метапакет стандартной библиотеки .NET:

- [NETStandard.Library](https://www.nuget.org/packages/NETStandard.Library) — описывает библиотеки, входящие в стандартную библиотеку .NET. Применяется ко всем реализациям .NET (например, .NET Framework, .NET Core и Mono), которые поддерживают стандартную библиотеку .NET. Формирует платформу netstandard.

Ниже приведен список основных метапакетов .NET Core:

- [Microsoft.NETCore.App](https://www.nuget.org/packages/Microsoft.NETCore.App) — описывает библиотеки, входящие в распространяемый пакет .NET Core. Формирует [платформу `.NETCoreApp`](https://github.com/dotnet/core-setup/blob/master/pkg/projects/Microsoft.NETCore.App/Microsoft.NETCore.App.pkgproj). Зависит от метапакета `NETStandard.Library`.
- [Microsoft.NETCore.Portable.Compatibility](https://www.nuget.org/packages/Microsoft.NETCore.Portable.Compatibility) — набор интерфейсов совместимости, которые обеспечивают выполнение переносимых библиотек классов на основе mscorlib в .NET Core.

Ссылки на метапакеты указываются так же, как ссылки на любые другие пакеты NuGet, в файле project.json. 

В приведенном ниже примере используется ссылка на метапакет `NETStandard.Library`, который служит для создания библиотек с возможностью переноса между разными средами выполнения .NET.

```json
{
  "dependencies": {
    "NETStandard.Library": "1.6.0"
  },
  "frameworks": {
    "netstandard1.6": {}
  }
}
```

В приведенном ниже примере используется ссылка на метапакет `Microsoft.NETCore.App`, который служит для создания приложений и библиотек, предназначенных для выполнения в среде .NET Core и использования всех ее возможностей. Он предоставляет доступ к более широкому набору библиотек, чем набор, предоставляемый `NETStandard.Library`.

```json
{
  "dependencies": {
    "Microsoft.NETCore.App": "1.0.0"
  },
  "frameworks": {
    "netcoreapp1.0": {}
  }
}
```

## <a name="frameworks"></a>Инфраструктуры

Каждый пакет .NET Core поддерживает набор платформ, которые объявляются в папках платформ (то есть в упомянутых ранее папках lib и ref). Платформа описывает доступный набор API (и, возможно, других характеристик), который можно применять при создании решения для данной платформы. Платформе присваивается новая версия при добавлении новых интерфейсов API.

Например, [System.IO.FileSystem](https://www.nuget.org/packages/System.IO.FileSystem) поддерживает следующие платформы:

- .NETFramework,Version=4.6;
- .NETStandard,Version=1.3;
- 6 платформ Xamarin (например, xamarinios10).

Полезно будет сравнить первые две из этих платформ, так как они представляют два разных способа определения платформ.

Платформа `.NETFramework,Version=4.6` представляет доступные интерфейсы API в .NET Framework 4.6. Вы можете создавать библиотеки, скомпилированные с помощью ссылочных сборок .NET Framework 4.6, а затем распространять их в пакетах NuGet в папке lib net46. Эта папка будет использоваться для приложений, предназначенных для платформы .NET Framework 4.6 или совместимых с ней. Именно так традиционно работали платформы.

Платформа `.NETStandard,Version=1.3` — это платформа на основе пакетов. Она использует пакеты, предназначенные для платформы, с целью определения и предоставления интерфейсов API в контексте платформы.

## <a name="packagebased-frameworks"></a>Платформы на основе пакетов

Между платформами и пакетами существует двусторонняя связь. Платформы определяют интерфейсы API, доступные для конкретной платформы, например `netstandard1.3`. Пакеты, предназначенные для `netstandard1.3` (или совместимых платформ, например `netstandard1.0`), определяют интерфейсы API, доступные для `netstandard1.3`. Такое определение может казаться циклически замкнутым, но это не так. Интерфейсы API для платформы основаны на пакетах, то есть определяются в них. Сама платформа не определяет интерфейсы API.

Второй стороной связи является выбор ресурсов. Пакеты могут содержать ресурсы для нескольких платформ. При наличии ссылки на набор пакетов или метапакетов платформе необходимо определить, какой ресурс следует выбрать, например `net46` или `netstandard1.3`. Важно выбрать правильный ресурс. Например, ресурс `net46` вряд ли будет совместим с .NET Framework 4.0 или .NET Core 1.0.

![Сочетаемость платформ на основе пакетов](./media/packages/package-framework.png)

Эту связь можно проследить на приведенном ниже рисунке. Интерфейс *API* нацелен на *платформу* и определяет ее. *Платформа* служит для *выбора актива*. *Актив* предоставляет интерфейс API.

Интересным представляется, где заканчивается определение платформы на основе пакетов и начинается использование этого определения. Платформу можно представить как функцию данного файла project.json. Зависимости формируют представление о платформе независимо от издателей этих зависимостей.

В .NET Core используются две основные платформы на основе пакетов:

- `netstandard`
- `netcoreapp`

### <a name="net-standard"></a>.NET Standard

Платформа .NET Standard (TFM: `netstandard`) представляет интерфейсы API, которые определяются и создаются на основе [библиотеки .NET Standard](../standard/library.md). Библиотеки, предназначенные для различных сред выполнения, должны быть нацелены на эту платформу. Они будут поддерживаться в любой среде выполнения, совместимой с .NET Standard, например .NET Core, .NET Framework и Mono или Xamarin. Каждая из этих сред выполнения поддерживает ряд версий .NET Standard в зависимости от реализуемых ими интерфейсов API. 

Метапакет `NETStandard.Library` предназначен для платформы `netstandard`. Наиболее распространенный способ нацеливания на `netstandard` — ссылка на этот метапакет. Он описывает и предоставляет доступ примерно к 40 библиотекам .NET и связанным интерфейсам API, которые определяют библиотеку .NET Standard. Вы можете ссылаться на другие пакеты, предназначенные для `netstandard`, чтобы получить доступ к дополнительным интерфейсам API.

[Версия библиотеки NETStandard.Library](versions/index.md) соответствует самой последней версии `netstandard`, к которой она представляет доступ (посредством оболочки). Ссылка на платформу в файле project.json служит для выбора соответствующих ресурсов из базовых пакетов. В данном случае требуются ресурсы `netstandard1.6`, а не `netstandard1.4` или `net46`, например. 

```json
{
  "dependencies": {
    "NETStandard.Library": "1.6.0"
  },
  "frameworks": {
    "netstandard1.6": {}
  }
}
```

Ссылки на платформу и метапакет в файле project.json не обязательно должны совпадать. Например, приведенный ниже файл project.json является допустимым.

```json
{
  "dependencies": {
    "NETStandard.Library": "1.6.0"
  },
  "frameworks": {
    "netstandard1.3": {}
  }
}
```

Нацеливание на `netstandard1.3` и одновременное использование версии 1.6.0 библиотеки `NETStandard.Library` может показаться странным. Однако это допустимый сценарий использования, так как метапакет поддерживает более старые версии `netstandard`. Например, вы могли выбрать версию 1.6.0 метапакета для стандартизации всех библиотек, которые предназначены для различных версий `netstandard`. При таком подходе необходимо восстанавливать только `NETStandard.Library` 1.6.0, но не предыдущие версии. 

Обратное (например, нацеливание на `netstandard1.6` с помощью `NETStandard.Library` версии 1.3.0) недопустимо. Нацеливание на платформу определенной версии с помощью метапакета более ранней версии невозможно, так как такой метапакет не будет предоставлять ресурсы для платформы более поздней версии. Согласно схеме управления версиями метапакетов метапакеты соответствуют самой поздней версии платформы, которую они описывают. Вследствие такой схемы управления версиями первая версия `NETStandard.Library` — 1.6.0, при условии, что она содержит ресурсы `netstandard1.6`. Версия 1.3.0 используется в предыдущем примере для согласованности с другим приведенным выше примером, хотя такой версии на самом деле нет.

### <a name="net-core-application"></a>Приложение .NET Core

Платформа приложений .NET Core (TFM: `netcoreapp`) представляет пакеты и связанные интерфейсы API, которые входят в состав распространяемого пакета .NET Core и предоставляемой им модели консольных приложений. Приложения .NET Core должны использовать эту платформу вследствие нацеливания на модель консольных приложений, так же как и библиотеки, предназначенные для выполнения только в .NET Core. При использовании этой платформы приложения и библиотеки могут выполняться только в .NET Core. 

Метапакет `Microsoft.NETCore.App` предназначен для платформы `netcoreapp`. Он обеспечивает доступ к примерно 40 библиотекам, предоставляемым пакетом `NETStandard.Library`, и примерно 20 дополнительным библиотекам (всего около 60 библиотек). Вы можете ссылаться на дополнительные библиотеки, предназначенные для `netcoreapp` или совместимых платформ, например `netstandard`, для получения доступа к дополнительным интерфейсам API. 

Большинство дополнительных библиотек, предоставляемых `Microsoft.NETCore.App`, также предназначены для `netstandard`, при условии что их зависимости обеспечиваются другими библиотеками `netstandard`. Это означает, что библиотеки `netstandard` также могут ссылаться на эти пакеты в качестве зависимостей. 


<!--HONumber=Nov16_HO1-->


