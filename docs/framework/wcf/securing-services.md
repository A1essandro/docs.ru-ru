---
title: "Защита служб"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- configuration [WCF], securing services
- WCF security
- WCF, security
ms.assetid: f0ecc6f7-f4b5-42a4-9cb1-b02e28e26620
caps.latest.revision: "28"
author: BrucePerlerMS
ms.author: bruceper
manager: mbaldwin
ms.workload: dotnet
ms.openlocfilehash: 2b8e84fe75f812cdcb97dcc24a0edad2d238515b
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="securing-services"></a><span data-ttu-id="f78ef-102">Защита служб</span><span class="sxs-lookup"><span data-stu-id="f78ef-102">Securing Services</span></span>
<span data-ttu-id="f78ef-103">Для обеспечения безопасности службы [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] необходимо выполнение двух основных требований - обеспечение безопасности передачи и выполнение авторизации.</span><span class="sxs-lookup"><span data-stu-id="f78ef-103">Security of a [!INCLUDE[indigo1](../../../includes/indigo1-md.md)] service consists of two primary requirements: transfer security and authorization.</span></span> <span data-ttu-id="f78ef-104">(Третье требование, аудит событий безопасности описана в [аудита](../../../docs/framework/wcf/feature-details/auditing-security-events.md).) Вкратце, для обеспечения безопасности передачи должна быть выполнена проверка подлинности (проверка идентификации как службы, так и клиента) и обеспечены конфиденциальность (шифрование сообщений) и целостность (цифровая подпись для обнаружения подделки).</span><span class="sxs-lookup"><span data-stu-id="f78ef-104">(A third requirement, auditing of security events, is described in [Auditing](../../../docs/framework/wcf/feature-details/auditing-security-events.md).) In brief, transfer security includes authentication (verifying the identity of both the service and the client), confidentiality (message encryption), and integrity (digital signing to detect tampering).</span></span> <span data-ttu-id="f78ef-105">Авторизация - это управление доступом к ресурсам, например разрешение чтение файла только привилегированным пользователям.</span><span class="sxs-lookup"><span data-stu-id="f78ef-105">Authorization is the control of access to resources, for example, allowing only privileged users to read a file.</span></span> <span data-ttu-id="f78ef-106">С помощью функций [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]два основных требования легко реализуются.</span><span class="sxs-lookup"><span data-stu-id="f78ef-106">Using features of [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], the two primary requirements are easily implemented.</span></span>  
  
 <span data-ttu-id="f78ef-107">За исключением элемента <xref:System.ServiceModel.BasicHttpBinding> класс (или [ \<basicHttpBinding >](../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md) элемента в конфигурации), обеспечение безопасности передачи включено по умолчанию для всех предопределенных привязок.</span><span class="sxs-lookup"><span data-stu-id="f78ef-107">With the exception of the <xref:System.ServiceModel.BasicHttpBinding> class (or the [\<basicHttpBinding>](../../../docs/framework/configure-apps/file-schema/wcf/basichttpbinding.md) element in configuration), transfer security is enabled by default for all of the predefined bindings.</span></span> <span data-ttu-id="f78ef-108">В подразделах данного раздела рассматриваются два основных сценария: обеспечение безопасности передачи и авторизации в службе интрасети, размещенной в IIS, а также обеспечение безопасности передачи и авторизации в службе, размещенной в IIS.</span><span class="sxs-lookup"><span data-stu-id="f78ef-108">The topics in this section cover two basic scenarios: implementing transfer security and authorization on an intranet service hosted on Internet Information Services (IIS), and implementing transfer security and authorization on a service hosted on IIS.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="f78ef-109">В Windows XP Home проверка подлинности Windows не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="f78ef-109">Windows XP Home does not support Windows authentication.</span></span> <span data-ttu-id="f78ef-110">Поэтому не следует запускать службу в этой системе.</span><span class="sxs-lookup"><span data-stu-id="f78ef-110">Therefore, you should not run a service on that system.</span></span>  
  
## <a name="security-basics"></a><span data-ttu-id="f78ef-111">Общие сведения о безопасности</span><span class="sxs-lookup"><span data-stu-id="f78ef-111">Security Basics</span></span>  
 <span data-ttu-id="f78ef-112">Средства обеспечения безопасности полагаются на *учетные данные*.</span><span class="sxs-lookup"><span data-stu-id="f78ef-112">Security relies on *credentials*.</span></span> <span data-ttu-id="f78ef-113">Учетные данные удостоверяют, что сущность является тем, за кого она себя выдает.</span><span class="sxs-lookup"><span data-stu-id="f78ef-113">A credential proves that an entity is who it claims to be.</span></span> <span data-ttu-id="f78ef-114">( *Сущности* может быть лицо, программный процесс, компания или каком-либо авторизованных.) Например, клиент службы делает *утверждения* из *удостоверения*, и учетные данные подтверждают некоторым способом это утверждение.</span><span class="sxs-lookup"><span data-stu-id="f78ef-114">(An *entity* can be a person, a software process, a company, or anything that can be authorized.) For example, a client of a service makes a *claim* of *identity*, and the credential proves that claim in some manner.</span></span> <span data-ttu-id="f78ef-115">В типовом сценарии происходит обмен учетными данными.</span><span class="sxs-lookup"><span data-stu-id="f78ef-115">In a typical scenario, an exchange of credentials occurs.</span></span> <span data-ttu-id="f78ef-116">Сначала служба делает утверждение своей идентификации и подтверждает его клиенту с помощью учетных данных.</span><span class="sxs-lookup"><span data-stu-id="f78ef-116">First, a service makes a claim of its identity and proves it to the client with a credential.</span></span> <span data-ttu-id="f78ef-117">И наоборот, клиент делает утверждение идентификации и представляет учетные данные службе.</span><span class="sxs-lookup"><span data-stu-id="f78ef-117">Conversely, the client makes a claim of identity and presents a credential to the service.</span></span> <span data-ttu-id="f78ef-118">Если обе стороны доверяют учетным данным друг друга, может быть установлен *контекст безопасности* , в котором осуществляется конфиденциальный обмен сообщениями, и все сообщения подписываются для защиты их целостности.</span><span class="sxs-lookup"><span data-stu-id="f78ef-118">If both parties trust the other's credentials, then a *secure context* can be established in which all messages are exchanged in confidentiality, and all messages are signed to protect their integrity.</span></span> <span data-ttu-id="f78ef-119">После того как служба устанавливает идентификацию клиента, она может сопоставить утверждения в учетных данных с *ролью* или *членством* в группе.</span><span class="sxs-lookup"><span data-stu-id="f78ef-119">After the service establishes the client's identity, it can then match the claims in the credential to a *role* or *membership* in a group.</span></span> <span data-ttu-id="f78ef-120">В каждом случае, используя роль или группу, к которой относится клиент, служба *разрешает* клиенту выполнять ограниченный набор операций, основанных на привилегиях роли или группы.</span><span class="sxs-lookup"><span data-stu-id="f78ef-120">In either case, using the role or the group to which the client belongs, the service *authorizes* the client to perform a limited set of operations based on the role or group privileges.</span></span>  
  
## <a name="windows-security-mechanisms"></a><span data-ttu-id="f78ef-121">Механизмы безопасности Windows</span><span class="sxs-lookup"><span data-stu-id="f78ef-121">Windows Security Mechanisms</span></span>  
 <span data-ttu-id="f78ef-122">Если клиент и компьютер службы находятся в домене Windows, который требует, чтобы и клиент, и компьютер службы регистрировались в сети, учетные данные предоставляются инфраструктурой Windows.</span><span class="sxs-lookup"><span data-stu-id="f78ef-122">If the client and the service computer are both on a Windows domain that requires both to log on to the network, the credentials are provided by Windows infrastructure.</span></span> <span data-ttu-id="f78ef-123">В этом случае учетные данные создаются, когда пользователь компьютера регистрируется в сети.</span><span class="sxs-lookup"><span data-stu-id="f78ef-123">In that case, the credentials are established when a computer user logs on to the network.</span></span> <span data-ttu-id="f78ef-124">Каждый пользователь и каждый компьютер в сети должны быть проверены на принадлежность к доверенному набору пользователей и компьютеров.</span><span class="sxs-lookup"><span data-stu-id="f78ef-124">Every user and every computer on the network must be validated as belonging to the trusted set of users and computers.</span></span> <span data-ttu-id="f78ef-125">В системе Windows каждый такой пользователь и компьютер называются также *участниками безопасности*.</span><span class="sxs-lookup"><span data-stu-id="f78ef-125">On a Windows system, every such user and computer is also known as a *security principal*.</span></span>  
  
 <span data-ttu-id="f78ef-126">В домене Windows, поддерживаемом контроллером *Kerberos* , контроллер Kerberos использует схему, основанную на предоставлении билетов каждому участнику безопасности.</span><span class="sxs-lookup"><span data-stu-id="f78ef-126">On a Windows domain backed by a *Kerberos* controller, the Kerberos controller uses a scheme based on granting tickets to each security principal.</span></span> <span data-ttu-id="f78ef-127">Билетам, предоставляемым этим контроллером, доверяют другие предоставляющие билеты средства в системе.</span><span class="sxs-lookup"><span data-stu-id="f78ef-127">The tickets the controller grants are trusted by other ticket granters in the system.</span></span> <span data-ttu-id="f78ef-128">Всякий раз когда сущность пытается выполнить некоторую операцию или получить доступ к *ресурсу* (например, файлу или каталогу на компьютере), билет проверяется на его действительность и в случае успешного прохождения проверки участнику предоставляется другой билет для операции.</span><span class="sxs-lookup"><span data-stu-id="f78ef-128">Whenever an entity tries to perform some operation or access a *resource* (such as a file or directory on a machine), the ticket is examined for its validity and, if it passes, the principal is granted another ticket for the operation.</span></span> <span data-ttu-id="f78ef-129">Этот метод предоставления билетов более эффективен, чем попытка проверить участника для каждой операции.</span><span class="sxs-lookup"><span data-stu-id="f78ef-129">This method of granting tickets is more efficient than the alternative of trying to validate the principal for every operation.</span></span>  
  
 <span data-ttu-id="f78ef-130">Более старый и менее безопасный механизм, используемый в доменах Windows, - NT LAN Manager (NTLM).</span><span class="sxs-lookup"><span data-stu-id="f78ef-130">An older, less-secure mechanism used on Windows domains is NT LAN Manager (NTLM).</span></span> <span data-ttu-id="f78ef-131">В случаях, когда использовать Kerberos невозможно (обычно вне домена Windows, например в рабочей группе), в качестве альтернативы можно применять NTLM.</span><span class="sxs-lookup"><span data-stu-id="f78ef-131">In cases where Kerberos cannot be used (typically outside of a Windows domain, such as in a workgroup), NTLM can be used as an alternative.</span></span> <span data-ttu-id="f78ef-132">Механизм NTLM доступен также в качестве варианта обеспечения безопасности для IIS.</span><span class="sxs-lookup"><span data-stu-id="f78ef-132">NTLM is also available as a security option for IIS.</span></span>  
  
 <span data-ttu-id="f78ef-133">В системе Windows авторизация осуществляется посредством назначения каждого компьютера и пользователя ряду ролей и групп.</span><span class="sxs-lookup"><span data-stu-id="f78ef-133">On a Windows system, authorization works by assigning each computer and user to a set of roles and groups.</span></span> <span data-ttu-id="f78ef-134">Например, каждый компьютер Windows должен настраиваться и управляться лицом (или группой лиц) в роли *администратора*.</span><span class="sxs-lookup"><span data-stu-id="f78ef-134">For example, every Windows computer must be set up and controlled by a person (or group of people) in the role of the *administrator*.</span></span> <span data-ttu-id="f78ef-135">Другая роль - *пользователь*. Она имеет намного более ограниченный набор прав.</span><span class="sxs-lookup"><span data-stu-id="f78ef-135">Another role is that of the *user*, which has a much more constrained set of permissions.</span></span> <span data-ttu-id="f78ef-136">Помимо роли, пользователи назначаются группам.</span><span class="sxs-lookup"><span data-stu-id="f78ef-136">In addition to the role, users are assigned to groups.</span></span> <span data-ttu-id="f78ef-137">Группа позволяет нескольким пользователям выполнять действия в одной и той же роли.</span><span class="sxs-lookup"><span data-stu-id="f78ef-137">A group allows multiple users to perform in the same role.</span></span> <span data-ttu-id="f78ef-138">Следовательно, фактически компьютер Windows администрируется путем назначения пользователей группам.</span><span class="sxs-lookup"><span data-stu-id="f78ef-138">In practice, therefore, a Windows machine is administered by assigning users to groups.</span></span> <span data-ttu-id="f78ef-139">Например, несколько пользователей могут быть назначены группе пользователей компьютера, и намного более ограниченный набор пользователей может быть назначен группе администраторов.</span><span class="sxs-lookup"><span data-stu-id="f78ef-139">For example, several users can be assigned to the group of users of a computer, and a much more constrained set of users can be assigned to the group of administrators.</span></span> <span data-ttu-id="f78ef-140">На локальном компьютере администратор может также создавать новые группы и назначать других пользователей (или даже другие группы) группе.</span><span class="sxs-lookup"><span data-stu-id="f78ef-140">On a local machine, an administrator can also create new groups and assign other users (or even other groups) to the group.</span></span>  
  
 <span data-ttu-id="f78ef-141">На компьютере под управлением Windows можно защитить каждую папку в каталоге,</span><span class="sxs-lookup"><span data-stu-id="f78ef-141">On a computer running Windows, every folder in a directory can be protected.</span></span> <span data-ttu-id="f78ef-142">т. е. можно выбрать папку и управлять тем, кто может обращаться к файлам, а также тем, можно ли копировать тот или иной файл или (в наиболее привилегированном случае) изменить файл, удалить файл либо добавить файлы в папку.</span><span class="sxs-lookup"><span data-stu-id="f78ef-142">That is, you can select a folder and control who can access the files, and whether or not they can copy the file, or (in the most privileged case) change a file, delete a file, or add files to the folder.</span></span> <span data-ttu-id="f78ef-143">Это называется управлением доступом, а механизм для такого управления - списком управления доступом (ACL).</span><span class="sxs-lookup"><span data-stu-id="f78ef-143">This is known as access control, and the mechanism for it is known as the access control list (ACL).</span></span> <span data-ttu-id="f78ef-144">При создании ACL можно назначить привилегии доступа любой группе или группам, а также отдельным членам домена.</span><span class="sxs-lookup"><span data-stu-id="f78ef-144">When creating the ACL, you can assign access privileges to any group or groups, as well as individual members of a domain.</span></span>  
  
 <span data-ttu-id="f78ef-145">Инфраструктура [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] разработана для использования этих механизмов безопасности Windows.</span><span class="sxs-lookup"><span data-stu-id="f78ef-145">The [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] infrastructure is designed to use these Windows security mechanisms.</span></span> <span data-ttu-id="f78ef-146">Следовательно, если создается служба, которая развертывается в интрасети, и клиентами этой службы являются только члены домена Windows, безопасность легко обеспечить.</span><span class="sxs-lookup"><span data-stu-id="f78ef-146">Therefore, if you are creating a service that is deployed on an intranet, and whose clients are restricted to members of the Windows domain, security is easily implemented.</span></span> <span data-ttu-id="f78ef-147">В домен могут входить только допустимые пользователи.</span><span class="sxs-lookup"><span data-stu-id="f78ef-147">Only valid users can log on to the domain.</span></span> <span data-ttu-id="f78ef-148">После входа пользователей контроллер Kerberos разрешает каждому пользователю устанавливать безопасные контексты с любым другим компьютером или приложением.</span><span class="sxs-lookup"><span data-stu-id="f78ef-148">After users are logged on, the Kerberos controller enables each user to establish secure contexts with any other computer or application.</span></span> <span data-ttu-id="f78ef-149">На локальном компьютере можно легко создать группы, и при защите конкретных папок эти группы можно использовать для назначения привилегий доступа на этом компьютере.</span><span class="sxs-lookup"><span data-stu-id="f78ef-149">On a local machine, groups can be easily created, and when protecting specific folders, those groups can be used to assign access privileges on the computer.</span></span>  
  
## <a name="implementing-windows-security-on-intranet-services"></a><span data-ttu-id="f78ef-150">Реализация безопасности Windows в службах интрасети</span><span class="sxs-lookup"><span data-stu-id="f78ef-150">Implementing Windows Security on Intranet Services</span></span>  
 <span data-ttu-id="f78ef-151">Чтобы защитить приложение, работающее только в домене Windows, можно использовать параметры безопасности по умолчанию привязки <xref:System.ServiceModel.WSHttpBinding> или <xref:System.ServiceModel.NetTcpBinding> .</span><span class="sxs-lookup"><span data-stu-id="f78ef-151">To secure an application that runs exclusively on a Windows domain, you can use the default security settings of either the <xref:System.ServiceModel.WSHttpBinding> or the <xref:System.ServiceModel.NetTcpBinding> binding.</span></span> <span data-ttu-id="f78ef-152">По умолчанию любой пользователь одного и того же домена Windows может иметь доступ к службам [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f78ef-152">By default, anyone on the same Windows domain can access [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services.</span></span> <span data-ttu-id="f78ef-153">Поскольку такие пользователи зарегистрированы в сети, они являются доверенными.</span><span class="sxs-lookup"><span data-stu-id="f78ef-153">Because those users have logged on to the network, they are trusted.</span></span> <span data-ttu-id="f78ef-154">Сообщения между службой и клиентом шифруются в целях конфиденциальности и подписываются в целях целостности.</span><span class="sxs-lookup"><span data-stu-id="f78ef-154">The messages between a service and a client are encrypted for confidentiality and signed for integrity.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="f78ef-155"> создании службы, использующей безопасность Windows, см. в разделе [How to: Secure a Service with Windows Credentials](../../../docs/framework/wcf/how-to-secure-a-service-with-windows-credentials.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-155"> how to create a service that uses Windows security, see [How to: Secure a Service with Windows Credentials](../../../docs/framework/wcf/how-to-secure-a-service-with-windows-credentials.md).</span></span>  
  
### <a name="authorization-using-the-principalpermissionattribute-class"></a><span data-ttu-id="f78ef-156">Авторизация с использованием класса PrincipalPermissionAttribute</span><span class="sxs-lookup"><span data-stu-id="f78ef-156">Authorization Using the PrincipalPermissionAttribute Class</span></span>  
 <span data-ttu-id="f78ef-157">Если необходимо ограничить доступ к ресурсам на компьютере, проще всего использовать класс <xref:System.Security.Permissions.PrincipalPermissionAttribute> .</span><span class="sxs-lookup"><span data-stu-id="f78ef-157">If you need to restrict the access of resources on a computer, the easiest way is to use the <xref:System.Security.Permissions.PrincipalPermissionAttribute> class.</span></span> <span data-ttu-id="f78ef-158">Этот атрибут позволяет ограничить вызов операций службы, требуя, чтобы пользователь находился в заданной группе Windows или имел заданную роль Windows или был особым пользователем.</span><span class="sxs-lookup"><span data-stu-id="f78ef-158">This attribute enables you to restrict the invocation of service operations by demanding that the user be in a specified Windows group or role, or to be a specific user.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="f78ef-159">[Как: ограничение доступа с использованием класса PrincipalPermissionAttribute](../../../docs/framework/wcf/how-to-restrict-access-with-the-principalpermissionattribute-class.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-159"> [How to: Restrict Access with the PrincipalPermissionAttribute Class](../../../docs/framework/wcf/how-to-restrict-access-with-the-principalpermissionattribute-class.md).</span></span>  
  
### <a name="impersonation"></a><span data-ttu-id="f78ef-160">Олицетворение</span><span class="sxs-lookup"><span data-stu-id="f78ef-160">Impersonation</span></span>  
 <span data-ttu-id="f78ef-161">Для управления доступом к ресурсам можно также использовать другой механизм, называемый олицетворением.</span><span class="sxs-lookup"><span data-stu-id="f78ef-161">Impersonation is another mechanism that you can use to control access to resources.</span></span> <span data-ttu-id="f78ef-162">По умолчанию служба, размещенная в IIS, работает под идентификатором учетной записи ASPNET.</span><span class="sxs-lookup"><span data-stu-id="f78ef-162">By default, a service hosted by IIS will run under the identity of the ASPNET account.</span></span> <span data-ttu-id="f78ef-163">Учетная запись ASPNET может иметь доступ только к ресурсам, использовать которые она имеет право.</span><span class="sxs-lookup"><span data-stu-id="f78ef-163">The ASPNET account can access only the resources for which it has permission.</span></span> <span data-ttu-id="f78ef-164">Однако для папки можно задать ACL, чтобы исключить учетную запись службы ASPNET, но разрешить доступ к папке некоторым другим идентификаторам.</span><span class="sxs-lookup"><span data-stu-id="f78ef-164">However, it is possible to set the ACL for a folder to exclude the ASPNET service account, but allow certain other identities to access the folder.</span></span> <span data-ttu-id="f78ef-165">Тогда встает вопрос, как разрешить этим пользователям доступ к папке, если для учетной записи ASPNET такой доступ не разрешен?</span><span class="sxs-lookup"><span data-stu-id="f78ef-165">The question then becomes how to allow those users to access the folder if the ASPNET account is not allowed to do so.</span></span> <span data-ttu-id="f78ef-166">Ответ - воспользоваться олицетворением, с помощью которого службе разрешается использовать учетные данные клиента для доступа к конкретному ресурсу.</span><span class="sxs-lookup"><span data-stu-id="f78ef-166">The answer is to use impersonation, whereby the service is allowed to use the credentials of the client to access a particular resource.</span></span> <span data-ttu-id="f78ef-167">Другим примером служит доступ к базе данных SQL Server, обращаться к которой имеют право только определенные пользователи.</span><span class="sxs-lookup"><span data-stu-id="f78ef-167">Another example is when accessing a SQL Server database to which only certain users have permission.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="f78ef-168">использовании олицетворения см. в разделе [как: олицетворение клиента в службе](../../../docs/framework/wcf/how-to-impersonate-a-client-on-a-service.md) и [делегирования и олицетворения](../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-168"> using impersonation, see [How to: Impersonate a Client on a Service](../../../docs/framework/wcf/how-to-impersonate-a-client-on-a-service.md) and [Delegation and Impersonation](../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md).</span></span>  
  
## <a name="security-on-the-internet"></a><span data-ttu-id="f78ef-169">Безопасность в Интернете</span><span class="sxs-lookup"><span data-stu-id="f78ef-169">Security on the Internet</span></span>  
 <span data-ttu-id="f78ef-170">Для обеспечения безопасности в Интернете необходимо выполнение тех же требований, что и для обеспечения безопасности в интрасети.</span><span class="sxs-lookup"><span data-stu-id="f78ef-170">Security on the Internet consists of the same requirements as security on an intranet.</span></span> <span data-ttu-id="f78ef-171">Служба должна представить свои учетные данные, чтобы подтвердить свою подлинность, а клиенты должны подтвердить свою идентификацию службе.</span><span class="sxs-lookup"><span data-stu-id="f78ef-171">A service needs to present its credentials to prove its authenticity, and clients need to prove their identity to the service.</span></span> <span data-ttu-id="f78ef-172">Проверив идентификацию клиента, служба может управлять доступом этого клиента к ресурсам.</span><span class="sxs-lookup"><span data-stu-id="f78ef-172">Once a client's identity is proven, the service can control how much access the client has to resources.</span></span> <span data-ttu-id="f78ef-173">Однако из-за разнородности Интернета представляемые учетные данные отличаются от учетных данных, используемых в домене Windows.</span><span class="sxs-lookup"><span data-stu-id="f78ef-173">However, due to the heterogeneous nature of the Internet, the credentials presented differ from those used on a Windows domain.</span></span> <span data-ttu-id="f78ef-174">Контроллер Kerberos осуществляет проверку подлинности пользователей в домене, используя билеты для учетных данных, а в Интернете службы и клиенты полагаются на один из нескольких других способов представления учетных данных.</span><span class="sxs-lookup"><span data-stu-id="f78ef-174">Whereas a Kerberos controller handles the authentication of users on a domain with tickets for credentials, on the Internet, services and clients rely on any one of several different ways to present credentials.</span></span> <span data-ttu-id="f78ef-175">Цель данного раздела, однако, - представить общий подход, позволяющий создать службу [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] , доступную в Интернете.</span><span class="sxs-lookup"><span data-stu-id="f78ef-175">The objective of this topic, however, is to present a common approach that enables you to create a [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service that is accessible on the Internet.</span></span>  
  
### <a name="using-iis-and-aspnet"></a><span data-ttu-id="f78ef-176">Использование IIS и ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f78ef-176">Using IIS and ASP.NET</span></span>  
 <span data-ttu-id="f78ef-177">Требования безопасности в Интернете и механизмы устранения связанных с безопасностью проблем не являются новыми.</span><span class="sxs-lookup"><span data-stu-id="f78ef-177">The requirements of Internet security, and the mechanisms to solve those problems, are not new.</span></span> <span data-ttu-id="f78ef-178">IIS - это веб-сервер корпорации Майкрософт для Интернета, в котором реализовано много функций обеспечения безопасности, устраняющих такие проблемы; кроме того, [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] содержит функции обеспечения безопасности, которые могут использоваться службами [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="f78ef-178">IIS is Microsoft's Web server for the Internet and has many security features that address those problems; in addition, [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] includes security features that [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] services can use.</span></span> <span data-ttu-id="f78ef-179">Чтобы воспользоваться преимуществами этих функций обеспечения безопасности, разместите службу [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] в IIS.</span><span class="sxs-lookup"><span data-stu-id="f78ef-179">To take advantage of these security features, host an [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] service on IIS.</span></span>  
  
#### <a name="using-aspnet-membership-and-role-providers"></a><span data-ttu-id="f78ef-180">Использование поставщиков членства и ролей ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f78ef-180">Using ASP.NET Membership and Role Providers</span></span>  
 <span data-ttu-id="f78ef-181">ASP.NET содержит поставщик членства и ролей.</span><span class="sxs-lookup"><span data-stu-id="f78ef-181">ASP.NET includes a membership and role provider.</span></span> <span data-ttu-id="f78ef-182">Поставщик - это база данных пар "имя пользователя – пароль" для проверки подлинности вызывающих, которая также позволяет задавать привилегии доступа каждого вызывающего.</span><span class="sxs-lookup"><span data-stu-id="f78ef-182">The provider is a database of user name/password pairs for authenticating callers that also allows you to specify each caller's access privileges.</span></span> <span data-ttu-id="f78ef-183">С помощью [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]можно легко использовать уже существующий поставщик членства и ролей через конфигурацию.</span><span class="sxs-lookup"><span data-stu-id="f78ef-183">With [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], you can easily use a pre-existing membership and role provider through configuration.</span></span> <span data-ttu-id="f78ef-184">Пример приложения, где демонстрируется такое использование, см. в примере [Membership and Role Provider](../../../docs/framework/wcf/samples/membership-and-role-provider.md) .</span><span class="sxs-lookup"><span data-stu-id="f78ef-184">For a sample application that demonstrates this, see the [Membership and Role Provider](../../../docs/framework/wcf/samples/membership-and-role-provider.md) sample.</span></span>  
  
### <a name="credentials-used-by-iis"></a><span data-ttu-id="f78ef-185">Учетные данные, используемые IIS</span><span class="sxs-lookup"><span data-stu-id="f78ef-185">Credentials Used by IIS</span></span>  
 <span data-ttu-id="f78ef-186">В отличие от домена Windows, поддерживаемого контроллером Kerberos, Интернет - это среда без отдельного контроллера для управления миллионами пользователей, входящими в систему в любое время.</span><span class="sxs-lookup"><span data-stu-id="f78ef-186">Unlike a Windows domain backed by a Kerberos controller, the Internet is an environment without a single controller to manage the millions of users logging on at any time.</span></span> <span data-ttu-id="f78ef-187">Вместо этого учетные данные в Интернете чаще всего представляются в виде сертификатов X.509 (называемых также сертификатами SSL).</span><span class="sxs-lookup"><span data-stu-id="f78ef-187">Instead, credentials on the Internet most often are in the form of X.509 certificates (also known as Secure Sockets Layer, or SSL, certificates).</span></span> <span data-ttu-id="f78ef-188">Эти сертификаты обычно издаются *центром сертификации*, которым может быть сторонняя компания, гарантирующая подлинность сертификата и лица, для которого он издан.</span><span class="sxs-lookup"><span data-stu-id="f78ef-188">These certificates are typically issued by a *certification authority*, which can be a third-party company that vouches for the authenticity of the certificate and the person it has been issued to.</span></span> <span data-ttu-id="f78ef-189">Чтобы представить службу в Интернете, необходимо также предоставить такой доверенный сертификат для проверки подлинности службы.</span><span class="sxs-lookup"><span data-stu-id="f78ef-189">To expose your service on the Internet, you must also supply such a trusted certificate to authenticate your service.</span></span>  
  
 <span data-ttu-id="f78ef-190">При этом возникает вопрос, как получить такой сертификат?</span><span class="sxs-lookup"><span data-stu-id="f78ef-190">The question arises at this point, how do you get such a certificate?</span></span> <span data-ttu-id="f78ef-191">Один из способов: при готовности развернуть службу и приобрести для нее сертификат следует обратиться в сторонний центр сертификации, например Authenticode или VeriSign.</span><span class="sxs-lookup"><span data-stu-id="f78ef-191">One approach is to go to a third-party certification authority, such as Authenticode or VeriSign, when you are ready to deploy your service, and purchase a certificate for your service.</span></span> <span data-ttu-id="f78ef-192">Однако на случай нахождения на этапе развертывания с [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] и неготовности приобрести сертификат предусмотрены средства и методы для создания сертификатов X.509, которые можно использовать для моделирования развертывания в рабочей среде.</span><span class="sxs-lookup"><span data-stu-id="f78ef-192">However, if you are in the development phase with [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] and not yet ready to commit to purchasing a certificate, tools and techniques exist for creating X.509 certificates that you can use to simulate a production deployment.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="f78ef-193">[Работа с сертификатами](../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-193"> [Working with Certificates](../../../docs/framework/wcf/feature-details/working-with-certificates.md).</span></span>  
  
## <a name="security-modes"></a><span data-ttu-id="f78ef-194">Режимы безопасности</span><span class="sxs-lookup"><span data-stu-id="f78ef-194">Security Modes</span></span>  
 <span data-ttu-id="f78ef-195">При программировании безопасности [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] встает несколько очень важных вопросов, подлежащих решению.</span><span class="sxs-lookup"><span data-stu-id="f78ef-195">Programming [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] security entails a few critical decision points.</span></span> <span data-ttu-id="f78ef-196">Один из самых главных вопросов - выбор *режима безопасности*.</span><span class="sxs-lookup"><span data-stu-id="f78ef-196">One of the most basic is the choice of *security mode*.</span></span> <span data-ttu-id="f78ef-197">Два основных режима безопасности - *транспортный режим* и *режим сообщений*.</span><span class="sxs-lookup"><span data-stu-id="f78ef-197">The two major security modes are *transport mode* and *message mode*.</span></span>  
  
 <span data-ttu-id="f78ef-198">Третий режим, в котором объединяется семантика двух основных режимов, - *режим транспорта с учетными данными сообщений*.</span><span class="sxs-lookup"><span data-stu-id="f78ef-198">A third mode, which combines the semantics of both major modes, is *transport with message credentials mode*.</span></span>  
  
 <span data-ttu-id="f78ef-199">Режим безопасности определяет способ защиты сообщений. Каждый вариант имеет свои преимущества и недостатки, описанные ниже.</span><span class="sxs-lookup"><span data-stu-id="f78ef-199">The security mode determines how messages are secured, and each choice has advantages and disadvantages, as explained below.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="f78ef-200"> задании режима безопасности см. в разделе [How to: Set the Security Mode](../../../docs/framework/wcf/how-to-set-the-security-mode.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-200"> setting the security mode, see [How to: Set the Security Mode](../../../docs/framework/wcf/how-to-set-the-security-mode.md).</span></span>  
  
#### <a name="transport-mode"></a><span data-ttu-id="f78ef-201">транспортный режим</span><span class="sxs-lookup"><span data-stu-id="f78ef-201">Transport Mode</span></span>  
 <span data-ttu-id="f78ef-202">Между сетевым и прикладным уровнями находится несколько уровней.</span><span class="sxs-lookup"><span data-stu-id="f78ef-202">There are several layers between the network and the application.</span></span> <span data-ttu-id="f78ef-203">Одним из таких уровней является *транспортный* уровень*,* который управляет передачей сообщений между конечными точками.</span><span class="sxs-lookup"><span data-stu-id="f78ef-203">One of these is the *transport* layer*,* which manages the transfer of messages between endpoints.</span></span> <span data-ttu-id="f78ef-204">В данном случае необходимо понимать только то, что [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] использует несколько транспортных протоколов, каждый из которых может защищать передачу сообщений.</span><span class="sxs-lookup"><span data-stu-id="f78ef-204">For the present purpose, it is only required that you understand that [!INCLUDE[indigo2](../../../includes/indigo2-md.md)] uses several transport protocols, each of which can secure the transfer of messages.</span></span> <span data-ttu-id="f78ef-205">([!INCLUDE[crabout](../../../includes/crabout-md.md)] транспортов. в разделе [транспортов](../../../docs/framework/wcf/feature-details/transports.md).)</span><span class="sxs-lookup"><span data-stu-id="f78ef-205">([!INCLUDE[crabout](../../../includes/crabout-md.md)] transports, see [Transports](../../../docs/framework/wcf/feature-details/transports.md).)</span></span>  
  
 <span data-ttu-id="f78ef-206">Обычно используемым протоколом является протокол HTTP; другой применяемый протокол - TCP.</span><span class="sxs-lookup"><span data-stu-id="f78ef-206">A commonly used protocol is HTTP; another is TCP.</span></span> <span data-ttu-id="f78ef-207">Каждый из этих протоколов может защищать передачу сообщений с помощью механизма (или механизмов), ориентированного на конкретный протокол.</span><span class="sxs-lookup"><span data-stu-id="f78ef-207">Each of these protocols can secure message transfer by a mechanism (or mechanisms) particular to the protocol.</span></span> <span data-ttu-id="f78ef-208">Например, протокол HTTP защищается с помощью протокола SSL поверх HTTP, обычно называемого "HTTPS".</span><span class="sxs-lookup"><span data-stu-id="f78ef-208">For example, the HTTP protocol is secured using SSL over HTTP, commonly abbreviated as "HTTPS."</span></span> <span data-ttu-id="f78ef-209">Таким образом, если для обеспечения безопасности выбирается транспортный режим, используется механизм, определяемый протоколом.</span><span class="sxs-lookup"><span data-stu-id="f78ef-209">Thus, when you select the transport mode for security, you are choosing to use the mechanism as dictated by the protocol.</span></span> <span data-ttu-id="f78ef-210">Например, если выбирается класс <xref:System.ServiceModel.WSHttpBinding> и в качестве его режима безопасности задается Transport, в качестве механизма безопасности выбирается протокол SSL поверх HTTP (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="f78ef-210">For example, if you select the <xref:System.ServiceModel.WSHttpBinding> class and set its security mode to Transport, you are selecting SSL over HTTP (HTTPS) as the security mechanism.</span></span> <span data-ttu-id="f78ef-211">Преимущество транспортного режима в том, что он более эффективен, чем режим сообщений, поскольку средства обеспечения безопасности интегрируются на относительно низком уровне.</span><span class="sxs-lookup"><span data-stu-id="f78ef-211">The advantage of the transport mode is that it is more efficient than message mode because security is integrated at a comparatively low level.</span></span> <span data-ttu-id="f78ef-212">При использовании транспортного режима механизм безопасности должен быть реализован в соответствии со спецификацией транспорта, и, таким образом, сообщения могут безопасно передаваться только от точки к точке по транспортному каналу.</span><span class="sxs-lookup"><span data-stu-id="f78ef-212">When using transport mode, the security mechanism must be implemented according to the specification for the transport, and thus messages can flow securely only from point-to-point over the transport.</span></span>  
  
#### <a name="message-mode"></a><span data-ttu-id="f78ef-213">режим сообщений</span><span class="sxs-lookup"><span data-stu-id="f78ef-213">Message Mode</span></span>  
 <span data-ttu-id="f78ef-214">В отличие от транспортного режима, в режиме сообщений безопасность обеспечивается включением в каждое сообщение данных безопасности.</span><span class="sxs-lookup"><span data-stu-id="f78ef-214">In contrast, message mode provides security by including the security data as part of every message.</span></span> <span data-ttu-id="f78ef-215">С помощью заголовков безопасности XML и SOAP в каждое сообщение включаются учетные данные и другие данные, необходимые для обеспечения целостности и конфиденциальности сообщения.</span><span class="sxs-lookup"><span data-stu-id="f78ef-215">Using XML and SOAP security headers, the credentials and other data needed to ensure the integrity and confidentiality of the message are included with every message.</span></span> <span data-ttu-id="f78ef-216">Каждое сообщение содержит данные безопасности, что приводит к снижению производительности, поскольку каждое сообщение должно обрабатываться индивидуально.</span><span class="sxs-lookup"><span data-stu-id="f78ef-216">Every message includes security data, so it results in a toll on performance because each message must be individually processed.</span></span> <span data-ttu-id="f78ef-217">(В транспортном режиме защищается транспортный уровень, и все сообщения передаются свободно.) Однако безопасность сообщений имеет одно преимущество над безопасностью транспорта: более высокая гибкость,</span><span class="sxs-lookup"><span data-stu-id="f78ef-217">(In transport mode, once the transport layer is secured, all messages flow freely.) However, message security has one advantage over transport security: it is more flexible.</span></span> <span data-ttu-id="f78ef-218">т. е. требования безопасности не определяются транспортом.</span><span class="sxs-lookup"><span data-stu-id="f78ef-218">That is, the security requirements are not determined by the transport.</span></span> <span data-ttu-id="f78ef-219">Для защиты сообщения можно использовать любой тип учетных данных клиента.</span><span class="sxs-lookup"><span data-stu-id="f78ef-219">You can use any type of client credential to secure the message.</span></span> <span data-ttu-id="f78ef-220">(В транспортном режиме тип учетных данных клиента, который можно использовать, определяется транспортным протоколом.)</span><span class="sxs-lookup"><span data-stu-id="f78ef-220">(In transport mode, the transport protocol determines the type of client credential that you can use.)</span></span>  
  
#### <a name="transport-with-message-credentials"></a><span data-ttu-id="f78ef-221">Транспорт с учетными данными сообщений</span><span class="sxs-lookup"><span data-stu-id="f78ef-221">Transport with Message Credentials</span></span>  
 <span data-ttu-id="f78ef-222">В третьем режиме объединяются лучшие характеристики режима безопасности транспорта и режима безопасности сообщений.</span><span class="sxs-lookup"><span data-stu-id="f78ef-222">The third mode combines the best of both transport and message security.</span></span> <span data-ttu-id="f78ef-223">В этом режиме средства обеспечения безопасности транспорта используются для эффективного обеспечения конфиденциальности и целостности каждого сообщения.</span><span class="sxs-lookup"><span data-stu-id="f78ef-223">In this mode, transport security is used to efficiently ensure the confidentiality and integrity of every message.</span></span> <span data-ttu-id="f78ef-224">В то же время каждое сообщение содержит свои учетные данные, позволяющие проверить его подлинность.</span><span class="sxs-lookup"><span data-stu-id="f78ef-224">At the same time, every message includes its credential data, which allows the message to be authenticated.</span></span> <span data-ttu-id="f78ef-225">С проверкой подлинности может быть также выполнена авторизация.</span><span class="sxs-lookup"><span data-stu-id="f78ef-225">With authentication, authorization can also be implemented.</span></span> <span data-ttu-id="f78ef-226">В результате проверки подлинности отправителя может быть предоставлен (или отклонен) доступ к ресурсам в соответствии с идентификацией отправителя.</span><span class="sxs-lookup"><span data-stu-id="f78ef-226">By authenticating a sender, access to resources can be granted (or denied) according to the sender's identity.</span></span>  
  
## <a name="specifying-the-client-credential-type-and-credential-value"></a><span data-ttu-id="f78ef-227">Задание типа учетных данных клиента и значения учетных данных</span><span class="sxs-lookup"><span data-stu-id="f78ef-227">Specifying the Client Credential Type and Credential Value</span></span>  
 <span data-ttu-id="f78ef-228">После выбора режима безопасности можно также задать тип учетных данных клиента.</span><span class="sxs-lookup"><span data-stu-id="f78ef-228">After you have selected a security mode, you may also want to specify a client credential type.</span></span> <span data-ttu-id="f78ef-229">Тип учетных данных клиента определяет, какой тип учетных данных клиент должен использовать для подтверждения своей подлинности серверу.</span><span class="sxs-lookup"><span data-stu-id="f78ef-229">The client credential type specifies what type a client must use to authenticate itself to the server.</span></span>  
  
 <span data-ttu-id="f78ef-230">Однако тип учетных данных клиента требуется не во всех сценариях.</span><span class="sxs-lookup"><span data-stu-id="f78ef-230">Not all scenarios require a client credential type, however.</span></span> <span data-ttu-id="f78ef-231">Служба подтверждает свою подлинность клиенту с помощью протокола SSL поверх HTTP (HTTPS).</span><span class="sxs-lookup"><span data-stu-id="f78ef-231">Using SSL over HTTP (HTTPS), a service authenticates itself to the client.</span></span> <span data-ttu-id="f78ef-232">В ходе такой проверки подлинности клиенту в процессе, называемом *согласованием*, передается сертификат службы.</span><span class="sxs-lookup"><span data-stu-id="f78ef-232">As part of this authentication, the service's certificate is sent to the client in a process called *negotiation*.</span></span> <span data-ttu-id="f78ef-233">Транспорт, защищенный с помощью SSL, гарантирует конфиденциальность всех сообщений.</span><span class="sxs-lookup"><span data-stu-id="f78ef-233">The SSL-secured transport ensures that all messages are confidential.</span></span>  
  
 <span data-ttu-id="f78ef-234">В случае создания службы, которая требует проверки подлинности клиента, выбор типа учетных данных клиента зависит от выбранных транспорта и режима.</span><span class="sxs-lookup"><span data-stu-id="f78ef-234">If you are creating a service that requires that the client be authenticated, your choice of a client credential type depends on the transport and mode selected.</span></span> <span data-ttu-id="f78ef-235">Например, при использовании транспорта HTTP и выборе транспортного режима возможны несколько вариантов выбора - Basic, Digest и другие.</span><span class="sxs-lookup"><span data-stu-id="f78ef-235">For example, using the HTTP transport and choosing transport mode gives you several choices, such as Basic, Digest, and others.</span></span> <span data-ttu-id="f78ef-236">([!INCLUDE[crabout](../../../includes/crabout-md.md)] этих типах учетных данных см. в разделе [Understanding HTTP Authentication](../../../docs/framework/wcf/feature-details/understanding-http-authentication.md).)</span><span class="sxs-lookup"><span data-stu-id="f78ef-236">([!INCLUDE[crabout](../../../includes/crabout-md.md)] these credential types, see [Understanding HTTP Authentication](../../../docs/framework/wcf/feature-details/understanding-http-authentication.md).)</span></span>  
  
 <span data-ttu-id="f78ef-237">В случае создания службы в домене Windows, которая будет доступна только другим пользователям сети, проще всего использовать тип учетных данных клиента Windows.</span><span class="sxs-lookup"><span data-stu-id="f78ef-237">If you are creating a service on a Windows domain that will be available only to other users of the network, the easiest to use is the Windows client credential type.</span></span> <span data-ttu-id="f78ef-238">Однако может также потребоваться обеспечить службу сертификатом.</span><span class="sxs-lookup"><span data-stu-id="f78ef-238">However, you may also need to provide a service with a certificate.</span></span> <span data-ttu-id="f78ef-239">Это показано в разделе [How to: Specify Client Credential Values](../../../docs/framework/wcf/how-to-specify-client-credential-values.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-239">This is shown in [How to: Specify Client Credential Values](../../../docs/framework/wcf/how-to-specify-client-credential-values.md).</span></span>  
  
#### <a name="credential-values"></a><span data-ttu-id="f78ef-240">Значения учетных данных</span><span class="sxs-lookup"><span data-stu-id="f78ef-240">Credential Values</span></span>  
 <span data-ttu-id="f78ef-241">*Значение учетных данных* - это фактические учетные данные, используемые службой.</span><span class="sxs-lookup"><span data-stu-id="f78ef-241">A *credential value* is the actual credential the service uses.</span></span> <span data-ttu-id="f78ef-242">После задания типа учетных данных может также потребоваться настроить службу с фактическими учетными данными.</span><span class="sxs-lookup"><span data-stu-id="f78ef-242">Once you have specified a credential type, you may also need to configure your service with the actual credentials.</span></span> <span data-ttu-id="f78ef-243">Если выбран тип Windows (и служба будет работать в домене Windows), фактическое значение учетных данных не задается.</span><span class="sxs-lookup"><span data-stu-id="f78ef-243">If you have selected Windows (and the service will run on a Windows domain), then you do not specify an actual credential value.</span></span>  
  
## <a name="identity"></a><span data-ttu-id="f78ef-244">идентификации</span><span class="sxs-lookup"><span data-stu-id="f78ef-244">Identity</span></span>  
 <span data-ttu-id="f78ef-245">В [!INCLUDE[indigo2](../../../includes/indigo2-md.md)]термин *идентификация* имеет разные значения для сервера и клиента.</span><span class="sxs-lookup"><span data-stu-id="f78ef-245">In [!INCLUDE[indigo2](../../../includes/indigo2-md.md)], the term *identity* has different meanings to the server and the client.</span></span> <span data-ttu-id="f78ef-246">Вкратце, при запуске службы идентификация назначается контексту безопасности после проверки подлинности.</span><span class="sxs-lookup"><span data-stu-id="f78ef-246">In brief, when running a service, an identity is assigned to the security context after authentication.</span></span> <span data-ttu-id="f78ef-247">Чтобы просмотреть фактическую идентификацию, проверьте свойства <xref:System.ServiceModel.ServiceSecurityContext.WindowsIdentity%2A> и <xref:System.ServiceModel.ServiceSecurityContext.PrimaryIdentity%2A> класса <xref:System.ServiceModel.ServiceSecurityContext> .</span><span class="sxs-lookup"><span data-stu-id="f78ef-247">To view the actual identity, check the <xref:System.ServiceModel.ServiceSecurityContext.WindowsIdentity%2A> and <xref:System.ServiceModel.ServiceSecurityContext.PrimaryIdentity%2A> properties of the <xref:System.ServiceModel.ServiceSecurityContext> class.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="f78ef-248">[Как: Проверьте контекст безопасности](../../../docs/framework/wcf/how-to-examine-the-security-context.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-248"> [How to: Examine the Security Context](../../../docs/framework/wcf/how-to-examine-the-security-context.md).</span></span>  
  
 <span data-ttu-id="f78ef-249">В отличие от этого, на клиенте идентификация используется для проверки службы.</span><span class="sxs-lookup"><span data-stu-id="f78ef-249">In contrast, on the client, identity is used to validate the service.</span></span> <span data-ttu-id="f78ef-250">Во время разработки разработчик клиента может настроить [ \<удостоверение >](../../../docs/framework/configure-apps/file-schema/wcf/identity.md) элемента значение, полученное от службы.</span><span class="sxs-lookup"><span data-stu-id="f78ef-250">At design time, a client developer can set the [\<identity>](../../../docs/framework/configure-apps/file-schema/wcf/identity.md) element to a value obtained from the service.</span></span> <span data-ttu-id="f78ef-251">Во время выполнения клиент проверяет значение элемента, сравнивая его с фактической идентификацией службы.</span><span class="sxs-lookup"><span data-stu-id="f78ef-251">At run time, the client checks the value of the element against the actual identity of the service.</span></span> <span data-ttu-id="f78ef-252">В случае отрицательного результата проверки клиент завершает взаимодействие.</span><span class="sxs-lookup"><span data-stu-id="f78ef-252">If the check fails, the client terminates the communication.</span></span> <span data-ttu-id="f78ef-253">Значением может быть имя участника-пользователя, если служба работает под удостоверением конкретного пользователя, или имя участника-службы, если служба работает под учетной записью компьютера.</span><span class="sxs-lookup"><span data-stu-id="f78ef-253">The value can be a user principal name (UPN) if the service runs under a particular user's identity or a service principal name (SPN) if the service runs under a machine account.</span></span> [!INCLUDE[crdefault](../../../includes/crdefault-md.md)]<span data-ttu-id="f78ef-254">[Службы удостоверений и проверки подлинности](../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-254"> [Service Identity and Authentication](../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md).</span></span> <span data-ttu-id="f78ef-255">Учетными данными может быть также сертификат или поле в сертификате, которое идентифицирует этот сертификат.</span><span class="sxs-lookup"><span data-stu-id="f78ef-255">The credential could also be a certificate, or a field found on a certificate that identifies the certificate.</span></span>  
  
## <a name="protection-levels"></a><span data-ttu-id="f78ef-256">Уровни защиты</span><span class="sxs-lookup"><span data-stu-id="f78ef-256">Protection Levels</span></span>  
 <span data-ttu-id="f78ef-257">Свойство `ProtectionLevel` встречается в нескольких классах атрибутов (например, в классах <xref:System.ServiceModel.ServiceContractAttribute> и <xref:System.ServiceModel.OperationContractAttribute> ).</span><span class="sxs-lookup"><span data-stu-id="f78ef-257">The `ProtectionLevel` property occurs on several attribute classes (such as the <xref:System.ServiceModel.ServiceContractAttribute> and the <xref:System.ServiceModel.OperationContractAttribute> classes).</span></span> <span data-ttu-id="f78ef-258">Уровень защиты - это значение, которое определяет для сообщений (или частей сообщений), поддерживающих службу, подписываются ли они, подписываются и шифруются или отправляются без подписи и шифровки.</span><span class="sxs-lookup"><span data-stu-id="f78ef-258">The protection level is a value that specifies whether the messages (or message parts) that support a service are signed, signed and encrypted, or sent without signatures or encryption.</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="f78ef-259">свойство, в разделе [уровень защиты основные сведения о](../../../docs/framework/wcf/understanding-protection-level.md)и примеры программирования см. в разделе [как: Установка свойства ProtectionLevel](../../../docs/framework/wcf/how-to-set-the-protectionlevel-property.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-259"> the property, see [Understanding Protection Level](../../../docs/framework/wcf/understanding-protection-level.md), and for programming examples, see [How to: Set the ProtectionLevel Property](../../../docs/framework/wcf/how-to-set-the-protectionlevel-property.md).</span></span> [!INCLUDE[crabout](../../../includes/crabout-md.md)]<span data-ttu-id="f78ef-260"> проектировании контракта службы с контекстом `ProtectionLevel` см. в разделе [Designing Service Contracts](../../../docs/framework/wcf/designing-service-contracts.md).</span><span class="sxs-lookup"><span data-stu-id="f78ef-260"> designing a service contract with the `ProtectionLevel` in context, see [Designing Service Contracts](../../../docs/framework/wcf/designing-service-contracts.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f78ef-261">См. также</span><span class="sxs-lookup"><span data-stu-id="f78ef-261">See Also</span></span>  
 <xref:System.ServiceModel>  
 <xref:System.ServiceModel.Description.ServiceCredentials>  
 <xref:System.ServiceModel.ServiceContractAttribute>  
 <xref:System.ServiceModel.OperationContractAttribute>  
 [<span data-ttu-id="f78ef-262">Идентификация и проверка подлинности службы</span><span class="sxs-lookup"><span data-stu-id="f78ef-262">Service Identity and Authentication</span></span>](../../../docs/framework/wcf/feature-details/service-identity-and-authentication.md)  
 [<span data-ttu-id="f78ef-263">Основные сведения об уровне защиты</span><span class="sxs-lookup"><span data-stu-id="f78ef-263">Understanding Protection Level</span></span>](../../../docs/framework/wcf/understanding-protection-level.md)  
 [<span data-ttu-id="f78ef-264">Делегирование и олицетворение</span><span class="sxs-lookup"><span data-stu-id="f78ef-264">Delegation and Impersonation</span></span>](../../../docs/framework/wcf/feature-details/delegation-and-impersonation-with-wcf.md)  
 [<span data-ttu-id="f78ef-265">Разработка контрактов службы</span><span class="sxs-lookup"><span data-stu-id="f78ef-265">Designing Service Contracts</span></span>](../../../docs/framework/wcf/designing-service-contracts.md)  
 [<span data-ttu-id="f78ef-266">Безопасность</span><span class="sxs-lookup"><span data-stu-id="f78ef-266">Security</span></span>](../../../docs/framework/wcf/feature-details/security.md)  
 [<span data-ttu-id="f78ef-267">Общие сведения о безопасности</span><span class="sxs-lookup"><span data-stu-id="f78ef-267">Security Overview</span></span>](../../../docs/framework/wcf/feature-details/security-overview.md)  
 [<span data-ttu-id="f78ef-268">Практическое руководство. Установка свойства ProtectionLevel</span><span class="sxs-lookup"><span data-stu-id="f78ef-268">How to: Set the ProtectionLevel Property</span></span>](../../../docs/framework/wcf/how-to-set-the-protectionlevel-property.md)  
 [<span data-ttu-id="f78ef-269">Практическое руководство. Защита службы с использованием учетных данных Windows</span><span class="sxs-lookup"><span data-stu-id="f78ef-269">How to: Secure a Service with Windows Credentials</span></span>](../../../docs/framework/wcf/how-to-secure-a-service-with-windows-credentials.md)  
 [<span data-ttu-id="f78ef-270">Практическое руководство. Задание режима безопасности</span><span class="sxs-lookup"><span data-stu-id="f78ef-270">How to: Set the Security Mode</span></span>](../../../docs/framework/wcf/how-to-set-the-security-mode.md)  
 [<span data-ttu-id="f78ef-271">Практическое руководство. Указание типа учетных данных клиента</span><span class="sxs-lookup"><span data-stu-id="f78ef-271">How to: Specify the Client Credential Type</span></span>](../../../docs/framework/wcf/how-to-specify-the-client-credential-type.md)  
 [<span data-ttu-id="f78ef-272">Практическое руководство. Ограничение доступа с использованием класса PrincipalPermissionAttribute</span><span class="sxs-lookup"><span data-stu-id="f78ef-272">How to: Restrict Access with the PrincipalPermissionAttribute Class</span></span>](../../../docs/framework/wcf/how-to-restrict-access-with-the-principalpermissionattribute-class.md)  
 [<span data-ttu-id="f78ef-273">Практическое руководство. Олицетворение клиента в рамках службы</span><span class="sxs-lookup"><span data-stu-id="f78ef-273">How to: Impersonate a Client on a Service</span></span>](../../../docs/framework/wcf/how-to-impersonate-a-client-on-a-service.md)  
 [<span data-ttu-id="f78ef-274">Практическое руководство. Анализ контекста безопасности</span><span class="sxs-lookup"><span data-stu-id="f78ef-274">How to: Examine the Security Context</span></span>](../../../docs/framework/wcf/how-to-examine-the-security-context.md)
