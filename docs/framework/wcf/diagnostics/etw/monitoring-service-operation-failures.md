---
title: "Наблюдение за сбоями в работе службы | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 59472ba3-8ebf-4479-bd7b-f440d5e636cb
caps.latest.revision: 6
author: "Erikre"
ms.author: "erikre"
manager: "erikre"
caps.handback.revision: 6
---
# Наблюдение за сбоями в работе службы
Если для приложения включено аналитическое отслеживание, сбои в работе службы можно легко отслеживать в обозревателе событий.В этом разделе показано, как определить момент, в который произошел сбой операции службы, и как определить причину сбоя.  
  
### Определение сведений о сбое операции службы  
  
1.  Откройте средство просмотра событий. Для этого нажмите кнопку **Пуск**, выберите команду **Выполнить** и введите `eventvwr.exe`.  
  
2.  Если не включено аналитическое отслеживание, разверните узлы **Журналы приложений и служб**, **Microsoft**, **Windows**, **Сервер приложений — приложения**.Установите в меню **Вид** флажок **Отобразить аналитический и отладочный журналы**.Щелкните правой кнопкой мыши пункт **Аналитический** и выберите команду **Включить журнал**.Оставьте окно просмотра событий открытым, чтобы можно было просмотреть трассировки после сбоя операции службы.  
  
3.  Затем откройте образец, созданный в [Учебник по началу работы](../../../../../docs/framework/wcf/getting-started-tutorial.md) в [!INCLUDE[vs_current_long](../../../../../includes/vs-current-long-md.md)]. Обратите внимание, что необходимо запустить [!INCLUDE[vs_current_long](../../../../../includes/vs-current-long-md.md)] в качестве администратора для обеспечения возможности создания службы.Если установлены образцы [!INCLUDE[indigo2](../../../../../includes/indigo2-md.md)], можно открыть образец [Начало работы](../../../../../docs/framework/wcf/samples/getting-started-sample.md), который содержит выполненный проект, созданный в учебнике.  
  
4.  В файле Program.cs в проекте «Server» добавьте следующую строку кода к началу метода `Divide` класса `CalculatorService`.  
  
    ```  
    if (n2 == 0) throw new DivideByZeroException();  
  
    ```  
  
5.  В файле Program.cs в проекте «Client» измените значение, назначенное value2, на нуль:  
  
    ```  
    //Call the Divide service operation  
    value1 = 22.00D;  
    value2 = 0.00D;  
    result = client.Divide(value1, value2);  
    Console.WriteLine("Divide({0}, {1}) = {2}", value1, value2, result);  
  
    ```  
  
6.  Выполните серверное приложение без отладки, нажав **Ctrl\+F5**.  
  
7.  Откройте командную строку Visual Studio.С помощью командной строки перейдите в каталог клиента и запустите клиент.  
  
8.  В окне просмотра событий отключите и обновите аналитический журнал и отсортируйте события по идентификаторам событий.Найдите событие с идентификатором [219 — ServiceException](../../../../../docs/framework/wcf/diagnostics/etw/219-serviceexception.md), описывающее сбой службы.  
  
    ```Output  
    Во время обработки сообщения возникло необработанное исключение типа System.DivideByZeroException.Полное исключение ToString: System.DivideByZeroException: Попытка деления на нуль.  
    ```  
  
    > [!NOTE]
    >  При отправке в обозреватель событий события буферизуются, при этом событие сбоя может не отобразиться сразу.