---
title: "Канал подтверждений HTTP"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 469f3056-5ef2-4753-8acf-b574d23d83cf
caps.latest.revision: "10"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 9081b47284b63315d950ef791389312df32815f8
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2017
---
# <a name="http-acknowledgement-channel"></a><span data-ttu-id="29df7-102">Канал подтверждений HTTP</span><span class="sxs-lookup"><span data-stu-id="29df7-102">HTTP Acknowledgement Channel</span></span>
<span data-ttu-id="29df7-103">Канал подтверждения HTTP - это пример многоуровневого канала, который изменяет односторонний шаблон обмена сообщениями, позволяя службе подтверждать получение сообщений или повторно использовать входящие сообщения, а не отправлять подтверждение автоматически при получении.</span><span class="sxs-lookup"><span data-stu-id="29df7-103">The HTTP Acknowledgement Channel is an example of a layered channel that changes the one-way messaging pattern, allowing a service to acknowledge or refuse incoming messages rather than automatically sending an acknowledgement on receipt.</span></span> <span data-ttu-id="29df7-104">Канал подтверждения HTTP также позволяет службе задерживать подтверждение до получения гарантии обработки сообщения на уровне бизнеса.</span><span class="sxs-lookup"><span data-stu-id="29df7-104">The HTTP Acknowledgement Channel also allows the service to delay acknowledgement until it can make a business-level guarantee that the message will be processed.</span></span>  
  
## <a name="demonstrates"></a><span data-ttu-id="29df7-105">Демонстрации</span><span class="sxs-lookup"><span data-stu-id="29df7-105">Demonstrates</span></span>  
 <span data-ttu-id="29df7-106"><xref:System.ServiceModel.Channels.ReceiveContext>, пример многоуровневого канала (канал подтверждения HTTP).</span><span class="sxs-lookup"><span data-stu-id="29df7-106"><xref:System.ServiceModel.Channels.ReceiveContext>, Layered channel example (HTTP Acknowledgement channel).</span></span>  
  
## <a name="discussion"></a><span data-ttu-id="29df7-107">Обсуждение</span><span class="sxs-lookup"><span data-stu-id="29df7-107">Discussion</span></span>  
 <span data-ttu-id="29df7-108">Для преобразования шаблона обмена сообщениями HTTP «запрос-ответ» в односторонний канал с отложенным подтверждением канал подтверждения HTTP реализует контекст <xref:System.ServiceModel.Channels.ReceiveContext>.</span><span class="sxs-lookup"><span data-stu-id="29df7-108">The HTTP Acknowledgement Channel implements <xref:System.ServiceModel.Channels.ReceiveContext> to reshape the HTTP request-reply messaging pattern to a one-way pattern with delayed acknowledgement.</span></span> <span data-ttu-id="29df7-109">С помощью этого нового шаблона служба может обеспечить обработку сообщения путем отправки подтверждения в форме кода состояния HTTP «ОК» (200), не блокируя при этом клиент до завершения обработки сообщения, либо она может отправить клиенту сообщение об ошибке в форме кода состояния HTTP «Внутренняя ошибка сервера» (500).</span><span class="sxs-lookup"><span data-stu-id="29df7-109">Using this new pattern, a service can ensure message processing by sending an acknowledgement in the form of an HTTP OK status code of 200 without blocking the client until message processing completes or can send a failure message to the client in the form of an HTTP Internal Server error status code of 500.</span></span> <span data-ttu-id="29df7-110">Например, служба может отправить подтверждение, записав сообщение в очередь, а затем продолжить обработку сообщения в асинхронном режиме.</span><span class="sxs-lookup"><span data-stu-id="29df7-110">For example, a service could send an acknowledgement after writing a message to a queue, and then continue processing the message asynchronously.</span></span> <span data-ttu-id="29df7-111">В этом случае, если клиент будет повторно отправлять каждое сообщение до получения подтверждения от службы, он может быть уверен, что его сообщения обработаны службой как минимум один раз.</span><span class="sxs-lookup"><span data-stu-id="29df7-111">In this scenario, a client could be assured its messages were processed at least once by the service, if it re-sent each message until it received an acknowledgement from the service.</span></span> <span data-ttu-id="29df7-112">Следует отметить, что если службе требуется быстрая асинхронная обработка сообщений по HTTP без каких-либо гарантий обработки сообщений, то более подходящим выбором будет <xref:System.ServiceModel.Channels.OneWayBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="29df7-112">Note that, if a service requires fast asynchronous message processing over HTTP without any message processing guarantees, then the <xref:System.ServiceModel.Channels.OneWayBindingElement> is a more appropriate choice.</span></span>  
  
 <span data-ttu-id="29df7-113">Контекст <xref:System.ServiceModel.Channels.ReceiveContext> используется для удержания сообщения в то время, пока определяется, может ли оно быть обработано в службе.</span><span class="sxs-lookup"><span data-stu-id="29df7-113"><xref:System.ServiceModel.Channels.ReceiveContext> is used to hold the message in place while it is determined whether the message can be processed at the service.</span></span> <span data-ttu-id="29df7-114">Способность службы успешно обработать сообщение указывается вызовом метода Complete для объекта <xref:System.ServiceModel.Channels.ReceiveContext>, который отправляет код состояния HTTP «ОК», а возможность службы обработать сообщение указывается вызовом метода <xref:System.ServiceModel.Channels.ReceiveContext> контекста `Abandon` для объекта <xref:System.ServiceModel.Channels.ReceiveContext>, который отправляет код состояния HTTP «Внутренняя ошибка сервера».</span><span class="sxs-lookup"><span data-stu-id="29df7-114">The ability of a service to successfully process the message is indicated by calling Complete on the <xref:System.ServiceModel.Channels.ReceiveContext> object that sends an HTTP OK status code and whether the service can process the message is indicated by calling <xref:System.ServiceModel.Channels.ReceiveContext>’s `Abandon` method on the <xref:System.ServiceModel.Channels.ReceiveContext> object, which sends an HTTP Internal Server error status code.</span></span>  
  
 <span data-ttu-id="29df7-115">В этом примере клиент запрашивает сведения об обработке путем отправки идентификатора сотрудника.</span><span class="sxs-lookup"><span data-stu-id="29df7-115">In this example, the client requests processing information by sending an employee ID.</span></span> <span data-ttu-id="29df7-116">Если полученный идентификатор сотрудника больше 50, то служба отправляет клиенту код состояния HTTP 500 (Внутренняя ошибка сервера), в противном случае предполагается, что обработка может быть успешно выполнена, в связи с чем служба отправляет клиенту код состояния HTTP 200 (Успешно).</span><span class="sxs-lookup"><span data-stu-id="29df7-116">On the service end, if the employee ID received is greater than 50, the service sends an HTTP Status code of 500 (Internal Server Error) back to the client, otherwise it is assumed that the processing can be successfully done and sends an HTTP Status code of 200 (Successful) to the client.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="29df7-117">Настройка, сборка и выполнение образца</span><span class="sxs-lookup"><span data-stu-id="29df7-117">To set up, build, and run the sample</span></span>  
  
1.  <span data-ttu-id="29df7-118">Откройте среду [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] с правами администратора.</span><span class="sxs-lookup"><span data-stu-id="29df7-118">Open [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] with Administrator privileges.</span></span>  
  
2.  <span data-ttu-id="29df7-119">Откройте **HttpAckChannel** решения.</span><span class="sxs-lookup"><span data-stu-id="29df7-119">Open the **HttpAckChannel** solution.</span></span>  
  
3.  <span data-ttu-id="29df7-120">Запустить новый экземпляр **службы** проекта, щелкните правой кнопкой мыши проект в **обозревателе решений**и выбрав **отладки**, **запустить новый экземпляр** в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="29df7-120">Start a new instance of the **Service** project by right clicking the project in **Solution Explorer**, and selecting **Debug**, **Start new instance** from the context menu.</span></span>  
  
4.  <span data-ttu-id="29df7-121">Запустить новый экземпляр **клиента** проекта, щелкните правой кнопкой мыши проект в **обозревателе решений**и выбрав **отладки**, и **запустить новый экземпляр** в контекстном меню.</span><span class="sxs-lookup"><span data-stu-id="29df7-121">Start a new instance of the **Client** project by right clicking the project in **Solution Explorer**, and selecting **Debug**, and **Start new instance** from the context menu.</span></span>  
  
5.  <span data-ttu-id="29df7-122">После запуска службы нажмите клавишу ВВОД в окне клиента, чтобы клиент отправил сообщение службе.</span><span class="sxs-lookup"><span data-stu-id="29df7-122">Once the service has started, press ENTER in the client window to let the client send a message to the service.</span></span>  
  
6.  <span data-ttu-id="29df7-123">Первое сообщение обрабатывается в службе, после чего она отправит клиенту код состояния HTTP «ОК».</span><span class="sxs-lookup"><span data-stu-id="29df7-123">The first message is processed on the service, and it sends an HTTP OK status code back to the client.</span></span>  
  
7.  <span data-ttu-id="29df7-124">Второе сообщение завершится неудачей, в результате чего служба отправит клиенту код состояния HTTP «Внутренняя ошибка сервера», который вызовет в клиенте исключение <xref:System.ServiceModel.CommunicationException>.</span><span class="sxs-lookup"><span data-stu-id="29df7-124">The second message is unsuccessful, and it sends an HTTP Internal Server error status code back to the client, which raises a <xref:System.ServiceModel.CommunicationException> on the client.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="29df7-125">Образцы уже могут быть установлены на компьютере.</span><span class="sxs-lookup"><span data-stu-id="29df7-125">The samples may already be installed on your machine.</span></span> <span data-ttu-id="29df7-126">Перед продолжением проверьте следующий каталог (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="29df7-126">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="29df7-127">Если этот каталог не существует, перейдите на страницу [Примеры Windows Communication Foundation (WCF) и Windows Workflow Foundation (WF) для .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) , чтобы скачать все примеры [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] и [!INCLUDE[wf1](../../../../includes/wf1-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="29df7-127">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="29df7-128">Этот образец расположен в следующем каталоге.</span><span class="sxs-lookup"><span data-stu-id="29df7-128">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WCF\Extensibility\Channels\HttpAckChannel`
