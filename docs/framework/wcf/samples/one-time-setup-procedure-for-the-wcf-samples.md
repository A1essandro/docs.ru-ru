---
title: "Процедура однократной настройки образцов Windows Communication Foundation | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: a5848ffd-3eb5-432d-812e-bd948ccb6bca
caps.latest.revision: 83
author: "Erikre"
ms.author: "erikre"
manager: "erikre"
caps.handback.revision: 83
---
# Процедура однократной настройки образцов Windows Communication Foundation
Большинство образцов [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] размещаются в службах IIS и выполняются из общего виртуального каталога.Эта выполняемая однократно процедура настройки создает папку на диске, а также добавляет в службы IIS виртуальный каталог с именем **ServiceModelSamples**.  
  
 Виртуальный каталог **ServiceModelSamples** используется для построения и выполнения всех образцов, которые используют службу, размещенную в службах IIS.Это единственный виртуальный каталог, необходимый для выполнения образцов.При построении образца будет заменена любая служба, развернутая ранее в этом виртуальном каталоге. Развернут и доступен в данном виртуальном каталоге будет только последний построенный образец.  
  
> [!NOTE]
>  Необходимо выполнить все команды от имени учетной записи локального администратора.При использовании Windows 7, [!INCLUDE[windowsver](../../../../includes/windowsver-md.md)] или Windows Server 2008 R2 необходимо запустить командную строку с более высоким уровнем привилегий.Для этого щелкните правой кнопкой мыши значок командной строки и выберите команду **Запуск от имени администратора**.Все команды в данном разделе должны выполняться в командной строке с соответствующим образом заданными параметрами пути.Проще всего добиться этого, используя командную строку Visual Studio.Для этого нажмите кнопку **Пуск**, выберите пункт **Все программы**, перейдите к пункту **Visual Studio 2010**, выберите пункт **Средства Visual Studio**, щелкните правой кнопкой пункт **Командная строка Visual Studio \(2010\)** и выберите команду **Запуск от имени администратора**.Если установлен один из выпусков Visual Studio Express, эта командная строка недоступна. В этом случае добавьте в системный путь строку «C:\\Windows\\Microsoft.Net\\Framework\\v4.0».  
  
### Однократно настраиваемая процедура для образцов WCF  
  
1.  Убедитесь, что [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] установлена.[!INCLUDE[crabout](../../../../includes/crabout-md.md)] настройке [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] см. в разделе [Инструкции по размещению в службах IIS](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md).  
  
2.  Убедитесь, что установлена платформа [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)].Найдите папку **\\Windows\\Microsoft.NET\\Framework** для версии 4.0 или более поздней.  
  
3.  Если среда [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] не установлена и используется операционная система, отличная от Windows Server 2008 SP2 или более поздней версии, установите [Пакет исправлений 251798](http://go.microsoft.com/fwlink/?LinkId=184693).  
  
4.  Выполните следующие команды.Дополнительные сведения о том, для чего нужно выполнить эти команды, см. в разделе [IIS Hosted Service Fails](http://msdn.microsoft.com/ru-ru/ee5499fc-1b10-4cda-a9b1-13dba70f05f8).  
  
    > [!WARNING]
    >  Если IIS был переустановлен, необходимо вновь выполнить следующие команды.  
  
    ```  
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\aspnet_regiis" –i –enable  
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\ServiceModelReg.exe" -r  
    ```  
  
    > [!WARNING]
    >  При выполнении команды `aspnet_regiis –i –enable` пул приложений по умолчанию будет выполняться с использованием [!INCLUDE[netfx40_short](../../../../includes/netfx40-short-md.md)], в результате чего могут возникнуть проблемы совместимости у других приложений на том же компьютере.  
  
5.  Выполните инструкции [Инструкции брандмауэра](../../../../docs/framework/wcf/samples/firewall-instructions.md), чтобы включить порты, используемые в образцах.  
  
6.  Проверьте следующий каталог по умолчанию: \<диск\_установки\>:**\\WF\_WCF\_Samples**.Если образцы были предварительно установлены, этот каталог будет выбран по умолчанию.  
  
7.  Если образцы не были установлены, установите их из загрузочного каталога для [Visual C\#](http://go.microsoft.com/fwlink/?LinkId=190939) или [Visual Basic](http://go.microsoft.com/fwlink/?LinkID=193373).  
  
8.  После установки образцов перейдите в каталог: \<диск\_установки\>:**\\WF\_WCF\_Samples\\WCF\\Setup\\**  
  
9. Запустите пакетный файл **Setupvroot.bat**.Выполняются следующие действия.  
  
    -   В службах IIS создается виртуальный каталог с именем ServiceModelSamples.  
  
    -   Создаются новые каталоги диска с именами «%SystemDrive%\\Inetpub\\wwwroot\\ServiceModelSamples» и «%SystemDrive%\\Inetpub\\wwwroot\\ServiceModelSamples\\bin».  
  
     Если требуется настроить эти каталоги вручную, см. раздел [Инструкции по настройке виртуальных каталогов](../../../../docs/framework/wcf/samples/virtual-directory-setup-instructions.md).Чтобы отменить все изменения, произведенные на данном шаге, запустите файл cleanupvroot.bat по окончании использования образцов.  
  
    > [!NOTE]
    >  Если только не запущен файл cleanupvroot.bat, эта процедура выполняется только один раз для каждого компьютера.  
  
10. Предоставьте разрешение на изменение папки «%SystemDrive%\\inetpub\\wwwroot» для учетной записи, от имени которой выполняется построение образцов, и для пользователя сетевой службы.При построении некоторых образцов, размещенных на веб\-сервере, может быть выполнена попытка копирования компилированных двоичных файлов в указанное ранее расположение, и если соответствующие разрешения не заданы, построение прервется.Можно также оставить разрешения неизменными и запускать командную строку пакета SDK или Visual Studio\(2012\) от имени администратора или строить образцы в [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] также от имени администратора.  
  
    > [!NOTE]
    >  Если этот шаг не выполнен, построение всех образцов, размещенных в службах IIS, завершится с ошибкой.Убедитесь, что разрешения заданы правильно, или запустите и командную строку пакета SDK, и командную строку Visual Studio \(2012\) от имени администратора.  
  
11. Создайте на компьютере каталог C:\\logs. Некоторые образцы могут ожидать его наличия.Убедитесь, что соответствующая учетная запись имеет разрешение на запись в этот каталог.Для Windows 7, [!INCLUDE[wv](../../../../includes/wv-md.md)] и Windows Server 2008 R2 это учетная запись **Network Service**.Для [!INCLUDE[lserver](../../../../includes/lserver-md.md)] это учетная запись NT Authority\\Network Service.Для [!INCLUDE[wxp](../../../../includes/wxp-md.md)] и [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)] это учетная запись ASPNET.  
  
12. Запустите файл Setupcerttool.bat.Данный файл расположен в папке \<пусть\_установки\>\\WF\_WCF\_Samples\\WCF\\Setup\\.Этот скрипт выполнит следующие задачи.  
  
    -   Построит средство FindPrivateKey.  
  
    -   Создаст каталог с именем %ProgramFiles%\\ServiceModelSampleTools.  
  
    -   Скопирует в этот каталог новое средство FindPrivateKey.  
  
     Данное средство необходимо для образцов, в которых используются сертификаты и которые размещены в службах IIS.  
  
    > [!NOTE]
    >  В целях безопасности по завершении работы с образцами не забудьте удалить определение виртуального каталога и разрешения, предоставленные на шагах установки, запустив пакетный файл Cleanupvroot.bat.  
  
13. Резидентным образцам \(не размещенным в службах IIS\) требуется разрешение на регистрацию HTTP\-адресов на компьютере для прослушивания.Разрешение на резервирование пространства имен HTTP поступает от учетной записи пользователя, используемой для выполнения образца.По умолчанию учетные записи администратора имеют разрешение на регистрацию любых HTTP\-адресов.Неадминистративным учетным записям должно быть предоставлено разрешение на использование пространства имен HTTP, применяемых в образцах кода.[!INCLUDE[crabout](../../../../includes/crabout-md.md)] настройке резервирования пространства имен см. в разделе [Настройка HTTP и HTTPS](../../../../docs/framework/wcf/feature-details/configuring-http-and-https.md).  
  
14. Для некоторых образцов требуется служба очередей сообщений.Инструкции по установке см. в разделе [Установка службы очередей сообщений \(MSMQ\)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md).  
  
    > [!NOTE]
    >  Перед запуском всех образцов, использующих очереди сообщений, необходимо убедиться, что запущена служба очередей сообщений.  
  
15. Для некоторых образцов требуются сертификаты.См. раздел [Инструкции по установке сертификата сервера в службах IIS](../../../../docs/framework/wcf/samples/iis-server-certificate-installation-instructions.md).  
  
## См. также