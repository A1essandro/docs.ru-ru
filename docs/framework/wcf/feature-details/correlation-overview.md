---
title: "Общие сведения о корреляции"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: edcc0315-5d26-44d6-a36d-ea554c418e9f
caps.latest.revision: "12"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: a29f761b4a3718293c1786d23d425265603f8c84
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2018
---
# <a name="correlation-overview"></a>Общие сведения о корреляции
Корреляция - это механизм связи сообщений службы рабочего процесса друг с другом или с состоянием экземпляра приложения, таким как ответ на начальный запрос, или с определенным идентификатором запроса к сохраненному состоянию рабочего процесса обработки запросов. В данном разделе приведены общие сведения о корреляции. В других подразделах этого раздела содержатся дополнительные сведения о каждом из видов корреляции.  
  
## <a name="types-of-correlation"></a>Типы корреляции  
 Корреляция может быть основана на протоколе или на содержимом. При основанной на протоколе корреляции для сопоставления сообщений используются данные, предоставляемые инфраструктурой доставки сообщений. Сообщения, сопоставляемые с помощью корреляции на основе протокола, связываются друг с другом с помощью находящегося в памяти объекта, например <xref:System.ServiceModel.Channels.RequestContext>, или с помощью маркера, предоставляемого транспортным протоколом. Корреляции на основе содержимого связывает сообщения друг с другом с помощью данных, задаваемых приложением. Сообщения, сопоставляемые с помощью корреляции на основе содержимого, связываются друг с другом с помощью содержащихся в сообщении данных, определяемых приложением, например по номеру клиента.  
  
 Действия, участвующие в корреляции, применяют для объединения действий обмена сообщениями дескриптор <xref:System.ServiceModel.Activities.CorrelationHandle>. Например, для действия <xref:System.ServiceModel.Activities.Send>, используемого для вызова службы, и следующего за ним действия <xref:System.ServiceModel.Activities.Receive>, используемого для получения обратного вызова от службы, применяется один и тот же дескриптор <xref:System.ServiceModel.Activities.CorrelationHandle>. Этот основной шаблон применяется как для корреляции на основе содержимого, так и для корреляции на основе протокола. Дескриптор взаимосвязи может быть установлен для каждого действия явно, или же действия могут содержаться в действии <xref:System.ServiceModel.Activities.CorrelationScope>. Дескрипторами взаимосвязи действий, содержащихся в <xref:System.ServiceModel.Activities.CorrelationScope>, управляет <xref:System.ServiceModel.Activities.CorrelationScope>, для них не требуется явно задавать значение <xref:System.ServiceModel.Activities.CorrelationHandle>. Область <xref:System.ServiceModel.Activities.CorrelationScope> реализует управление дескрипторами <xref:System.ServiceModel.Activities.CorrelationHandle> для корреляции «запрос-ответ» и одного дополнительного типа корреляции. Для служб рабочих процессов, размещенных с помощью <xref:System.ServiceModel.Activities.WorkflowServiceHost>, используется то же управление корреляцией по умолчанию, что и для действия <xref:System.ServiceModel.Activities.CorrelationScope>. Это управление корреляцией по умолчанию, как правило, приводит к тому, что во многих сценариях использования для действий обмена сообщениями в области <xref:System.ServiceModel.Activities.CorrelationScope> или для службы рабочего процесса не требуется задавать дескриптор <xref:System.ServiceModel.Activities.CorrelationHandle>, если только несколько действий обмена сообщениями не выполняются параллельно или с перекрытием (например, два параллельных действия <xref:System.ServiceModel.Activities.Receive> или два действия <xref:System.ServiceModel.Activities.Send>, за которыми следует два действия <xref:System.ServiceModel.Activities.Receive>). Дополнительные сведения о корреляции по умолчанию содержатся в подразделах этого раздела, описывающих каждый из видов корреляции по отдельности. [!INCLUDE[crabout](../../../../includes/crabout-md.md)]действия обмена сообщениями в разделе [действий обмена сообщениями](../../../../docs/framework/wcf/feature-details/messaging-activities.md) и [как: создание службы рабочего процесса с действиями обмена сообщениями](../../../../docs/framework/wcf/feature-details/how-to-create-a-workflow-service-with-messaging-activities.md).  
  
## <a name="protocol-based-correlation"></a>Корреляция, основанная на протоколе  
 Основанная на протоколе корреляция использует транспортный механизм для связи сообщений друг с другом и с соответствующим экземпляром. Некоторые предоставляемые системой корреляции на основе протокола включают корреляции типа «запрос-ответ» и корреляции на основе контекста. Корреляции «запрос-ответ» используются для сопоставления пары действий обмена сообщениями с операцией двунаправленной формы, например действие <xref:System.ServiceModel.Activities.Send> может составлять пару с действием <xref:System.ServiceModel.Activities.ReceiveReply>, а действие <xref:System.ServiceModel.Activities.Receive> может составлять пару с действием <xref:System.ServiceModel.Activities.SendReply>. Конструктор рабочих процессов среды [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] также предоставляет набор шаблонов действия, позволяющих быстро реализовать эту схему. Корреляция на основе контекста основана на механизме обмена контекстом, описанной в [спецификации протокола обмена контекстом .NET](http://go.microsoft.com/fwlink/?LinkID=166059). Для использования корреляции на основе контекста в конечной точке необходимо использовать привязку на основе контекста, например <xref:System.ServiceModel.BasicHttpContextBinding>, <xref:System.ServiceModel.WSHttpContextBinding> или <xref:System.ServiceModel.NetTcpContextBinding>.  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]протокол корреляции см. в разделе [обмен контекстом](../../../../docs/framework/wcf/feature-details/context-exchange-correlation.md), [устойчивый дуплекс](../../../../docs/framework/wcf/feature-details/durable-duplex-correlation.md), и [запрос-ответ](../../../../docs/framework/wcf/feature-details/request-reply-correlation.md). [!INCLUDE[crabout](../../../../includes/crabout-md.md)]с помощью [!INCLUDE[vs_current_long](../../../../includes/vs-current-long-md.md)] шаблонов действия конструктора рабочих процессов, см. раздел [действий обмена сообщениями](../../../../docs/framework/wcf/feature-details/messaging-activities.md). Пример кода, в разделе [устойчивый дуплекс &#91; Образцы WF &#93; ](../../../../docs/framework/windows-workflow-foundation/samples/durable-duplex.md) и [NetContextExchangeCorrelation](http://msdn.microsoft.com/library/93c74a1a-b9e2-46c6-95c0-c9b0e9472caf) образцов.  
  
## <a name="content-based-correlation"></a>Корреляция по содержимому  
 При корреляции, основанной на содержимом, для сопоставления сообщения с конкретным экземпляром используется часть содержащихся в сообщении данных. В отличие от корреляции на основе протокола, при использовании корреляции на основе содержимого разработчик приложения должен явно указать, где в каждом из сопоставляемых сообщений находится такая часть данных. В действиях, использующих корреляцию на основе содержимого, эти данные сообщения задаются с помощью набора <xref:System.ServiceModel.MessageQuerySet>. Корреляция на основе содержимого полезна при взаимодействии со службами, в которых не применяется ни одна из контекстных привязок, таких как <xref:System.ServiceModel.BasicHttpContextBinding>. [!INCLUDE[crabout](../../../../includes/crabout-md.md)]корреляции на основе содержимого см. в разделе [на основе содержимого](../../../../docs/framework/wcf/feature-details/content-based-correlation.md). Пример кода, в разделе [корреляция по содержимому](../../../../docs/framework/windows-workflow-foundation/samples/content-based-correlation.md) и [коррелированных калькулятора](../../../../docs/framework/windows-workflow-foundation/samples/correlated-calculator.md) образцы.  
  
## <a name="see-also"></a>См. также  
 [Корреляция по содержимому](../../../../docs/framework/windows-workflow-foundation/samples/content-based-correlation.md)  
 [Калькулятор с корреляцией](../../../../docs/framework/windows-workflow-foundation/samples/correlated-calculator.md)  
 [Сохраняемый дуплекс &#91; Образцы WF &#93;](../../../../docs/framework/windows-workflow-foundation/samples/durable-duplex.md)  
 [NetContextExchangeCorrelation](http://msdn.microsoft.com/library/93c74a1a-b9e2-46c6-95c0-c9b0e9472caf)
