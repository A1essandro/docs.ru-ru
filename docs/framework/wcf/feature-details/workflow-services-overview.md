---
title: Общие сведения о службах рабочих процессов
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: e536dda3-e286-441e-99a7-49ddc004b646
caps.latest.revision: 30
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 6eb5381438aa082eae8b4252bbd1cf343ba0ebf7
ms.sourcegitcommit: 94d33cadc5ff81d2ac389bf5f26422c227832052
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/30/2018
---
# <a name="workflow-services-overview"></a>Общие сведения о службах рабочих процессов
Службы рабочих процессов - это службы на основе [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], которые реализованы с помощью рабочих процессов. Службы Workflow Services являются рабочими процессами, использующими действия обмена сообщениями для отправки и получения сообщений [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]. В.NET Framework 4.5 появилось несколько действий обмена сообщениями, позволяющих отправлять и получать сообщения из рабочего процесса. Дополнительные сведения о действия обмена сообщениями и как они могут использоваться для реализации различных шаблонов обмена сообщениями см. в разделе [действий обмена сообщениями](../../../../docs/framework/wcf/feature-details/messaging-activities.md).  
  
## <a name="benefits-of-using-workflow-services"></a>Преимущества использования служб рабочих процессов  
 По мере возрастания распределения приложений отдельные службы становятся ответственными за вызов других служб для передачи им некоторой части работы. Реализация таких вызовов в виде асинхронных операций в коде представляет некоторую сложность. Обработка ошибок добавляет некоторую сложность в форме обработки исключений и обеспечения подробных сведений об отслеживании. Довольно часто некоторые службы являются длительными и занимают ценные системные ресурсы при ожидании ввода. Вследствие этих причин распределенные приложения часто являются очень сложными и их трудно разрабатывать и поддерживать. Рабочие процессы являются естественным способом координации асинхронной работы, особенно вызовов внешних служб. Рабочие процессы также достаточно эффективны при представлении длительных бизнес-процессов. Эти качества делают рабочий процесс великолепным активом для построения служб в распределенной среде.  
  
## <a name="implementing-a-workflow-service"></a>Реализация службы рабочего процесса  
 При реализации службы [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] выполняется определение контрактов, описывающих службу, и данных, которые она отправляет и получает. Данные, представленные в виде контрактов данных и сообщений. Службы WCF и службы рабочих процессов используют контракты данных и определения контрактов сообщений как часть описаний служб. Служба сама предоставляет метаданные (в форме WSDL) для описания операций службы. В WCF контракты службы и операций определяют службу и операции, которые она поддерживает. Однако в службе рабочего процесса эти контракты являются частью самого бизнес-процесса. Они поставляются в метаданные процессом, называемым выводом контракта. При размещении службы рабочего процесса с использованием <xref:System.ServiceModel.Activities.WorkflowServiceHost> просматривается определение рабочего процесса и формируется контракт на основе набора действий по отправке и получению сообщений, обнаруженных в рабочем процессе. В частности, для создания контракта используются следующие действия и свойства:  
  
 Действие <xref:System.ServiceModel.Activities.Receive>  
  
-   <xref:System.ServiceModel.Activities.Receive.ServiceContractName%2A>  
  
-   <!--zz <xref:System.ServiceModel.Activities.Receive.OperationContractName%2A>  --> `System.ServiceModel.Activities.Receive.OperationContractName`
  
-   <xref:System.ServiceModel.Activities.Receive.Action%2A>  
  
-   <!--zz <xref:System.ServiceModel.Activities.Receive.ValueType%2A>  --> `System.ServiceModel.Activities.Receive.ValueType`
  
 Действие <xref:System.ServiceModel.Activities.SendReply>  
  
-   <xref:System.ServiceModel.Activities.SendReply.Action%2A>  
  
-   <!--zz <xref:System.ServiceModel.Activities.SendReply.ValueType%2A> -->
`xref:System.ServiceModel.Activities.SendReply.ValueType`
  
 Действие <xref:System.ServiceModel.Activities.TransactedReceiveScope>  
  
 Конечным результатом вывода контракта является описание службы, использующей структуры данных, аналогичные структурам данных служб [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] и контрактов операций. Затем эти сведения используются для предоставления WSDL для службы рабочего процесса.  
  
> [!NOTE]
>  [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] не позволяет писать службы рабочего процесса с использованием существующего определения контракта без дополнительных средств разработки. Контракты служб рабочих процессов создаются посредством процесса вывода, который был рассмотрен ранее. Контракты сообщений и данных, тем не менее, полностью поддерживаются.  
  
## <a name="workflow-services-and-msmq-based-bindings"></a>Службы рабочих процессов и привязки на основе очереди сообщений (MSMQ)  
 WCF определяет две привязки на основе очереди сообщений (MSMQ) - <xref:System.ServiceModel.NetMsmqBinding> и <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.  Привязки на основе очереди сообщений (MSMQ) часто используются со службами рабочих процессов, что связано с продолжительностью работы таких служб. Привязки на основе очереди сообщений (MSMQ) имеют свойство `ValidityDuration`, определяющее срок, в течение которого сообщения MSMQ считаются достоверными. Из-за длительного срока работы служб рабочих процессов возможно, что длительность достоверности сообщения MSMQ закончится до того, как служба рабочих процессов сможет его обработать. Поэтому очень важно задать для длительности достоверности привязки MSMQ подходящее значение. Это значение должно выбираться на основе рабочего процесса и способа, с помощью которого он обрабатывает сообщения. Например, если имеется рабочий процесс с действием <xref:System.ServiceModel.Activities.Receive>, сопровождаемым пользовательским действием, которое выполняется 10 минут, и действием <xref:System.ServiceModel.Activities.Receive>, правильное значение `ValidityDuration` должно превышать 10 минут.  
  
## <a name="hosting-a-workflow-service"></a>Размещение службы рабочего процесса  
 Подобно службам [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] службы Workflow Services необходимо размещать. Службы [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] используют класс <xref:System.ServiceModel.ServiceHost> для размещения служб, а службы Workflow Services используют класс <xref:System.ServiceModel.Activities.WorkflowServiceHost> для размещения служб. Подобно службам [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], службы рабочих процессов можно размещать несколькими способами, например:  
  
-   в управляемом приложении платформы [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)];  
  
-   В службах IIS.  
  
-   в службе WAS;  
  
-   в управляемой службе Windows.  
  
 Службы рабочих процессов, размещаемые в управляемом приложении платформы [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] либо в управляемой службе Windows, создают экземпляр класса <xref:System.ServiceModel.Activities.WorkflowServiceHost> и передают его экземпляру <xref:System.ServiceModel.Activities.WorkflowService>, содержащему определение рабочего процесса в свойстве <xref:System.ServiceModel.Activities.WorkflowService.Body%2A>. Определение рабочего процесса, содержащее действия обмена сообщениями, предоставлено службой рабочего процесса.  
  
 Для размещения службы рабочего процесса в IIS или WAS поместите XAMLX-файл, содержащий определение службы рабочего процесса, в виртуальный каталог. Конечная точка по умолчанию (с помощью <xref:System.ServiceModel.BasicHttpBinding>) — создается автоматически для получения дополнительной информации, в разделе [упрощенной конфигурации](../../../../docs/framework/wcf/simplified-configuration.md). Также для указания собственных конечных точек можно разместить файл Web.config в виртуальном каталоге. Если определение рабочего процесса находится в сборке, то можно разместить SVC-файл в виртуальном каталоге, а сборку рабочего процесса в каталоге с кодом приложения. SVC-файл должен указывать фабрику узла службы и класс, реализующий службу рабочего процесса. В следующем примере показан способ указания фабрики узла службы и класса, реализующего службу рабочего процесса.  
  
```  
<%@ServiceHost Factory=" System.ServiceModel.Activities.Activation.WorkflowServiceHostFactory  
Service="EchoService"%>  
```
