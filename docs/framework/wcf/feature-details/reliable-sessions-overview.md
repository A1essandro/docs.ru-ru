---
title: Общие сведения о надежных сеансах
ms.date: 03/30/2017
ms.assetid: a7fc4146-ee2c-444c-82d4-ef6faffccc2d
ms.openlocfilehash: 1c5344c2804cf4c17fdc46a7fea5a4a360122b6e
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33497082"
---
# <a name="reliable-sessions-overview"></a>Общие сведения о надежных сеансах

Windows Communication Foundation (WCF) надежный обмен сообщениями SOAP предоставляет-сквозной обмен сообщениями между конечными точками SOAP. Такой обмен реализуется в сетях, которые ненадежны из-за исправления ошибок транспорта и ошибок на уровне сообщений SOAP. В частности, эта технология обеспечивает основанную на сеансах, одиночную, упорядоченную (необязательно) доставку сообщений, отправленных по протоколу SOAP или через транспортных посредников. Для группирования сообщений в сеансе с необязательным упорядочиванием сообщений предоставляет доставки на основе сеансов.

В этом разделе описываются надежных сеансов, как и способы их использования и для их защиты.

## <a name="wcf-reliable-sessions"></a>Надежные сеансы WCF

Надежные сеансы WCF представляет собой реализацию надежного обмена сообщениями в соответствии с определением протокола WS-ReliableMessaging SOAP.

Надежный обмен сообщениями WCF SOAP обеспечивает конца в конец надежного сеанса между двумя конечными точками, независимо от количества и типа посредников, разделяющих конечные точки обмена сообщениями. Сюда входят любые транспортные посредники, не использующие протокол SOAP (например, прокси-серверы HTTP) или посредники, использующие протокол SOAP (например, мосты или маршрутизаторы на базе SOAP), необходимые для продвижения сообщений между конечными точками. Канал надежного сеанса поддерживает *интерактивный* связи, чтобы службы, соединенные таким каналом выполняться одновременно, а также обмениваться и обрабатывать сообщения в условиях низкой задержкой, в течение относительно небольшого размера интервалы времени. Такое объединение означает, что эти компоненты прогресса вместе или ошибкой, то есть не изолированы между ними.

Надежный сеанс скрывает два вида сбоев.

- Сбои на уровне сообщений SOAP, которые включают в себя потерянные или дублированные сообщения и сообщения, приходящие в порядке, отличном от порядка, в котором они были отправлены.

- Сбои транспорта.

Надежный сеанс реализует протокол WS-ReliableMessaging и окно передачи в памяти, чтобы маскировать сбои на уровне сообщений SOAP, и восстанавливает подключения в случае сбоев транспорта.

Надежный сеанс обеспечивает для сообщений SOAP то, что обеспечивает TCP для IP-пакетов. Подключение через сокет TCP - это единая, упорядоченная передача IP-пакетов между узлами. Надежный канал обеспечивает тот же тип надежной передачи, но отличается от надежности сокета TCP в следующем.

- Надежность поддерживается на уровне сообщений SOAP, она не связана с пакетом байтов произвольного размера.

- Надежность транспорта нейтральные, не только для передачи по протоколу TCP.

- Надежность не привязана к определенному сеансу транспорта (например, сеанс, который обеспечивает подключение TCP) и могут использовать несколько сеансов транспорта параллельно или последовательно в течение времени существования надежного сеанса.

- Надежный сеанс осуществляется между конечными точками отправителя и получателя SOAP независимо от числа транспортных подключений, необходимых для их соединения. Иными словами надежность TCP заканчивается, которой заканчивается транспортного соединения, пока надежный сеанс обеспечивает надежность начала до конца.

## <a name="reliable-sessions-and-bindings"></a>Надежные сеансы и привязки

Как упоминалось ранее, надежного сеанса является нейтральным транспорта. Кроме того можно установить для многих шаблонов обмена сообщениями, таких как запрос ответ или дуплексного надежного сеанса. Надежные сеансы WCF предоставляется как свойство ряда привязок.

Используйте конечные точки, использующие надежный сеанс:

- стандартные привязки транспорта на основе HTTP

  - `WsHttpBinding` и предоставление контрактов типа запрос-ответ или односторонних контрактов.

  - При использовании надежного сеанса через запрос ответ или простого одностороннего контракта службы.

  - `WsDualHttpBinding` и предоставление дуплексных, односторонних контрактов или контрактов типа запрос-ответ.

  - `WsFederationHttpBinding` и предоставление контрактов типа запрос-ответ или односторонних контрактов.

- стандартные привязки транспорта на основе TCP

  - `NetTcpBinding` и предоставление дуплексных, односторонних контрактов или контрактов типа запрос-ответ.

Использовать надежного сеанса для любых других привязок, создав пользовательскую привязку, например HTTPS (Дополнительные сведения о проблемах см. в разделе <a href="#reliable-sessions-and-security">надежные сеансы и безопасность</a>) или привязку именованного канала.

Можно располагать надежного сеанса на базовых каналов разных типов, и получаемая форма канала надежного сеанса зависит. На клиенте и сервере тип поддерживаемого канала надежного сеанса зависит от типа используемого базового канала. В следующей таблице представлен список типов каналов сеансов, поддерживаемых клиентом, в качестве функции типа базового канала.

| Поддерживаемые типы каналов надежного сеанса&#8224; | `IRequestChannel` | `IRequestSessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :---------------: | :----------------------: | :--------------: | :---------------------: |
| `IOutputSessionChannel`                         | Да               | Да                      | Да              | Да                     |
| `IRequestSessionChannel`                        | Да               | Да                      | Нет               | Нет                      |
| `IDuplexSessionChannel`                         | Нет                | Нет                       | Да              | Да                     |

&#8224;Поддерживаемые типы каналов представляют собой значения, доступные для универсального `TChannel` значение параметра, передаваемого в <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelFactory%60%601%28System.ServiceModel.Channels.BindingContext%29> метод.

В следующей таблице представлен список типов каналов сеансов, поддерживаемых сервером, в качестве функции типа базового канала.

| Поддерживаемые типы каналов надежного сеанса&#8225; | `IReplyChannel` | `IReplySessionChannel` | `IDuplexChannel` | `IDuplexSessionChannel` |
| ----------------------------------------------- | :-------------: | :--------------------: | :--------------: | :---------------------: |
| `IInputSessionChannel`                          | Да             | Да                    | Да              | Да                     |
| `IReplySessionChannel`                          | Да             | Да                    | Нет               | Нет                      |
| `IDuplexSessionChannel`                         | Нет              | Нет                     | Да              | Да                     |

&#8225;Поддерживаемые типы каналов представляют собой значения, доступные для универсального `TChannel` значение параметра, передаваемого в <xref:System.ServiceModel.Channels.ReliableSessionBindingElement.BuildChannelListener%60%601%28System.ServiceModel.Channels.BindingContext%29> метод.

## <a name="reliable-sessions-and-security"></a>Надежные сеансы и безопасность

Защита надежного сеанса важно для обеспечения проверки подлинности взаимодействующих сторон (службы и клиента), а не подделаны сообщений, передаваемых в сеансе. Кроме того важно обеспечить целостность каждого отдельного надежного сеанса. Надежный сеанс защищен его привязкой к контексту безопасности, представленному и управляемому каналом сеанса безопасности. Канал безопасности обеспечивает сеанс безопасности. Маркеры безопасности, обмен которыми осуществляется во время установления сеанса, затем используются для защиты сообщений в надежном сеансе.

Если надежный сеанс по TCP-S, сеанс TCP привязывается к надежному сеансу. Таким образом механизм обеспечения безопасности транспорта обеспечивает безопасность и привязан к надежному сеансу. В этом случае восстановление подключения выключено.

Единственное исключение относится к использованию HTTPS. Сеанс Secure Sockets Layer (SSL) не привязан к надежному сеансу. Это предполагает угрозу, поскольку сеансы, которые совместно используют контекст безопасности (сеанс SSL) не защищены друг от друга; Это может являться или не может являться реальной угрозой в зависимости от приложения.

## <a name="using-reliable-sessions"></a>С использованием надежных сеансов

Чтобы использовать надежные сеансы WCF, создайте конечную точку с привязкой, которая поддерживает надежный сеанс. Используйте одну из предоставляемых системой привязок, предоставляемых WCF с помощью надежного сеанса включен, или создать собственную пользовательскую привязку, такому же принципу.

Определенные системой привязки, которые поддерживают и разрешают надежный сеанс, включают в себя:

- <xref:System.ServiceModel.WSDualHttpBinding>

Предоставляемые системой привязки, которые поддерживают надежные сеансы с помощью параметров, но не включено по умолчанию, включают:

- <xref:System.ServiceModel.WSHttpBinding>

- <xref:System.ServiceModel.WSFederationHttpBinding>

- <xref:System.ServiceModel.NetTcpBinding>

Пример создания пользовательской привязки см. в разделе [как: Создание пользовательской привязки надежного сеанса с использованием HTTPS](../../../../docs/framework/wcf/feature-details/how-to-create-a-custom-reliable-session-binding-with-https.md).

Описание привязок WCF, которые поддерживают надежные сеансы, в разделе [привязка, предоставляемая системой](../../../../docs/framework/wcf/system-provided-bindings.md).

## <a name="when-to-use-reliable-sessions"></a>Когда следует использовать надежные сеансы

Важно понять, когда следует использовать надежные сеансы в вашем приложении. WCF поддерживает надежные сеансы между конечными точками, которые являются активными, работающими одновременно. Если приложению требуется одна конечная точка бы недоступной в течение определенного периода времени, а затем использовать очереди для обеспечения надежности.

Если сценарий требует две конечные точки подключения по протоколу TCP, TCP может быть достаточно для обеспечения надежного обмена сообщениями. Хотя это необязательно для использования надежных сеансов, так как TCP гарантирует, что пакеты прибывают в порядке и только один раз.

Если ваш сценарий имеет один из следующих характеристик, вы должны серьезно рассмотрите возможность использования надежного сеанса.

- Посредники протокола SOAP, например маршрутизаторы SOAP

- Посредники прокси или транспортные мосты

- Неустойчивое подключение

- Сеансы по протоколу HTTP

## <a name="see-also"></a>См. также

[Использование привязок для настройки служб и клиентов](../../../../docs/framework/wcf/using-bindings-to-configure-services-and-clients.md)   
[Надежный сеанс WS](../../../../docs/framework/wcf/samples/ws-reliable-session.md)
