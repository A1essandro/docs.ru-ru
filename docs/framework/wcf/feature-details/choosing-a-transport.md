---
title: Выбор транспортов
ms.date: 03/30/2017
helpviewer_keywords:
- choosing transports [WCF]
ms.assetid: b169462b-f7b6-4cf4-9fca-d306909ee8bf
ms.openlocfilehash: 7f1b356bdb70c9a7fd94f45c5c4424eebe822049
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="choosing-a-transport"></a>Выбор транспортов
В этом разделе рассматриваются критерии выбора одного из трех основных транспортов, включенные в Windows Communication Foundation (WCF): HTTP, TCP и именованных каналов. WCF также включает транспорт очереди сообщений (MSMQ), но в этом документе не описываются очереди сообщений.  
  
 Модель программирования WCF отделяет операции конечных (выраженные в контракте службы) от транспортного механизма, соединяющего две конечные точки. Это позволяет выбирать способ предоставления служб сети.  
  
 В WCF, укажите способ передачи данных по сети между конечными точками, с помощью *привязки*, которая состоит из последовательности *элементов привязки*. Транспорт представляется элементом привязки транспорта, являющимся частью привязки. В привязку входят необязательные элементы привязки протокола, такие как безопасность, обязательный элемент привязки кодировщика сообщений и обязательный элемент привязки транспорта. Транспорт отправляет другому приложению сериализованную форму сообщения и получает ее от этого приложения.  
  
 При необходимости подключиться к существующему клиенту или серверу не всегда имеется возможность выбрать определенный транспорт. Однако службы WCF могут выполняться доступны через несколько конечных точек, каждая из которых использует разный транспорт. Если один транспорт не охватывает всю аудиторию, для которой предназначена служба, целесообразно предоставлять службы через несколько конечных точек. Это позволит клиентским приложениям выбирать наиболее подходящие конечные точки.  
  
 После выбора транспорта необходимо выбрать использующую его привязку. Можно выбрать предоставляемую системой привязку (см. [привязка, предоставляемая системой](../../../../docs/framework/wcf/system-provided-bindings.md)), или можно создать собственную пользовательскую привязку (см. [пользовательских привязок](../../../../docs/framework/wcf/extending/custom-bindings.md)). Также можно создать собственную привязку. Дополнительные сведения см. в разделе [привязки привязанных к](../../../../docs/framework/wcf/extending/creating-user-defined-bindings.md).  
  
## <a name="advantages-of-each-transport"></a>Преимущества каждого транспорта  
 В этом разделе описываются основные причины выбора одного из трех основных транспортов и приводится подробная диаграмма принятия решений, которая поможет сделать правильный выбор.  
  
### <a name="when-to-use-http-transport"></a>Использование транспорта HTTP  
 HTTP - это протокол обмена запросами и ответами между клиентами и серверами. Чаще всего он используется при взаимодействии клиентов веб-обозревателя с веб-сервером. Клиент отправляет запрос на сервер, который ожидает передачи сообщений запроса клиента. После получения запроса сервер возвращает ответ, в котором содержится состояние запроса. В случае успешного выполнения возвращаются необязательные данные, такие как веб-страница, сообщение об ошибке и другая информация. Дополнительные сведения о протоколе HTTP см. в разделе [HTTP - протокол](http://go.microsoft.com/fwlink/?LinkId=94858).  
  
 Протокол HTTP функционирует не на основе подключения, т. е. после отправки ответа состояние не поддерживается. Обработка многостраничных транзакций возможна только при сохранении необходимого состояния приложения.  
  
 В WCF, транспорт HTTP привязка оптимизирована для взаимодействия с системами прежних версий не WCF. Если все взаимодействующие стороны используют WCF, TCP или именованных каналов привязки на основе работают быстрее. Дополнительные сведения см. в разделах <xref:System.ServiceModel.NetTcpBinding> и <xref:System.ServiceModel.NetNamedPipeBinding>.  
  
### <a name="when-to-use-the-tcp-transport"></a>Использование транспорта TCP  
 Протокол TCP - это поточно-ориентированная служба доставки на основе подключения с возможностью сквозного обнаружения и исправления ошибок. *На основе подключения* означает, что до начала обмена данными устанавливается сеанс связи между узлами. Узел - это любое устройство в сети TCP/IP, идентифицируемое логическим IP-адресом.  
  
 Протокол TCP обеспечивает надежную доставку данных и отличается простотой в использовании. В частности, протокол TCP уведомляет отправителя о доставке пакета, гарантирует сохранение очередности пакетов в процессе доставки, повторно передает потерянные пакеты и препятствует дублированию пакетов данных. Обратите внимание, что это надежная доставка осуществляется между двумя узлами TCP/IP не то же самое, что *WS-ReliableMessaging*, которая применяется между конечными точками, независимо от того, сколько промежуточных узлов могут быть включены.  
  
 Транспорта WCF TCP оптимизирован для сценария, где обе взаимодействующие стороны используют WCF. Эта привязка является быстрым привязки WCF для сценариев, предполагающих взаимодействие между разными компьютерами. Обмены сообщениями используют элемент привязки <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement> для оптимизированной передачи сообщений. TCP обеспечивает дуплексную связь, следовательно, этот протокол можно использовать для реализации дуплексных контрактов, даже если клиент находится за пределами преобразования сетевых адресов (NAT).  
  
### <a name="when-to-use-the-named-pipe-transport"></a>Использование транспорта именованного канала  
 Именованный канал - это объект в ядре операционной системы Windows, такой как, например, общая область памяти, которая может использоваться процессами для взаимодействия. Именованный канал имеет имя, его можно использовать для односторонней или дуплексной связи между процессами на одном компьютере.  
  
 Если вы хотите запретить любое взаимодействие с другого компьютера при обмене данными между приложениями WCF на одном компьютере, затем используйте транспорт именованных каналов. При этом действует еще одно ограничение: процессы, выполняемые с удаленного рабочего стола Windows, могут ограничиваться тем же сеансом удаленного рабочего стола Windows, если они не обладают привилегиями более высокого уровня.  
  
> [!WARNING]
>  При использовании транспорта именованного канала с резервированием URL-адрес со слабым шаблоном на нескольких узлах, размещенных в IIS, может возникнуть следующая ошибка: произошла ошибка в службе активации «NetPipeActivator» протокола «net.pipe» при попытке прослушивания узла «2», Поэтому протокол для узла был временно отключен. См. сообщение об исключении для получения дополнительных сведений. URL-адрес: WeakWildcard:net.pipe:/\<имя компьютера > / Состояние: ConflictingRegistration исключение: имя процесса: идентификатор процесса SMSvcHost: 1076\  
  
## <a name="decision-points-for-choosing-a-transport"></a>Факторы, определяющие выбор транспорта  
 В следующей таблице описаны стандартные факторы, которые необходимо учитывать при выборе транспорта. Необходимо также рассмотреть все дополнительные атрибуты и транспорты, применимые к приложению. Определите важные для приложения атрибуты и транспорты, которые успешно связываются с каждым из атрибутов, затем выберите транспорты, которые лучше всего подходят к составленному набору атрибутов.  
  
|Атрибут|Описание|Поддерживаемые транспорты|  
|---------------|-----------------|------------------------|  
|Диагностика|Диагностика позволяет автоматически выявлять проблемы с подключением транспорта. Все транспорты поддерживают возможность обратной отправки информации о сбоях подключения. WCF не включает средства диагностики для исследования неполадок в сети.|Нет|  
|Размещение|Всех конечных точек WCF должны размещаться внутри приложения. [!INCLUDE[iis601](../../../../includes/iis601-md.md)] и более ранние версии поддерживают размещение приложений, использующих только HTTP-транспорт. На [!INCLUDE[wv](../../../../includes/wv-md.md)], поддержка добавляется для размещения всех транспортов WCF, включая протокол TCP и именованные каналы. Дополнительные сведения см. в разделе [размещение в службах IIS](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md) и [размещение в службе активации процессов Windows](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md).|HTTP|  
|Проверка|Проверка - это возможность извлекать и обрабатывать информацию из сообщений во время передачи. Протокол HTTP отделяет сведения о маршрутизации и управлении от данных, благодаря чему легче создавать средства для проверки и анализа сообщений. Транспорты, которые легко проверять, также требуют меньше вычислительной производительности в сетевых устройствах. Возможность проверки сообщений зависит от заданного уровня безопасности.|HTTP|  
|Задержка|Задержка - это минимальный промежуток времени, необходимый для завершения обмена сообщениями. Все сетевые операции имеют то или иное значение задержки, которое зависит от выбранного транспорта. При односторонней или дуплексной связи с использованием транспорта, собственным шаблоном обмена сообщениями которого является "запрос-ответ" (например, HTTP), задержка увеличивается, так как организуется принудительная корреляция сообщений. В этом случае целесообразно использовать транспорт с собственным дуплексным шаблоном обмена сообщениями (например, TCP).|TCP, именованный<br /><br /> канал|  
|Область действия|Область действия транспорта характеризует способность транспорта подключаться к другим системам. Транспорт именованных каналов имеет очень небольшую область действия, так как он может подключаться только к службам, выполняемым на том же компьютере. Транспорты TCP и HTTP обладают широкой областью действия и способны проникать в некоторые конфигурации NAT и конфигурации брандмауэра. Дополнительные сведения см. в разделе [работа с NAT и брандмауэров](../../../../docs/framework/wcf/feature-details/working-with-nats-and-firewalls.md).|HTTP, TCP|  
|Безопасность|Безопасность - это возможность защищать сообщения во время передачи с помощью конфиденциальности, целостности или проверки подлинности. Конфиденциальность защищает сообщение от изучения, целостность - от изменения, а проверка подлинности предоставляет гарантии относительно отправителя или получателя сообщения.<br /><br /> WCF поддерживает безопасность передачи как на уровне сообщений и транспортного уровня. Безопасность сообщения составляется с транспортом, если транспорт поддерживает режим буферизованной передачи. Поддержка транспортной безопасности варьируется в зависимости от выбранного транспорта. Транспорты HTTP, TCP и транспорт именованных каналов обеспечивают практически одинаковую поддержку безопасности транспорта.|Все|  
|Пропускная способность|Этот показатель измеряет объем данных, которые можно передать и обработать за указанный промежуток времени. Выбор транспорта влияет на пропускную способность операций службы, как и на задержку. Чтобы обеспечить максимальную пропускную способность транспорта, необходимо свести к минимуму нагрузку передаваемого содержимого и максимально сократить время ожидания завершения обмена сообщениями. При использовании транспорта TCP и транспорта именованных каналов к телу сообщения добавляется незначительная нагрузка, более того, эти транспорты поддерживают собственную дуплексную форму, благодаря чему сокращается время ожидания ответных сообщений.|TCP, именованный канал|  
|Инструментарий|Инструментарий представляет поддержку сторонних приложений для протокола, с помощью которого осуществляются разработка, диагностика, размещение и другие операции с приложением. Очень выгодным вложением станет создание средств и программного обеспечения для работы с протоколом HTTP.|HTTP|  
  
## <a name="see-also"></a>См. также  
 <xref:System.ServiceModel.BasicHttpBinding>  
 <<!--zz xref:System.ServiceModel.WsHttpBinding --> `xref:System.ServiceModel.WsHttpBinding`>  
  <<!--zz <xref:System.ServiceModel.WsDualHttpBinding> --> `System.ServiceModel.WsDualHttpBinding`
 <<!--zz <xref:System.ServiceModel.WsFederationHttpBinding>  --> `System.ServiceModel.WsFederationHttpBinding` <xref:System.ServiceModel.Channels.HttpTransportBindingElement>  
 <xref:System.ServiceModel.NetTcpBinding>  
 <xref:System.ServiceModel.Channels.TcpTransportBindingElement>  
 <xref:System.ServiceModel.NetNamedPipeBinding>  
 <xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement>  
 [Привязки](../../../../docs/framework/wcf/feature-details/bindings.md)  
 [Привязки, предоставляемые системой](../../../../docs/framework/wcf/system-provided-bindings.md)  
 [Создание пользовательских привязок](../../../../docs/framework/wcf/extending/creating-user-defined-bindings.md)
