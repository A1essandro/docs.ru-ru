---
title: "Выбор транспортов | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "выбор транспортов [WCF]"
ms.assetid: b169462b-f7b6-4cf4-9fca-d306909ee8bf
caps.latest.revision: 25
author: "Erikre"
ms.author: "erikre"
manager: "erikre"
caps.handback.revision: 25
---
# Выбор транспортов
В этом разделе описываются критерии выбора одного из трех основных транспортов, входящих в состав [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]: HTTP, TCP, именованные каналы.[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] также включает транспорт очереди сообщений \(также известный как MSMQ\), однако в этом документе не описываются очереди сообщений.  
  
 Модель программирования [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] отделяет операции конечных точек \(выраженные в контракте службы\) от транспортного механизма, соединяющего две конечные точки.Это позволяет выбирать способ предоставления служб сети.  
  
 В [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] способ передачи данных по сети между конечными точками задается с помощью *привязки*, которая состоит из последовательности *элементов привязки*.Транспорт представляется элементом привязки транспорта, являющимся частью привязки.В привязку входят необязательные элементы привязки протокола, такие как безопасность, обязательный элемент привязки кодировщика сообщений и обязательный элемент привязки транспорта.Транспорт отправляет другому приложению сериализованную форму сообщения и получает ее от этого приложения.  
  
 При необходимости подключиться к существующему клиенту или серверу не всегда имеется возможность выбрать определенный транспорт.Однако доступ к службам [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] может осуществляться через несколько конечных точек, каждая из которых использует разный транспорт.Если один транспорт не охватывает всю аудиторию, для которой предназначена служба, целесообразно предоставлять службы через несколько конечных точек.Это позволит клиентским приложениям выбирать наиболее подходящие конечные точки.  
  
 После выбора транспорта необходимо выбрать использующую его привязку.Можно выбрать привязку, предоставляемую системой \(см. раздел [Привязки, предоставляемые системой](../../../../docs/framework/wcf/system-provided-bindings.md)\), или создать пользовательскую привязку \(см. раздел [Пользовательские привязки](../../../../docs/framework/wcf/extending/custom-bindings.md)\).Также можно создать собственную привязку.[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Создание пользовательских привязок](../../../../docs/framework/wcf/extending/creating-user-defined-bindings.md).  
  
## Преимущества каждого транспорта  
 В этом разделе описываются основные причины выбора одного из трех основных транспортов и приводится подробная диаграмма принятия решений, которая поможет сделать правильный выбор.  
  
### Использование транспорта HTTP  
 HTTP — это протокол обмена запросами и ответами между клиентами и серверами.Чаще всего он используется при взаимодействии клиентов веб\-обозревателя с веб\-сервером.Клиент отправляет запрос на сервер, который ожидает передачи сообщений запроса клиента.После получения запроса сервер возвращает ответ, в котором содержится состояние запроса.В случае успешного выполнения возвращаются необязательные данные, такие как веб\-страница, сообщение об ошибке и другая информация.[!INCLUDE[crabout](../../../../includes/crabout-md.md)] о HTTP\-протоколе см. в разделе [HTTP — протокол передачи гипертекста](http://go.microsoft.com/fwlink/?LinkId=94858).  
  
 Протокол HTTP функционирует не на основе подключения, т. е. после отправки ответа состояние не поддерживается.Обработка многостраничных транзакций возможна только при сохранении необходимого состояния приложения.  
  
 В [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] привязка транспорта HTTP оптимизирована для обеспечения взаимодействия с системами, отличными от [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], прежних версий.Если все взаимодействующие стороны используют [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], то привязки на основе TCP или именованных каналов работают быстрее.[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<xref:System.ServiceModel.NetTcpBinding> и <xref:System.ServiceModel.NetNamedPipeBinding>.  
  
### Использование транспорта TCP  
 Протокол TCP — это поточно\-ориентированная служба доставки на основе подключения с возможностью сквозного обнаружения и исправления ошибок.*На основе подключения* означает, что до начала обмена данными между узлами устанавливается сеанс связи.Узел — это любое устройство в сети TCP\/IP, идентифицируемое логическим IP\-адресом.  
  
 Протокол TCP обеспечивает надежную доставку данных и отличается простотой в использовании.В частности, протокол TCP уведомляет отправителя о доставке пакета, гарантирует сохранение очередности пакетов в процессе доставки, повторно передает потерянные пакеты и препятствует дублированию пакетов данных.Обратите внимание, что такая надежная доставка осуществляется между двумя узлами TCP\/IP и отличается от доставки по протоколу *WS\-ReliableMessaging*, так как последняя осуществляется между конечными точками независимо от того, сколько промежуточных узлов входит в их состав.  
  
 Транспорт TCP [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] оптимизирован для сценария, в котором обе взаимодействующие стороны используют [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].Эта привязка является самой быстрой из всех привязок [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] для сценариев, предполагающих взаимодействие между разными компьютерами.Обмены сообщениями используют элемент привязки <xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement> для оптимизированной передачи сообщений.TCP обеспечивает дуплексную связь, следовательно, этот протокол можно использовать для реализации дуплексных контрактов, даже если клиент находится за пределами преобразования сетевых адресов \(NAT\).  
  
### Использование транспорта именованного канала  
 Именованный канал — это объект в ядре операционной системы Windows, такой как, например, общая область памяти, которая может использоваться процессами для взаимодействия.Именованный канал имеет имя, его можно использовать для односторонней или дуплексной связи между процессами на одном компьютере.  
  
 Если необходимо наладить связь между разными приложениями [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] на одном компьютере и не допустить участия во взаимодействии другого компьютера, следует использовать транспорт именованных каналов.При этом действует еще одно ограничение: процессы, выполняемые с удаленного рабочего стола Windows, могут ограничиваться тем же сеансом удаленного рабочего стола Windows, если они не обладают привилегиями более высокого уровня.  
  
> [!WARNING]
>  При использовании транспорта именованного канала с резервированием URL\-адресов со слабым шаблоном на нескольких узлах, размещенных на IIS, может возникнуть следующая ошибка: Возникла ошибка в службе активации «NetPipeActivator» протокола «net.pipe» при попытке прослушивания узла «2», поэтому протокол для узла был временно отключен. Дополнительные сведения см. в описании сообщения об исключении. URL: WeakWildcard:net.pipe:\/\<machine name\>\/ Status: ConflictingRegistration Exception:  Process Name: SMSvcHost Process ID: 1076\\  
  
## Факторы, определяющие выбор транспорта  
 В следующей таблице описаны стандартные факторы, которые необходимо учитывать при выборе транспорта.Необходимо также рассмотреть все дополнительные атрибуты и транспорты, применимые к приложению.Определите важные для приложения атрибуты и транспорты, которые успешно связываются с каждым из атрибутов, затем выберите транспорты, которые лучше всего подходят к составленному набору атрибутов.  
  
|Атрибут|Описание|Поддерживаемые транспорты|  
|-------------|--------------|-------------------------------|  
|Диагностика|Диагностика позволяет автоматически выявлять проблемы с подключением транспорта.Все транспорты поддерживают возможность обратной отправки информации о сбоях подключения.Однако в состав [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] не входят средства диагностики для исследования неполадок в сети.|None|  
|Размещение|Все конечные точки [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] должны размещаться внутри приложения.[!INCLUDE[iis601](../../../../includes/iis601-md.md)] и более ранние версии поддерживают размещение приложений, использующих только HTTP\-транспорт.В [!INCLUDE[wv](../../../../includes/wv-md.md)] добавлена поддержка размещения приложений, использующих все транспорты [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], включая TCP и именованные каналы.[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Размещение в службах IIS](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md) и [Размещение в службе активации процессов Windows](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md).|HTTP|  
|Проверка|Проверка — это возможность извлекать и обрабатывать информацию из сообщений во время передачи.Протокол HTTP отделяет сведения о маршрутизации и управлении от данных, благодаря чему легче создавать средства для проверки и анализа сообщений.Транспорты, которые легко проверять, также требуют меньше вычислительной производительности в сетевых устройствах.Возможность проверки сообщений зависит от заданного уровня безопасности.|HTTP|  
|Задержка|Задержка — это минимальный промежуток времени, необходимый для завершения обмена сообщениями.Все сетевые операции имеют то или иное значение задержки, которое зависит от выбранного транспорта.При односторонней или дуплексной связи с использованием транспорта, собственным шаблоном обмена сообщениями которого является "запрос\-ответ" \(например, HTTP\), задержка увеличивается, так как организуется принудительная корреляция сообщений.В этом случае целесообразно использовать транспорт с собственным дуплексным шаблоном обмена сообщениями \(например, TCP\).|TCP, именованный<br /><br /> канал|  
|Область действия|Область действия транспорта характеризует способность транспорта подключаться к другим системам.Транспорт именованных каналов имеет очень небольшую область действия, так как он может подключаться только к службам, выполняемым на том же компьютере.Транспорты TCP и HTTP обладают широкой областью действия и способны проникать в некоторые конфигурации NAT и конфигурации брандмауэра.[!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Работа со средствами NAT и брандмауэрами](../../../../docs/framework/wcf/feature-details/working-with-nats-and-firewalls.md).|HTTP, TCP|  
|Безопасность|Безопасность — это возможность защищать сообщения во время передачи с помощью конфиденциальности, целостности или проверки подлинности.Конфиденциальность защищает сообщение от изучения, целостность — от изменения, а проверка подлинности предоставляет гарантии относительно отправителя или получателя сообщения.<br /><br /> [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] поддерживает безопасность передачи как на уровне сообщения, так и на уровне транспорта.Безопасность сообщения составляется с транспортом, если транспорт поддерживает режим буферизованной передачи.Поддержка транспортной безопасности варьируется в зависимости от выбранного транспорта.Транспорты HTTP, TCP и транспорт именованных каналов обеспечивают практически одинаковую поддержку безопасности транспорта.|Все|  
|Пропускная способность|Этот показатель измеряет объем данных, которые можно передать и обработать за указанный промежуток времени.Выбор транспорта влияет на пропускную способность операций службы, как и на задержку.Чтобы обеспечить максимальную пропускную способность транспорта, необходимо свести к минимуму нагрузку передаваемого содержимого и максимально сократить время ожидания завершения обмена сообщениями.При использовании транспорта TCP и транспорта именованных каналов к телу сообщения добавляется незначительная нагрузка, более того, эти транспорты поддерживают собственную дуплексную форму, благодаря чему сокращается время ожидания ответных сообщений.|TCP, именованный канал|  
|Инструментарий|Инструментарий представляет поддержку сторонних приложений для протокола, с помощью которого осуществляются разработка, диагностика, размещение и другие операции с приложением.Очень выгодным вложением станет создание средств и программного обеспечения для работы с протоколом HTTP.|HTTP|  
  
## См. также  
 <xref:System.ServiceModel.BasicHttpBinding>   
 <xref:System.ServiceModel.WsHttpBinding>   
 <xref:System.ServiceModel.WsDualHttpBinding>   
 <xref:System.ServiceModel.WsFederationHttpBinding>   
 <xref:System.ServiceModel.Channels.HttpTransportBindingElement>   
 <xref:System.ServiceModel.NetTcpBinding>   
 <xref:System.ServiceModel.Channels.TcpTransportBindingElement>   
 <xref:System.ServiceModel.NetNamedPipeBinding>   
 <xref:System.ServiceModel.Channels.NamedPipeTransportBindingElement>   
 [Привязки](../../../../docs/framework/wcf/feature-details/bindings.md)   
 [Привязки, предоставляемые системой](../../../../docs/framework/wcf/system-provided-bindings.md)   
 [Создание пользовательских привязок](../../../../docs/framework/wcf/extending/creating-user-defined-bindings.md)