---
title: "Диагностика транзакционных приложений"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 4a993492-1088-4d10-871b-0c09916af05f
caps.latest.revision: "8"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 15bb435269ca67e8de67e8e768e98d5832556f02
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2017
---
# <a name="diagnosing-transactional-applications"></a>Диагностика транзакционных приложений
В этом разделе рассматривается использование функции управления и диагностики [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] для устранения неполадок транзакционного приложения.  
  
## <a name="performance-counters"></a>Счетчики производительности  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] обеспечивает стандартный набор счетчиков производительности для измерения производительности транзакционного приложения. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Счетчики производительности](../../../../docs/framework/wcf/diagnostics/performance-counters/index.md).  
  
 Счетчики производительности группируются по трем различным уровням области действия: служба, конечная точка и операция, как описано в приведенных далее таблицах.  
  
### <a name="service-performance-counters"></a>Счетчики производительности службы  
  
|Счетчик производительности|Описание|  
|-------------------------|-----------------|  
|Количество поступивших транзакций|Количество транзакций в операциях для данной службы. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном в службу, имеется транзакция.|  
|Количество поступивших транзакций в секунду|Количество транзакций в операциях для данной службы за каждую секунду. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном в службу, имеется транзакция.|  
|Количество зафиксированных операций с поддержкой транзакций|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с результатом, зафиксированным в этой службе. Работа, выполненная в таких операциях, полностью зафиксирована. Ресурсы обновлены в соответствии с работой, выполненной в операции.|  
|Количество зафиксированных операций с поддержкой транзакций в секунду|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с результатом, зафиксированным в этой службе в течение каждой секунды. Работа, выполненная в таких операциях, полностью зафиксирована. Ресурсы обновлены в соответствии с работой, выполненной в операции.|  
|Количество прерванных операций с поддержкой транзакций|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с прерыванием в этой службе. Для работы, выполненной в таких операциях, производится откат. Для ресурсов восстанавливается предыдущее состояние.|  
|Количество прерванных операций с поддержкой транзакций в секунду|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены прерыванием в этой службе в течение каждой секунды. Для работы, выполненной в таких операциях, производится откат. Для ресурсов восстанавливается предыдущее состояние.|  
|Количество операций с поддержкой транзакций с сомнительным результатом|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с сомнительным результатом в этой службе. Работа, выполненная с результатом "сомнительно", находится в неопределенном состоянии. Ресурсы находятся в состоянии ожидания результата.|  
|Количество операций с поддержкой транзакций с сомнительным результатом в секунду|Количество выполненных операций с поддержкой транзакций, транзакции которых были завершены с результатом "сомнительно" в этой службе в течение каждой секунды. Работа, выполненная с результатом "сомнительно", находится в неопределенном состоянии. Ресурсы находятся в состоянии ожидания результата.|  
  
### <a name="endpoint-performance-counters"></a>Счетчики производительности конечных точек  
  
|Счетчик производительности|Описание|  
|-------------------------|-----------------|  
|Количество поступивших транзакций|Количество транзакций, поступивших в операции на этой конечной точке. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
|Количество поступивших транзакций в секунду|Количество транзакций в операциях для данной конечной точки за каждую секунду. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
  
### <a name="operation-performance-counters"></a>Счетчики производительности операций  
  
|Счетчик производительности|Описание|  
|-------------------------|-----------------|  
|Количество поступивших транзакций|Количество транзакций, поступивших в операции на этой конечной точке. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
|Количество поступивших транзакций в секунду|Количество транзакций в операциях для данной конечной точки за каждую секунду. Значение этого счетчика увеличивается каждый раз, когда в сообщении, отправленном на эту конечную точку, содержится транзакция.|  
  
## <a name="windows-management-instrumentation"></a>Инструментарий управления Windows (WMI)  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] предоставляет данные проверки службы во время выполнения с помощью поставщика инструментария управления Windows (WMI) [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]. [!INCLUDE[crabout](../../../../includes/crabout-md.md)]доступ к данным WMI, в разделе [с помощью Windows Management Instrumentation для диагностики](../../../../docs/framework/wcf/diagnostics/wmi/index.md).  
  
 Ряд свойств WMI только для чтения показывает применяемые в службе параметры транзакции. В приведенных ниже таблицах перечислены эти параметры.  
  
 В службе атрибут `ServiceBehaviorAttribute` имеет следующие свойства.  
  
|Имя|Тип|Описание|  
|----------|----------|-----------------|  
|ReleaseServiceInstanceOnTransactionComplete|Boolean|Указывает, производится ли повторное использование объекта службы после завершения текущей транзакции.|  
|TransactionAutoCompleteOnSessionClose|Boolean|Указывает, завершаются ли ожидающие транзакции при закрытии текущего сеанса.|  
|TransactionIsolationLevel|Строка, содержащая допустимое значение перечисления <xref:System.Transactions.IsolationLevel>.|Задает уровень изоляции транзакции, поддерживаемый этой службой.|  
|TransactionTimeout|<xref:System.DateTime>|Задает период времени, в течение которого транзакция должна быть завершена.|  
  
 Атрибут `ServiceTimeoutsBehavior` имеет следующее свойство.  
  
|Имя|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionTimeout|<xref:System.DateTime>|Задает период времени, в течение которого транзакция должна быть завершена.|  
  
 В привязке атрибут `TransactionFlowBindingElement` имеет следующие свойства.  
  
|Имя|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionProtocol|Строка, содержащая допустимое значение типа <xref:System.ServiceModel.TransactionProtocol>.|Указывает протокол транзакций, используемый при передаче транзакций.|  
|TransactionFlow|Boolean|Задает, включен ли входящий поток транзакций.|  
  
 В операции атрибут `OperationBehaviorAttribute` имеет следующие свойства.  
  
|Имя|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionAutoComplete|Boolean|Указывает, следует ли автоматически фиксировать текущую транзакцию при отсутствии необработанных исключений.|  
|TransactionScopeRequired|Boolean|Указывает, требует ли операция транзакции.|  
  
 В операции атрибут `TransactionFlowAttribute` имеет следующие свойства.  
  
|Имя|Тип|Описание|  
|----------|----------|-----------------|  
|TransactionFlowOption|Строка, содержащая допустимое значение перечисления <xref:System.ServiceModel.TransactionFlowOption>.|Задает область, к которой требуется поток транзакций.|  
  
## <a name="tracing"></a>Трассировка  
 Трассировка позволяет контролировать и анализировать ошибки в транзакционных приложениях. Трассировку можно включить следующими способами.  
  
-   Стандартная трассировка [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]  
  
     Трассировка этого типа аналогична трассировке любого другого приложения [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]. [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)][Настройка трассировки](../../../../docs/framework/wcf/diagnostics/tracing/configuring-tracing.md).  
  
-   Трассировка WS-AtomicTransaction  
  
     Трассировку WS-AtomicTransaction можно включить с помощью [программы конфигурации WS-AtomicTransaction (wsatConfig.exe)](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md). Такая трассировка позволяет контролировать состояние транзакций и участников внутри системы. Чтобы включить также и трассировку модели службы, можно задать для ключа реестра `HKLM\SOFTWARE\Microsoft\WSAT\3.0\ServiceModelDiagnosticTracing` допустимое значение перечисления <xref:System.Diagnostics.SourceLevels>. Ведение журнала сообщений включается так же, как и для других приложений [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].  
  
-   Трассировка `System.Transactions`  
  
     При использовании протокола OleTransactions возможна трассировка сообщений протокола. Поддержка трассировки, предоставляемая инфраструктурой <xref:System.Transactions> (которая использует протокол OleTransactions), позволяет пользователям просматривать события, происходящие с транзакциями. Чтобы включить трассировку для приложения <xref:System.Transactions>, поместите приведенный ниже код в файл конфигурации `App.config`.  
  
    ```xml  
    <configuration>  
      <system.diagnostics>  
         <sources>  
            <source name="System.Transactions" switchValue="Verbose, ActivityTracing">  
               <listeners>  
                  <add name="Text"  
                     type="System.Diagnostics.XmlWriterTraceListener"  
                     initializeData="SysTx.log"  
                     traceOutputOptions="Callstack" />  
               </listeners>  
            </source>  
         </sources>  
         <trace autoflush="true" indentsize="4">  
         </trace>  
      </system.diagnostics>  
    </configuration>  
    ```  
  
     При этом включается и трассировка [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], так как [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] также использует инфраструктуру <xref:System.Transactions>.  
  
## <a name="see-also"></a>См. также  
 [Администрирование и диагностика](../../../../docs/framework/wcf/diagnostics/index.md)  
 [Настройка трассировки](../../../../docs/framework/wcf/diagnostics/tracing/configuring-tracing.md)  
 [Служебная программа конфигурации WS-AtomicTransaction (wsatConfig.exe)](../../../../docs/framework/wcf/ws-atomictransaction-configuration-utility-wsatconfig-exe.md)
