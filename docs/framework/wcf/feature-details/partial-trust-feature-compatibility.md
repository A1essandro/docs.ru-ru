---
title: "Совместимость возможностей частичного доверия"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: a36a540b-1606-4e63-88e0-b7c59e0e6ab7
caps.latest.revision: "75"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 1950a0c4015658affb0b9fa0d7c87a062865144b
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="partial-trust-feature-compatibility"></a><span data-ttu-id="bf8e0-102">Совместимость возможностей частичного доверия</span><span class="sxs-lookup"><span data-stu-id="bf8e0-102">Partial Trust Feature Compatibility</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="bf8e0-103"> поддерживает ограниченный набор функциональности при выполнении в частично доверенной среде.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-103"> supports a limited subset of functionality when running in a partially-trusted environment.</span></span> <span data-ttu-id="bf8e0-104">Дополнительные сведения о различных функциях, поддерживаемых при работе с частичным доверием, которые разработаны на базе определенного набора сценариев, см. в разделе [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-104">The features supported in partial trust are designed around a specific set of scenarios as described in the [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md) topic.</span></span>  
  
## <a name="minimum-permission-requirements"></a><span data-ttu-id="bf8e0-105">Минимальные требования к разрешениям</span><span class="sxs-lookup"><span data-stu-id="bf8e0-105">Minimum Permission Requirements</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="bf8e0-106"> поддерживает подмножество функций в приложениях, выполняемых в рамках одного из следующих наборов разрешений со стандартными именами:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-106"> supports a subset of features in applications running under either of the following standard named permission sets:</span></span>  
  
-   <span data-ttu-id="bf8e0-107">Разрешения среднего уровня доверия;</span><span class="sxs-lookup"><span data-stu-id="bf8e0-107">Medium Trust permissions</span></span>  
  
-   <span data-ttu-id="bf8e0-108">Набор разрешений зоны Интернета.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-108">Internet Zone permissions</span></span>  
  
 <span data-ttu-id="bf8e0-109">Попытка использовать [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в частично доверенных приложениях с более строгими разрешениями может привести к возникновению исключений безопасности во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-109">Attempting to use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] in partially-trusted applications with more restrictive permissions may result in security exceptions at runtime.</span></span>  
  
## <a name="contracts"></a><span data-ttu-id="bf8e0-110">Контракты</span><span class="sxs-lookup"><span data-stu-id="bf8e0-110">Contracts</span></span>  
 <span data-ttu-id="bf8e0-111">При выполнении в частичном доверии контракты зависят от следующих ограничений:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-111">Contracts are subject to the following restrictions when running under partial trust:</span></span>  
  
-   <span data-ttu-id="bf8e0-112">Класс службы, реализующий интерфейс `[ServiceContract]` , должен иметь тип `public` и содержать конструктор типа `public` .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-112">The service class that implements the `[ServiceContract]` interface must be `public` and have a `public` constructor.</span></span> <span data-ttu-id="bf8e0-113">Если он определяет методы `[OperationContract]` , они должны иметь тип `public`.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-113">If it defines `[OperationContract]` methods, these must be `public`.</span></span> <span data-ttu-id="bf8e0-114">Если вместо этого он реализует интерфейс `[ServiceContract]` , эти методы реализации могут быть явно заданы или иметь тип `private`при условии, что интерфейс `[ServiceContract]` имеет тип `public`;</span><span class="sxs-lookup"><span data-stu-id="bf8e0-114">If it instead implements a `[ServiceContract]` interface, those method implementations can be explicit or `private`, provided that the `[ServiceContract]` interface is `public`.</span></span>  
  
-   <span data-ttu-id="bf8e0-115">При использовании атрибута `[ServiceKnownType]` указанный метод должен иметь тип `public`;</span><span class="sxs-lookup"><span data-stu-id="bf8e0-115">When using the `[ServiceKnownType]` attribute, the method specified must be `public`.</span></span>  
  
-   <span data-ttu-id="bf8e0-116">Классы`[MessageContract]` и их члены могут иметь тип `public`.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-116">`[MessageContract]` classes and their members can be `public`.</span></span> <span data-ttu-id="bf8e0-117">Если класс `[MessageContract]` определен в сборке приложения, он может иметь тип `internal` и его члены будут также `internal` .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-117">If the `[MessageContract]` class is defined in the application assembly it can be `internal` and have `internal` members.</span></span>  
  
## <a name="system-provided-bindings"></a><span data-ttu-id="bf8e0-118">Привязки, предоставляемые системой</span><span class="sxs-lookup"><span data-stu-id="bf8e0-118">System-Provided Bindings</span></span>  
 <span data-ttu-id="bf8e0-119">Типы <xref:System.ServiceModel.BasicHttpBinding> и <xref:System.ServiceModel.WebHttpBinding> полностью поддерживаются в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-119">The <xref:System.ServiceModel.BasicHttpBinding> and <xref:System.ServiceModel.WebHttpBinding> are fully supported in a partial trust environment.</span></span> <span data-ttu-id="bf8e0-120">Тип <xref:System.ServiceModel.WSHttpBinding> поддерживается только для режима безопасности транспорта.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-120">The <xref:System.ServiceModel.WSHttpBinding> is supported for Transport security mode only.</span></span>  
  
 <span data-ttu-id="bf8e0-121">Привязки, использующие транспорты, отличные от HTTP, такие как <xref:System.ServiceModel.NetTcpBinding>, <xref:System.ServiceModel.NetNamedPipeBinding>и <xref:System.ServiceModel.NetMsmqBinding>, не поддерживаются при выполнении в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-121">Bindings that use transports other than HTTP, such as the <xref:System.ServiceModel.NetTcpBinding>, the <xref:System.ServiceModel.NetNamedPipeBinding>, or the <xref:System.ServiceModel.NetMsmqBinding>, are not supported when running in a partial trust environment.</span></span>  
  
## <a name="custom-bindings"></a><span data-ttu-id="bf8e0-122">Пользовательские привязки</span><span class="sxs-lookup"><span data-stu-id="bf8e0-122">Custom Bindings</span></span>  
 <span data-ttu-id="bf8e0-123">Пользовательские привязки можно создавать и использовать в среде с частичным доверием, однако для них должны соблюдаться ограничения, указанные в данном разделе.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-123">Custom bindings can be created and used in a partial trust environment, but must follow the restrictions specified in this section.</span></span>  
  
### <a name="transports"></a><span data-ttu-id="bf8e0-124">Транспорты</span><span class="sxs-lookup"><span data-stu-id="bf8e0-124">Transports</span></span>  
 <span data-ttu-id="bf8e0-125">Допускается использование только элементов привязок транспортов <xref:System.ServiceModel.Channels.HttpTransportBindingElement> и <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-125">The only allowed transport binding elements are <xref:System.ServiceModel.Channels.HttpTransportBindingElement> and <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>.</span></span>  
  
### <a name="encoders"></a><span data-ttu-id="bf8e0-126">Кодировщики</span><span class="sxs-lookup"><span data-stu-id="bf8e0-126">Encoders</span></span>  
 <span data-ttu-id="bf8e0-127">Допускается использование следующих кодировщиков:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-127">The following encoders are allowed:</span></span>  
  
-   <span data-ttu-id="bf8e0-128">Текстовый кодировщик (<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>);</span><span class="sxs-lookup"><span data-stu-id="bf8e0-128">The text encoder (<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>).</span></span>  
  
-   <span data-ttu-id="bf8e0-129">Двоичный кодировщик (<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>);</span><span class="sxs-lookup"><span data-stu-id="bf8e0-129">The binary encoder (<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>).</span></span>  
  
-   <span data-ttu-id="bf8e0-130">Кодировщик веб-сообщений (<xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>).</span><span class="sxs-lookup"><span data-stu-id="bf8e0-130">The Web Message encoder (<xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>).</span></span>  
  
 <span data-ttu-id="bf8e0-131">Кодировщики механизма оптимизации передачи сообщений (MTOM) не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-131">The Message Transmission Optimization Mechanism (MTOM) encoders are not supported.</span></span>  
  
### <a name="security"></a><span data-ttu-id="bf8e0-132">Безопасность</span><span class="sxs-lookup"><span data-stu-id="bf8e0-132">Security</span></span>  
 <span data-ttu-id="bf8e0-133">Частично доверенные приложения для обеспечения безопасности своего взаимодействия могут использовать функции безопасности транспортного уровня [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="bf8e0-133">Partially-trusted applications can use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]'s transport-level security features for securing their communication.</span></span> <span data-ttu-id="bf8e0-134">Безопасность уровня сообщений не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-134">Message-level security is not supported.</span></span> <span data-ttu-id="bf8e0-135">Настройка привязки на использование безопасности уровня сообщений вызовет исключение в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-135">Configuring a binding to use message-level security results in an exception at runtime.</span></span>  
  
### <a name="unsupported-bindings"></a><span data-ttu-id="bf8e0-136">Неподдерживаемые привязки</span><span class="sxs-lookup"><span data-stu-id="bf8e0-136">Unsupported Bindings</span></span>  
 <span data-ttu-id="bf8e0-137">Не поддерживаются привязки, использующие надежный обмен сообщениями, транзакции и безопасность уровня сообщений.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-137">Bindings that use reliable messaging, transactions, or message-level security are not supported.</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="bf8e0-138">Сериализация</span><span class="sxs-lookup"><span data-stu-id="bf8e0-138">Serialization</span></span>  
 <span data-ttu-id="bf8e0-139">Оба типа <xref:System.Runtime.Serialization.DataContractSerializer> и <xref:System.Xml.Serialization.XmlSerializer> поддерживаются в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-139">Both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Xml.Serialization.XmlSerializer> are supported in a partial trust environment.</span></span> <span data-ttu-id="bf8e0-140">При этом использование <xref:System.Runtime.Serialization.DataContractSerializer> зависит от следующих условий.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-140">However, use of the <xref:System.Runtime.Serialization.DataContractSerializer> is subject to the following conditions:</span></span>  
  
-   <span data-ttu-id="bf8e0-141">Все сериализуемые типы `[DataContract]` должны иметь тип `public`.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-141">All serializable `[DataContract]` types must be `public`.</span></span>  
  
-   <span data-ttu-id="bf8e0-142">Все сериализуемые поля и свойства `[DataMember]` в типе `[DataContract]` должны быть открытыми и доступными для чтения и записи.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-142">All serializable `[DataMember]` fields or properties in a `[DataContract]` type must be public and read/write.</span></span> <span data-ttu-id="bf8e0-143">Сериализация и десериализация полей [readonly](http://go.microsoft.com/fwlink/?LinkID=98854) не поддерживается при выполнении [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в частично доверенном приложении.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-143">The serialization and deserialization of [readonly](http://go.microsoft.com/fwlink/?LinkID=98854) fields is not supported when running [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] in a partially-trusted application.</span></span>  
  
-   <span data-ttu-id="bf8e0-144">Модель программирования `[Serializable]`/ISerializable не поддерживается в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-144">The `[Serializable]`/ISerializable programming model is not supported in a partial trust environment.</span></span>  
  
-   <span data-ttu-id="bf8e0-145">Известные типы должны быть заданы в коде или конфигурации уровня компьютера (файл machine.config).</span><span class="sxs-lookup"><span data-stu-id="bf8e0-145">Known types must be specified in code or machine-level configuration (machine.config).</span></span> <span data-ttu-id="bf8e0-146">По соображениям безопасности известные типы нельзя задавать в конфигурации уровня приложения.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-146">Known types cannot be specified in application-level configuration for security reasons.</span></span>  
  
-   <span data-ttu-id="bf8e0-147">Типы, которые реализуют <xref:System.Runtime.Serialization.IObjectReference> , в среде с частичным доверием вызывают исключение.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-147">Types that implement <xref:System.Runtime.Serialization.IObjectReference> throw an exception in a partially-trusted environment.</span></span>  
  
 <span data-ttu-id="bf8e0-148">Дополнительные сведения о безопасности при использовании [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md) в частично доверенном приложении см. в разделе "Сериализация" статьи <xref:System.Runtime.Serialization.DataContractSerializer> .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-148">See the Serialization section in [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md) for more information about security when using <xref:System.Runtime.Serialization.DataContractSerializer> safely in a partially-trusted application.</span></span>  
  
### <a name="collection-types"></a><span data-ttu-id="bf8e0-149">Типы коллекций</span><span class="sxs-lookup"><span data-stu-id="bf8e0-149">Collection Types</span></span>  
 <span data-ttu-id="bf8e0-150">Некоторые типы коллекций реализуют и <xref:System.Collections.Generic.IEnumerable%601> , и <xref:System.Collections.IEnumerable>.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-150">Some collection types implement both <xref:System.Collections.Generic.IEnumerable%601> and <xref:System.Collections.IEnumerable>.</span></span> <span data-ttu-id="bf8e0-151">Примеры содержат типы, которые реализуют <xref:System.Collections.Generic.ICollection%601>.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-151">Examples include types that implement <xref:System.Collections.Generic.ICollection%601>.</span></span> <span data-ttu-id="bf8e0-152">Такие типы позволяют создать открытую ( `public` ) реализацию метода `GetEnumerator()`и явную реализацию метода `GetEnumerator()`.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-152">Such types can implement a `public` implementation of `GetEnumerator()`, and an explicit implementation of `GetEnumerator()`.</span></span> <span data-ttu-id="bf8e0-153">В данном случае <xref:System.Runtime.Serialization.DataContractSerializer> вызывает открытую ( `public` ) реализацию метода `GetEnumerator()`, а не явную реализацию метода `GetEnumerator()`.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-153">In this case, <xref:System.Runtime.Serialization.DataContractSerializer> invokes the `public` implementation of `GetEnumerator()`, and not the explicit implementation of `GetEnumerator()`.</span></span> <span data-ttu-id="bf8e0-154">Если все реализации метода `GetEnumerator()` являются явными и нет ни одной открытой ( `public` ), сериализатор <xref:System.Runtime.Serialization.DataContractSerializer> вызовет метод `IEnumerable.GetEnumerator()`.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-154">If none of the `GetEnumerator()` implementations are `public` and all are explicit implementations, then <xref:System.Runtime.Serialization.DataContractSerializer> invokes `IEnumerable.GetEnumerator()`.</span></span>  
  
 <span data-ttu-id="bf8e0-155">Для типов коллекций при выполнении [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в среде с частичным доверием, если ни одна из реализаций метода `GetEnumerator()` не является открытой ( `public`) или явной реализацией интерфейса, возникает исключение безопасности.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-155">For collection types when [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is running in a partial trust environment, if none of the `GetEnumerator()` implementations are `public`, or none of them are explicit interface implementations, then a security exception is thrown.</span></span>  
  
### <a name="netdatacontractserializer"></a><span data-ttu-id="bf8e0-156">NetDataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="bf8e0-156">NetDataContractSerializer</span></span>  
 <span data-ttu-id="bf8e0-157">При работе с частичным доверием многие типы коллекций .NET Framework не поддерживаются <xref:System.Collections.Generic.List%601>, например <xref:System.Collections.ArrayList>, <xref:System.Collections.Generic.Dictionary%602> , <xref:System.Collections.Hashtable> и <xref:System.Runtime.Serialization.NetDataContractSerializer> .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-157">Many .NET Framework collection types such as <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ArrayList>, <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Hashtable> are not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust.</span></span> <span data-ttu-id="bf8e0-158">У этих типов задан атрибут `[Serializable]` , который не поддерживается при работе с частичным доверием, о чем написано выше в разделе «Сериализация».</span><span class="sxs-lookup"><span data-stu-id="bf8e0-158">These types have the `[Serializable]` attribute set, and as stated previously in the Serialization section, this attribute is not supported in partial trust.</span></span> <span data-ttu-id="bf8e0-159">Сериализатор <xref:System.Runtime.Serialization.DataContractSerializer> обрабатывает коллекции определенным образом, тем самым существует возможность обхода данного ограничения, а у сериализатора <xref:System.Runtime.Serialization.NetDataContractSerializer> такого механизма обхода нет.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-159">The <xref:System.Runtime.Serialization.DataContractSerializer> treats collections in a special way and is thus able to get around this restriction, but the <xref:System.Runtime.Serialization.NetDataContractSerializer> has no such mechanism to circumvent this restriction.</span></span>  
  
 <span data-ttu-id="bf8e0-160">Тип <xref:System.DateTimeOffset> не поддерживается сериализатором <xref:System.Runtime.Serialization.NetDataContractSerializer> при работе с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-160">The <xref:System.DateTimeOffset> type is not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust.</span></span>  
  
 <span data-ttu-id="bf8e0-161">Суррогат не может использоваться в <xref:System.Runtime.Serialization.NetDataContractSerializer> (с помощью механизма <xref:System.Runtime.Serialization.SurrogateSelector> ) при работе с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-161">A surrogate cannot be used with the <xref:System.Runtime.Serialization.NetDataContractSerializer> (using the <xref:System.Runtime.Serialization.SurrogateSelector> mechanism) when running in partial trust.</span></span> <span data-ttu-id="bf8e0-162">Обратите внимание, что данное ограничение относится к использованию суррогата, а не к его сериализации.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-162">Note that this restriction applies to using a surrogate, not to serializing it.</span></span>  
  
## <a name="enabling-common-behaviors-to-run"></a><span data-ttu-id="bf8e0-163">Включение выполнения общих поведений</span><span class="sxs-lookup"><span data-stu-id="bf8e0-163">Enabling Common Behaviors to Run</span></span>  
 <span data-ttu-id="bf8e0-164">Поведение службы или конечной точки, не помеченный <xref:System.Security.AllowPartiallyTrustedCallersAttribute> атрибут (APTCA), к которому добавляются [ \<commonBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md) раздел файла конфигурации не выполняются, когда приложение работает в режиме частичного доверия в этом случае среды и исключение не возникает.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-164">Service or endpoint behaviors not marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute (APTCA) that are added to the [\<commonBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md) section of a configuration file are not run when the application runs in a partial trust environment and no exception is thrown when this occurs.</span></span> <span data-ttu-id="bf8e0-165">Чтобы принудительно запустить общие поведения, необходимо выполнить одно из следующих условий:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-165">To enforce the running of common behaviors, you must do one of the following options:</span></span>  
  
-   <span data-ttu-id="bf8e0-166">Пометить общее поведение атрибутом <xref:System.Security.AllowPartiallyTrustedCallersAttribute> , чтобы оно могло выполняться при развертывании в приложении с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-166">Mark your common behavior with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute so that it can run when deployed as a partial trust application.</span></span> <span data-ttu-id="bf8e0-167">Обратите внимание, что на компьютере может быть установлен соответствующий раздел реестра, чтобы на нем не могли выполняться сборки, помеченные атрибутом APTCA.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-167">Note that a registry entry can be set on the computer to prevent APTCA-marked assemblies from running.</span></span> <span data-ttu-id="bf8e0-168">.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-168">.</span></span>  
  
-   <span data-ttu-id="bf8e0-169">Проверить, что при развертывании приложения в качестве приложения с полным доверием, которое не может изменяться пользователям, параметры управления доступом для кода разрешают выполнение приложения в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-169">Ensure that if the application is deployed as a fully-trusted application that users cannot modify the code-access security settings to run the application in a partial trust environment.</span></span> <span data-ttu-id="bf8e0-170">Если это так, поведение не выполняется и исключение не создается.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-170">If they can do so, the behavior does not run and no exception is thrown.</span></span> <span data-ttu-id="bf8e0-171">Чтобы обеспечить это, в разделе **levelfinal** с помощью [Caspol.exe (средство политики безопасности доступа кода)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).</span><span class="sxs-lookup"><span data-stu-id="bf8e0-171">To ensure this, see the **levelfinal** option using [Caspol.exe (Code Access Security Policy Tool)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).</span></span>  
  
 [!INCLUDE[crexample](../../../../includes/crexample-md.md)]<span data-ttu-id="bf8e0-172"> общего поведения см. в разделе [How to: Lock Down Endpoints in the Enterprise](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md).</span><span class="sxs-lookup"><span data-stu-id="bf8e0-172"> a common behavior, see [How to: Lock Down Endpoints in the Enterprise](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md).</span></span>  
  
## <a name="configuration"></a><span data-ttu-id="bf8e0-173">Конфигурация</span><span class="sxs-lookup"><span data-stu-id="bf8e0-173">Configuration</span></span>  
 <span data-ttu-id="bf8e0-174">За одним исключением, частично доверенный код может загружать разделы конфигурации [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] только из локального файла `app.config` .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-174">With one exception, partially-trusted code can only load [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] configuration sections in the local `app.config` file.</span></span> <span data-ttu-id="bf8e0-175">Для загрузки разделов конфигурации [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] , которые ссылаются на разделы [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в файле machine.config или корневом файле web.config, требуется разрешение ConfigurationPermission(Unrestricted).</span><span class="sxs-lookup"><span data-stu-id="bf8e0-175">To load [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] configuration sections that reference [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] sections in machine.config or in a root web.config file requires ConfigurationPermission(Unrestricted).</span></span> <span data-ttu-id="bf8e0-176">Без данного разрешения ссылки на разделы конфигурации [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] (поведения, привязки), которые находятся не в локальном файле конфигурации, приводят к возникновению исключения при загрузке конфигурации.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-176">Without this permission, references to [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] configuration sections (behaviors, bindings) outside of the local configuration file results in an exception when the configuration is loaded.</span></span>  
  
 <span data-ttu-id="bf8e0-177">Одно из известных исключений — конфигурация типа для сериализации, как описано в разделе "Сериализация" данной статьи.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-177">The one exception is known-type configuration for serialization, as described in the Serialization section of this topic.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="bf8e0-178">Расширения конфигурации поддерживаются только при запуске с полным уровнем доверия.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-178">Configuration extensions are only supported when running under Full Trust.</span></span>  
  
## <a name="diagnostics"></a><span data-ttu-id="bf8e0-179">Диагностика</span><span class="sxs-lookup"><span data-stu-id="bf8e0-179">Diagnostics</span></span>  
  
### <a name="event-logging"></a><span data-ttu-id="bf8e0-180">Ведение журнала событий</span><span class="sxs-lookup"><span data-stu-id="bf8e0-180">Event Logging</span></span>  
 <span data-ttu-id="bf8e0-181">При выполнении в частичном доверии поддерживается ограниченное ведение журнала событий.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-181">Limited event logging is supported under partial trust.</span></span> <span data-ttu-id="bf8e0-182">Только сбои активации служб, а также ошибки трассировки и ведения журналов записываются в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-182">Only service activation faults and tracing/message logging failures are logged to the Event Log.</span></span> <span data-ttu-id="bf8e0-183">Максимальное число событий, которые записываются процессом, равно 5, что позволяет предотвратить запись чрезмерного количества сообщений в журнал событий.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-183">The maximum number of events that can be logged by a process is 5, to avoid writing excessive messages to the Event Log.</span></span>  
  
### <a name="message-logging"></a><span data-ttu-id="bf8e0-184">Ведение журналов сообщений</span><span class="sxs-lookup"><span data-stu-id="bf8e0-184">Message Logging</span></span>  
 <span data-ttu-id="bf8e0-185">Ведение журнала сообщений не работает при выполнении [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в среде с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-185">Message logging does not work when [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is run in a partial trust environment.</span></span> <span data-ttu-id="bf8e0-186">Если для частичного доверия включено ведение журнала сообщений, сбой активации службы не произойдет, однако сообщения записываться не будут.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-186">If enabled under partial trust, it does not fail service activation, but no message is logged.</span></span>  
  
### <a name="tracing"></a><span data-ttu-id="bf8e0-187">Трассировка</span><span class="sxs-lookup"><span data-stu-id="bf8e0-187">Tracing</span></span>  
 <span data-ttu-id="bf8e0-188">При выполнении в среде с частичным доверием доступна ограниченная функциональность трассировки.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-188">Restricted tracing functionality is available when running in a partial trust environment.</span></span> <span data-ttu-id="bf8e0-189">В элементе <`listeners`> файла конфигурации можно добавлять только тип <xref:System.Diagnostics.TextWriterTraceListener> и новый тип <xref:System.Diagnostics.EventSchemaTraceListener>.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-189">In the <`listeners`> element in the configuration file, the only types that you can add are <xref:System.Diagnostics.TextWriterTraceListener> and the new <xref:System.Diagnostics.EventSchemaTraceListener>.</span></span> <span data-ttu-id="bf8e0-190">Использование обычного типа <xref:System.Diagnostics.XmlWriterTraceListener> может привести к неполным или неверным записям.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-190">Use of the standard <xref:System.Diagnostics.XmlWriterTraceListener> may result in incomplete or incorrect logs.</span></span>  
  
 <span data-ttu-id="bf8e0-191">Поддерживаются следующие источники трассировки:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-191">Supported trace sources are:</span></span>  
  
-   <xref:System.ServiceModel>  
  
-   <xref:System.Runtime.Serialization>  
  
-   <span data-ttu-id="bf8e0-192"><xref:System.IdentityModel.Claims>, <xref:System.IdentityModel.Policy>, <xref:System.IdentityModel.Selectors>и <xref:System.IdentityModel.Tokens>.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-192"><xref:System.IdentityModel.Claims>, <xref:System.IdentityModel.Policy>, <xref:System.IdentityModel.Selectors>, and <xref:System.IdentityModel.Tokens>.</span></span>  
  
 <span data-ttu-id="bf8e0-193">Следующие источники трассировки не поддерживаются:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-193">The following trace sources are not supported:</span></span>  
  
-   <span data-ttu-id="bf8e0-194">CardSpace</span><span class="sxs-lookup"><span data-stu-id="bf8e0-194">CardSpace</span></span>  
  
-   <xref:System.IO.Log>  

-   <span data-ttu-id="bf8e0-195">[System.ServiceModel.Internal.TransactionBridge](https://msdn.microsoft.com/library/system.servicemodel.internal.transactionbridge.aspx)]</span><span class="sxs-lookup"><span data-stu-id="bf8e0-195">[System.ServiceModel.Internal.TransactionBridge](https://msdn.microsoft.com/library/system.servicemodel.internal.transactionbridge.aspx)]</span></span>
  
 <span data-ttu-id="bf8e0-196">Не должны быть заданы следующие члены перечисления <xref:System.Diagnostics.TraceOptions> :</span><span class="sxs-lookup"><span data-stu-id="bf8e0-196">The following members of the <xref:System.Diagnostics.TraceOptions> enumeration should not be specified:</span></span>  
  
-   <xref:System.Diagnostics.TraceOptions.Callstack?displayProperty=nameWithType>  
  
-   <xref:System.Diagnostics.TraceOptions.ProcessId?displayProperty=nameWithType>  
  
 <span data-ttu-id="bf8e0-197">При использовании трассировки в среде с частичным доверием, убедитесь, что приложение обладает достаточными правами для хранения выходных данных прослушивателя трассировки.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-197">When using tracing in a partial trust environment, ensure that the application has sufficient permissions to store the output of the trace listener.</span></span> <span data-ttu-id="bf8e0-198">Например, при использовании <xref:System.Diagnostics.TextWriterTraceListener> для записи выходных данных трассировки в текстовый файл, убедитесь, что приложение имеет необходимое разрешение FileIOPermission, которое требуется для добавления записей в файл трассировки.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-198">For example, when using the <xref:System.Diagnostics.TextWriterTraceListener> to write trace output to a text file, ensure that the application has the necessary FileIOPermission required to successfully write to the trace file.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="bf8e0-199">Во избежание переполнения файлов трассировки дублирующимися ошибками, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] отключает трассировку ресурсов и действий после первого сбоя безопасности.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-199">To avoid flooding the trace files with duplicate errors, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] disables tracing of the resource or action after the first security failure.</span></span> <span data-ttu-id="bf8e0-200">Существует одна трассировка исключения для каждой неудачной попытки доступа к ресурсам, которая создается при первой попытке доступа к ресурсам или при первой попытке выполнения действия.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-200">There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.</span></span>  
  
## <a name="wcf-service-host"></a><span data-ttu-id="bf8e0-201">Узел службы WCF</span><span class="sxs-lookup"><span data-stu-id="bf8e0-201">WCF Service Host</span></span>  
 <span data-ttu-id="bf8e0-202">Узел службы[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] не поддерживает частичное доверие.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-202">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service host does not support partial trust.</span></span> <span data-ttu-id="bf8e0-203">Если требуется использовать службу [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в частичном доверии, шаблон проекта библиотеки служб [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] в [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] не используется для построения службы.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-203">If you want to use a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service in partial trust, do not use the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] Service Library Project template in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] to build your service.</span></span> <span data-ttu-id="bf8e0-204">Вместо этого создайте новый веб-сайт в [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] путем выбора шаблона веб-сайта службы [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] , который может разместить службу на веб-сервере с поддержкой частичного доверия [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="bf8e0-204">Instead, create a new Web site in [!INCLUDE[vsprvs](../../../../includes/vsprvs-md.md)] by choosing the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service Web site template, which can host the service in a Web server on which [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] partial trust is supported.</span></span>  
  
## <a name="other-limitations"></a><span data-ttu-id="bf8e0-205">Другие ограничения</span><span class="sxs-lookup"><span data-stu-id="bf8e0-205">Other Limitations</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="bf8e0-206"> обычно ограничивается вопросами безопасности, установленными ведущим приложением.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-206"> is generally limited to the security considerations imposed upon it by the hosting application.</span></span> <span data-ttu-id="bf8e0-207">Например, если [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] размещается в приложении браузера XAML (XBAP), к нему применяются ограничения XBAP, как описано в разделе [Безопасность частичного доверия Windows Presentation Foundation](http://go.microsoft.com/fwlink/?LinkId=89138).</span><span class="sxs-lookup"><span data-stu-id="bf8e0-207">For example, if [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] is hosted in a XAML Browser Application (XBAP), it is subject to XBAP limitations, as described in [Windows Presentation Foundation Partial Trust Security](http://go.microsoft.com/fwlink/?LinkId=89138).</span></span>  
  
 <span data-ttu-id="bf8e0-208">При выполнении indifo2 в среде с частичным доверием не включаются следующие дополнительные возможности:</span><span class="sxs-lookup"><span data-stu-id="bf8e0-208">The following additional features are not enabled when running indigo2 in a partial trust environment:</span></span>  
  
-   <span data-ttu-id="bf8e0-209">инструментирование управления Windows (WMI)</span><span class="sxs-lookup"><span data-stu-id="bf8e0-209">Windows Management Instrumentation (WMI)</span></span>  
  
-   <span data-ttu-id="bf8e0-210">Ведение журнала событий не в полном объеме (см. обсуждение в разделе **Диагностика** );</span><span class="sxs-lookup"><span data-stu-id="bf8e0-210">Event logging is only partially enabled (see discussion in **Diagnostics** section).</span></span>  
  
-   <span data-ttu-id="bf8e0-211">Счетчики производительности.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-211">Performance counters</span></span>  
  
 <span data-ttu-id="bf8e0-212">Использование функций [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] , которые не поддерживаются в среде с частичным доверием, может привести к возникновению исключений в среде выполнения.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-212">Use of [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] features that are not supported in a partial trust environment may result in exceptions at runtime.</span></span>  
  
## <a name="unlisted-features"></a><span data-ttu-id="bf8e0-213">Отсутствующие функции</span><span class="sxs-lookup"><span data-stu-id="bf8e0-213">Unlisted Features</span></span>  
 <span data-ttu-id="bf8e0-214">Лучший способ обнаружить недоступный фрагмент информации или действия при выполнении в среде с частичным доверием - попытка обращения к ресурсу или выполнение действия внутри блока `try` с последующим перехватом ( `catch` ) сбоя.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-214">The best way to discover that a piece of information or action is unavailable when running in a partial trust environment is to try to access the resource or do the action inside of a `try` block, and then `catch` the failure.</span></span> <span data-ttu-id="bf8e0-215">Во избежание переполнения файлов трассировки дублирующимися ошибками, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] отключает трассировку ресурсов и действий после первого сбоя безопасности.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-215">To avoid flooding the trace files with duplicate errors, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] disables tracing of the resource or action after the first security failure.</span></span> <span data-ttu-id="bf8e0-216">Существует одна трассировка исключения для каждой неудачной попытки доступа к ресурсам, которая создается при первой попытке доступа к ресурсам или при первой попытке выполнения действия.</span><span class="sxs-lookup"><span data-stu-id="bf8e0-216">There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="bf8e0-217">См. также</span><span class="sxs-lookup"><span data-stu-id="bf8e0-217">See Also</span></span>  
 <xref:System.ServiceModel.Channels.HttpTransportBindingElement>  
 <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>  
 <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>  
 <xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>  
 [<span data-ttu-id="bf8e0-218">Поддерживаемые сценарии развертывания</span><span class="sxs-lookup"><span data-stu-id="bf8e0-218">Supported Deployment Scenarios</span></span>](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md)  
 [<span data-ttu-id="bf8e0-219">Рекомендации по частичному доверию</span><span class="sxs-lookup"><span data-stu-id="bf8e0-219">Partial Trust Best Practices</span></span>](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md)
