---
title: "Общие сведения об интеграции с приложениями COM+"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Windows Communication Foundation, COM+ integration
- WCF, COM+ integration
ms.assetid: e481e48f-7096-40eb-9f20-7f0098412941
caps.latest.revision: "29"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: d1c4488421f4162d70fc47f8dd4d04c9374f25fc
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2017
---
# <a name="integrating-with-com-applications-overview"></a><span data-ttu-id="e79e2-102">Общие сведения об интеграции с приложениями COM+</span><span class="sxs-lookup"><span data-stu-id="e79e2-102">Integrating with COM+ Applications Overview</span></span>
<span data-ttu-id="e79e2-103">Служба [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] предоставляет среду с широкими возможностями для создания распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="e79e2-103">[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] provides a rich environment for creating distributed applications.</span></span> <span data-ttu-id="e79e2-104">Если уже используется логика приложения на основе компонентов, размещенного на COM+, инфраструктура [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] позволит расширить существующую логику вместо ее переписывания.</span><span class="sxs-lookup"><span data-stu-id="e79e2-104">If you are already using component-based application logic hosted in COM+, you can use [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] to extend your existing logic rather than having to rewrite it.</span></span> <span data-ttu-id="e79e2-105">Стандартный сценарий - предоставление доступа существующему приложению COM+ или бизнес-логике Enterprise Services службы через веб-службы.</span><span class="sxs-lookup"><span data-stu-id="e79e2-105">A common scenario is when you want to expose existing COM+ or Enterprise Services business logic through Web Services.</span></span>  
  
 <span data-ttu-id="e79e2-106">Когда доступ к компоненту COM+ предоставляется через веб-службу, спецификация и контракт таких служб определяются путем автоматического сопоставления, которое выполняется во время инициализации приложения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-106">When an interface on a COM+ component is exposed as a Web service, the specification and contract of these services are determined by an automatic mapping that is performed at application initialization time.</span></span> <span data-ttu-id="e79e2-107">В следующем списке показана концептуальная модель такого сопоставления:</span><span class="sxs-lookup"><span data-stu-id="e79e2-107">The following list shows the conceptual model for this mapping:</span></span>  
  
-   <span data-ttu-id="e79e2-108">для каждого из классов COM, к которым предоставляется доступ, определяется одна служба;</span><span class="sxs-lookup"><span data-stu-id="e79e2-108">One service is defined for each exposed COM class.</span></span>  
  
-   <span data-ttu-id="e79e2-109">контракт для службы получается напрямую из определения интерфейса выбранного компонента с определенной в конфигурации возможностью исключения определенных методов;</span><span class="sxs-lookup"><span data-stu-id="e79e2-109">The contract for the service is derived directly from the selected component's interface definition with the possibility of method exclusion defined in configuration.</span></span>  
  
-   <span data-ttu-id="e79e2-110">операции в контракте получаются напрямую из методов в определении интерфейса компонента;</span><span class="sxs-lookup"><span data-stu-id="e79e2-110">The operations in that contract are derived directly from the methods on the component's interface definition.</span></span>  
  
-   <span data-ttu-id="e79e2-111">параметры этих операций получаются напрямую из типа COM-взаимодействия, который соответствует параметрам метода компонента.</span><span class="sxs-lookup"><span data-stu-id="e79e2-111">The parameters for those operations are derived directly from the COM interoperability type that corresponds to the component's method parameters.</span></span>  
  
 <span data-ttu-id="e79e2-112">Адреса и привязки транспорта по умолчанию для службы задаются в файле конфигурации службы, но при необходимости их можно изменить.</span><span class="sxs-lookup"><span data-stu-id="e79e2-112">Default addresses and transport bindings for the service are provided in a service configuration file, but these can be reconfigured as required.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e79e2-113">Контракты для предоставляемых веб-служб остаются постоянными, если только не изменяются интерфейсы COM+ и конфигурация.</span><span class="sxs-lookup"><span data-stu-id="e79e2-113">The contracts for the exposed Web services remain constant as long as the COM+ interfaces and configuration remain unchanged.</span></span> <span data-ttu-id="e79e2-114">Изменение нескольких интерфейсов не приводит к автоматическому обновлению доступных служб и требует повторного запуска программы настройки модели служб COM+ (ComSvcConfig.exe).</span><span class="sxs-lookup"><span data-stu-id="e79e2-114">A modification to several interfaces does not automatically update the available services and requires re-running the COM+ Service Model Configuration tool (ComSvcConfig.exe).</span></span>  
  
 <span data-ttu-id="e79e2-115">Требования проверки подлинности и авторизации приложения COM+ и его компонентов остаются в силе и при использовании приложения через веб-службу.</span><span class="sxs-lookup"><span data-stu-id="e79e2-115">The authentication and authorization requirements of the COM+ application and its components continue to be enforced when used as a Web service.</span></span>  
  
 <span data-ttu-id="e79e2-116">Если вызывающий объект инициирует транзакцию веб-службы, компоненты, помеченные в качестве транзакционных, включатся в список в области транзакции.</span><span class="sxs-lookup"><span data-stu-id="e79e2-116">If the caller initiates a Web service transaction, components marked as transactional enlist within that transaction scope.</span></span>  
  
 <span data-ttu-id="e79e2-117">Чтобы предоставить доступ к интерфейсу компонента COM+ через веб-службу без изменения компонента, необходимо выполнить следующие действия.</span><span class="sxs-lookup"><span data-stu-id="e79e2-117">The following steps are required to expose a COM+ component's interface as a Web service without modifying the component:</span></span>  
  
1.  <span data-ttu-id="e79e2-118">Определите, можно ли предоставить доступ к интерфейсу компонента COM+ через веб-службу.</span><span class="sxs-lookup"><span data-stu-id="e79e2-118">Determine whether the COM+ component's interface can be exposed as a Web service.</span></span>  
  
2.  <span data-ttu-id="e79e2-119">Выберите подходящий режим размещения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-119">Select an appropriate hosting mode.</span></span>  
  
3.  <span data-ttu-id="e79e2-120">С помощью средства настройки модели службы COM+ (ComSvcConfig.exe) добавьте веб-службу для нужного интерфейса.</span><span class="sxs-lookup"><span data-stu-id="e79e2-120">Use the COM+ Service Model Configuration tool (ComSvcConfig.exe) to add a Web service for the interface.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="e79e2-121">порядок использования ComSvcConfig.exe см. в разделе [как: использование программы настройки модели служб COM +](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span><span class="sxs-lookup"><span data-stu-id="e79e2-121"> how to use ComSvcConfig.exe, see [How to: Use the COM+ Service Model Configuration Tool](../../../../docs/framework/wcf/feature-details/how-to-use-the-com-service-model-configuration-tool.md).</span></span>  
  
4.  <span data-ttu-id="e79e2-122">Задайте необходимые дополнительные параметры службы в файле конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-122">Configure any additional service settings in the application configuration file.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="e79e2-123">как настроить компонент см. в разделе [как: COM + настройки параметров службы](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span><span class="sxs-lookup"><span data-stu-id="e79e2-123"> how to configure a component, see [How to: Configure COM+ Service Settings](../../../../docs/framework/wcf/feature-details/how-to-configure-com-service-settings.md).</span></span>  
  
## <a name="supported-interfaces"></a><span data-ttu-id="e79e2-124">Поддерживаемые интерфейсы</span><span class="sxs-lookup"><span data-stu-id="e79e2-124">Supported Interfaces</span></span>  
 <span data-ttu-id="e79e2-125">На интерфейсы, которые можно делать доступными через веб-службы, накладываются определенные ограничения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-125">There are some restrictions on the type of interfaces that can be exposed as a Web service.</span></span> <span data-ttu-id="e79e2-126">Следующие типы интерфейсов не поддерживаются:</span><span class="sxs-lookup"><span data-stu-id="e79e2-126">The following types of interfaces are not supported:</span></span>  
  
-   <span data-ttu-id="e79e2-127">интерфейсы, которые передают в качестве параметров ссылки на объекты; ограниченный подход к передаче ссылок на объекты описан в разделе "Ограниченная поддержка ссылок на объекты";</span><span class="sxs-lookup"><span data-stu-id="e79e2-127">Interfaces that pass object references as parameters - the following limited object reference approach is described in the Limited Object Reference Support section.</span></span>  
  
-   <span data-ttu-id="e79e2-128">интерфейсы, которые передают типы, несовместимые с преобразованиями COM-взаимодействия [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)];</span><span class="sxs-lookup"><span data-stu-id="e79e2-128">Interfaces that pass types that are not compatible with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] COM interoperability conversions.</span></span>  
  
-   <span data-ttu-id="e79e2-129">интерфейсы приложений, для которых при размещении в COM+ включено объединение приложений в пул;</span><span class="sxs-lookup"><span data-stu-id="e79e2-129">Interfaces for applications that have application pooling enabled when hosted by COM+.</span></span>  
  
-   <span data-ttu-id="e79e2-130">интерфейсы компонентов, которые помечены в приложении как закрытые;</span><span class="sxs-lookup"><span data-stu-id="e79e2-130">Interfaces of components that are marked as private to the application.</span></span>  
  
-   <span data-ttu-id="e79e2-131">интерфейсы инфраструктуры COM+;</span><span class="sxs-lookup"><span data-stu-id="e79e2-131">COM+ infrastructure interfaces.</span></span>  
  
-   <span data-ttu-id="e79e2-132">интерфейсы системных приложений;</span><span class="sxs-lookup"><span data-stu-id="e79e2-132">Interfaces from the system application.</span></span>  
  
-   <span data-ttu-id="e79e2-133">интерфейсы компонентов Enterprise Services, не включенные в глобальный кэш сборок.</span><span class="sxs-lookup"><span data-stu-id="e79e2-133">Interfaces from Enterprise Services components that have not been added to the global assembly cache.</span></span>  
  
### <a name="limited-object-reference-support"></a><span data-ttu-id="e79e2-134">Ограниченная поддержка ссылок на объекты</span><span class="sxs-lookup"><span data-stu-id="e79e2-134">Limited Object Reference Support</span></span>  
 <span data-ttu-id="e79e2-135">Поскольку некоторые развернутые компоненты COM+ используют объекты, передаваемые по ссылкам, например при возврате объекта ADO Recordset, интеграция с COM+ включает ограниченную поддержку передачи параметров, являющихся ссылками на объекты.</span><span class="sxs-lookup"><span data-stu-id="e79e2-135">Because a number of deployed COM+ components do use objects by reference parameters, such as returning an ADO Recordset object, COM+ integration includes limited support for object reference parameters.</span></span> <span data-ttu-id="e79e2-136">Эта поддержка ограничивается объектами, которые реализуют интерфейс COM `IPersistStream`.</span><span class="sxs-lookup"><span data-stu-id="e79e2-136">The support is limited to objects that implement the `IPersistStream` COM interface.</span></span> <span data-ttu-id="e79e2-137">Она включает объекты ADO Recordset и может быть реализована для COM-объектов, относящихся к конкретному приложению.</span><span class="sxs-lookup"><span data-stu-id="e79e2-137">This includes ADO Recordset objects and can be implemented for application specific COM objects.</span></span>  
  
 <span data-ttu-id="e79e2-138">Для включения такой поддержки у программы ComSvcConfig.exe имеется **allowreferences** коммутатора, который отключает обычный параметр подписи методов и проверяет, что выполняется эта программы, чтобы убедиться, что параметры ссылки на объект не используются .</span><span class="sxs-lookup"><span data-stu-id="e79e2-138">To enable this support, the ComSvcConfig.exe tool provides the **allowreferences** switch that disables the regular method signature parameter and checks that the tool runs to ensure that object reference parameters are not being used.</span></span> <span data-ttu-id="e79e2-139">Кроме того, типы объектов, передаваемых в качестве параметров, должны быть указаны и определены в элементе конфигурации <`persistableTypes`>, который является дочерним для элемента <`comContract`>.</span><span class="sxs-lookup"><span data-stu-id="e79e2-139">In addition, the object types that you pass as parameters must be named and identified within the <`persistableTypes`> configuration element that is a child of the <`comContract`> element.</span></span>  
  
 <span data-ttu-id="e79e2-140">Если включен этот режим, служба интеграции COM+ использует для сериализации и десериализации экземпляров объектов интерфейс `IPersistStream`.</span><span class="sxs-lookup"><span data-stu-id="e79e2-140">When this feature is used, the COM+ integration service uses the `IPersistStream` interface to serialize or deserialize the object instance.</span></span> <span data-ttu-id="e79e2-141">Если экземпляр объекта не поддерживает интерфейс `IPersistStream`, создается исключение.</span><span class="sxs-lookup"><span data-stu-id="e79e2-141">If the object instance does not support `IPersistStream`, an exception is thrown.</span></span>  
  
 <span data-ttu-id="e79e2-142">Внутри клиентского приложения для передачи объектов службе и возврата объектов можно использовать методы объекта <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper>.</span><span class="sxs-lookup"><span data-stu-id="e79e2-142">Within a client application, the methods on the <xref:System.ServiceModel.ComIntegration.PersistStreamTypeWrapper> object can be used to pass an object in to a service and similarly to retrieve an object.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e79e2-143">Поскольку способ сериализации определяется конкретной платформой, такой подход лучше всего использовать при взаимодействии между клиентами [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] и службами [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e79e2-143">Due to the custom and platform-specific nature of the serialization approach, this is best suited for use between [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services.</span></span>  
  
## <a name="selecting-the-hosting-mode"></a><span data-ttu-id="e79e2-144">Выбор режима размещения</span><span class="sxs-lookup"><span data-stu-id="e79e2-144">Selecting the Hosting Mode</span></span>  
 <span data-ttu-id="e79e2-145">Модель COM+ предоставляет доступ через веб-службы с использованием одного из следующих режимов размещения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-145">COM+ exposes Web services in one of the following hosting modes:</span></span>  
  
-   <span data-ttu-id="e79e2-146">Размещение в службах COM+</span><span class="sxs-lookup"><span data-stu-id="e79e2-146">COM+-hosted</span></span>  
  
     <span data-ttu-id="e79e2-147">Веб-служба размещается в выделенном процессе приложения на сервере COM+ (Dllhost.exe).</span><span class="sxs-lookup"><span data-stu-id="e79e2-147">The Web service is hosted within the application's dedicated COM+ server process (Dllhost.exe).</span></span> <span data-ttu-id="e79e2-148">При использовании этого режима приложение должно быть явным образом запущено, прежде чем оно сможет получать запросы веб-службы.</span><span class="sxs-lookup"><span data-stu-id="e79e2-148">This mode requires the application to be explicitly started before it can receive Web service requests.</span></span> <span data-ttu-id="e79e2-149">Чтобы избежать перехода приложения и его службы в режим ожидания, можно использовать параметры COM+ "Запустить как службу NT" или "Не останавливать при ожидании".</span><span class="sxs-lookup"><span data-stu-id="e79e2-149">The COM+ options "Run as an NT Service" or "Leave running when idle" can be used to prevent idle shutdown of the application and its services.</span></span> <span data-ttu-id="e79e2-150">В этом режиме обращаться к приложению можно как через веб-службу, так и через доступ DCOM.</span><span class="sxs-lookup"><span data-stu-id="e79e2-150">This mode provides both Web service and DCOM access to the server application.</span></span>  
  
-   <span data-ttu-id="e79e2-151">Размещение на веб-сервере</span><span class="sxs-lookup"><span data-stu-id="e79e2-151">Web-hosted</span></span>  
  
     <span data-ttu-id="e79e2-152">Веб-служба размещается в рабочем процессе веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="e79e2-152">The Web service is hosted within a Web server worker process.</span></span> <span data-ttu-id="e79e2-153">В этом режиме служба COM+ не обязательно должна быть активной при получении первого запроса.</span><span class="sxs-lookup"><span data-stu-id="e79e2-153">This mode does not require COM+ to be active when the initial request is received.</span></span> <span data-ttu-id="e79e2-154">Если приложение неактивно при получении первого запроса, оно автоматически активируется перед обработкой запроса.</span><span class="sxs-lookup"><span data-stu-id="e79e2-154">If the application is not active when this request is received, it is automatically activated prior to processing the request.</span></span> <span data-ttu-id="e79e2-155">В этом режиме доступ к серверному приложению также может осуществляться через веб-службу или технологию DCOM, однако при обработке запросов веб-службы будет происходить переход процесса.</span><span class="sxs-lookup"><span data-stu-id="e79e2-155">This mode also provides both Web service and DCOM access to the server application, but causes a process hop for Web service requests.</span></span> <span data-ttu-id="e79e2-156">Обычно для этого необходимо включить олицетворение на клиенте.</span><span class="sxs-lookup"><span data-stu-id="e79e2-156">This typically requires the client to enable impersonation.</span></span> <span data-ttu-id="e79e2-157">В [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] для этого можно воспользоваться свойством <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> класса <xref:System.ServiceModel.Security.WindowsClientCredential>, которое доступно в качестве свойства универсального класса <xref:System.ServiceModel.ChannelFactory%601>, а также в виде значения перечисления <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span><span class="sxs-lookup"><span data-stu-id="e79e2-157">In [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], this can be done with the <xref:System.ServiceModel.Security.WindowsClientCredential.AllowedImpersonationLevel%2A> property of the <xref:System.ServiceModel.Security.WindowsClientCredential> class, which is accessed as a property of the generic <xref:System.ServiceModel.ChannelFactory%601> class, as well as the <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation> enumeration value.</span></span>  
  
-   <span data-ttu-id="e79e2-158">Внутрипроцессное размещение на веб-сервере</span><span class="sxs-lookup"><span data-stu-id="e79e2-158">Web-hosted in-process</span></span>  
  
     <span data-ttu-id="e79e2-159">Веб-служба и логика приложения COM+ размещаются внутри рабочего процесса веб-сервера.</span><span class="sxs-lookup"><span data-stu-id="e79e2-159">The Web service and the COM+ application logic are hosted within the Web server worker process.</span></span> <span data-ttu-id="e79e2-160">Это позволяет автоматически активировать режим размещения на веб-сервере без перехода процесса при запросах веб-службы.</span><span class="sxs-lookup"><span data-stu-id="e79e2-160">This provides automatic activation of the Web-hosted mode without causing a process hop for Web service requests.</span></span> <span data-ttu-id="e79e2-161">Недостаток такого подхода заключается в том, что к серверному приложению невозможно обратиться с помощью технологии DCOM.</span><span class="sxs-lookup"><span data-stu-id="e79e2-161">The disadvantage is that the server application cannot be accessed through DCOM.</span></span>  
  
### <a name="security-considerations"></a><span data-ttu-id="e79e2-162">Вопросы безопасности</span><span class="sxs-lookup"><span data-stu-id="e79e2-162">Security Considerations</span></span>  
 <span data-ttu-id="e79e2-163">Как и в случае других служб [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], администрирование параметров безопасности службы, к которой предоставляется доступ, осуществляется через параметры конфигурации канала [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="e79e2-163">Like other [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services, the security settings for the exposed service are administered through configuration settings for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] channel.</span></span> <span data-ttu-id="e79e2-164">Обычные параметры безопасности DCOM, например разрешения DCOM уровня компьютера, не действуют.</span><span class="sxs-lookup"><span data-stu-id="e79e2-164">Traditional DCOM security settings such as the DCOM machine-wide permissions settings are not enforced.</span></span> <span data-ttu-id="e79e2-165">Чтобы включить роли приложений COM+, для компонента необходимо включить режим авторизации "Принудительная проверка доступа на уровне компонента".</span><span class="sxs-lookup"><span data-stu-id="e79e2-165">To enforce COM+ application roles, "component-level access checks" authorization must be enabled for the component.</span></span>  
  
 <span data-ttu-id="e79e2-166">При использовании незащищенной привязки возможно искажение передаваемых данных или раскрытие информации.</span><span class="sxs-lookup"><span data-stu-id="e79e2-166">The use of a non-secured binding can leave communication open to tampering or information disclosure.</span></span> <span data-ttu-id="e79e2-167">Во избежание этого рекомендуется использовать защищенную привязку.</span><span class="sxs-lookup"><span data-stu-id="e79e2-167">To prevent this, it is recommended that you use a secured binding.</span></span>  
  
 <span data-ttu-id="e79e2-168">При размещении в служба COM+и на веб-сервере клиентское приложение должно разрешать серверному процессу олицетворять клиентского пользователя.</span><span class="sxs-lookup"><span data-stu-id="e79e2-168">For the COM+-hosted and Web-hosted modes, client applications must permit the server process to impersonate the client user.</span></span> <span data-ttu-id="e79e2-169">Для этого можно в клиентах [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] установить уровень олицетворения <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span><span class="sxs-lookup"><span data-stu-id="e79e2-169">This can be done in [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients by setting the impersonation level to <xref:System.Security.Principal.TokenImpersonationLevel.Impersonation>.</span></span>  
  
 <span data-ttu-id="e79e2-170">Если используются службы IIS или службы активации Windows (WAS) с транспортом HTTP, можно с помощью средства Httpcfg.exe зарезервировать адрес конечной точки транспорта.</span><span class="sxs-lookup"><span data-stu-id="e79e2-170">With Internet Information Services (IIS) or Windows Process Activation Service (WAS) using the HTTP transport, the Httpcfg.exe tool can be used to reserve a transport endpoint address.</span></span> <span data-ttu-id="e79e2-171">В других конфигурациях важно обеспечить защиту от поддельных служб, которые выдают себя за настоящие службы.</span><span class="sxs-lookup"><span data-stu-id="e79e2-171">In other configurations, it is important to protect against rogue services that act as the intended service.</span></span> <span data-ttu-id="e79e2-172">Чтобы избежать запуска поддельной службы в выбранной конечной точке, можно настроить настоящую службу на выполнение в качестве службы NT.</span><span class="sxs-lookup"><span data-stu-id="e79e2-172">To prevent a rogue service from starting at the desired endpoint, the legitimate service can be configured to run as an NT service.</span></span> <span data-ttu-id="e79e2-173">В результате настоящая служба утвердит адрес конечной точки до того, как это сможет сделать какая-либо поддельная служба.</span><span class="sxs-lookup"><span data-stu-id="e79e2-173">This enables the legitimate service to claim the endpoint address prior to any rogue services.</span></span>  
  
 <span data-ttu-id="e79e2-174">При размещении приложения COM + с настроенными ролями COM + как службу веб сервере, «Запустите IIS учетной записи процесса» должен добавляться к одной из ролей приложения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-174">When exposing a COM+ application with configured COM+ roles as a Web-hosted service, the "Launch IIS Process Account" must be added to one of the application’s roles.</span></span> <span data-ttu-id="e79e2-175">Эта учетная запись (обычно она имеет имя IWAM_имя_компьютера) должна добавляться, чтобы можно было безопасно отключить объекты после использования.</span><span class="sxs-lookup"><span data-stu-id="e79e2-175">This account, typically with the name IWAM_machinename, must be added to enable clean shutdown of objects after use.</span></span> <span data-ttu-id="e79e2-176">Не следует предоставлять этой учетной записи какие-либо дополнительные разрешения.</span><span class="sxs-lookup"><span data-stu-id="e79e2-176">The account should not be granted any additional permissions.</span></span>  
  
 <span data-ttu-id="e79e2-177">Функции перезапуска процессов COM+ невозможно использовать в интегрированных приложениях.</span><span class="sxs-lookup"><span data-stu-id="e79e2-177">The COM+ process recycling features cannot be used on integrated applications.</span></span> <span data-ttu-id="e79e2-178">Если приложение настроено на использование перезапуска процессов, а компоненты выполняются в процессе служб COM+, запустить службу не удастся.</span><span class="sxs-lookup"><span data-stu-id="e79e2-178">If the application is configured to use process recycling and the components are running in a COM+ hosted process, the service fails to start.</span></span> <span data-ttu-id="e79e2-179">Это требование не распространяется на службы, использующие внутрипроцессное размещение на веб-сервере, поскольку параметры перезапуска процессов в этом случае не действуют.</span><span class="sxs-lookup"><span data-stu-id="e79e2-179">This requirement does not include services using the Web-hosted in-process mode because the process recycling settings are not applied.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e79e2-180">См. также</span><span class="sxs-lookup"><span data-stu-id="e79e2-180">See Also</span></span>  
 [<span data-ttu-id="e79e2-181">Интеграция с Общие сведения о приложениях COM</span><span class="sxs-lookup"><span data-stu-id="e79e2-181">Integrating with COM Applications Overview</span></span>](../../../../docs/framework/wcf/feature-details/integrating-with-com-applications-overview.md)
