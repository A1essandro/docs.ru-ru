---
title: "Разрешение вопросов, связанных с созданием элементов управления и компонентов | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-winforms"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "jsharp"
helpviewer_keywords: 
  - "компоненты [Windows Forms], устранение неполадок"
  - "элементы управления [Windows Forms], устранение неполадок"
  - "устранение неполадок для компонентов"
  - "устранение неполадок для элементов управления"
  - "элементы управления Windows Forms, отладка"
ms.assetid: e9c8c099-2271-4737-882f-50f336c7a55e
caps.latest.revision: 22
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 22
---
# Разрешение вопросов, связанных с созданием элементов управления и компонентов
В этом разделе перечислены распространенные проблемы, возникающие при разработке компонентов и элементов управления.  Дополнительные сведения см. в разделе [Programming with Components](../Topic/Programming%20with%20Components.md).  
  
-   Не удается добавить элемент управления в панель элементов  
  
-   Не удается отладить настраиваемые элементы управления и компоненты Windows Forms  
  
-   В унаследованном компоненте или элементе управления событие вызывается дважды.  
  
-   Ошибка во время разработки: "Не удалось создать компонент *Имя компонента"*  
  
-   STAThreadAttribute  
  
-   Значок компонента не отображается в панели элементов  
  
## Не удается добавить элемент управления в панель элементов  
 Чтобы добавить в **Панель элементов** настраиваемый элемент управления, созданный в другом проекте, или элемент управления, созданный сторонним производителем, необходимо сделать это вручную.  Если в текущем проекте содержится пользовательский элемент управления или компонент, он должен отображаться в **панели элементов** автоматически.  Дополнительные сведения см. в разделе [Пример. Автоматическое заполнение панели элементов пользовательскими компонентами](../../../../docs/framework/winforms/controls/walkthrough-automatically-populating-the-toolbox-with-custom-components.md).  
  
#### Добавление элемента управления в панель элементов  
  
1.  Щелкните правой кнопкой мыши по **панели элементов** и из контекстного меню выберите  **Выбрать элементы**.  
  
2.  В диалоговом окне **Выбор элементов панели элементов** добавьте компонент.  
  
    -   Чтобы добавить компонент или элемент управления .NET Framework, щелкните вкладку **Компоненты .NET Framework**.  
  
         – или –  
  
    -   Чтобы добавить COM\-компонент или элемент управления ActiveX, щелкните вкладку **COM\-компоненты**.  
  
3.  Если элемент управления указан в диалоговом окне, убедитесь, что он выделен, и нажмите кнопку **ОК**.  
  
     Элемент управления добавляется в **Панель элементов**.  
  
4.  Если элемент управления не отображается в диалоговом окне, выполните следующую процедуру.  
  
    1.  Нажмите кнопку **Обзор**.  
  
    2.  Выберите папку, в которой находится DLL\-файл, содержащий этот элемент управления.  
  
    3.  Выберите DLL\-файл и щелкните **Открыть**.  
  
         Элемент управления отображается в диалоговом окне.  
  
    4.  Убедитесь, что необходимый элемент управления выбран, а затем нажмите кнопку **ОК**.  
  
         Элемент управления добавляется в **Панель элементов**.  
  
## Не удается отладить настраиваемые элементы управления и компоненты Windows Forms  
 Если элемент управления происходит из класса <xref:System.Windows.Forms.UserControl>, можно выполнить отладку его поведения во время выполнения, используя тестовый контейнер.  Дополнительные сведения см. в разделе [Практическое руководство. Тестирование поведения элемента UserControl во время выполнения](../../../../docs/framework/winforms/controls/how-to-test-the-run-time-behavior-of-a-usercontrol.md).  
  
 Другие настраиваемые элементы управления и компоненты не являются автономными проектами.  Они должны размещаться в каком\-либо приложении, например, в проекте Windows Forms.  Чтобы отладить элемент управления или компонент, его необходимо добавить к проекту Windows Forms.  
  
#### Чтобы выполнить отладку компонента или элемента управления  
  
1.  В меню **Построение** щелкните **Построить решение**, чтобы выполнить построение собственного решения.  
  
2.  Чтобы добавить к приложению тестовый проект, в меню **Файл** выберите **Добавить**, а затем выберите команду **Создать проект**.  
  
3.  В диалоговом окне **Добавление нового проекта** выберите в качестве типа проекта **Приложение Windows**.  
  
4.  В **обозревателе решений** щелкните правой кнопкой мыши узел **Ссылки** для создания нового проекта.  Чтобы добавить ссылку на проект, содержащий компонент или элемент управления, в контекстном меню щелкните **Добавить ссылку**.  
  
5.  Создайте экземпляр компонента или элемента управления в тестовом проекте.  Если компонент находится в **панели элементов**, его можно перетащить на поверхность конструктора. Можно также создать экземпляр программным путем, как показано в следующем примере кода.  
  
    ```vb  
    Dim Component1 As New MyNeatComponent()  
    ```  
  
    ```csharp  
    MyNeatComponent Component1 = new MyNeatComponent();  
    ```  
  
     Теперь можно выполнять отладку элемента управления или компонента обычным образом.  
  
 Дополнительные сведения об отладке см. в разделах [Отладка в Visual Studio](../Topic/Debugging%20in%20Visual%20Studio.md) и [Пример. Отладка пользовательских элементов управления Windows Forms во время разработки](../../../../docs/framework/winforms/controls/walkthrough-debugging-custom-windows-forms-controls-at-design-time.md).  
  
## В унаследованном компоненте или элементе управления событие вызывается дважды.  
 С большой долей вероятности причиной этой проблемы является повторяющееся предложение `Handles`.  Дополнительные сведения см. в разделе [Устранение неполадок, связанных с унаследованными обработчиками событий, в Visual Basic](../Topic/Troubleshooting%20Inherited%20Event%20Handlers%20in%20Visual%20Basic.md).  
  
## Ошибка во время разработки: "Не удалось создать компонент “Имя компонента”"  
 Пользовательский компонент или элемент управления должен предоставлять конструктор по умолчанию, не содержащий параметров.  Когда в среде разработки создается экземпляр компонента или элемента управления, она не пытается предоставить какие\-либо параметры перегрузкам конструктора, принимающим параметры.  
  
## STAThreadAttribute  
 <xref:System.STAThreadAttribute> информирует среду CLR, что Windows Forms использует модель однопотокового контейнера.  Если не применить этот атрибут к методу `Main` приложения Windows Forms, то можно заметить признаки нежелательного поведения.  Например, для таких элементов управления как <xref:System.Windows.Forms.ListView> могут не отображаться фоновые изображения.  Для некоторых элементов управления этот атрибут может понадобиться для правильного выполнения операций автозаполнения и перетаскивания.  
  
## Значок компонента не отображается в панели элементов  
 При использовании <xref:System.Drawing.ToolboxBitmapAttribute> для сопоставления значка и настраиваемого компонента для автоматически сгенерированных компонентов в панели инструментов точечный рисунок не отображается.  Чтобы увидеть растровый рисунок, перезагрузите элемент управления с помощью окна **Выберите элементы панели элементов**.  Дополнительные сведения см. в разделе [Практическое руководство. Предоставление точечного рисунка панели элементов для элемента управления](../../../../docs/framework/winforms/controls/how-to-provide-a-toolbox-bitmap-for-a-control.md).  
  
## См. также  
 [Создание элементов управления Windows Forms во время разработки](../../../../docs/framework/winforms/controls/developing-windows-forms-controls-at-design-time.md)   
 [Пример. Автоматическое заполнение панели элементов пользовательскими компонентами](../../../../docs/framework/winforms/controls/walkthrough-automatically-populating-the-toolbox-with-custom-components.md)   
 [Практическое руководство. Тестирование поведения элемента UserControl во время выполнения](../../../../docs/framework/winforms/controls/how-to-test-the-run-time-behavior-of-a-usercontrol.md)   
 [Пример. Отладка пользовательских элементов управления Windows Forms во время разработки](../../../../docs/framework/winforms/controls/walkthrough-debugging-custom-windows-forms-controls-at-design-time.md)   
 [Component Authoring](../Topic/Component%20Authoring.md)   
 [Troubleshooting Design\-Time Development](../Topic/Troubleshooting%20Design-Time%20Development.md)   
 [Programming with Components](../Topic/Programming%20with%20Components.md)