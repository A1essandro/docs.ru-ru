---
title: 'Пошаговое руководство: Создание основной подробности формы с помощью двух элементов управления DataGridView Windows Forms'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- DataGridView control [Windows Forms], master/detail form
- parent-child tables [Windows Forms], displaying on Windows Forms
- master-details lists [Windows Forms], displaying on Windows Forms
- walkthroughs [Windows Forms], DataGridView control
ms.assetid: c5fa29e8-47f7-4691-829b-0e697a691f36
ms.openlocfilehash: 38f7c6197fb3ee79119e41ab9620bc3aa2b21900
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33529445"
---
# <a name="walkthrough-creating-a-masterdetail-form-using-two-windows-forms-datagridview-controls"></a><span data-ttu-id="b6341-102">Пример. Создание главного и подчиненного представлений данных с использованием двух элементов управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="b6341-102">Walkthrough: Creating a Master/Detail Form Using Two Windows Forms DataGridView Controls</span></span>
<span data-ttu-id="b6341-103">Одним из наиболее распространенных сценариев использования <xref:System.Windows.Forms.DataGridView> управления *иерархического* формы, в котором отображается отношение "родители потомки" между двумя таблицами базы данных.</span><span class="sxs-lookup"><span data-stu-id="b6341-103">One of the most common scenarios for using the <xref:System.Windows.Forms.DataGridView> control is the *master/detail* form, in which a parent/child relationship between two database tables is displayed.</span></span> <span data-ttu-id="b6341-104">Выбор строк в главной таблице приводит таблицы сведений, чтобы обновить соответствующие дочерние данные.</span><span class="sxs-lookup"><span data-stu-id="b6341-104">Selecting rows in the master table causes the detail table to update with the corresponding child data.</span></span>  
  
 <span data-ttu-id="b6341-105">Реализация главного и подчиненного облегчает взаимодействие между <xref:System.Windows.Forms.DataGridView> управления и <xref:System.Windows.Forms.BindingSource> компонента.</span><span class="sxs-lookup"><span data-stu-id="b6341-105">Implementing a master/detail form is easy using the interaction between the <xref:System.Windows.Forms.DataGridView> control and the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="b6341-106">В этом пошаговом руководстве вы создадите формы, с использованием двух <xref:System.Windows.Forms.DataGridView> элементов управления и два <xref:System.Windows.Forms.BindingSource> компонентов.</span><span class="sxs-lookup"><span data-stu-id="b6341-106">In this walkthrough, you will build the form using two <xref:System.Windows.Forms.DataGridView> controls and two <xref:System.Windows.Forms.BindingSource> components.</span></span> <span data-ttu-id="b6341-107">В форме будут показаны две связанные таблицы в образце базы данных "Борей" SQL Server: `Customers` и `Orders`.</span><span class="sxs-lookup"><span data-stu-id="b6341-107">The form will show two related tables in the Northwind SQL Server sample database: `Customers` and `Orders`.</span></span> <span data-ttu-id="b6341-108">Когда вы закончите, будет иметь форму, которая содержит все клиенты базы данных в базе данных master <xref:System.Windows.Forms.DataGridView> и все заказы для выбранного клиента подробно <xref:System.Windows.Forms.DataGridView>.</span><span class="sxs-lookup"><span data-stu-id="b6341-108">When you are finished, you will have a form that shows all the customers in the database in the master <xref:System.Windows.Forms.DataGridView> and all the orders for the selected customer in the detail <xref:System.Windows.Forms.DataGridView>.</span></span>  
  
 <span data-ttu-id="b6341-109">Скопируйте код из этой темы, в разделе [как: создание Главная и подчиненная формы с помощью двух DataGridView элементов управления Windows Forms](../../../../docs/framework/winforms/controls/create-a-master-detail-form-using-two-datagridviews.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-109">To copy the code in this topic as a single listing, see [How to: Create a Master/Detail Form Using Two Windows Forms DataGridView Controls](../../../../docs/framework/winforms/controls/create-a-master-detail-form-using-two-datagridviews.md).</span></span>  
  
## <a name="prerequisites"></a><span data-ttu-id="b6341-110">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="b6341-110">Prerequisites</span></span>  
 <span data-ttu-id="b6341-111">Для выполнения данного пошагового руководства требуется:</span><span class="sxs-lookup"><span data-stu-id="b6341-111">In order to complete this walkthrough, you will need:</span></span>  
  
-   <span data-ttu-id="b6341-112">Доступ к серверу с учебной базе данных "Борей" SQL Server.</span><span class="sxs-lookup"><span data-stu-id="b6341-112">Access to a server that has the Northwind SQL Server sample database.</span></span>  
  
## <a name="creating-the-form"></a><span data-ttu-id="b6341-113">Создание формы</span><span class="sxs-lookup"><span data-stu-id="b6341-113">Creating the form</span></span>  
  
#### <a name="to-create-a-masterdetail-form"></a><span data-ttu-id="b6341-114">Создание главного и подчиненного</span><span class="sxs-lookup"><span data-stu-id="b6341-114">To create a master/detail form</span></span>  
  
1.  <span data-ttu-id="b6341-115">Создайте класс, производный от <xref:System.Windows.Forms.Form> и содержит два <xref:System.Windows.Forms.DataGridView> элементов управления и два <xref:System.Windows.Forms.BindingSource> компонентов.</span><span class="sxs-lookup"><span data-stu-id="b6341-115">Create a class that derives from <xref:System.Windows.Forms.Form> and contains two <xref:System.Windows.Forms.DataGridView> controls and two <xref:System.Windows.Forms.BindingSource> components.</span></span> <span data-ttu-id="b6341-116">Ниже представлена базовая реализация формы и включает `Main` метод.</span><span class="sxs-lookup"><span data-stu-id="b6341-116">The following code provides basic form initialization and includes a `Main` method.</span></span> <span data-ttu-id="b6341-117">При использовании конструктора Visual Studio для создания формы, используйте вместо этого кода конструктора созданный код, но следует использовать названия из объявления переменных.</span><span class="sxs-lookup"><span data-stu-id="b6341-117">If you use the Visual Studio designer to create your form, you can use the designer generated code instead of this code, but be sure to use the names shown in the variable declarations here.</span></span>  
  
     [!code-csharp[System.Windows.Forms.DataGridViewMasterDetails#01](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/CS/masterdetails.cs#01)]
     [!code-vb[System.Windows.Forms.DataGridViewMasterDetails#01](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/VB/masterdetails.vb#01)]  
    [!code-csharp[System.Windows.Forms.DataGridViewMasterDetails#02](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/CS/masterdetails.cs#02)]
    [!code-vb[System.Windows.Forms.DataGridViewMasterDetails#02](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/VB/masterdetails.vb#02)]  
  
2.  <span data-ttu-id="b6341-118">Реализуйте метод в определении класса формы для обработки подробные сведения о подключении к базе данных.</span><span class="sxs-lookup"><span data-stu-id="b6341-118">Implement a method in your form's class definition for handling the detail of connecting to the database.</span></span> <span data-ttu-id="b6341-119">В этом примере используется `GetData` метод, который заполняет <xref:System.Data.DataSet> , добавляет <xref:System.Data.DataRelation> объекта для набора данных и привязывает <xref:System.Windows.Forms.BindingSource> компонентов.</span><span class="sxs-lookup"><span data-stu-id="b6341-119">This example uses a `GetData` method that populates a <xref:System.Data.DataSet> object, adds a <xref:System.Data.DataRelation> object to the data set, and binds the <xref:System.Windows.Forms.BindingSource> components.</span></span> <span data-ttu-id="b6341-120">Убедитесь, что переменной `connectionString` присвоено значение, соответствующее базе данных.</span><span class="sxs-lookup"><span data-stu-id="b6341-120">Be sure to set the `connectionString` variable to a value that is appropriate for your database.</span></span>  
  
    > [!IMPORTANT]
    >  <span data-ttu-id="b6341-121">Хранение конфиденциальных сведений (например, пароля) в строке подключения может повлиять на безопасность приложения.</span><span class="sxs-lookup"><span data-stu-id="b6341-121">Storing sensitive information, such as a password, within the connection string can affect the security of your application.</span></span> <span data-ttu-id="b6341-122">Использование проверки подлинности Windows (также называемой встроенными средствами безопасности) — более безопасный способ управления доступом к базе данных.</span><span class="sxs-lookup"><span data-stu-id="b6341-122">Using Windows Authentication (also known as integrated security) is a more secure way to control access to a database.</span></span> <span data-ttu-id="b6341-123">Дополнительные сведения см. в разделе [Защита сведений о подключении](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-123">For more information, see [Protecting Connection Information](../../../../docs/framework/data/adonet/protecting-connection-information.md).</span></span>  
  
     [!code-csharp[System.Windows.Forms.DataGridViewMasterDetails#20](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/CS/masterdetails.cs#20)]
     [!code-vb[System.Windows.Forms.DataGridViewMasterDetails#20](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/VB/masterdetails.vb#20)]  
  
3.  <span data-ttu-id="b6341-124">Реализуйте обработчик для формы <xref:System.Windows.Forms.Form.Load> событий, который привязывает <xref:System.Windows.Forms.DataGridView> элементы управления <xref:System.Windows.Forms.BindingSource> компоненты и вызывает метод `GetData` метод.</span><span class="sxs-lookup"><span data-stu-id="b6341-124">Implement a handler for your form's <xref:System.Windows.Forms.Form.Load> event that binds the <xref:System.Windows.Forms.DataGridView> controls to the <xref:System.Windows.Forms.BindingSource> components and calls the `GetData` method.</span></span> <span data-ttu-id="b6341-125">Следующий пример содержит код, который изменяет размер <xref:System.Windows.Forms.DataGridView> столбцы по размеру отображаемых данных.</span><span class="sxs-lookup"><span data-stu-id="b6341-125">The following example includes code that resizes <xref:System.Windows.Forms.DataGridView> columns to fit the displayed data.</span></span>  
  
     [!code-csharp[System.Windows.Forms.DataGridViewMasterDetails#10](../../../../samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/CS/masterdetails.cs#10)]
     [!code-vb[System.Windows.Forms.DataGridViewMasterDetails#10](../../../../samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.DataGridViewMasterDetails/VB/masterdetails.vb#10)]  
  
## <a name="testing-the-application"></a><span data-ttu-id="b6341-126">Тестирование приложения</span><span class="sxs-lookup"><span data-stu-id="b6341-126">Testing the Application</span></span>  
 <span data-ttu-id="b6341-127">Теперь можно проверить форму, чтобы убедиться в том, что оно правильно работает.</span><span class="sxs-lookup"><span data-stu-id="b6341-127">You can now test the form to make sure it behaves as expected.</span></span>  
  
#### <a name="to-test-the-form"></a><span data-ttu-id="b6341-128">Чтобы проверить форму</span><span class="sxs-lookup"><span data-stu-id="b6341-128">To test the form</span></span>  
  
-   <span data-ttu-id="b6341-129">Скомпилируйте и запустите приложение.</span><span class="sxs-lookup"><span data-stu-id="b6341-129">Compile and run the application.</span></span>  
  
     <span data-ttu-id="b6341-130">Вы увидите два <xref:System.Windows.Forms.DataGridView> управляет друг с другом.</span><span class="sxs-lookup"><span data-stu-id="b6341-130">You will see two <xref:System.Windows.Forms.DataGridView> controls, one above the other.</span></span> <span data-ttu-id="b6341-131">В верхней части являются клиентов из базы данных Northwind `Customers` таблицы, а в нижней — `Orders` соответствующего выбранному клиенту.</span><span class="sxs-lookup"><span data-stu-id="b6341-131">On top are the customers from the Northwind `Customers` table, and at the bottom are the `Orders` corresponding to the selected customer.</span></span> <span data-ttu-id="b6341-132">При выборе различными строками в правом верхнем <xref:System.Windows.Forms.DataGridView>, содержимое нижнего <xref:System.Windows.Forms.DataGridView> соответствующим образом изменить.</span><span class="sxs-lookup"><span data-stu-id="b6341-132">As you select different rows in the upper <xref:System.Windows.Forms.DataGridView>, the contents of the lower <xref:System.Windows.Forms.DataGridView> change accordingly.</span></span>  
  
## <a name="next-steps"></a><span data-ttu-id="b6341-133">Следующие шаги</span><span class="sxs-lookup"><span data-stu-id="b6341-133">Next Steps</span></span>  
 <span data-ttu-id="b6341-134">Это приложение позволяет основные <xref:System.Windows.Forms.DataGridView> возможности элемента управления.</span><span class="sxs-lookup"><span data-stu-id="b6341-134">This application gives you a basic understanding of the <xref:System.Windows.Forms.DataGridView> control's capabilities.</span></span> <span data-ttu-id="b6341-135">Можно настроить внешний вид и поведение <xref:System.Windows.Forms.DataGridView> управления несколькими способами:</span><span class="sxs-lookup"><span data-stu-id="b6341-135">You can customize the appearance and behavior of the <xref:System.Windows.Forms.DataGridView> control in several ways:</span></span>  
  
-   <span data-ttu-id="b6341-136">Изменение стилей границ и заголовка.</span><span class="sxs-lookup"><span data-stu-id="b6341-136">Change border and header styles.</span></span> <span data-ttu-id="b6341-137">Дополнительные сведения см. в разделе [как: изменения границ и стили линий сетки в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/change-the-border-and-gridline-styles-in-the-datagrid.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-137">For more information, see [How to: Change the Border and Gridline Styles in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/change-the-border-and-gridline-styles-in-the-datagrid.md).</span></span>  
  
-   <span data-ttu-id="b6341-138">Включения или отключения пользовательского ввода для <xref:System.Windows.Forms.DataGridView> элемента управления.</span><span class="sxs-lookup"><span data-stu-id="b6341-138">Enable or restrict user input to the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="b6341-139">Дополнительные сведения см. в разделе [как: запретить добавление и удаление строк в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/prevent-row-addition-and-deletion-datagridview.md), и [как: сделать столбцы только для чтения в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/how-to-make-columns-read-only-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-139">For more information, see [How to: Prevent Row Addition and Deletion in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/prevent-row-addition-and-deletion-datagridview.md), and [How to: Make Columns Read-Only in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-make-columns-read-only-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="b6341-140">Проверка пользовательского ввода для <xref:System.Windows.Forms.DataGridView> элемента управления.</span><span class="sxs-lookup"><span data-stu-id="b6341-140">Validate user input to the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="b6341-141">Дополнительные сведения см. в разделе [Пошаговое руководство: проверка данных в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/walkthrough-validating-data-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-141">For more information, see [Walkthrough: Validating Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/walkthrough-validating-data-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="b6341-142">Обработка очень больших наборов данных в виртуальном режиме.</span><span class="sxs-lookup"><span data-stu-id="b6341-142">Handle very large data sets using virtual mode.</span></span> <span data-ttu-id="b6341-143">Дополнительные сведения см. в разделе [Пошаговое руководство: реализация виртуального режима в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-143">For more information, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="b6341-144">Настройте внешний вид ячеек.</span><span class="sxs-lookup"><span data-stu-id="b6341-144">Customize the appearance of cells.</span></span> <span data-ttu-id="b6341-145">Дополнительные сведения см. в разделе [как: Настройка внешнего вида ячеек в элементе управления DataGridView Windows Forms](../../../../docs/framework/winforms/controls/customize-the-appearance-of-cells-in-the-datagrid.md) и [как: набор стилей ячейки по умолчанию для элемента управления DataGridView в Windows Forms](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="b6341-145">For more information, see [How to: Customize the Appearance of Cells in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/customize-the-appearance-of-cells-in-the-datagrid.md) and [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b6341-146">См. также</span><span class="sxs-lookup"><span data-stu-id="b6341-146">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 <xref:System.Windows.Forms.BindingSource>  
 [<span data-ttu-id="b6341-147">Отображение данных с помощью элемента управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="b6341-147">Displaying Data in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/displaying-data-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="b6341-148">Практическое руководство. Отображение главного и подчиненного представлений данных с использованием двух элементов управления DataGridView в Windows Forms</span><span class="sxs-lookup"><span data-stu-id="b6341-148">How to: Create a Master/Detail Form Using Two Windows Forms DataGridView Controls</span></span>](../../../../docs/framework/winforms/controls/create-a-master-detail-form-using-two-datagridviews.md)  
 [<span data-ttu-id="b6341-149">Защита сведений о подключении</span><span class="sxs-lookup"><span data-stu-id="b6341-149">Protecting Connection Information</span></span>](../../../../docs/framework/data/adonet/protecting-connection-information.md)
