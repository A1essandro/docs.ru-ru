---
title: "Создание собственных элементов управления | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-winforms"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "jsharp"
helpviewer_keywords: 
  - "составные элементы управления"
  - "элементы управления [Windows Forms], составной"
  - "элементы управления [Windows Forms], расширенный"
  - "элементы управления [Windows Forms], типы"
  - "элементы управления [Windows Forms], пользовательские элементы управления"
  - "пользовательские элементы управления [Windows Forms]"
  - "расширенные элементы управления"
  - "пользовательские элементы управления [Windows Forms]"
ms.assetid: 3cea09e5-4344-4ccb-9858-b66ccac210ff
caps.latest.revision: 20
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 20
---
# Создание собственных элементов управления
Платформа .NET Framework предоставляет возможности разработки и реализации новых элементов управления.  Если нужно расширить функции существующего элемента управления, можно путем наследования создать элемент управления, производный от существующего.  Можно также написать собственные элементы управления, выполняющие свое оформление.  
  
 Выбор типа создаваемого элемента управления может вызвать затруднения.  В этом разделе описываются различия между типами элементов управления, которые можно наследовать, а также приводятся сведения о том, как выбрать тип для проекта.  
  
> [!NOTE]
>  Дополнительные сведения о создании элемента управления для использования в конструкторе Web Forms см. в разделе [Developing Custom ASP.NET Server Controls](../Topic/Developing%20Custom%20ASP.NET%20Server%20Controls.md).  
  
## Базовый класс элемента управления  
 Класс <xref:System.Windows.Forms.Control> является базовым классом элементов управления Windows Forms.  Он обеспечивает инфраструктуру, необходимую для визуального отображения в приложениях Windows Forms.  
  
 Класс <xref:System.Windows.Forms.Control> выполняет следующие задачи для обеспечения визуального отображения в приложениях Windows Forms:  
  
-   Предоставление дескриптора окна.  
  
-   Управление маршрутизацией сообщений.  
  
-   Предоставление событий мыши и клавиатуры и многих других событий пользовательского интерфейса.  
  
-   Предоставление расширенных функций размещения.  
  
-   Большое число функций, относящихся к визуальному представлению, таких как <xref:System.Windows.Forms.Control.ForeColor%2A>, <xref:System.Windows.Forms.Control.BackColor%2A>, <xref:System.Windows.Forms.Control.Height%2A>, и <xref:System.Windows.Forms.Control.Width%2A>.  
  
-   Предоставление безопасности и поддержки потоков, необходимых для элемента управления Windows Forms для действия элемента управления Microsoft® ActiveX®.  
  
 Благодаря такому разнообразию инфраструктуры, которое предоставляет базовый класс, разработать свой собственный элемент управления Windows Forms относительно просто.  
  
## Типы элементов управления  
 Windows Forms поддерживает три типа определяемых пользователем элементов управления: *составной*, *расширенный* и *пользовательский*.  В следующих разделах описан каждый тип элемента управления и приводятся рекомендации по выбору типа для проектов пользователя.  
  
### Составные элементы управления  
 Составной элемент управления — это коллекция элементов управления Windows Forms, инкапсулированный в общий контейнер.  Этот тип элемента управления часто называют *пользовательским*.  Элементы управления, входящие в состав составных элементов управления, называются *составляющими элементами управления*.  
  
 Составной элемент управления хранит все функции, связанные с каждым составляющим элементом управления Windows Forms, и позволяет выборочно представлять и связывать их свойства.  Кроме того, составной элемент управления также обеспечивает большое число функций обработки клавиатуры по умолчанию, не требуя дополнительных усилий для разработки со стороны пользователя.  
  
 Например, составной элемент управления может служить для отображения адресных данных заказчика из базы данных.  Этот элемент управления может содержать элемент <xref:System.Windows.Forms.DataGridView> для отображения полей базы данных, элемент <xref:System.Windows.Forms.BindingSource> для обработки привязки к источнику данных, и элемент <xref:System.Windows.Forms.BindingNavigator> для перемещения между записями.  Свойства привязки данных могут быть представлены выборочно, а весь элемент управления можно упаковать и повторно использовать в разных приложениях.  Пример такого типа составного элемента управления содержится в разделе [Практическое руководство. Применение атрибутов к элементам управления Windows Forms](../../../../docs/framework/winforms/controls/how-to-apply-attributes-in-windows-forms-controls.md).  
  
 Чтобы создать составной элемент управления, сделайте его производным от класса <xref:System.Windows.Forms.UserControl>.  Базовый класс <xref:System.Windows.Forms.UserControl> обеспечивает клавиатурную маршрутизацию для дочерних элементов управления и позволяет им работать в группе.  Дополнительные сведения см. в разделе [Разработка составного элемента Windows Forms](../../../../docs/framework/winforms/controls/developing-a-composite-windows-forms-control.md).  
  
 **Рекомендации**  
  
 Наследование класса <xref:System.Windows.Forms.UserControl> имеет смысл следующем случае:  
  
-   Если требуется объединить функции нескольких элементов управления Windows Forms в один блок для повторного использования.  
  
### Расширенные элементы управления  
 Наследуемый элемент управления можно получить из любого существующего элемента Windows Forms.  Такой подход позволяет сохранить все стандартные функции элемента управления Windows Forms, а затем расширить их путем добавления пользовательских свойств, методов или других функций.  В этом случае, логику рисования базового элемента управления можно переопределить и расширить его пользовательский интерфейс, изменив внешний вид.  
  
 Например, можно создать производный от <xref:System.Windows.Forms.Button> элемент управления, отслеживающий число раз его нажатия пользователем.  
  
 В некоторых элементах управления к графическому интерфейсу можно добавить пользовательское оформление путем переопределения метода <xref:System.Windows.Forms.Control.OnPaint%2A> базового класса.  В расширенной кнопке, отслеживающей нажатия, метод <xref:System.Windows.Forms.Control.OnPaint%2A> можно переопределить для вызова базовой реализации <xref:System.Windows.Forms.Control.OnPaint%2A>, а затем нарисовать число нажатий в одном углу клиентской области элемента управления <xref:System.Windows.Forms.Button>.  
  
 **Рекомендации**  
  
 Наследование из элемента управления Windows Forms рекомендуется применять в следующих случаях:  
  
-   Если большинство необходимых функций аналогичны функциям уже существующего элемента управления Windows Forms.  
  
-   Если нестандартный графический интерфейс пользователя не требуется или необходимо разработать новый графический интерфейс для существующего элемента управления.  
  
### Пользовательские элементы управления  
 Другим способом разработки элемента управления является создание его с нуля путем наследования класса <xref:System.Windows.Forms.Control>.  Класс <xref:System.Windows.Forms.Control> предоставляет все основные функции, необходимые элементам управления \(включая события обработки мыши и клавиатуры\), однако он не содержит функции для элемента управления и графический интерфейс.  
  
 Создание элемента управления путем наследования из класса <xref:System.Windows.Forms.Control> — гораздо более сложная задача, чем наследование из <xref:System.Windows.Forms.UserControl> или существующего элемента управления Windows Forms.  Поскольку задача реализации в больше мере возлагается на пользователя, создаваемый элемент управления обладает большей гибкостью, чем составной или расширенный элемент управления, что позволяет подстроить его под конкретные потребности.  
  
 Для реализации элемента управления необходимо написать код для события <xref:System.Windows.Forms.Control.OnPaint%2A> элемента управления, а также любой код для необходимой функции.  Кроме того, метод <xref:System.Windows.Forms.Control.WndProc%2A> можно переопределить и обработать сообщения Windows напрямую.  Это является наиболее эффективным способом создания элемента управления, но для этого необходимо знать Microsoft Win32® API.  
  
 Примером пользовательского элемента управления служит элемент "Часы", который выглядит и действует аналогично часам со стрелками.  Можно применить пользовательское оформление, чтобы заставить стрелки часов двигаться в зависимости от событий <xref:System.Windows.Forms.Timer.Tick> внутреннего компонента <xref:System.Windows.Forms.Timer>.  Дополнительные сведения см. в разделе [Руководство: Разработка простого элемента управления форм Windows Forms](../../../../docs/framework/winforms/controls/how-to-develop-a-simple-windows-forms-control.md).  
  
 **Рекомендации**  
  
 Наследование класса <xref:System.Windows.Forms.Control> имеет смысл следующем случае:  
  
-   Если требуется определить пользовательское графическое представление элемента управления.  
  
-   Если требуется реализовать пользовательские функции, которые недоступны в стандартных элементах управления.  
  
### Элементы управления ActiveX  
 Несмотря на то, что инфраструктура Windows Forms оптимизирована для работы с элементами управления Windows Forms, можно также использовать элементы управления ActiveX.  Данная задача поддерживается в Visual Studio.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление элементов управления ActiveX в формы Windows Forms.](../../../../docs/framework/winforms/controls/how-to-add-activex-controls-to-windows-forms.md).  
  
### Безоконные элементы управления  
 Технологии Microsoft Visual Basic® 6.0 и ActiveX поддерживают *безоконные* элементы управления.  Безоконные элементы управления не поддерживаются в Windows Forms.  
  
## Пользовательский опыт проектирования  
 В случае необходимости реализации пользовательского опыта времени проектирования, можно создать собственный конструктор.  Для составных элементов управления, наследуйте пользовательский класс конструктора из классов <xref:System.Windows.Forms.Design.ParentControlDesigner> или <xref:System.Windows.Forms.Design.DocumentDesigner>.  Для расширенных и пользовательских элементов управления, наследуйте пользовательский класс конструктора из класса <xref:System.Windows.Forms.Design.ControlDesigner>.  
  
 Используйте <xref:System.ComponentModel.DesignerAttribute> для связывания элемента управления с конструктором.  Дополнительные сведения см. в разделах [Extending Design\-Time Support](../Topic/Extending%20Design-Time%20Support.md) и [How to: Create a Windows Forms Control That Takes Advantage of Design\-Time Features](../Topic/How%20to:%20Create%20a%20Windows%20Forms%20Control%20That%20Takes%20Advantage%20of%20Design-Time%20Features.md).  
  
## См. также  
 [Разработка пользовательских элементов управления Windows Forms в .NET Framework](../../../../docs/framework/winforms/controls/developing-custom-windows-forms-controls.md)   
 [Руководство: Разработка простого элемента управления форм Windows Forms](../../../../docs/framework/winforms/controls/how-to-develop-a-simple-windows-forms-control.md)   
 [Разработка составного элемента Windows Forms](../../../../docs/framework/winforms/controls/developing-a-composite-windows-forms-control.md)   
 [Extending Design\-Time Support](../Topic/Extending%20Design-Time%20Support.md)   
 [How to: Create a Windows Forms Control That Takes Advantage of Design\-Time Features](../Topic/How%20to:%20Create%20a%20Windows%20Forms%20Control%20That%20Takes%20Advantage%20of%20Design-Time%20Features.md)