---
title: "Пошаговое руководство. Демонстрация визуального наследования | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-winforms"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "jsharp"
helpviewer_keywords: 
  - "наследование форм, пошаговые руководства"
  - "наследование, пошаговые руководства"
  - "визуальное наследование"
  - "пошаговые руководства [Windows Forms], визуальное наследование"
  - "Windows Forms, наследование"
ms.assetid: 01966086-3142-450e-8210-3fd4cb33f591
caps.latest.revision: 24
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 24
---
# Пошаговое руководство. Демонстрация визуального наследования
Визуальное наследование позволяет просматривать элементы управления в базовой форме и добавлять новые элементы управления.  В этом пошаговом руководстве рассматривается создание базовой формы и ее компиляция  в библиотеку классов.  После этого данная библиотека классов импортируется в другой проект и создается новая форма, которая наследуется от базовой формы.  В этом пошаговом руководстве описаны следующие процедуры.  
  
-   Создание проекта библиотеки классов, содержащей базовую форму.  
  
-   Добавление кнопки со свойствами, которые могут изменяться производными классами базовой формы.  
  
-   Добавление кнопки, которая не может изменяться наследниками базовой формы.  
  
-   Создание проекта, содержащего форму, которая наследуется от `BaseForm`.  
  
 В конечном счете в этом пошаговом руководстве показано различие между частным и защищенным элементами управления в производной форме.  
  
> [!NOTE]
>  Отображаемые диалоговые окна и команды меню могут отличаться от описанных в справке в зависимости от текущих параметров или выпуска.  Чтобы изменить параметры, выберите в меню **Сервис** пункт **Импорт и экспорт параметров**.  Дополнительные сведения см. в разделе [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
> [!CAUTION]
>  Не все элементы управления поддерживают визуальное наследование от базовой формы.  Не поддерживают сценарий, описанный в этом пошаговом руководстве, следующие элементы управления:  
>   
>  <xref:System.Windows.Forms.WebBrowser>  
>   
>  <xref:System.Windows.Forms.ToolStrip>  
>   
>  <xref:System.Windows.Forms.ToolStripPanel>  
>   
>  <xref:System.Windows.Forms.TableLayoutPanel>  
>   
>  <xref:System.Windows.Forms.FlowLayoutPanel>  
>   
>  <xref:System.Windows.Forms.DataGridView>  
>   
>  Эти элементы управления в производной форме всегда доступны только для чтения, независимо от используемых модификаторов \(`private`, `protected` или `public`\).  
  
## Шаги сценария  
 Первым шагом является создание базовой формы.  
  
#### Создание проекта библиотеки классов, содержащей базовую форму  
  
1.  В меню **Файл** выберите пункт **Создать**, затем выберите пункт **Проект**, чтобы открыть диалоговое окно **Создание проекта**.  
  
2.  Создайте приложение Windows Forms с именем `BaseFormLibrary`.  
  
3.  Чтобы создать библиотеку классов вместо стандартного приложения Windows Forms, в **обозревателе решений**, щелкните правой кнопкой мыши узел проекта **BaseFormLibrary** и выберите пункт **Свойства**.  
  
4.  В свойствах проекта измените значение **Выходной тип** с **Приложение Windows** на **Библиотека классов**.  
  
5.  В меню **Файл** выберите **Сохранить все**, чтобы сохранить проект и файлы в расположении по умолчанию.  
  
 Следующие две процедуры выполняют добавление кнопок на базовую форму.  Чтобы продемонстрировать визуальное наследование, кнопкам будет заданы разные уровни доступа с помощью свойств `Modifiers`.  
  
#### Добавление кнопки, которую могут изменить наследники базовой формы  
  
1.  Откройте **Form1** в конструкторе.  
  
2.  На вкладке **Все формы Windows Forms** **панели элементов**, дважды щелкните элемент **Кнопка**, чтобы добавить кнопку на форму.  Измените положение и размер кнопки с помощью мыши.  
  
3.  В окне "Свойства" задайте следующие свойства кнопки.  
  
    -   Задайте для свойства **Text** значение **Привет**.  
  
    -   Задайте для свойства **\(Name\)** значение **btnProtected**.  
  
    -   Задайте для свойства**Modifiers** значение **Protected**.  Это позволяет формам, производным от **Form1**, изменять свойства **btnProtected**.  
  
4.  Дважды щелкните кнопку **Привет**, чтобы добавить обработчик событий для события **Click**.  
  
5.  Добавьте следующий код в обработчик событий:  
  
    ```vb  
    MessageBox.Show("Hello, World!")  
    ```  
  
    ```csharp  
    MessageBox.Show("Hello, World!");  
    ```  
  
#### Добавление кнопки, которая не может изменяться наследующими объектами базовой формы  
  
1.  Перейдите в представление конструктора, щелкнув вкладку **Form1.vb \[Design\], Form1.cs \[Design\] или \[Design\] Form1.jsl** в верхней части редактора кода или нажав клавишу F7.  
  
2.  Добавьте вторую кнопку и задайте ее свойства следующим образом.  
  
    -   Задайте для свойства **Text** значение **До свидания**.  
  
    -   Задайте для свойства **\(Name\)** значение **btnPrivate**.  
  
    -   Задайте для свойства **Modifiers** значение **Private**.  Это не позволяет формам, производным от **Form1**, изменять свойства **btnPrivate**.  
  
3.  Дважды щелкните кнопку **До свидания**, чтобы добавить обработчик событий для события **Click**.  Добавьте следующую строку кода в процедуру обработки события.  
  
    ```vb  
    MessageBox.Show("Goodbye!")  
    ```  
  
    ```csharp  
    MessageBox.Show("Goodbye!");  
    ```  
  
4.  В меню **Сборка** выберите пункт **Собрать библиотеку BaseForm** для создания библиотеки классов.  
  
     После сборки библиотеки можно создать новый проект, наследуемый от только что созданной формы.  
  
#### Создание проекта, содержащего форму, которая наследуется от базовой формы  
  
1.  В меню **Файл** выберите пункт **Создать**, затем выберите пункт **Проект**, чтобы открыть диалоговое окно **Создание проекта**.  
  
2.  Создайте приложение Windows Forms с именем `InheritanceTest`.  
  
#### Добавление производной формы  
  
1.  В **обозревателе решений** щелкните правой кнопкой мыши проект **InheritanceTest**, выберите **Добавить** и щелкните **Создать элемент**.  
  
2.  В диалоговом окне **Создание элемента** выберите категорию**Windows Forms** \(если имеется список категорий\) и шаблон **Производная форма**.  
  
3.  Оставьте имя по умолчанию `Form2` и щелкните **Добавить**.  
  
4.  В диалоговом окне **Выбор компонентов для наследования** выберите **Form1** из проекта **BaseFormLibrary** в качестве формы для наследования и нажмите кнопку **ОК**.  
  
     После этого в проекте **InheritanceTest** будет создана форма в проекте, которая является производной от формы в **BaseFormLibrary**.  
  
5.  Откройте производную форму \(**Form2**\) в конструкторе, дважды щелкнув ее, если она еще не открыта.  
  
     В конструкторе производные кнопки в верхнем углу имеют символ \(![Снимок экрана VisualBasicInheritanceSymbol](../../../../docs/framework/winforms/advanced/media/vbinheritanceglyph.png "vbInheritanceGlyph")\), указывающий, что они являются производными.  
  
6.  Выберите кнопку **Привет** и убедитесь в наличии маркеров изменения размера.  Так как данная кнопка защищена, то наследники могут ее перемещать, изменять размер, название и вносить другие изменения.  
  
7.  Выберите частную кнопку **До свидания** и обратите внимание, что она не имеет маркеров изменения размера.  Кроме того, в окне **Свойства** свойства этой кнопки отображены серым цветом, это говорит о том, что они не могут быть изменены.  
  
8.  При использовании [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)].  
  
    1.  В **обозревателе решений** щелкните правой кнопкой мыши **Form1** в проекте **InheritanceTest**, а затем выберите **Удалить**.  В появившемся диалоговом окне нажмите **ОК** для подтверждения удаления.  
  
    2.  Откройте файл Program.cs и измените строку `Application.Run(new Form1());` на `Application.Run(new Form2());`.  
  
9. В **обозревателе решений** щелкните правой кнопкой мыши проект **InheritanceTest** и выберите **Установить как запускаемый проект**.  
  
10. В **обозревателе решений** щелкните правой кнопкой мыши проект **InheritanceTest** и выберите **Свойства**.  
  
11. На страницах свойства **InheritanceTest** установите в качестве значения **Автоматически запускаемый объект** производную форму \(**Form2**\).  
  
12. Нажмите клавишу F5 для запуска приложения и понаблюдайте за поведением производной формы.  
  
## Следующие действия  
 Наследование для пользовательских элементов управления работает таким же образом.  Откройте новый проект библиотеки классов и добавьте пользовательский элемент управления.  Поместите на него составные элементы управления и скомпилируйте проект.  Откройте еще один новый проект библиотеки классов и добавьте ссылку на скомпилированную библиотеку классов.  Также попытайтесь добавить в проект производный элемент управления \(через диалоговое окно **Добавление новых элементов**\) и с помощью **Выбор компонентов для наследования**.  Добавьте пользовательский элемент управления и измените оператор `Inherits` \(`:` в [!INCLUDE[csprcs](../../../../includes/csprcs-md.md)]\).  Дополнительные сведения см. в разделе [Практическое руководство. Наследование форм Windows Forms](../../../../docs/framework/winforms/advanced/how-to-inherit-windows-forms.md).  
  
## См. также  
 [Практическое руководство. Наследование форм Windows Forms](../../../../docs/framework/winforms/advanced/how-to-inherit-windows-forms.md)   
 [Визуальное наследование в Windows Forms](../../../../docs/framework/winforms/advanced/windows-forms-visual-inheritance.md)   
 [Windows Forms](../../../../docs/framework/winforms/index.md)