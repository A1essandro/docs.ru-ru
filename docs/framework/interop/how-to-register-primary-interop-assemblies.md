---
title: "How to: Register Primary Interop Assemblies | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
helpviewer_keywords: 
  - "registering primary interop assemblies"
  - "primary interop assemblies, registering"
ms.assetid: 4b2fcf8a-429d-43ce-8334-e026040be8bb
caps.latest.revision: 8
author: "rpetrusha"
ms.author: "ronpet"
manager: "wpickett"
caps.handback.revision: 8
---
# How to: Register Primary Interop Assemblies
Маршалинг классов может выполняться только с помощью COM\-взаимодействия и только в качестве интерфейсов.  Иногда интерфейс, используемый для маршалинга класса, называют интерфейсом класса.  Информацию о переопределении интерфейса класса интерфейсом, выбранным разработчиком, см. в разделе [COM Callable Wrapper](../../../docs/framework/interop/com-callable-wrapper.md).  
  
 Разработчик, желающий использовать типы COM из приложения .NET Framework, может создать сборку взаимодействия, однако это связано с проблемой.  Каждый раз, когда разработчик импортирует и подписывает библиотеку типов COM, он создает набор уникальных типов, которые несовместимы с типами, импортированными и подписанными другим разработчиком.  Чтобы решить эту проблему несовместимости, каждый разработчик должен получить предоставляемую поставщиком и подписанную основную сборку взаимодействия.  
  
 Если вы планируете предоставлять доступ к сторонним типам COM другим приложениям, всегда используйте основную сборку взаимодействия, предоставленную тем же издателем, что и определяемая ею библиотека типов.  Помимо обеспечения гарантированной совместимости типов, основные сборки взаимодействия часто настраиваются поставщиками так, чтобы оптимизировать взаимодействие.  
  
 Даже если вы не планируете предоставлять доступ к сторонним типам COM, использование основной сборки взаимодействия может упростить задачу взаимодействия с COM\-компонентами.  Однако такая стратегия не обеспечивает изоляции от изменений, которые поставщик может вносить в типы, определенные в основной сборке взаимодействия.  Если приложению требуется такая изоляция, создайте собственную сборку взаимодействия вместо использования основной сборки взаимодействия.  
  
 Вам необходимо зарегистрировать все приобретенные основные сборки взаимодействия на своем компьютере, прежде чем вы сможете ссылаться на них с помощью [!INCLUDE[vsprvsext](../../../includes/vsprvsext-md.md)].  Visual Studio ищет основную сборку взаимодействия и использует ее при первой ссылке на тип из библиотеки типов COM.  Если программа Visual Studio не может найти основную сборку взаимодействия, связанную с библиотекой типов, она предлагает приобрести ее или создать сборку взаимодействия.  [Средство импорта библиотек типов \(Tlbimp.exe\)](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md) также использует реестр для обнаружения основных сборок взаимодействия.  
  
 Если вы не планируете использовать Visual Studio, регистрировать основные сборки взаимодействия необязательно, однако регистрация предоставляет два преимущества.  
  
-   Зарегистрированная основная сборка взаимодействия явным образом помечается в разделе реестра исходной библиотеки типов.  Регистрация — наилучший способ обнаружения основной сборки взаимодействия на компьютере.  
  
-   Использование Visual Studio для ссылки на тип, для которого существует незарегистрированная основная сборка взаимодействия, позволяет избежать случайного создания и использования новой сборки взаимодействия.  
  
 Для регистрации основной сборки взаимодействия используется [средство регистрации сборок \(Regasm.exe\)](../../../docs/framework/tools/regasm-exe-assembly-registration-tool.md).  
  
### Регистрация основной сборки взаимодействия  
  
1.  В командной строке введите:  
  
     **regasm** *имя\_сборки*  
  
     В этой команде *имя\_сборки* — это имя файла регистрируемой сборки.  Программа Regasm.exe добавляет запись об основной сборке взаимодействия в тот же раздел реестра, что и для исходной библиотеки типов.  
  
## Пример  
 В примере ниже регистрируется основная сборка взаимодействия `CompanyA.UtilLib.dll`.  
  
```  
regasm CompanyA.UtilLib.dll  
```  
  
## См. также  
 [Programming with Primary Interop Assemblies](http://msdn.microsoft.com/ru-ru/306fa1d6-0703-4004-9e93-d0a57f1be81e)   
 [Locating Primary Interop Assemblies](http://msdn.microsoft.com/ru-ru/d6768e4b-cd80-414d-a4f8-05d979eb393b)   
 [Redistributing Primary Interop Assemblies](http://msdn.microsoft.com/ru-ru/e76384f0-d631-474c-bdbd-13884cba0265)