---
title: "Создание файлов ресурсов для приложений для настольных систем | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-bcl"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "RESOURCES-файлы"
  - "ресурсы приложений, создание файлов"
  - "файлы ресурсов, RESOURCES-файлы"
  - "файлы ресурсов, создание"
ms.assetid: 6c5ad891-66a0-4e7a-adcf-f41863ba6d8d
caps.latest.revision: 25
author: "rpetrusha"
ms.author: "ronpet"
manager: "wpickett"
caps.handback.revision: 25
---
# Создание файлов ресурсов для приложений для настольных систем
Ресурсы, например строки, изображения или данные объектов, можно включить в файлы ресурсов, чтобы сделать их легко доступными приложению.  В платформе .NET Framework предлагается пять способов создания файлов ресурсов.  
  
-   Создайте текстовый файл, содержащий строковые ресурсы.  Для преобразования текстового файла в двоичный файл ресурсов \(RESOURCES\-файл\) можно использовать [генератор файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md).  Затем двоичный файл ресурсов можно внедрить в исполняемый файл или библиотеку приложения с помощью компилятора языка или во вспомогательную сборку с помощью [компоновщика сборок \(Al.exe\)](../../../docs/framework/tools/al-exe-assembly-linker.md).  Дополнительные сведения см. в разделе [Ресурсы в формате текстовых файлов](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md#TextFiles).  
  
-   Создайте файл ресурсов XML \(RESX\-файл\), содержащий строковые данные, данные изображений или данные объектов.  Для преобразования RESX\-файла в двоичный файл ресурсов \(RESOURCES\-файл\) можно использовать [генератор файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md).  Затем двоичный файл ресурсов можно внедрить в исполняемый файл или библиотеку приложения с помощью компилятора языка или во вспомогательную сборку с помощью [компоновщика сборок \(Al.exe\)](../../../docs/framework/tools/al-exe-assembly-linker.md).  Дополнительные сведения см. в разделе [Ресурсы в RESX-файлах](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md#ResxFiles).  
  
-   Создайте файл ресурсов XML \(RESX\-файл\) программным способом, используя типы в пространстве имен <xref:System.Resources>.  Можно создать RESX\-файл, перечислить его ресурсы и извлечь конкретные ресурсы по имени.  Дополнительные сведения см. в разделе [Работа с RESX\-файлами программным способом](../../../docs/framework/resources/working-with-resx-files-programmatically.md).  
  
-   Создайте двоичный файл ресурсов \(RESOURCES\-файл\) программным способом.  Затем этот файл можно внедрить в исполняемый файл или библиотеку приложения с помощью компилятора языка или во вспомогательную сборку с помощью [компоновщика сборок \(Al.exe\)](../../../docs/framework/tools/al-exe-assembly-linker.md).  Дополнительные сведения см. в разделе [Ресурсы в RESOURCES-файлах](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md#ResourcesFiles).  
  
-   Используйте Visual Studio для создания файла ресурсов и включите этот файл в проект.  В Visual Studio имеется редактор ресурсов, с помощью которого можно добавлять, удалять и изменять ресурсы.  Во время компиляции файл ресурсов автоматически преобразуется в двоичный RESOURCES\-файл и внедряется в сборку приложения или вспомогательную сборку.  Дополнительные сведения см. в разделе [Файлы ресурсов в Visual Studio](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md#VSResFiles).  
  
<a name="TextFiles"></a>   
## Ресурсы в формате текстовых файлов  
 Текстовые файлы \(с расширением .txt или .restext\) можно использовать для хранения только строковых ресурсов; для нестроковых ресурсов используйте файлы с расширением .resx или создайте их программным способом.  Текстовые файлы, содержащие строковые ресурсы, имеют следующий формат.  
  
```  
# This is an optional comment.  
name = value  
  
; This is another optional comment.  
name = value  
  
; The following supports conditional compilation if X is defined.  
#ifdef X  
name1=value1  
name2=value2  
#endif  
  
# The following supports conditional compilation if Y is undefined.  
#if !Y  
name1=value1  
name2=value2  
#endif  
  
```  
  
 Форматы файлов ресурсов .txt и .restext идентичны.  Расширение файла .restext служит для того, чтобы текстовые файлы сразу опознавались как файлы ресурсов на основе текста.  
  
 Строковые ресурсы представляются в виде пар *name\/value*, где *name* — строка, определяющая ресурс, а *value* — строка ресурса, которая возвращается при передаче *name* методу извлечения ресурсов, например <xref:System.Resources.ResourceManager.GetString%2A?displayProperty=fullName>.  *name* и *value* должны быть разделены знаком равенства \(\=\).  Примеры.  
  
```  
  
FileMenuName=File  
EditMenuName=Edit  
ViewMenuName=View  
HelpMenuName=Help  
  
```  
  
> [!CAUTION]
>  Не следует использовать файлы ресурсов для хранения паролей, секретных сведений или личных данных.  
  
 В текстовых файлах разрешены пустые строки \(что указывает на ресурс, значение которого <xref:System.String.Empty?displayProperty=fullName>\).  Примеры.  
  
```  
EmptyString=  
```  
  
 Начиная с [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] текстовые файлы поддерживают условную компиляцию с конструкциями `#ifdef` *symbol*...  `#endif` и `#if !`*symbol*...  `#endif`.  Затем можно использовать переключатель `/define` с [генератором файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md) для того, чтобы указать символы.  Каждый ресурс требует собственной конструкции `#ifdef` *symbol*…  `#endif` или `#if !`*symbol*...  `#endif`.  Если при использовании оператора `#ifdef` *symbol* указан, то связанный ресурс добавляется в файл ресурсов; в противном случае он не добавляется.  Если при использовании оператора `#if !` *symbol* не указан, то связанный ресурс добавляется в файл ресурсов; в противном случае он не добавляется.  
  
 Комментарии в текстовых файлах необязательны и им предшествует точка с запятой \(;\) или знак решетки \(\#\) в начале строки.  Строки с комментариями могут находиться в любом месте файла.  Комментарии не добавляются в скомпилированный файл ресурсов, созданный с помощью [генератора файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md).  
  
 Любые пустые строки в текстовых файлах считаются содержащими пробелы и игнорируются.  
  
 В следующем примере определяются два строковых ресурса с именами `OKButton` и `CancelButton`.  
  
```  
#Define resources for buttons in the user interface.  
OKButton=OK  
CancelButton=Cancel  
```  
  
 Если в текстовом файле содержатся дубликаты *name*, [Генератор файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md) отображает предупреждение и игнорирует второе имя.  
  
 *value* не может содержать символы начала новой строки, но можно использовать escape\-символы языка С, например `\n` для обозначения новой строки и `\t` для обозначения символа табуляции.  Можно также включить символ обратной косой черты, если он экранируется \(например, "\\\\"\).  Разрешается использование пустых строк.  
  
 Ресурсы должны сохраняться в формате текстового файла с кодировкой UTF\-8 или UTF\-16 с прямым или обратным порядком байтов.  Однако [генератор файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md), преобразующий TXT\-файл в RESOURCES\-файл, по умолчанию трактует файлы как файлы UTF\-8.  Если требуется, чтобы программа Resgen.exe могла работать с файлом в кодировке UTF\-16, необходимо включить в начало файла маркер порядка следования байтов Юникода \(U\+FEFF\).  
  
 Чтобы внедрить файл ресурсов в текстовом формате в сборку платформы .NET Framework, необходимо преобразовать этот файл в двоичный файл ресурсов \(RESOURCES\-файл\) с помощью [генератора файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md).  Затем этот RESOURCES\-файл можно внедрить в сборку платформы .NET Framework с помощью компилятора языка или во вспомогательную сборку с помощью [компоновщика сборок \(Al.exe\)](../../../docs/framework/tools/al-exe-assembly-linker.md).  
  
 В следующем примере используется файл ресурсов в текстовом формате с именем GreetingResources.txt для простого консольного приложения "Hello World".  В этом текстовом файле определены две строки — `prompt` и `greeting`, которые предлагают пользователю ввести свое имя и отображают приветствие.  
  
```  
# GreetingResources.txt   
# A resource file in text format for a "Hello World" application.  
#  
# Initial prompt to the user.  
prompt=Enter your name:   
# Format string to display the result.  
greeting=Hello, {0}!  
```  
  
 Текстовый файл преобразуется в RESOURCES\-файл с помощью следующей команды:  
  
 **resgen GreetingResources.txt**  
  
 В следующем примере показан исходный код для консольного приложения, использующего RESOURCES\-файл для отображения сообщений пользователю.  
  
 [!code-csharp[Conceptual.Resources.TextFiles#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.textfiles/cs/greeting.cs#1)]
 [!code-vb[Conceptual.Resources.TextFiles#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.textfiles/vb/greeting.vb#1)]  
  
 Если используется Visual Basic и файл исходного кода имеет имя Greeting.vb, исполняемый файл, содержащий внедренный RESOURCES\-файл, создается с помощью следующей команды:  
  
 **vbc greeting.vb \/resource:GreetingResources.resources**  
  
 Если используется C\# и файл исходного кода имеет имя Greeting.cs, исполняемый файл, содержащий внедренный RESOURCES\-файл, создается с помощью следующей команды:  
  
 **csc greeting.cs \/resource:GreetingResources.resources**  
  
<a name="ResxFiles"></a>   
## Ресурсы в RESX\-файлах  
 В отличие от текстовых файлов, в которых могут храниться только строковые ресурсы, в файлах ресурсов XML \(RESX\-файлах\) могут храниться строки, двоичные данные \(например, изображения, значки и аудиоклипы\) и программные объекты.  RESX\-файл содержит стандартный заголовок, который описывает формат записей ресурсов и включает применяемые для анализа данных сведения об управлении версиями для XML.  После заголовка XML находятся данные файла ресурсов.  Каждый элемент данных состоит из пары "имя\-значение", которая содержится в теге `data`.  Атрибут `name` элемента данных определяет имя ресурса, а вложенный тег `value` содержит значение ресурса.  Для строковых данных тег `value` содержит строку.  
  
 Например, в следующем теге `data` определяется строковый ресурс с именем `prompt`, значение которого — "Enter your name:".  
  
```  
<data name="prompt" xml:space="preserve">  
  <value>Enter your name:</value>  
</data>  
```  
  
> [!WARNING]
>  Не следует использовать файлы ресурсов для хранения паролей, секретных сведений или личных данных.  
  
 Для объектов ресурсов тег **data** содержит атрибут `type`, указывающий тип данных ресурса.  Для объектов, состоящих из двоичных данных, тег `data` также содержит атрибут `mimetype`, указывающий тип `base64` двоичных данных.  
  
> [!NOTE]
>  Во всех RESX\-файлах для создания и анализа двоичных данных заданного типа используется форматтер двоичной сериализации.  В результате, если формат двоичной сериализации для объекта изменится недопустимым образом, RESX\-файл может стать недействительным.  
  
 В следующем примере показана часть RESX\-файла, в которой содержится ресурс <xref:System.Int32> и растровое изображение.  
  
```  
  
<data name="i1" type="System.Int32, mscorlib">  
  <value>20</value>  
</data>  
  
<data name="flag" type="System.Drawing.Bitmap, System.Drawing,     
    Version=1.0.5000.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a"   
    mimetype="application/x-microsoft.net.object.bytearray.base64">  
  <value>  
    AAEAAAD/////AQAAAAAAAAAMAgAAADtTeX…  
  </value>  
</data>  
```  
  
> [!IMPORTANT]
>  Поскольку RESX\-файлы должны представлять собой XML\-код с правильным, заранее определенным форматом, с ними не рекомендуется работать вручную, особенно если они содержат нестроковые ресурсы.  Вместо этого в Visual Studio предусмотрен прозрачный интерфейс для создания RESX\-файлов и управления ими; дополнительные сведения см. в разделе [Файлы ресурсов в Visual Studio](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md#VSResFiles).  Создавать RESX\-файлы и управлять ими можно также программно.  Для получения дополнительной информации см. [Работа с RESX\-файлами программным способом](../../../docs/framework/resources/working-with-resx-files-programmatically.md).  
  
<a name="ResourcesFiles"></a>   
## Ресурсы в RESOURCES\-файлах  
 Для программного создания двоичного файла ресурсов \(RESOURCES\-файла\) непосредственно из кода можно использовать класс <xref:System.Resources.ResourceWriter?displayProperty=fullName>.  Для создания RESOURCES\-файла из текстового файла или RESX\-файла можно также использовать [генератор файлов ресурсов \(Resgen.exe\)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md).  Помимо строковых данных, RESOURCES\-файл может содержать двоичные данные \(массивы байтов\) и данные объектов.  Для программного создания RESOURCES\-файла необходимо выполнить следующие действия.  
  
1.  Создайте объект <xref:System.Resources.ResourceWriter> с уникальным именем файла.  Это можно сделать, указав конструктору класса <xref:System.Resources.ResourceWriter> имя файла или файловый поток.  
  
2.  Вызовите одну из перегрузок метода <xref:System.Resources.ResourceWriter.AddResource%2A?displayProperty=fullName> для каждого именованного ресурса, который требуется добавить в файл.  Ресурсом может быть строка, объект или коллекция двоичных данных \(массив байтов\).  
  
3.  Вызовите метод <xref:System.Resources.ResourceWriter.Close%2A?displayProperty=fullName>, чтобы записать ресурсы в файл и закрыть объект <xref:System.Resources.ResourceWriter>.  
  
> [!NOTE]
>  Не следует использовать файлы ресурсов для хранения паролей, секретных сведений или личных данных.  
  
 В следующем примере программным способом создается RESOURCES\-файл с именем CarResources.resources, в котором хранятся шесть строк, значок и два объекта, определяемые приложением \(два объекта `Automobile`\).  Обратите внимание, что класс `Automobile`, определенный и созданный в этом примере, отмечен атрибутом <xref:System.SerializableAttribute>, который позволяет ему сохраняться модулем форматирования при двоичной сериализации.  
  
 [!code-csharp[Conceptual.Resources.Resources#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.resources.resources/cs/resources1.cs#1)]
 [!code-vb[Conceptual.Resources.Resources#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.resources.resources/vb/resources1.vb#1)]  
  
 После создания RESOURCES\-файла его можно внедрить в исполняемый файл среды выполнения или библиотеку, используя параметр `/resource` компилятора языка, или во вспомогательную сборку с помощью [компоновщика сборок \(Al.exe\)](../../../docs/framework/tools/al-exe-assembly-linker.md).  
  
<a name="VSResFiles"></a>   
## Файлы ресурсов в Visual Studio  
 При добавлении файла ресурсов в проект Visual Studio среда Visual Studio создает RESX\-файл в каталоге проекта.  В Visual Studio имеются редакторы ресурсов, позволяющие добавлять строки, изображения и двоичные объекты.  Поскольку редакторы предназначены для обработки только статических данных, их нельзя использовать для хранения программных объектов; данные объектов необходимо записывать в RESX\-файл или RESOURCES\-файл программным способом.  См. раздел [Работа с RESX\-файлами программным способом](../../../docs/framework/resources/working-with-resx-files-programmatically.md) и [Ресурсы в RESOURCES-файлах](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md#ResourcesFiles) для получения дополнительных сведений.  
  
 При добавлении локализованных ресурсов следует назначать им то же корневое имя файла, как у основного файла ресурсов, а также указывать в имени файла их язык и региональные параметры.  Например, при добавлении файла ресурсов с именем Resources.resx можно также создать файлы ресурсов с именами Resources.en\-US.resx и Resources.fr\-FR.resx, чтобы сохранить локализованные ресурсы для английского \(США\) и французского \(Франция\) языков и региональных параметров соответственно.  Необходимо также указать язык и региональные параметры по умолчанию для приложения.  Это язык и региональные параметры, ресурсы которых используются в том случае, если для конкретного языка и региональных параметров никаких локализованных ресурсов обнаружить не удается.  Чтобы задать язык и региональные параметры по умолчанию, в обозревателе решений Visual Studio щелкните правой кнопкой мыши имя проекта, выберите "Приложение", щелкните **Сведения о сборке** и в списке **Нейтральный язык** выберите соответствующий язык и региональные параметры.  
  
 Во время компиляции среда Visual Studio сначала преобразует RESX\-файлы проекта в двоичные файлы ресурсов \(RESOURCES\-файлы\) и сохраняет их в подкаталоге каталога obj проекта.  Visual Studio внедряет любые файлы ресурсов, не содержащие локализованные ресурсы, в основную сборку, созданную проектом.  Если в каких\-либо файлах ресурсов есть локализованные ресурсы, Visual Studio внедряет их в отдельные вспомогательные сборки для каждого локализованного языка и региональных параметров.  Затем Visual Studio сохраняет каждую вспомогательную сборку в каталоге, имя которого соответствует локализованному языку и региональным параметрам.  Например, локализованные ресурсы английского языка \(США\) сохраняются во вспомогательной сборке в подкаталоге en\-US.  
  
## См. также  
 <xref:System.Resources>   
 [Ресурсы в приложениях для настольных систем](../../../docs/framework/resources/index.md)   
 [Упаковка и развертывание ресурсов](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)