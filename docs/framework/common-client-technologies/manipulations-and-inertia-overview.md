---
title: Общие сведения о манипуляциях и инерции
ms.date: 03/30/2017
ms.assetid: dd31b89b-eab6-45a1-8d0b-11e0eb84b234
ms.openlocfilehash: 6396c174b341b5ae937fa931488ee1bd3a5fcbd5
ms.sourcegitcommit: c93fd5139f9efcf6db514e3474301738a6d1d649
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2018
ms.locfileid: "50187823"
---
# <a name="manipulations-and-inertia-overview"></a><span data-ttu-id="8d2e6-102">Общие сведения о манипуляциях и инерции</span><span class="sxs-lookup"><span data-stu-id="8d2e6-102">Manipulations and Inertia Overview</span></span>
<span data-ttu-id="8d2e6-103">*Манипуляции* предоставляют пользователям возможность перемещать, поворачивать и изменять размеры элементов пользовательского интерфейса с помощью *манипуляторов*.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-103">*Manipulations* enable users to move, rotate, and resize user interface (UI) elements by using *manipulators*.</span></span> <span data-ttu-id="8d2e6-104">Манипулятором является мышь или (в сценарии с поддержкой сенсорного ввода) перо либо палец.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-104">A manipulator represents a mouse or (in a touch-enabled scenario) a stylus or a finger.</span></span>  
  
 <span data-ttu-id="8d2e6-105">*Инерция* моделирует поведение, характерное для реального мира, для движущихся элементов пользовательского интерфейса, имитируя силы трения в элементах.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-105">*Inertia* emulates real-world behavior for UI elements that are in motion by simulating friction forces on the elements.</span></span> <span data-ttu-id="8d2e6-106">Это позволяет элементам постепенно замедлять свое движение (линейное и угловое) перед остановкой.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-106">This enables elements to gradually slow their movement (both linear and angular) before coming to a stop.</span></span> <span data-ttu-id="8d2e6-107">В этой статье содержатся вводные сведения о манипуляциях и инерции для .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-107">This article provides an introduction to manipulations and inertia for the .NET Framework.</span></span>  
  
## <a name="manipulations"></a><span data-ttu-id="8d2e6-108">Манипуляции</span><span class="sxs-lookup"><span data-stu-id="8d2e6-108">Manipulations</span></span>  
 <span data-ttu-id="8d2e6-109">Манипуляция воспринимает набор манипуляторов как составной объект.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-109">A manipulation treats a collection of manipulators as a composite object.</span></span> <span data-ttu-id="8d2e6-110">Приложение может отслеживать изменения этого составного объекта вместо отдельных компонентов.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-110">An application can track the changes to the composite object instead of the individual components.</span></span>  
  
 <span data-ttu-id="8d2e6-111">Рассмотрим следующую иллюстрацию.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-111">Consider the image in the following illustration.</span></span> <span data-ttu-id="8d2e6-112">Пользователь может использовать два манипулятора для перемещения, поворота и масштабирования изображения.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-112">A user can use two manipulators to move, rotate, and scale the image.</span></span> <span data-ttu-id="8d2e6-113">Изменения каждого манипулятора интерпретируются вместе с другими манипуляторами.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-113">The changes to each manipulator are interpreted together with the other manipulators.</span></span>  
  
 <span data-ttu-id="8d2e6-114">Например, если на изображении есть два манипулятора (1 и 2) и манипулятор 1 перемещается в направлении +Y (вниз), изменение изображения зависит от того, что происходит с манипулятором 2.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-114">For example, if you have two manipulators (1 and 2) on the image, and you move manipulator 1 in a +Y direction (down), the change to the image depends on what happens to manipulator 2.</span></span> <span data-ttu-id="8d2e6-115">Если манипулятор 2 также перемещается в направлении +Y (вниз), изображение просто перемещается в направлении +Y.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-115">If manipulator 2 also moves in the +Y direction (down), the image simply moves in the +Y direction.</span></span> <span data-ttu-id="8d2e6-116">Но если манипулятор 2 не изменяется или перемещается в направлении -Y (вверх), изображение становится меньше или поворачивается.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-116">But if manipulator 2 does not change, or it moves in a -Y direction (up), the image is made smaller or rotated.</span></span>  
  
 <span data-ttu-id="8d2e6-117">![Виртуальная фотография, на которой изображена манипуляция двумя пальцами.](../../../docs/framework/common-client-technologies/media/manipulation-resize.png "Manipulation_Resize")</span><span class="sxs-lookup"><span data-stu-id="8d2e6-117">![A virtual photo that two fingers are manipulating.](../../../docs/framework/common-client-technologies/media/manipulation-resize.png "Manipulation_Resize")</span></span>  
  
 <span data-ttu-id="8d2e6-118">Изображение, управляемое двумя манипуляторами</span><span class="sxs-lookup"><span data-stu-id="8d2e6-118">An image being manipulated by two manipulators</span></span>  
  
 <span data-ttu-id="8d2e6-119">Обработка манипуляции обеспечивает инфраструктуру, которая наблюдает за подмножеством манипуляторов и интерпретирует их, как если бы они действовали вместе, а не независимо друг от друга.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-119">Manipulation processing provides a framework that monitors a subset of manipulators and interprets them as if they are acting together, instead of independently.</span></span> <span data-ttu-id="8d2e6-120">Можно создать несколько объектов обработчика манипуляции одновременно, по одному для каждого элемента пользовательского интерфейса, с которым выполняются манипуляции в приложении.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-120">You can create several manipulation processor objects simultaneously, one for each UI element to be manipulated in an application.</span></span> <span data-ttu-id="8d2e6-121">Обработчик манипуляции информирован о том, какие устройства ввода следует наблюдать, и сообщает о манипуляциях с помощью [событий .NET](../../../docs/standard/events/index.md).</span><span class="sxs-lookup"><span data-stu-id="8d2e6-121">A manipulation processor is informed of which input devices to observe and it reports manipulations through [.NET events](../../../docs/standard/events/index.md).</span></span>  
  
 <span data-ttu-id="8d2e6-122">Обработчик манипуляции не имеет сведений о конкретном элементе, с которым выполняется манипуляция.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-122">A manipulation processor does not have information about the particular element that is being manipulated.</span></span> <span data-ttu-id="8d2e6-123">Приложение по отдельности применяет изменения к элементу конкретного приложения.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-123">An application separately applies the changes to an application-specific element.</span></span> <span data-ttu-id="8d2e6-124">Например, приложение применяет преобразования к изображению или перерисовывает его для отображения в новом месте или с новыми размерами или ориентацией.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-124">For example, an application applies transformations to an image or redraws it to display it at its new location or with a new size or orientation.</span></span>  
  
 <span data-ttu-id="8d2e6-125">Манипуляции предназначены для двумерных (2-D) [аффинных преобразований](/windows/desktop/gdiplus/-gdiplus-transformations-use).</span><span class="sxs-lookup"><span data-stu-id="8d2e6-125">Manipulations are designed for two-dimensional (2-D) [affine transformations](/windows/desktop/gdiplus/-gdiplus-transformations-use).</span></span> <span data-ttu-id="8d2e6-126">Эти преобразования включают перемещение, поворот и масштабирование.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-126">These transformations include translate, rotate, and scale.</span></span>  
  
### <a name="parts-of-a-manipulation"></a><span data-ttu-id="8d2e6-127">Части манипуляции</span><span class="sxs-lookup"><span data-stu-id="8d2e6-127">Parts of a Manipulation</span></span>  
 <span data-ttu-id="8d2e6-128">Манипуляция представляет собой коллекцию объектов <xref:System.Windows.Input.Manipulations.Manipulator2D>.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-128">A manipulation is a collection of <xref:System.Windows.Input.Manipulations.Manipulator2D> objects.</span></span> <span data-ttu-id="8d2e6-129">Эта агрегатная манипуляция представляется исходной точкой и эллипсом.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-129">This aggregate manipulation is represented by an origin point and an ellipse.</span></span> <span data-ttu-id="8d2e6-130">Исходная точка — это среднее положение всех манипуляторов, используемых для манипуляции элементом.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-130">The origin point is the average position of all manipulators that are manipulating an element.</span></span> <span data-ttu-id="8d2e6-131">Эллипс имеет радиус, представляющий собой среднее расстояние от исходной точки до каждого из объектов <xref:System.Windows.Input.Manipulations.Manipulator2D>.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-131">The ellipse has a radius that is the average distance from the origin to each of the <xref:System.Windows.Input.Manipulations.Manipulator2D> objects.</span></span>  
  
 <span data-ttu-id="8d2e6-132">![Части манипуляции.](../../../docs/framework/common-client-technologies/media/manipulation-definition.png "Manipulation_Definition")</span><span class="sxs-lookup"><span data-stu-id="8d2e6-132">![The parts of a manipulation.](../../../docs/framework/common-client-technologies/media/manipulation-definition.png "Manipulation_Definition")</span></span>  
  
 <span data-ttu-id="8d2e6-133">Манипуляция задается двумя манипуляторами (1 и 2), исходной точкой и эллипсом.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-133">Two manipulators (1 and 2), an origin, and an ellipse specify a manipulation</span></span>  
  
 <span data-ttu-id="8d2e6-134">Когда манипуляторы добавляются, перемещаются или удаляются для элемента пользовательского интерфейса, приложение обновляет объект <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D> путем вызова метода <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.ProcessManipulators%2A>.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-134">As manipulators are added, moved, or removed for a UI element, an application updates the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D> object by calling the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.ProcessManipulators%2A> method.</span></span> <span data-ttu-id="8d2e6-135">В начале манипуляции возникает событие <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Started>.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-135">When the manipulation first begins, the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Started> event is raised.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8d2e6-136">Обработка манипуляции более эффективна при использовании в среде фреймового обновления.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-136">Manipulation processing is more efficient when used in a frame-based update environment.</span></span> <span data-ttu-id="8d2e6-137">При использовании обработки манипуляции в приложении Microsoft XNA это не имеет значения, так как инфраструктура XNA предоставляет фреймовые обновления с помощью метода [Game.Update](https://docs.microsoft.com/previous-versions/windows/xna/bb199616%28v%3dxnagamestudio.41%29).</span><span class="sxs-lookup"><span data-stu-id="8d2e6-137">When using manipulation processing in a Microsoft XNA application, this is not a concern because the XNA framework provides frame-based updates using the [Game.Update](https://docs.microsoft.com/previous-versions/windows/xna/bb199616%28v%3dxnagamestudio.41%29) method.</span></span> <span data-ttu-id="8d2e6-138">В другой среде (например, в WinForms) может понадобиться предоставить собственную фреймовую логику для сбора манипуляций и их периодической отправки в метод <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.ProcessManipulators%2A> в виде пакета.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-138">In another environment (such as WinForms), you might need to provide your own frame-based logic to collect manipulations and periodically send them to the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.ProcessManipulators%2A> method as a batch.</span></span>  
  
 <span data-ttu-id="8d2e6-139">При изменении числа манипуляторов или их положения возникает событие <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Delta>.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-139">As the number of manipulators or their position change, the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Delta> event is raised.</span></span> <span data-ttu-id="8d2e6-140">Свойства объекта <xref:System.Windows.Input.Manipulations.Manipulation2DDeltaEventArgs>, который передается в обработчик события <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Delta>, определяют изменения в исходной точке, масштабе, повороте и перемещении, произошедшие с момента последнего события.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-140">Properties of the <xref:System.Windows.Input.Manipulations.Manipulation2DDeltaEventArgs> object that is passed to the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Delta> event handler specify changes in origin, scale, rotation, and translation that have occurred since the last event.</span></span> <span data-ttu-id="8d2e6-141">Исходная точка манипуляции изменяется при перемещении манипуляторов, а также при добавлении или удалении манипуляторов.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-141">The origin of the manipulation changes when manipulators move, and when manipulators are added or removed.</span></span> <span data-ttu-id="8d2e6-142">Значения перемещения указывают, какое перемещение по оси X или Y включает эта манипуляция.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-142">Translation values specify how much X or Y movement the manipulation includes.</span></span>  
  
 <span data-ttu-id="8d2e6-143">С помощью этих новых значений приложение перерисовывает элемент пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-143">Using the new values, an application redraws the UI element.</span></span>  
  
 <span data-ttu-id="8d2e6-144">![Манипуляция после контакта A переместилась вправо.](../../../docs/framework/common-client-technologies/media/manipulation-changed.png "Manipulation_Changed")</span><span class="sxs-lookup"><span data-stu-id="8d2e6-144">![A manipulation after contact A moved to the right.](../../../docs/framework/common-client-technologies/media/manipulation-changed.png "Manipulation_Changed")</span></span>  
  
 <span data-ttu-id="8d2e6-145">Манипулятор 1 перемещается и приводит к изменению исходной точки.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-145">Manipulator 1 moves and causes the origin to change</span></span>  
  
 <span data-ttu-id="8d2e6-146">Когда последний манипулятор, связанный с манипуляцией, удаляется из объекта <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D>, возникает событие <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Completed></span><span class="sxs-lookup"><span data-stu-id="8d2e6-146">When the last manipulator that is associated with the manipulation is removed from the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D> object, the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Completed> event is raised.</span></span>  
  
### <a name="the-manipulation-processing-model"></a><span data-ttu-id="8d2e6-147">Модель обработки манипуляции</span><span class="sxs-lookup"><span data-stu-id="8d2e6-147">The Manipulation Processing Model</span></span>  
 <span data-ttu-id="8d2e6-148">Обработчик манипуляции использует модель прямого использования.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-148">A manipulation processor uses a direct-usage model.</span></span> <span data-ttu-id="8d2e6-149">В этой простой модели приложение должно передавать обработчику манипуляции все сведения о событиях ввода.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-149">With this simple model, an application must pass any input event details to the manipulation processor.</span></span> <span data-ttu-id="8d2e6-150">Событие ввода может быть вызвано любым примитивом ввода, таким как устройство мыши, перо или палец.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-150">An input event might be raised by any input primitive, such as a mouse device, a stylus, or a finger.</span></span> <span data-ttu-id="8d2e6-151">Этот процесс обеспечивает механизм прямой фильтрации и простую модель использования, поэтому приложение при необходимости может объединять события ввода в пакет.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-151">This process provides a direct filtering mechanism and a simple usage model, so the application can batch input events when it is necessary.</span></span>  
  
 <span data-ttu-id="8d2e6-152">Чтобы приложение включило примитив ввода в процесс манипуляции, создается структура <xref:System.Windows.Input.Manipulations.Manipulator2D> из сведений примитива ввода, а затем эта структура передается в обработчик манипуляции с помощью метода <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.ProcessManipulators%2A>.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-152">For an application to include an input primitive in the manipulation process, it creates a <xref:System.Windows.Input.Manipulations.Manipulator2D> structure from the details of the input primitive, and passes the structure to the manipulation processor using the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.ProcessManipulators%2A> method.</span></span> <span data-ttu-id="8d2e6-153">Затем обработчик манипуляции инициирует события, которые приложение должно обработать, чтобы обновить визуальный компонент соответствующим образом.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-153">The manipulation processor then raises events, which the application must handle to update the visual component in an appropriate way.</span></span>  
  
 <span data-ttu-id="8d2e6-154">![Поток манипуляций модели прямого использования.](../../../docs/framework/common-client-technologies/media/manipulation-flow.png "Manipulation_Flow")</span><span class="sxs-lookup"><span data-stu-id="8d2e6-154">![The flow of the manipulations direct&#45;usage model.](../../../docs/framework/common-client-technologies/media/manipulation-flow.png "Manipulation_Flow")</span></span>  
  
 <span data-ttu-id="8d2e6-155">Модель обработки манипуляции</span><span class="sxs-lookup"><span data-stu-id="8d2e6-155">The manipulation processing model</span></span>  
  
## <a name="inertia"></a><span data-ttu-id="8d2e6-156">Инерция</span><span class="sxs-lookup"><span data-stu-id="8d2e6-156">Inertia</span></span>  
 <span data-ttu-id="8d2e6-157">Обработчик инерции позволяет приложениям экстраполировать расположение, ориентацию и другие свойства элемента пользовательского интерфейса, имитируя поведение, существующее в реальном мире.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-157">The inertia processor enables applications to extrapolate location, orientation, and other properties of a UI element by simulating real-world behavior.</span></span>  
  
 <span data-ttu-id="8d2e6-158">Например, когда пользователь ударяет элемент, он может продолжить движение, замедлиться и затем медленно остановиться.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-158">For instance, when a user flicks an element, it can continue moving, decelerate, and then slowly stop.</span></span> <span data-ttu-id="8d2e6-159">Обработчик инерции реализует это поведение, вызывая изменение аффинных двумерных значений (исходной точки, масштаба, перемещения и поворота) в течение указанного времени с заданной скоростью замедления.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-159">The inertia processor implements this behavior by causing the affine 2-D values (origin, scale, translation, and rotation) to change over a specified time at a specified deceleration rate.</span></span>  
  
 <span data-ttu-id="8d2e6-160">Как и при обработке манипуляции, обработчик инерции не имеет сведений ни об одном конкретном элементе пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-160">As with manipulation processing, an inertia processor does not have information about any particular UI element.</span></span> <span data-ttu-id="8d2e6-161">В ответ на события, возникающие в объекте <xref:System.Windows.Input.Manipulations.InertiaProcessor2D>, приложение по-отдельности применяет изменения к элементу конкретного приложения.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-161">In response to events that are raised on an <xref:System.Windows.Input.Manipulations.InertiaProcessor2D> object, an application separately applies the changes to an application-specific element.</span></span>  
  
 <span data-ttu-id="8d2e6-162">Обработка инерции и обработка манипуляции часто используются совместно.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-162">Inertia processing and manipulation processing are often used together.</span></span> <span data-ttu-id="8d2e6-163">Их интерфейсы аналогичны, и события, которые они вызывают, идентичны (в некоторых случаях).</span><span class="sxs-lookup"><span data-stu-id="8d2e6-163">Their interfaces are similar, and the events that they raise are (in some cases) identical.</span></span> <span data-ttu-id="8d2e6-164">Обычно обработка инерции начинается после завершения манипуляции с элементом пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-164">Generally, inertia processing begins when the manipulation of the UI element is completed.</span></span> <span data-ttu-id="8d2e6-165">Это достигается путем прослушивания события <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Completed> и запуска обработки инерции из обработчика этого события.</span><span class="sxs-lookup"><span data-stu-id="8d2e6-165">This is accomplished by listening to the <xref:System.Windows.Input.Manipulations.ManipulationProcessor2D.Completed> event and starting the inertia processing from that event handler.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8d2e6-166">См. также</span><span class="sxs-lookup"><span data-stu-id="8d2e6-166">See Also</span></span>  
 <xref:System.Windows.Input.Manipulations>
