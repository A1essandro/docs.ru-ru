---
title: "Активация экземпляров | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 134c3f70-5d4e-46d0-9d49-469a6643edd8
caps.latest.revision: 6
author: "Erikre"
ms.author: "erikre"
manager: "erikre"
caps.handback.revision: 6
---
# Активация экземпляров
Хранилище экземпляров рабочих процессов SQL работает как внутренняя задача, которая периодически активируется и обнаруживает запускаемые или доступные для действий экземпляры рабочих процессов в базе данных сохраняемости.Если запускаемый экземпляр рабочего процесса найден, хранилище уведомит узел рабочих процессов, который может активировать этот экземпляр.Если хранилище экземпляров найдет доступный экземпляр рабочего процесса, оно уведомит общий узел, который активирует узел рабочих процессов, который в свою очередь запустит экземпляр рабочего процесса.В следующих подразделах этого раздела приводится подробное объяснение процесса активации экземпляра.  
  
##  <a name="RunnableSection"></a> Обнаружение и активация запускаемых экземпляров рабочих процессов  
 Хранилище экземпляров рабочих процессов SQL считает экземпляр рабочего процесса *запускаемым*, если он не находится в приостановленном или завершенном состоянии и удовлетворяет следующим условиям.  
  
-   Экземпляр разблокирован и имеет таймер в состоянии ожидания, время которого истекло.  
  
-   Время блокировки экземпляра истекло.  
  
-   Экземпляр разблокирован, и его состояние — **Executing**.  
  
 При обнаружении запускаемого экземпляра хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent>.После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> на этом хранилище.  
  
 Узел рабочих процессов, который подписался на событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> и может загрузить экземпляр, выполняет команду <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> относительно хранилища экземпляров для его загрузки в память.Считается, что узел рабочих процессов способен загрузить экземпляр рабочего процесса, если свойство метаданных **WorkflowServiceType** для узла и экземпляра имеет одно и то же значение.  
  
## Обнаружение и активация доступных для действий экземпляров рабочих процессов  
 Экземпляр рабочего процесса считается *доступным для действия*, если он является запускаемым и на компьютере нет узла рабочих процессов, способного загрузить этот экземпляр.Определение экземпляра запускаемого рабочего процесса см. выше, в разделе Обнаружение и активация запускаемых экземпляров рабочих процессов.  
  
 При обнаружении доступного для действий экземпляра рабочего процесса в базе данных хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>.После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> на этом хранилище.  
  
 Когда общий узел, подписанный на событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>, получает его, он выполняет команду <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> относительно хранилища экземпляров для получения параметров активации, необходимых для создания узла рабочих процессов.Универсальный узел использует эти параметры для создания приложения рабочего процесса, которое в свою очередь загружает и запускает запускаемый экземпляр службы.  
  
## Универсальные узлы  
 Универсальный узел ― это узел, у которого свойству метаданных **WorkflowServiceType** для универсальных узлов задано значение **WorkflowServiceType.Any**, что означает, что этот узел может обрабатывать любой тип рабочего процесса.Параметр XName универсального узла имеет значение **ActivationType**.  
  
 В настоящее время хранилище экземпляров рабочих процессов SQL поддерживает универсальные узлы с параметром ActivationType в значении **WAS**.Если параметру ActivationType не задано значение WAS, хранилище экземпляров рабочих процессов SQL формирует исключение <xref:System.Runtime.DurableInstancing.InstancePersistenceException>.Служба управления рабочими процессами, поставляемая под рабочим названием [!INCLUDE[dublin](../../../includes/dublin-md.md)], является универсальным узлом с типом активации **WAS**.  
  
 Для активации WAS универсальному узлу требуется набор параметров активации для выявления адреса конечной точки, по которому можно активировать новые узлы.Параметры для активации WAS ― это имя узла, путь к приложению относительно узла и путь к службе относительно приложения.Хранилище экземпляров рабочих процессов SQL хранит эти параметры активации во время выполнения команды <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.  
  
## Период обнаружения запускаемых экземпляров  
 Свойство **Runnable Instances Detection Period** хранилища экземпляров рабочих процессов SQL указывает временной интервал с момента предыдущего цикла обнаружения, по истечении которого хранилище экземпляров рабочих процессов SQL выполняет задачу обнаружения выполняемых или активируемых экземпляров рабочих процессов в базе данных сохраняемости.Дополнительные сведения об этом свойстве см. в разделе [Период обнаружения запускаемых экземпляров](../../../docs/framework/windows-workflow-foundation//runnable-instances-detection-period.md).