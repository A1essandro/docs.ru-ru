---
title: Активация экземпляров
ms.date: 03/30/2017
ms.assetid: 134c3f70-5d4e-46d0-9d49-469a6643edd8
ms.openlocfilehash: a1b78dc62fbdc6e5551addf400ceb14dc9e822f5
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33516832"
---
# <a name="instance-activation"></a>Активация экземпляров
Хранилище экземпляров рабочих процессов SQL работает как внутренняя задача, которая периодически активируется и обнаруживает запускаемые или доступные для действий экземпляры рабочих процессов в базе данных сохраняемости. Если запускаемый экземпляр рабочего процесса найден, хранилище уведомит узел рабочих процессов, который может активировать этот экземпляр. Если хранилище экземпляров найдет доступный экземпляр рабочего процесса, оно уведомит общий узел, который активирует узел рабочих процессов, который в свою очередь запустит экземпляр рабочего процесса. В следующих подразделах этого раздела приводится подробное объяснение процесса активации экземпляра.  
  
##  <a name="RunnableSection"></a> Обнаружение и активация запускаемых экземпляров рабочих процессов  
 Хранилище экземпляров рабочих процессов SQL считает экземпляр рабочего процесса *запускаемых* Если экземпляр не находится в приостановленном или завершенном состоянии и удовлетворяет следующим условиям:  
  
-   Экземпляр разблокирован и имеет таймер в состоянии ожидания, время которого истекло.  
  
-   Время блокировки экземпляра истекло.  
  
-   Экземпляр разблокирован, и она находится в состоянии **выполнение**.  
  
 При обнаружении запускаемого экземпляра хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent>. После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> на этом хранилище.  
  
 Узел рабочих процессов, который подписался на событие <xref:System.Activities.DurableInstancing.HasRunnableWorkflowEvent> и может загрузить экземпляр, выполняет команду <xref:System.Activities.DurableInstancing.TryLoadRunnableWorkflowCommand> относительно хранилища экземпляров для его загрузки в память. Узел рабочего процесса считается способен загрузить экземпляр рабочего процесса, если узла и экземпляра имеет свойство метаданных **WorkflowServiceType** присвоено то же значение.  
  
## <a name="detecting-and-activating-activatable-workflow-instances"></a>Обнаружение и активация доступных для действий экземпляров рабочих процессов  
 Экземпляр рабочего процесса считается *активируемый* Если является запускаемым и отсутствует узел рабочего процесса, поддерживающий загрузку экземпляра, выполняется на компьютере. Определение экземпляра запускаемого рабочего процесса см. выше, в разделе Обнаружение и активация запускаемых экземпляров рабочих процессов.  
  
 При обнаружении доступного для действий экземпляра рабочего процесса в базе данных хранилище экземпляров рабочих процессов SQL создает событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>. После этого хранилище экземпляров рабочих процессов SQL останавливает наблюдение до однократного вызова <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> на этом хранилище.  
  
 Когда общий узел, подписанный на событие <xref:System.Activities.DurableInstancing.HasActivatableWorkflowEvent>, получает его, он выполняет команду <xref:System.Activities.DurableInstancing.QueryActivatableWorkflowsCommand> относительно хранилища экземпляров для получения параметров активации, необходимых для создания узла рабочих процессов. Универсальный узел использует эти параметры для создания приложения рабочего процесса, которое в свою очередь загружает и запускает запускаемый экземпляр службы.  
  
## <a name="generic-hosts"></a>Универсальные узлы  
 Универсальный узел — узел со значением свойства метаданных **WorkflowServiceType** для универсальных узлов задано значение **WorkflowServiceType.Any** для указания, что он может обрабатывать любой тип рабочего процесса. Параметр XName универсального узла имеет **ActivationType**.  
  
 В настоящее время хранилище экземпляров рабочих процессов SQL поддерживает универсальные узлы с параметром ActivationType значение **WAS**. Если параметру ActivationType не задано значение WAS, хранилище экземпляров рабочих процессов SQL формирует исключение <xref:System.Runtime.DurableInstancing.InstancePersistenceException>. Служба управления рабочими процессами, который поставляется вместе с [!INCLUDE[dublin](../../../includes/dublin-md.md)] является универсальным узлом с типом активации **WAS**.  
  
 Для активации WAS универсальному узлу требуется набор параметров активации для выявления адреса конечной точки, по которому можно активировать новые узлы. Параметры для активации WAS ― это имя узла, путь к приложению относительно узла и путь к службе относительно приложения. Хранилище экземпляров рабочих процессов SQL хранит эти параметры активации во время выполнения команды <xref:System.Activities.DurableInstancing.SaveWorkflowCommand>.  
  
## <a name="runnable-instances-detection-period"></a>Период обнаружения запускаемых экземпляров  
 **Период обнаружения запускаемых экземпляров** свойства хранилища экземпляров рабочих процессов SQL указывает период времени, после которого хранилище экземпляров рабочих процессов SQL выполняет задачу обнаружения выполняемых или активируемых рабочих процессов экземпляры в базе данных постоянного хранения после предыдущего цикла обнаружения. В разделе [период обнаружения запускаемых экземпляров](../../../docs/framework/windows-workflow-foundation/runnable-instances-detection-period.md) Дополнительные сведения о данном свойстве.
