---
title: "Узел ReadLine экземпляра WorkflowApplication"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: f7b362be-cb42-40d7-b9ef-cfc4aed2455b
caps.latest.revision: "14"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: 1ba33dff4be8ae3e75ee4d1873feeb4d5e5944b7
ms.sourcegitcommit: ce279f2d7fe2220e6ea0a25a8a7a5370ddf8d9f0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2017
---
# <a name="workflowapplication-readline-host"></a><span data-ttu-id="52ecb-102">Узел ReadLine экземпляра WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="52ecb-102">WorkflowApplication ReadLine Host</span></span>
<span data-ttu-id="52ecb-103">Этот образец представляет собой универсальный узел ReadLine.</span><span class="sxs-lookup"><span data-stu-id="52ecb-103">This sample is a generic ReadLine host.</span></span> <span data-ttu-id="52ecb-104">С помощью имеющегося действия `ReadLine` (или других действий, подобных тем, которые возвращают данные из закладок, возобновленных со строками) можно загружать и запускать любой рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="52ecb-104">You can load and run any workflow using the included `ReadLine` activity (or other activities like it that get data from bookmarks resumed with strings).</span></span> <span data-ttu-id="52ecb-105">Выходные данные из действия `WriteLine` или любого другого, выполняющего запись в расширение <xref:System.Activities.Statements.WriteLine.TextWriter%2A>, направляются в окно узла.</span><span class="sxs-lookup"><span data-stu-id="52ecb-105">Output from the `WriteLine` activity or anything writing to the <xref:System.Activities.Statements.WriteLine.TextWriter%2A> extension is directed to the host window.</span></span> <span data-ttu-id="52ecb-106">Если экземпляр бездействует, в поле со списком отображаются имеющиеся в нем закладки.</span><span class="sxs-lookup"><span data-stu-id="52ecb-106">When an instance is idle, the available bookmarks for that instance appear in a combo box.</span></span> <span data-ttu-id="52ecb-107">Если выбрать закладку, ввести некоторый текст и нажать кнопку возобновления закладки, то выполнение рабочего процесса будет продолжено.</span><span class="sxs-lookup"><span data-stu-id="52ecb-107">Selecting a bookmark, inputting some text, and pressing the resume bookmark button continue the execution of the workflow.</span></span> <span data-ttu-id="52ecb-108">Можно также отменить, прервать или завершить выбранный рабочий процесс.</span><span class="sxs-lookup"><span data-stu-id="52ecb-108">You can also cancel, abort, or terminate a selected workflow.</span></span> <span data-ttu-id="52ecb-109">По умолчанию сохраняемость включена - можно остановить узел и снова его запустить, список экземпляров при этом будет заполнен экземплярами, сохраненными в базе данных.</span><span class="sxs-lookup"><span data-stu-id="52ecb-109">Persistence is on by default – you can shut down the host and bring it back, and the instance list is populated with the instances stored in the database.</span></span> <span data-ttu-id="52ecb-110">Отслеживание используется для передачи событий уровня <xref:System.Activities.WorkflowApplication> узлу с возможностью добавления подробного отслеживания на уровне действия.</span><span class="sxs-lookup"><span data-stu-id="52ecb-110">Tracking is used to output <xref:System.Activities.WorkflowApplication>-level events to the host with the option to add detailed tracking at the activity level.</span></span>  
  
## <a name="sample-details"></a><span data-ttu-id="52ecb-111">Подробные сведения об образце</span><span class="sxs-lookup"><span data-stu-id="52ecb-111">Sample Details</span></span>  
 <span data-ttu-id="52ecb-112">На этом узле имеются два уровня: представление и диспетчер экземпляров.</span><span class="sxs-lookup"><span data-stu-id="52ecb-112">There are two layers to this host: the view and the instance manager.</span></span> <span data-ttu-id="52ecb-113">Представление состоит из классов `HostView` и `WorkflowApplicationInfo`.</span><span class="sxs-lookup"><span data-stu-id="52ecb-113">The view consists of the `HostView` and `WorkflowApplicationInfo` classes.</span></span> <span data-ttu-id="52ecb-114">Общим шаблоном для этого узла является то, что класс `HostView` должен отображать для пользователя доступные параметры на основе объектов `WorkflowApplicationInfo`, для которых поддерживается приемлемая степень синхронизации с экземплярами, которые они представляют.</span><span class="sxs-lookup"><span data-stu-id="52ecb-114">The general pattern for this host is for the `HostView` class to display available options to the user based on `WorkflowApplicationInfo` objects that are kept reasonably in synchronization with the instances they represent.</span></span> <span data-ttu-id="52ecb-115">Уровень диспетчера экземпляров состоит из класса `WorkflowApplicationManager`, который является ядром связи узла, и класса `WorkflowDefinitionExtension`, сохраняющего связь между экземпляром и определением программы, с которым он был запущен, и нескольких других классов.</span><span class="sxs-lookup"><span data-stu-id="52ecb-115">The instance manager layer consists of the `WorkflowApplicationManager` class, which is the core of all host communications, and the `WorkflowDefinitionExtension` class, which persists the relationship between an instance and the program definition it was started with and a few other classes.</span></span> <span data-ttu-id="52ecb-116">Представление `HostView` вызывает операции управления применительно к `WorkflowApplicationManager`.</span><span class="sxs-lookup"><span data-stu-id="52ecb-116">The `HostView` calls control operations on the `WorkflowApplicationManager`.</span></span> <span data-ttu-id="52ecb-117">Эти вызовы обычно являются асинхронными, что позволяет иметь быстро реагирующий пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="52ecb-117">These calls are typically asynchronous to maintain a responsive user interface.</span></span> <span data-ttu-id="52ecb-118">После завершения асинхронных вызовов диспетчер `WorkflowApplicationManager` выполняет обратные вызовы на уровень представления через полностью определенный интерфейс (`IHostView`).</span><span class="sxs-lookup"><span data-stu-id="52ecb-118">When the asynchronous calls complete, the `WorkflowApplicationManager` makes calls back into the view layer through a well-defined interface (`IHostView`).</span></span> <span data-ttu-id="52ecb-119">Класс `HostView` чаще всего планирует эти вызовы из класса `WorkflowApplicationManager` в поток пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="52ecb-119">The `HostView` class most often dispatches these calls from the `WorkflowApplicationManager` class to the user interface thread.</span></span> <span data-ttu-id="52ecb-120">Запись текста выполняется в потокобезопасные объекты <xref:System.Activities.Statements.WriteLine.TextWriter%2A>, предоставленные классом `HostView`.</span><span class="sxs-lookup"><span data-stu-id="52ecb-120">Text writing is done to thread-safe <xref:System.Activities.Statements.WriteLine.TextWriter%2A> objects provided by the `HostView` class.</span></span> <span data-ttu-id="52ecb-121">Пользовательский интерфейс не является единственным объектом, создающим события.</span><span class="sxs-lookup"><span data-stu-id="52ecb-121">The user interface is not the only thing generating events.</span></span> <span data-ttu-id="52ecb-122">Объекты <xref:System.Activities.WorkflowApplication> также передают сообщения диспетчеру `WorkflowApplicationManager`, например переходя в состояние `Idle`, `Complete` или находясь в состоянии `Aborted`.</span><span class="sxs-lookup"><span data-stu-id="52ecb-122">The <xref:System.Activities.WorkflowApplication> objects also signal the `WorkflowApplicationManager` when they go `Idle`, `Complete`, or are `Aborted`, for example.</span></span> <span data-ttu-id="52ecb-123">Класс `WorkflowApplicationManager` выходит из потока событий, планируя очистку или обновление работы на узле.</span><span class="sxs-lookup"><span data-stu-id="52ecb-123">The `WorkflowApplicationManager` class gets off the event thread by dispatching clean up or updating work to the host.</span></span>  
  
 <span data-ttu-id="52ecb-124">Запись файла, используемого для запуска приложения <xref:System.Activities.WorkflowApplication>, упрощается с помощью класса `WorkflowDefinitionExtension`.</span><span class="sxs-lookup"><span data-stu-id="52ecb-124">The recording of the file used to launch a <xref:System.Activities.WorkflowApplication> is facilitated by the `WorkflowDefinitionExtension` class.</span></span> <span data-ttu-id="52ecb-125">Он реализует интерфейс <xref:System.Activities.Persistence.PersistenceIOParticipant> для участия в сохраняемости и сохранения пути к определению рабочего потока.</span><span class="sxs-lookup"><span data-stu-id="52ecb-125">It implements the <xref:System.Activities.Persistence.PersistenceIOParticipant> interface to participate in persistence and persist the path to the workflow definition.</span></span>  
  
 <span data-ttu-id="52ecb-126">Метод `WorkflowApplicationManager.Load` использует сохраненный путь для создания экземпляров программ рабочего процесса, необходимых для загрузки незавершенных объектов <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="52ecb-126">The `WorkflowApplicationManager.Load` method uses the stored path to instantiate the workflow programs required for loading unfinished <xref:System.Activities.WorkflowApplication> objects.</span></span>  
  
#### <a name="to-set-up-build-and-run-the-sample"></a><span data-ttu-id="52ecb-127">Настройка, сборка и выполнение образца</span><span class="sxs-lookup"><span data-stu-id="52ecb-127">To set up, build, and run the sample</span></span>  
  
1.  <span data-ttu-id="52ecb-128">Для этого образца необходимо установить SQL Express.</span><span class="sxs-lookup"><span data-stu-id="52ecb-128">This sample requires SQL Express to be installed.</span></span> <span data-ttu-id="52ecb-129">SQL Express входит в состав [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span><span class="sxs-lookup"><span data-stu-id="52ecb-129">SQL Express comes with [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].</span></span>  
  
2.  <span data-ttu-id="52ecb-130">Откройте командную строку Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="52ecb-130">Open a Visual Studio 2010 command prompt.</span></span>  
  
3.  <span data-ttu-id="52ecb-131">Перейдите в каталог образцов (\WF\Basic\Execution\ControllingWorkflowApplications) и запустите CreateInstanceStore.cmd.</span><span class="sxs-lookup"><span data-stu-id="52ecb-131">Navigate to the sample directory (\WF\Basic\Execution\ControllingWorkflowApplications) and run CreateInstanceStore.cmd.</span></span>  
  
4.  <span data-ttu-id="52ecb-132">Скрипт CreateInstanceStore.cmd создает базу данных в экземпляре SQL Server 2008 Express по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="52ecb-132">The CreateInstanceStore.cmd script attempts to create the database on the default instance of SQL Server 2008 Express.</span></span> <span data-ttu-id="52ecb-133">Чтобы установить базу данных в другом экземпляре, измените скрипт.</span><span class="sxs-lookup"><span data-stu-id="52ecb-133">If you want to install the database on a different instance, modify the script to do so.</span></span>  
  
5.  <span data-ttu-id="52ecb-134">Скомпилируйте проект WorkflowApplicationReadLineHost и запустите его из командной строки.</span><span class="sxs-lookup"><span data-stu-id="52ecb-134">Compile the WorkflowApplicationReadLineHost project and run it from the command line.</span></span>  
  
6.  <span data-ttu-id="52ecb-135">После запуска проекта сохраняемость можно по желанию включать или выключать.</span><span class="sxs-lookup"><span data-stu-id="52ecb-135">Once running, you can optionally turn persistence off or on.</span></span> <span data-ttu-id="52ecb-136">Кроме того, можно произвольно включать или выключать подробное отслеживание действия.</span><span class="sxs-lookup"><span data-stu-id="52ecb-136">Further, you can optionally turn detailed activity tracking on or off.</span></span>  
  
7.  <span data-ttu-id="52ecb-137">Нажмите кнопку с многоточием рядом с **запуска** кнопку для просмотра рабочего процесса, определенные в XAML-файле</span><span class="sxs-lookup"><span data-stu-id="52ecb-137">Press the ellipsis button next to the **Run** button to browse for a workflow defined in a XAML file</span></span>  
  
     <span data-ttu-id="52ecb-138">В папке SampleWorkflows находятся два образца.</span><span class="sxs-lookup"><span data-stu-id="52ecb-138">Two samples can be found under the SampleWorkflows folder.</span></span> <span data-ttu-id="52ecb-139">Пример parallel1.xaml переходит в состояние бездействия.</span><span class="sxs-lookup"><span data-stu-id="52ecb-139">The parallel1.xaml example goes idle.</span></span>  
  
8.  <span data-ttu-id="52ecb-140">После выбора примера клавишу **запуска** кнопки.</span><span class="sxs-lookup"><span data-stu-id="52ecb-140">Once an example is selected, press the **Run** button.</span></span>  
  
9. <span data-ttu-id="52ecb-141">Если или рабочий процесс переходит в состояние бездействия, **закладки** содержит поле со списком доступных закладок.</span><span class="sxs-lookup"><span data-stu-id="52ecb-141">If or when the workflow goes idle, the **Bookmarks** combo box is populated with available bookmarks.</span></span>  
  
10. <span data-ttu-id="52ecb-142">В этот момент можно выбрать возобновление закладки, отмену, прерывание или завершение рабочего процесса.</span><span class="sxs-lookup"><span data-stu-id="52ecb-142">The options at this point are to resume a bookmark, cancel, abort, or terminate the workflow.</span></span> <span data-ttu-id="52ecb-143">Можно также остановить и перезапустить узел.</span><span class="sxs-lookup"><span data-stu-id="52ecb-143">You can also shut down the host and restart it.</span></span> <span data-ttu-id="52ecb-144">Если сохраняемость оставлена включенной, экземпляры выгружаются при останове и снова загружаются при запуске.</span><span class="sxs-lookup"><span data-stu-id="52ecb-144">If persistence is left on, the instances are unloaded on shutdown and reloaded on start up.</span></span>  
  
     <span data-ttu-id="52ecb-145">Чтобы возобновить закладку, выберите требуемую закладку, введите значение в текстовом поле рядом со списком и нажмите кнопку **возобновить закладку**.</span><span class="sxs-lookup"><span data-stu-id="52ecb-145">To resume a bookmark, select the desired bookmark, type in a value in the text box next to the combo box and press **Resume Bookmark**.</span></span>  
  
#### <a name="to-remove-the-instance-store-database"></a><span data-ttu-id="52ecb-146">Удаление базы данных хранилища экземпляров</span><span class="sxs-lookup"><span data-stu-id="52ecb-146">To remove the instance store database</span></span>  
  
1.  <span data-ttu-id="52ecb-147">Откройте командную строку Visual Studio 2010.</span><span class="sxs-lookup"><span data-stu-id="52ecb-147">Open a Visual Studio 2010 command prompt.</span></span>  
  
2.  <span data-ttu-id="52ecb-148">Перейдите в каталог образцов (\WF\Basic\Execution\ControllingWorkflowApplications) и запустите RemoveInstanceStore.cmd.</span><span class="sxs-lookup"><span data-stu-id="52ecb-148">Navigate to the sample directory (\WF\Basic\Execution\ControllingWorkflowApplications) and run RemoveInstanceStore.cmd.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="52ecb-149">Образцы уже могут быть установлены на компьютере.</span><span class="sxs-lookup"><span data-stu-id="52ecb-149">The samples may already be installed on your machine.</span></span> <span data-ttu-id="52ecb-150">Перед продолжением проверьте следующий каталог (по умолчанию).</span><span class="sxs-lookup"><span data-stu-id="52ecb-150">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="52ecb-151">Если этот каталог не существует, перейдите на страницу [Примеры Windows Communication Foundation (WCF) и Windows Workflow Foundation (WF) для .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) , чтобы скачать все примеры [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] и [!INCLUDE[wf1](../../../../includes/wf1-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="52ecb-151">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="52ecb-152">Этот образец расположен в следующем каталоге.</span><span class="sxs-lookup"><span data-stu-id="52ecb-152">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Execution\ControllingWorkflowApplications`