---
title: Узел ReadLine экземпляра WorkflowApplication
ms.date: 03/30/2017
ms.assetid: f7b362be-cb42-40d7-b9ef-cfc4aed2455b
ms.openlocfilehash: 4388ff0285de58b0dc6f86af93aad84b2894373f
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/04/2018
ms.locfileid: "43502939"
---
# <a name="workflowapplication-readline-host"></a>Узел ReadLine экземпляра WorkflowApplication
Этот образец представляет собой универсальный узел ReadLine. С помощью имеющегося действия `ReadLine` (или других действий, подобных тем, которые возвращают данные из закладок, возобновленных со строками) можно загружать и запускать любой рабочий процесс. Выходные данные из действия `WriteLine` или любого другого, выполняющего запись в расширение <xref:System.Activities.Statements.WriteLine.TextWriter%2A>, направляются в окно узла. Если экземпляр бездействует, в поле со списком отображаются имеющиеся в нем закладки. Если выбрать закладку, ввести некоторый текст и нажать кнопку возобновления закладки, то выполнение рабочего процесса будет продолжено. Можно также отменить, прервать или завершить выбранный рабочий процесс. По умолчанию сохраняемость включена - можно остановить узел и снова его запустить, список экземпляров при этом будет заполнен экземплярами, сохраненными в базе данных. Отслеживание используется для передачи событий уровня <xref:System.Activities.WorkflowApplication> узлу с возможностью добавления подробного отслеживания на уровне действия.  
  
## <a name="sample-details"></a>Подробные сведения об образце  
 На этом узле имеются два уровня: представление и диспетчер экземпляров. Представление состоит из классов `HostView` и `WorkflowApplicationInfo`. Общим шаблоном для этого узла является то, что класс `HostView` должен отображать для пользователя доступные параметры на основе объектов `WorkflowApplicationInfo`, для которых поддерживается приемлемая степень синхронизации с экземплярами, которые они представляют. Уровень диспетчера экземпляров состоит из класса `WorkflowApplicationManager`, который является ядром связи узла, и класса `WorkflowDefinitionExtension`, сохраняющего связь между экземпляром и определением программы, с которым он был запущен, и нескольких других классов. Представление `HostView` вызывает операции управления применительно к `WorkflowApplicationManager`. Эти вызовы обычно являются асинхронными, что позволяет иметь быстро реагирующий пользовательский интерфейс. После завершения асинхронных вызовов диспетчер `WorkflowApplicationManager` выполняет обратные вызовы на уровень представления через полностью определенный интерфейс (`IHostView`). Класс `HostView` чаще всего планирует эти вызовы из класса `WorkflowApplicationManager` в поток пользовательского интерфейса. Запись текста выполняется в потокобезопасные объекты <xref:System.Activities.Statements.WriteLine.TextWriter%2A>, предоставленные классом `HostView`. Пользовательский интерфейс не является единственным объектом, создающим события. Объекты <xref:System.Activities.WorkflowApplication> также передают сообщения диспетчеру `WorkflowApplicationManager`, например переходя в состояние `Idle`, `Complete` или находясь в состоянии `Aborted`. Класс `WorkflowApplicationManager` выходит из потока событий, планируя очистку или обновление работы на узле.  
  
 Запись файла, используемого для запуска приложения <xref:System.Activities.WorkflowApplication>, упрощается с помощью класса `WorkflowDefinitionExtension`. Он реализует интерфейс <xref:System.Activities.Persistence.PersistenceIOParticipant> для участия в сохраняемости и сохранения пути к определению рабочего потока.  
  
 Метод `WorkflowApplicationManager.Load` использует сохраненный путь для создания экземпляров программ рабочего процесса, необходимых для загрузки незавершенных объектов <xref:System.Activities.WorkflowApplication>.  
  
#### <a name="to-set-up-build-and-run-the-sample"></a>Настройка, сборка и выполнение образца  
  
1.  Для этого образца необходимо установить SQL Express. SQL Express входит в состав [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)].  
  
2.  Откройте командную строку Visual Studio 2010.  
  
3.  Перейдите в каталог образцов (\WF\Basic\Execution\ControllingWorkflowApplications) и запустите CreateInstanceStore.cmd.  
  
4.  Скрипт CreateInstanceStore.cmd создает базу данных в экземпляре SQL Server 2008 Express по умолчанию. Чтобы установить базу данных в другом экземпляре, измените скрипт.  
  
5.  Скомпилируйте проект WorkflowApplicationReadLineHost и запустите его из командной строки.  
  
6.  После запуска проекта сохраняемость можно по желанию включать или выключать. Кроме того, можно произвольно включать или выключать подробное отслеживание действия.  
  
7.  Нажмите кнопку с многоточием рядом с полем **запуска** кнопки для просмотра рабочего процесса, определенного в файле XAML  
  
     В папке SampleWorkflows находятся два образца. Пример parallel1.xaml переходит в состояние бездействия.  
  
8.  После выбора примера нажмите **запуска** кнопки.  
  
9. Если или рабочий процесс переходит в состояние бездействия, **закладки** содержит поле со списком доступных закладок.  
  
10. В этот момент можно выбрать возобновление закладки, отмену, прерывание или завершение рабочего процесса. Можно также остановить и перезапустить узел. Если сохраняемость оставлена включенной, экземпляры выгружаются при останове и снова загружаются при запуске.  
  
     Чтобы возобновить закладку, выберите требуемую закладку, введите значение в текстовом поле рядом со списком и нажмите кнопку **возобновить закладку**.  
  
#### <a name="to-remove-the-instance-store-database"></a>Удаление базы данных хранилища экземпляров  
  
1.  Откройте командную строку Visual Studio 2010.  
  
2.  Перейдите в каталог образцов (\WF\Basic\Execution\ControllingWorkflowApplications) и запустите RemoveInstanceStore.cmd.  
  
> [!IMPORTANT]
>  Образцы уже могут быть установлены на компьютере. Перед продолжением проверьте следующий каталог (по умолчанию).  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  Если этот каталог не существует, перейдите к [Windows Communication Foundation (WCF) и образцы Windows Workflow Foundation (WF) для .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) для загрузки всех Windows Communication Foundation (WCF) и [!INCLUDE[wf1](../../../../includes/wf1-md.md)] примеры. Этот образец расположен в следующем каталоге.  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Execution\ControllingWorkflowApplications`