---
title: "Документы в WPF | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-wpf"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "документы, просматриваемые в браузере"
  - "документы, просматриваемые в браузере"
  - "документы, элементы управления"
  - "документы, упаковка"
  - "документы, макет текста"
  - "документы, типы"
  - "документы, XPS"
  - "упаковка документов"
  - "XPS-документы"
ms.assetid: 6e8db7bc-050a-4070-aa72-bb8c46e87ff8
caps.latest.revision: 36
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 35
---
# Документы в WPF
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] предлагает широкий диапазон свойств документа, который позволяет создавать содержимое высокого качества, предназначенное для более легкого доступа и чтения, чем в предыдущих поколениях [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)].  В дополнение к расширенным возможностям и качеству приложение [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] также предоставляет интегрированные службы для отображения документов, упаковки и безопасности.  Этот раздел содержит введение в типы документов [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] и упаковку документов.  
  
   
  
<a name="types_of_documents"></a>   
## Типы документов  
 Приложение [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] разделяет документы на две основные категории на основе их предполагаемого использования; эти категории документов называются "документы фиксированного формата" и "документы нефиксированного формата".  
  
 Документы фиксированного формата предназначены для приложений, требующих точного представления в режиме [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)], независимо от используемого дисплея или принтера.  Документы фиксированного формата обычно используются при подготовке публикаций с помощью настольных издательских средств, обработке текста и разметке формы, где строгое соблюдение исходного дизайна страницы является обязательным.  Документы фиксированного формата, как часть макета, поддерживает точное позиционирование содержимого элементов, независимо от используемых устройств отображения или печати.  Например, страница формата фиксированного документа, просматриваемая на экране с разрешением 96 точек на дюйм, будет отображаться точно так же на выводе лазерного принтера с разрешением 600 точек на дюйм или устройстве фотовывода с разрешением 4800 точек на дюйм.  Макет страницы остается неизменным во всех случаях, в то время как качество документа повышается в соответствии с возможностями каждого устройства.  
  
 Для сравнения, документы нефиксированного формата предназначены для оптимизации просмотра и удобочитаемости и наиболее удобны в использовании, когда простота чтения является основным требованием скрипта документа.  Документы нефиксированного формата не зависят от предварительно определенного макета, а динамически изменяют и переформатируют свое содержимое на основе переменных времени выполнения \(например, размера окна и разрешения устройства\) и дополнительных пользовательских настроек.  Веб\-страница представляет собой простой пример документа нефиксированного формата, где содержимое страницы динамически форматируется в соответствии с размерами текущего окна.  В зависимости от среды выполнения, документы нефиксированного формата оптимизируют просмотр и чтение для пользователя.  Например, один тот же документ нефиксированного формата будет динамически переформатирован для оптимальной удобочитаемости как на 19\-дюймовом экране с высоким разрешением, так и на небольшом 2x3\-дюймовом экране карманного ПК.  Кроме того, документы нефиксированного формата имеют множество встроенных возможностей, включая поиск, просмотр режимов оптимизации удобочитаемости и возможность изменения размера и вида шрифтов.  Более подробные сведения о документах нефиксированного формата, примеры и иллюстрации содержатся в разделе [Общие сведения о документе нефиксированного формата](../../../../docs/framework/wpf/advanced/flow-document-overview.md).  
  
<a name="document_viewer"></a>   
## Элементы управления документом и разметка текста  
 Компонент [!INCLUDE[TLA2#tla_avalonwinfx](../../../../includes/tla2sharptla-avalonwinfx-md.md)] предоставляет набор встроенных элементов управления, которые упрощают использование документов фиксированного формата, документов нефиксированного формата и основного текста в приложении.  Отображение содержимого формата фиксированного документа поддерживается с помощью элемента управления <xref:System.Windows.Controls.DocumentViewer>.  Отображение содержимого документа нефиксированного формат поддерживается с помощью трех различных элементов управления <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer> и <xref:System.Windows.Controls.FlowDocumentScrollViewer>, которые сопоставлены разным пользовательским скриптам \(см. разделы ниже\).  Другие элементы управления[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] предоставляют упрощенную разметку для поддержки использования основного текста \(см. ниже раздел [Текст в пользовательском интерфейсе](#text_in_the_user_interface)\).  
  
### Элемент управления формата фиксированного документа — DocumentViewer  
 Элемент управления <xref:System.Windows.Controls.DocumentViewer> предназначен для отображения содержимого <xref:System.Windows.Documents.FixedDocument>.  Элемент управления <xref:System.Windows.Controls.DocumentViewer> обеспечивает интуитивно понятный пользовательский интерфейс, который предоставляет встроенную поддержку общих операций, включая вывод на печать, копирование в буфер обмена, масштабирование и возможности поиска текста.  Этот элемент управления предоставляет доступ к страницам содержимого с помощью хорошо знакомого механизма прокрутки.  Как и все элементы управления, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], <xref:System.Windows.Controls.DocumentViewer> поддерживает полное или частичное изменение стиля, что позволяет визуально интегрировать элемент управления, фактически, в любое приложение или среду.  
  
 Элемент управления <xref:System.Windows.Controls.DocumentViewer> предназначен для отображения содержимого в режиме только для чтения; редактирование или изменение содержимого недоступно и не поддерживается.  
  
<a name="flow_document"></a>   
### Элементы управления документами нефиксированного формата  
 **Примечание.** Более подробно о возможностях документов нефиксированного формата и способах их создания см. в разделе [Общие сведения о документе нефиксированного формата](../../../../docs/framework/wpf/advanced/flow-document-overview.md).  
  
 Отображение содержимого документа фиксированного формата поддерживается тремя элементами управления: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer> и <xref:System.Windows.Controls.FlowDocumentScrollViewer>.  
  
#### Элемент управления FlowDocumentReader  
 <xref:System.Windows.Controls.FlowDocumentReader> включает возможности, позволяющие пользователю динамически выбирать различные режимы просмотра, включая одностраничный \(постраничный\), двухстраничный \(книжный формат\) и режим просмотра непрерывной прокрутки \(«без дна»\).  Дополнительные сведения об этих режимах просмотра содержатся в разделе <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>.  Если динамическое переключение между режимами просмотра не требуется, элементы управления <xref:System.Windows.Controls.FlowDocumentPageViewer> и <xref:System.Windows.Controls.FlowDocumentScrollViewer> предоставляют облегченные средства просмотра содержимого документа нефиксированного формата, закрепленные для определенного режима просмотра.  
  
#### FlowDocumentPageViewer и FlowDocumentScrollViewer  
 Элемент управления <xref:System.Windows.Controls.FlowDocumentPageViewer> отображает содержимое в режиме постраничного просмотра, а <xref:System.Windows.Controls.FlowDocumentScrollViewer> отображает содержимое в режиме непрерывной прокрутки.  Оба элемента управления <xref:System.Windows.Controls.FlowDocumentPageViewer> и <xref:System.Windows.Controls.FlowDocumentScrollViewer> предназначены только для конкретного режима просмотра.  Это отличает их от элемента управления <xref:System.Windows.Controls.FlowDocumentReader>, который включает в себя возможности, позволяющие пользователю динамически выбирать различные режимы просмотра \(представленные перечислением <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>\), что делает его более ресурсоемким, чем элементы управления <xref:System.Windows.Controls.FlowDocumentPageViewer> или <xref:System.Windows.Controls.FlowDocumentScrollViewer>.  
  
 По умолчанию вертикальная полоса прокрутки отображается всегда, а горизонтальная становится видимой при необходимости.  По умолчанию [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] объекта <xref:System.Windows.Controls.FlowDocumentScrollViewer> не содержит панели инструментов; однако для включения встроенной панели инструментов можно использовать свойство <xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A>.  
  
<a name="text_in_the_user_interface"></a>   
### Текст в пользовательском интерфейсе  
 Помимо добавления в документы, текст, разумеется, может быть использован в пользовательском интерфейсе приложения, как, например, формы.  В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] представлен ряд элементов управления для рисования текста на экране.  Каждый элемент управления предназначен для различных скриптов и содержит собственный список функций и ограничений.  В целом, элемент <xref:System.Windows.Controls.TextBlock> следует использовать, если требуется ограниченная поддержка текста, например для короткого предложения, которое нужно вставить в [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].  <xref:System.Windows.Controls.Label> может использоваться, если необходима минимальная поддержка текста.  Дополнительные сведения см. в разделе [Общие сведения о TextBlock](../../../../docs/framework/wpf/controls/textblock-overview.md).  
  
<a name="packaging"></a>   
## Упаковка документа  
 [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] пространства имен <xref:System.IO.Packaging> предоставляют эффективные средства для организации данных приложения, содержимого документов и связанных ресурсов в одном контейнере, который обеспечивает простой доступ, портативность и легкость распределения.  ZIP\-файл является примером типа <xref:System.IO.Packaging.Package>, который может хранить нескольких объектов, как один структурный элемент.  [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] упаковки обеспечивают реализацию объекта <xref:System.IO.Packaging.ZipPackage> по умолчанию, разработанную с использованием стандарта Open Packaging Convention с архитектурой XML и ZIP\-файла.  [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] упаковки приложения [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] делают простым создание пакетов, хранение в них объектов и доступ к ним.  Объект, хранящийся в <xref:System.IO.Packaging.Package>, называется <xref:System.IO.Packaging.PackagePart> \("часть"\).  Пакеты могут также включать подписанные цифровые сертификаты, которые можно использовать для идентификации создателя части и проверки того, что содержимое пакета не было изменено.  Пакеты также включают средство <xref:System.IO.Packaging.PackageRelationship>, позволяющее добавлять дополнительные сведения в пакет или связывать их с определенным частями без фактического изменения содержимого существующих частей.  Службы пакета также поддерживают [!INCLUDE[TLA#tla_rm](../../../../includes/tlasharptla-rm-md.md)].  
  
 Архитектура [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Package служит основой для большого числа ключевых технологий:  
  
-   Документы [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)], удовлетворяющие [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)].  
  
-   Документы открытого XML\-формата Microsoft Office "12" \(docx\).  
  
-   Пользовательские форматы хранения для разработки собственного приложения.  
  
 Основанный на API упаковки, объект <xref:System.Windows.Xps.Packaging.XpsDocument> специально разработаны для хранения документов с фиксированным содержимым [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  <xref:System.Windows.Xps.Packaging.XpsDocument> — это автономный документ, который можно открыть в средстве просмотра, отображенный в элементе управления <xref:System.Windows.Controls.DocumentViewer>, маршрутизированный в очередь печати или непосредственно на вывод [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]\-совместимого принтера.  
  
 Следующие разделы содержат дополнительные сведения об [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] <xref:System.IO.Packaging.Package> и <xref:System.Windows.Xps.Packaging.XpsDocument>, предоставляемых с приложением [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  
  
<a name="packages"></a>   
### Компоненты пакета  
 API упаковки приложения [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] позволяют организовывать данные приложения и документы в один портативный структурный элемент.  ZIP\-файл является одним из наиболее распространенных типов пакетов и по умолчанию используется с [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  <xref:System.IO.Packaging.Package> ― это абстрактный класс, из которого реализуется <xref:System.IO.Packaging.ZipPackage> с использованием открытой стандартной архитектуры XML и ZIP\-файлов.  Метод <xref:System.IO.Packaging.Package.Open%2A> использует объект <xref:System.IO.Packaging.ZipPackage> для создания и использования ZIP\-файлов по умолчанию.  Пакет может содержать три основных типа элементов:  
  
|||  
|-|-|  
|<xref:System.IO.Packaging.PackagePart>|Содержимое приложения, данные, документы и файлы ресурсов.|  
|<xref:System.IO.Packaging.PackageDigitalSignature>|[Сертификат X.509](GTMT) для идентификации, аутентификации и проверки подлинности.|  
|<xref:System.IO.Packaging.PackageRelationship>|Добавленные сведения, относящиеся к пакету или отдельной части.|  
  
<a name="PackageParts"></a>   
#### PackageParts  
 <xref:System.IO.Packaging.PackagePart> \("часть"\) — это абстрактный класс, который ссылается на объект, хранящийся в объекте <xref:System.IO.Packaging.Package>.  В ZIP\-файле части пакета соответствуют отдельным файлам, содержащимся в ZIP\-файле.  <xref:System.IO.Packaging.ZipPackagePart> предоставляет реализацию по умолчанию для сериализуемых объектов, хранящихся в <xref:System.IO.Packaging.ZipPackage>.  Подобно файловой системе, части, содержащиеся в пакете, хранятся в иерархическом каталоге или в структуре "в стиле папки".  Используя API упаковки [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], приложения могут записывать, хранить и считывать нескольких объектов <xref:System.IO.Packaging.PackagePart>, используя один контейнер ZIP\-файла.  
  
<a name="PackageDigitalSignatures"></a>   
#### PackageDigitalSignatures  
 В целях безопасности объект <xref:System.IO.Packaging.PackageDigitalSignature> \("цифровая подпись"\) может быть связан с частями внутри пакета.  <xref:System.IO.Packaging.PackageDigitalSignature> включает сертификат [509](GTMT), предоставляющий две возможности:  
  
1.  Идентификация и проверка подлинности создателя части.  
  
2.  Проверка того, что часть не была изменена.  
  
 Цифровая подпись не защищает часть от изменения, но проверка цифровой подписи завершится ошибкой, если часть была каким\-либо образом изменена.  Затем приложение может предпринять соответствующее действие — например, заблокировать открытие части или уведомить пользователя, что часть была изменена и не является безопасной.  
  
<a name="PackageRelationships"></a>   
#### PackageRelationships  
 Объект <xref:System.IO.Packaging.PackageRelationship> \("отношение"\) обеспечивает механизм сопоставления дополнительных сведений с пакетом или частью в пакете.  Отношение — это возможность уровня пакета, которая может связать дополнительные сведения с частью, не изменяя фактического содержимого части.  Вставка новых данных непосредственно в содержимое части обычно не используются по многим причинам:  
  
-   Фактический тип части и схема содержимого неизвестны.  
  
-   Даже если известны, схема содержимого может не предоставлять средств для добавления новых данных.  
  
-   Часть может быть защищена от любых изменений цифровой подписью или шифрованием.  
  
 Отношения пакета предоставляют видимые средства для добавления дополнительных сведений и сопоставления их с отдельными частями или всем пакетом.  Отношения пакета используются для двух основных возможностей:  
  
1.  Определение отношений зависимостей из одной части в другую.  
  
2.  Определение отношений данных, добавляющих заметки или другие данные, относящиеся к частям.  
  
 Объект <xref:System.IO.Packaging.PackageRelationship> предоставляет быстрые, видимые средства для определения зависимостей и добавления дополнительных сведений, связанных с частью или всем пакетом.  
  
<a name="Dependency_Relationships"></a>   
##### Отношения зависимостей  
 Отношения зависимостей используются для описания зависимостей, которые одна часть создает с другими.  Например, пакет может содержать HTML\-часть, включающую один или несколько тегов изображения \<img\>.  Теги изображения ссылаются на изображения, расположенные внутри пакета, как другие части, либо вне пакета, например — доступные через Интернет.  Создание объекта <xref:System.IO.Packaging.PackageRelationship>, связанного с файлом HTML, делает обнаружение и доступ к зависимым ресурсам быстрее и проще.  Браузер или приложение средства просмотра может непосредственно обратиться к отношениям части и сразу начать сборку зависимых ресурсов без знания схемы или синтаксического анализа документа.  
  
<a name="Information_Relationships"></a>   
##### Отношения данных  
 Кроме примечания или комментария объект <xref:System.IO.Packaging.PackageRelationship> может также использоваться для хранения других типов данных, которые будут связаны с частью без необходимости фактического изменения содержимого части.  
  
<a name="XPS_Documents"></a>   
## Документы XPS  
 Документ [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] ― это пакет, содержащий один или несколько документов фиксированного формата вместе со всеми ресурсами и сведениями, необходимыми для отрисовки.  [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] также является собственным форматом файла очереди печати для [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].  Объект <xref:System.Windows.Xps.Packaging.XpsDocument> хранится в стандартном наборе данных ZIP; он может включать комбинацию XML и двоичных компонентов, таких как файлы изображений и шрифтов. Для определения зависимостей между содержимым и ресурсами, необходимыми для полного отображения документа, используются связи [PackageRelationships](#PackageRelationships).  Структура <xref:System.Windows.Xps.Packaging.XpsDocument> предоставляет простое решение документа высокого качества, которое поддерживает повторное использование:  
  
-   Чтение, запись и хранение содержимого формата фиксированного документа и ресурсов в виде единого, портативного и легко распределяемого файла.  
  
-   Отображение документов с помощью приложения [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Viewer.  
  
-   Вывод документов в собственном формате вывода очереди печати [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].  
  
-   Маршрутизация документов непосредственно на [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]\-совместимый принтер.  
  
## См. также  
 <xref:System.Windows.Documents.FixedDocument>   
 <xref:System.Windows.Documents.FlowDocument>   
 <xref:System.Windows.Xps.Packaging.XpsDocument>   
 <xref:System.IO.Packaging.ZipPackage>   
 <xref:System.IO.Packaging.ZipPackagePart>   
 <xref:System.IO.Packaging.PackageRelationship>   
 <xref:System.Windows.Controls.DocumentViewer>   
 [Text](../../../../docs/framework/wpf/advanced/optimizing-performance-text.md)   
 [Общие сведения о документе нефиксированного формата](../../../../docs/framework/wpf/advanced/flow-document-overview.md)   
 [Общие сведения о печати](../../../../docs/framework/wpf/advanced/printing-overview.md)   
 [Сериализация и хранение документов](../../../../docs/framework/wpf/advanced/document-serialization-and-storage.md)