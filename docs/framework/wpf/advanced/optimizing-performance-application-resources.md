---
title: 'Оптимизация производительности: ресурсы приложения'
ms.date: 03/30/2017
helpviewer_keywords:
- application resources [WPF], performance
- resources [WPF], performance
- static resources [WPF]
- sharing resources [WPF]
- brushes [WPF], performance
- sharing brushes without copying [WPF]
ms.assetid: 62b88488-c08e-4804-b7de-a1c34fbe929c
ms.openlocfilehash: 53e906f31f32fb0f1df3f8d986daa0ae95ea9e4c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="optimizing-performance-application-resources"></a><span data-ttu-id="2656c-102">Оптимизация производительности: ресурсы приложения</span><span class="sxs-lookup"><span data-stu-id="2656c-102">Optimizing Performance: Application Resources</span></span>
[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="2656c-103"> позволяет совместно использовать ресурсы приложения, чтобы можно поддерживать согласованный внешний вид или поведение с помощью элементов одинакового типа.</span><span class="sxs-lookup"><span data-stu-id="2656c-103"> allows you to share application resources so that you can support a consistent look or behavior across similar-typed elements.</span></span> <span data-ttu-id="2656c-104">Этот раздел содержит несколько рекомендаций в этой области, которые могут помочь повысить производительность приложений.</span><span class="sxs-lookup"><span data-stu-id="2656c-104">This topic provides a few recommendations in this area that can help you improve the performance of your applications.</span></span>  
  
 <span data-ttu-id="2656c-105">Дополнительные сведения о ресурсах см. в разделе [Ресурсы XAML](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span><span class="sxs-lookup"><span data-stu-id="2656c-105">For more information on resources, see [XAML Resources](../../../../docs/framework/wpf/advanced/xaml-resources.md).</span></span>  
  
## <a name="sharing-resources"></a><span data-ttu-id="2656c-106">Совместное использование ресурсов</span><span class="sxs-lookup"><span data-stu-id="2656c-106">Sharing resources</span></span>  
 <span data-ttu-id="2656c-107">Если приложение использует пользовательские элементы управления и определяет ресурсы в <xref:System.Windows.ResourceDictionary> (или узле ресурсов XAML), рекомендуется определить ресурсы на <xref:System.Windows.Application> или <xref:System.Windows.Window> объекта уровень или указать их в тему по умолчанию для пользовательские элементы управления.</span><span class="sxs-lookup"><span data-stu-id="2656c-107">If your application uses custom controls and defines resources in a <xref:System.Windows.ResourceDictionary> (or XAML Resources node), it is recommended that you either define the resources at the <xref:System.Windows.Application> or <xref:System.Windows.Window> object level, or define them in the default theme for the custom controls.</span></span> <span data-ttu-id="2656c-108">Определение ресурсов в пользовательский элемент управления <xref:System.Windows.ResourceDictionary> оказывает влияние на производительность для всех экземпляров этого элемента управления.</span><span class="sxs-lookup"><span data-stu-id="2656c-108">Defining resources in a custom control's <xref:System.Windows.ResourceDictionary> imposes a performance impact for every instance of that control.</span></span> <span data-ttu-id="2656c-109">Например при наличии кисти ресурсоемких операций, определенных как часть определения ресурсов для пользовательского элемента управления и несколько экземпляров элемента управления рабочего набора приложения увеличит значительно.</span><span class="sxs-lookup"><span data-stu-id="2656c-109">For example, if you have performance-intensive brush operations defined as part of the resource definition of a custom control and many instances of the custom control, the application's working set will increase significantly.</span></span>  
  
 <span data-ttu-id="2656c-110">Чтобы проиллюстрировать это, рассмотрим следующее.</span><span class="sxs-lookup"><span data-stu-id="2656c-110">To illustrate this point, consider the following.</span></span> <span data-ttu-id="2656c-111">Предположим, что вы разрабатываете карты игры с использованием [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2656c-111">Let's say you are developing a card game using [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="2656c-112">Для большинства карточных играх необходимо 52 карты с 52 различными вариантами лицевой стороны.</span><span class="sxs-lookup"><span data-stu-id="2656c-112">For most card games, you need 52 cards with 52 different faces.</span></span> <span data-ttu-id="2656c-113">Чтобы реализовать пользовательский элемент управления карты и определить 52 кисти (каждый из которых представляет лицевой стороны) в ресурсах пользовательского элемента управления карты.</span><span class="sxs-lookup"><span data-stu-id="2656c-113">You decide to implement a card custom control and you define 52 brushes (each representing a card face) in the resources of your card custom control.</span></span> <span data-ttu-id="2656c-114">В главном приложении первоначально создается 52 экземпляра пользовательского элемента управления карты.</span><span class="sxs-lookup"><span data-stu-id="2656c-114">In your main application, you initially create 52 instances of this card custom control.</span></span> <span data-ttu-id="2656c-115">Каждый экземпляр элемента управления создает 52 экземпляра <xref:System.Windows.Media.Brush> объектов, которые в итоге 52 \* 52 дает <xref:System.Windows.Media.Brush> объектов в приложении.</span><span class="sxs-lookup"><span data-stu-id="2656c-115">Each instance of the card custom control generates 52 instances of <xref:System.Windows.Media.Brush> objects, which gives you a total of 52 \* 52 <xref:System.Windows.Media.Brush> objects in your application.</span></span> <span data-ttu-id="2656c-116">Перемещая кисти из ресурсов пользовательского элемента управления для <xref:System.Windows.Application> или <xref:System.Windows.Window> уровень объекта или определения их в тему по умолчанию для пользовательского элемента управления, можно уменьшить рабочее множество приложения, так как теперь общего 52 кисти 52 экземпляра элемента управления карты.</span><span class="sxs-lookup"><span data-stu-id="2656c-116">By moving the brushes out of the card custom control resources to the <xref:System.Windows.Application> or <xref:System.Windows.Window> object level, or defining them in the default theme for the custom control, you reduce the working set of the application, since you are now sharing the 52 brushes among 52 instances of the card control.</span></span>  
  
## <a name="sharing-a-brush-without-copying"></a><span data-ttu-id="2656c-117">Общее использование кисти без копирования</span><span class="sxs-lookup"><span data-stu-id="2656c-117">Sharing a Brush without Copying</span></span>  
 <span data-ttu-id="2656c-118">Если у вас есть несколько элементов, используя те же <xref:System.Windows.Media.Brush> объекта, определите кисть как ресурс и ссылки, но не определение встроенной кисти в [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2656c-118">If you have multiple elements using the same <xref:System.Windows.Media.Brush> object, define the brush as a resource and reference it, rather than defining the brush inline in [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)].</span></span> <span data-ttu-id="2656c-119">Этот метод создаст один экземпляр и повторно использует его, тогда как определение встроенной кисти в [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] создает новый экземпляр для каждого элемента.</span><span class="sxs-lookup"><span data-stu-id="2656c-119">This method will create one instance and reuse it, whereas defining brushes inline in [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] creates a new instance for each element.</span></span>  
  
 <span data-ttu-id="2656c-120">В следующем примере разметки показано:</span><span class="sxs-lookup"><span data-stu-id="2656c-120">The following markup sample illustrates this point:</span></span>  
  
 [!code-xaml[Performance#PerformanceSnippet7](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/BrushResource.xaml#performancesnippet7)]  
  
## <a name="use-static-resources-when-possible"></a><span data-ttu-id="2656c-121">Использование статических ресурсов, если это возможно</span><span class="sxs-lookup"><span data-stu-id="2656c-121">Use Static Resources when Possible</span></span>  
 <span data-ttu-id="2656c-122">Статический ресурс предоставляет значение для любого атрибута свойства XAML путем поиска ссылки на уже определенный ресурс.</span><span class="sxs-lookup"><span data-stu-id="2656c-122">A static resource provides a value for any XAML property attribute by looking up a reference to an already defined resource.</span></span> <span data-ttu-id="2656c-123">Поведение подстановки для этого ресурса является аналогом во время компиляции.</span><span class="sxs-lookup"><span data-stu-id="2656c-123">Lookup behavior for that resource is analogous to compile-time lookup.</span></span>  
  
 <span data-ttu-id="2656c-124">Динамический ресурс, с другой стороны, создаст временное выражение во время начальной компиляции и таким образом, отложит для ресурсов, пока значение запрошенного ресурса фактически требуется для создания объекта.</span><span class="sxs-lookup"><span data-stu-id="2656c-124">A dynamic resource, on the other hand, will create a temporary expression during the initial compilation and thus defer lookup for resources until the requested resource value is actually required in order to construct an object.</span></span> <span data-ttu-id="2656c-125">Поведение подстановки для этого ресурса является аналогом подстановки во время выполнения, который оказывает влияние на производительность.</span><span class="sxs-lookup"><span data-stu-id="2656c-125">Lookup behavior for that resource is analogous to run-time lookup, which imposes a performance impact.</span></span> <span data-ttu-id="2656c-126">Использование статических ресурсов, когда это возможно в приложении, с помощью динамического ресурсы только при необходимости.</span><span class="sxs-lookup"><span data-stu-id="2656c-126">Use static resources whenever possible in your application, using dynamic resources only when necessary.</span></span>  
  
 <span data-ttu-id="2656c-127">В следующем примере разметки показано использование обоих типов ресурсов:</span><span class="sxs-lookup"><span data-stu-id="2656c-127">The following markup sample shows the use of both types of resources:</span></span>  
  
 [!code-xaml[Performance#PerformanceSnippet8](../../../../samples/snippets/csharp/VS_Snippets_Wpf/Performance/CSharp/DynamicResource.xaml#performancesnippet8)]  
  
## <a name="see-also"></a><span data-ttu-id="2656c-128">См. также</span><span class="sxs-lookup"><span data-stu-id="2656c-128">See Also</span></span>  
 [<span data-ttu-id="2656c-129">Улучшение производительности приложений WPF</span><span class="sxs-lookup"><span data-stu-id="2656c-129">Optimizing WPF Application Performance</span></span>](../../../../docs/framework/wpf/advanced/optimizing-wpf-application-performance.md)  
 [<span data-ttu-id="2656c-130">Планирование производительности приложения</span><span class="sxs-lookup"><span data-stu-id="2656c-130">Planning for Application Performance</span></span>](../../../../docs/framework/wpf/advanced/planning-for-application-performance.md)  
 [<span data-ttu-id="2656c-131">Использование преимуществ оборудования</span><span class="sxs-lookup"><span data-stu-id="2656c-131">Taking Advantage of Hardware</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-taking-advantage-of-hardware.md)  
 [<span data-ttu-id="2656c-132">Разметка и разработка</span><span class="sxs-lookup"><span data-stu-id="2656c-132">Layout and Design</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-layout-and-design.md)  
 [<span data-ttu-id="2656c-133">Двумерная графика и изображения</span><span class="sxs-lookup"><span data-stu-id="2656c-133">2D Graphics and Imaging</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-2d-graphics-and-imaging.md)  
 [<span data-ttu-id="2656c-134">Поведение объекта</span><span class="sxs-lookup"><span data-stu-id="2656c-134">Object Behavior</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-object-behavior.md)  
 [<span data-ttu-id="2656c-135">Text</span><span class="sxs-lookup"><span data-stu-id="2656c-135">Text</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-text.md)  
 [<span data-ttu-id="2656c-136">Привязка данных</span><span class="sxs-lookup"><span data-stu-id="2656c-136">Data Binding</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md)  
 [<span data-ttu-id="2656c-137">Дополнительные рекомендации по повышению производительности</span><span class="sxs-lookup"><span data-stu-id="2656c-137">Other Performance Recommendations</span></span>](../../../../docs/framework/wpf/advanced/optimizing-performance-other-recommendations.md)
