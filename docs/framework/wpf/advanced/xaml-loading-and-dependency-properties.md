---
title: Загрузка кода XAML и свойства зависимостей
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- custom dependency properties [WPF]
- dependency properties [WPF], XAML loading and
- loading XML data [WPF]
ms.assetid: 6eea9f4e-45ce-413b-a266-f08238737bf2
ms.openlocfilehash: 28e121e73ad4bd8ab70aed5f651418eb309b0c03
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33547730"
---
# <a name="xaml-loading-and-dependency-properties"></a><span data-ttu-id="a3c23-102">Загрузка кода XAML и свойства зависимостей</span><span class="sxs-lookup"><span data-stu-id="a3c23-102">XAML Loading and Dependency Properties</span></span>
<span data-ttu-id="a3c23-103">Текущая реализация процессора [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], по сути, учитывает свойство зависимостей.</span><span class="sxs-lookup"><span data-stu-id="a3c23-103">The current [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of its [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor is inherently dependency property aware.</span></span> <span data-ttu-id="a3c23-104">При загрузке двоичных файлов [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] и обработке атрибутов, которые являются свойствами зависимостей, процессор [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] использует методы системы свойств для свойств зависимостей.</span><span class="sxs-lookup"><span data-stu-id="a3c23-104">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor uses property system methods for dependency properties when loading binary [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] and processing attributes that are dependency properties.</span></span> <span data-ttu-id="a3c23-105">При этом выполняется обход оболочек свойств.</span><span class="sxs-lookup"><span data-stu-id="a3c23-105">This effectively bypasses the property wrappers.</span></span> <span data-ttu-id="a3c23-106">При реализации пользовательских свойств зависимостей необходимо учитывать такое поведение и следует избегать размещения любого другого кода в оболочке свойства Кроме методов системы свойств <xref:System.Windows.DependencyObject.GetValue%2A> и <xref:System.Windows.DependencyObject.SetValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="a3c23-106">When you implement custom dependency properties, you must account for this behavior and should avoid placing any other code in your property wrapper other than the property system methods <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A>.</span></span>  
  
  
<a name="prerequisites"></a>   
## <a name="prerequisites"></a><span data-ttu-id="a3c23-107">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="a3c23-107">Prerequisites</span></span>  
 <span data-ttu-id="a3c23-108">В этом разделе предполагается, что вы, как пользователь и разработчик, понимаете свойства зависимостей и ознакомились с разделами [Общие сведения о свойствах зависимости](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md) и [Пользовательские свойства зависимостей](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="a3c23-108">This topic assumes that you understand dependency properties both as consumer and author and have read [Dependency Properties Overview](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md) and [Custom Dependency Properties](../../../../docs/framework/wpf/advanced/custom-dependency-properties.md).</span></span> <span data-ttu-id="a3c23-109">Следует также прочитать разделы [Общие сведения о языке XAML (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md) и [Подробное описание синтаксиса XAML](../../../../docs/framework/wpf/advanced/xaml-syntax-in-detail.md).</span><span class="sxs-lookup"><span data-stu-id="a3c23-109">You should also have read [XAML Overview (WPF)](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md) and [XAML Syntax In Detail](../../../../docs/framework/wpf/advanced/xaml-syntax-in-detail.md).</span></span>  
  
<a name="implementation"></a>   
## <a name="the-wpf-xaml-loader-implementation-and-performance"></a><span data-ttu-id="a3c23-110">Реализация загрузчика XAML WPF и производительность</span><span class="sxs-lookup"><span data-stu-id="a3c23-110">The WPF XAML Loader Implementation, and Performance</span></span>  
 <span data-ttu-id="a3c23-111">В целях реализации требуется значительно меньше затрат определить свойство как свойство зависимостей и доступа в системе свойств <xref:System.Windows.DependencyObject.SetValue%2A> метод, чтобы задать его, а не с помощью оболочки свойства и задания значения.</span><span class="sxs-lookup"><span data-stu-id="a3c23-111">For implementation reasons, it is computationally less expensive to identify a property as a dependency property and access the property system <xref:System.Windows.DependencyObject.SetValue%2A> method to set it, rather than using the property wrapper and its setter.</span></span> <span data-ttu-id="a3c23-112">Причина этого заключается в том, что процессору [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] требуется вывести всю объектную модель вспомогательного кода, основываясь только на сведениях о типе и связях между членами, которые определены структурой разметки и различными строками.</span><span class="sxs-lookup"><span data-stu-id="a3c23-112">This is because a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor must infer the entire object model of the backing code based only on knowing the type and member relationships that are indicated by the structure of the markup and various strings.</span></span>  
  
 <span data-ttu-id="a3c23-113">Тип осуществляется посредством сочетания элементов xmlns и атрибутов сборки, однако для идентификации членов, определения членов которой может установить в качестве атрибута, и разрешения, какие типы поддерживают значения свойств бы в противном случае требуется расширенное отражение с помощью <xref:System.Reflection.PropertyInfo>.</span><span class="sxs-lookup"><span data-stu-id="a3c23-113">The type is looked up through a combination of xmlns and assembly attributes, but identifying the members, determining which could support being set as an attribute, and resolving what types the property values support would otherwise require extensive reflection using <xref:System.Reflection.PropertyInfo>.</span></span> <span data-ttu-id="a3c23-114">Так как свойства зависимостей для заданного типа доступны в виде таблицы хранилища с помощью системы свойств, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] реализация его [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] процессор использует эту таблицу и выводит все свойства заданного *ABC* может быть задано более эффективно, вызвав <xref:System.Windows.DependencyObject.SetValue%2A> в содержащем <xref:System.Windows.DependencyObject> производный тип, используя идентификатор свойства зависимостей *ABCProperty*.</span><span class="sxs-lookup"><span data-stu-id="a3c23-114">Because dependency properties on a given type are accessible as a storage table through the property system, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of its [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor uses this table and infers that any given property *ABC* can be more efficiently set by calling <xref:System.Windows.DependencyObject.SetValue%2A> on the containing <xref:System.Windows.DependencyObject> derived type, using the dependency property identifier *ABCProperty*.</span></span>  
  
<a name="implications"></a>   
## <a name="implications-for-custom-dependency-properties"></a><span data-ttu-id="a3c23-115">Последствия использования пользовательских свойств зависимостей</span><span class="sxs-lookup"><span data-stu-id="a3c23-115">Implications for Custom Dependency Properties</span></span>  
 <span data-ttu-id="a3c23-116">Так как текущая реализация процессора [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] при установке свойства полностью обходит оболочки, не следует помещать дополнительную логику в определения метода set оболочки для пользовательского свойства зависимости.</span><span class="sxs-lookup"><span data-stu-id="a3c23-116">Because the current [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor behavior for property setting bypasses the wrappers entirely, you should not put any additional logic into the set definitions of the wrapper for your custom dependency property.</span></span> <span data-ttu-id="a3c23-117">Если поместить такую логику в определение метода set, она не будет выполняться, если свойство задается в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], а не в коде.</span><span class="sxs-lookup"><span data-stu-id="a3c23-117">If you put such logic in the set definition, then the logic will not be executed when the property is set in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] rather than in code.</span></span>  
  
 <span data-ttu-id="a3c23-118">Аналогичным образом, другие аспекты [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] процессора, которые получают значения свойств из [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] обработки также используйте <xref:System.Windows.DependencyObject.GetValue%2A> вместо использования оболочки.</span><span class="sxs-lookup"><span data-stu-id="a3c23-118">Similarly, other aspects of the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor that obtain property values from [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processing also use <xref:System.Windows.DependencyObject.GetValue%2A> rather than using the wrapper.</span></span> <span data-ttu-id="a3c23-119">Поэтому следует избегать любых дополнительных реализаций в `get` определения за пределами <xref:System.Windows.DependencyObject.GetValue%2A> вызова.</span><span class="sxs-lookup"><span data-stu-id="a3c23-119">Therefore, you should also avoid any additional implementation in the `get` definition beyond the <xref:System.Windows.DependencyObject.GetValue%2A> call.</span></span>  
  
 <span data-ttu-id="a3c23-120">В приведенном ниже примере показано рекомендуемое определение свойства зависимости с оболочками, где идентификатор свойства хранится в виде поля с атрибутами `public` `static` `readonly`, а определения методов `get` и `set` не содержат никакого кода, кроме необходимых методов системы свойств, определяющих резервное свойство зависимости.</span><span class="sxs-lookup"><span data-stu-id="a3c23-120">The following example is a recommended dependency property definition with wrappers, where the property identifier is stored as a `public` `static` `readonly` field, and the `get` and `set` definitions contain no code beyond the necessary property system methods that define the dependency property backing.</span></span>  
  
 [!code-csharp[WPFAquariumSln#AGWithWrapper](../../../../samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#agwithwrapper)]
 [!code-vb[WPFAquariumSln#AGWithWrapper](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#agwithwrapper)]  
  
## <a name="see-also"></a><span data-ttu-id="a3c23-121">См. также</span><span class="sxs-lookup"><span data-stu-id="a3c23-121">See Also</span></span>  
 [<span data-ttu-id="a3c23-122">Общие сведения о свойствах зависимости</span><span class="sxs-lookup"><span data-stu-id="a3c23-122">Dependency Properties Overview</span></span>](../../../../docs/framework/wpf/advanced/dependency-properties-overview.md)  
 [<span data-ttu-id="a3c23-123">Общие сведения о языке XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="a3c23-123">XAML Overview (WPF)</span></span>](../../../../docs/framework/wpf/advanced/xaml-overview-wpf.md)  
 [<span data-ttu-id="a3c23-124">Метаданные свойства зависимостей</span><span class="sxs-lookup"><span data-stu-id="a3c23-124">Dependency Property Metadata</span></span>](../../../../docs/framework/wpf/advanced/dependency-property-metadata.md)  
 [<span data-ttu-id="a3c23-125">Свойства зависимостей типа коллекции</span><span class="sxs-lookup"><span data-stu-id="a3c23-125">Collection-Type Dependency Properties</span></span>](../../../../docs/framework/wpf/advanced/collection-type-dependency-properties.md)  
 [<span data-ttu-id="a3c23-126">Безопасность свойства зависимостей</span><span class="sxs-lookup"><span data-stu-id="a3c23-126">Dependency Property Security</span></span>](../../../../docs/framework/wpf/advanced/dependency-property-security.md)  
 [<span data-ttu-id="a3c23-127">Шаблоны безопасного конструктора для DependencyObjects</span><span class="sxs-lookup"><span data-stu-id="a3c23-127">Safe Constructor Patterns for DependencyObjects</span></span>](../../../../docs/framework/wpf/advanced/safe-constructor-patterns-for-dependencyobjects.md)
