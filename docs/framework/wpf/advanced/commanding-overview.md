---
title: "Общие сведения о системе команд"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- interfaces [WPF], ICommandSource
- command library [WPF]
- commands [WPF], definition of
- CommandBindings [WPF]
- ICommandSource interfaces [WPF]
- commanding [WPF]
- CommandManager [WPF]
ms.assetid: bc208dfe-367d-426a-99de-52b7e7511e81
caps.latest.revision: "35"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 3eb7d05cdf5f6a80a0a247a5f429052cc9a8368b
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2018
---
# <a name="commanding-overview"></a><span data-ttu-id="7c06b-102">Общие сведения о системе команд</span><span class="sxs-lookup"><span data-stu-id="7c06b-102">Commanding Overview</span></span>
<span data-ttu-id="7c06b-103">Система команд <a name="introduction"></a> представляет собой механизм ввода в [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], обеспечивающий обработку входных данных на более семантическом уровне по сравнению с вводом устройств.</span><span class="sxs-lookup"><span data-stu-id="7c06b-103"><a name="introduction"></a> Commanding is an input mechanism in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] which provides input handling at a more semantic level than device input.</span></span> <span data-ttu-id="7c06b-104">Примеры команд включают операции **Копировать**, **Вырезать** и **Вставить**, доступные во многих приложениях.</span><span class="sxs-lookup"><span data-stu-id="7c06b-104">Examples of commands are the **Copy**, **Cut**, and **Paste** operations found on many applications.</span></span>  
  
 <span data-ttu-id="7c06b-105">В этом обзоре определяется понятие команд в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], классы, входящие в модель команд, и способы использования и создания команд в приложениях.</span><span class="sxs-lookup"><span data-stu-id="7c06b-105">This overview defines what commands are in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], which classes are part of the commanding model, and how to use and create commands in your applications.</span></span>  
  
 <span data-ttu-id="7c06b-106">В этом разделе содержатся следующие подразделы.</span><span class="sxs-lookup"><span data-stu-id="7c06b-106">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="7c06b-107">Что представляют собой команды?</span><span class="sxs-lookup"><span data-stu-id="7c06b-107">What Are Commands?</span></span>](#commands_at_10000_feet)  
  
-   [<span data-ttu-id="7c06b-108">Пример простой команды в WPF</span><span class="sxs-lookup"><span data-stu-id="7c06b-108">Simple Command Example in WPF</span></span>](#simple_command)  
  
-   [<span data-ttu-id="7c06b-109">Четыре основных понятия в системе команд WPF</span><span class="sxs-lookup"><span data-stu-id="7c06b-109">Four Main Concepts in WPF Commanding</span></span>](#Four_main_Concepts)  
  
-   [<span data-ttu-id="7c06b-110">Библиотека команд</span><span class="sxs-lookup"><span data-stu-id="7c06b-110">Command Library</span></span>](#Command_Library)  
  
-   [<span data-ttu-id="7c06b-111">Создание настраиваемых команд</span><span class="sxs-lookup"><span data-stu-id="7c06b-111">Creating Custom Commands</span></span>](#creating_commands)  
  
<a name="commands_at_10000_feet"></a>   
## <a name="what-are-commands"></a><span data-ttu-id="7c06b-112">Что представляют собой команды?</span><span class="sxs-lookup"><span data-stu-id="7c06b-112">What Are Commands?</span></span>  
 <span data-ttu-id="7c06b-113">Команды применяются в различных целях.</span><span class="sxs-lookup"><span data-stu-id="7c06b-113">Commands have several purposes.</span></span> <span data-ttu-id="7c06b-114">Первой задачей является отделение семантики и объекта, вызывающего команду, от логики, которая выполняет команду.</span><span class="sxs-lookup"><span data-stu-id="7c06b-114">The first purpose is to separate the semantics and the object that invokes a command from the logic that executes the command.</span></span> <span data-ttu-id="7c06b-115">Это позволяет нескольким и разнородным источникам вызывать одну логику команды, а также настраивать логику команды для различных целевых объектов.</span><span class="sxs-lookup"><span data-stu-id="7c06b-115">This allows for multiple and disparate sources to invoke the same command logic, and it allows the command logic to be customized for different targets.</span></span> <span data-ttu-id="7c06b-116">Например, операции редактирования **Копировать**, **Вырезать** и **Вставить**, которые встречаются во многих приложениях, могут вызываться с помощью разных действий пользователя, если они реализованы с помощью команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-116">For example, the editing operations **Copy**, **Cut**, and **Paste**, which are found in many applications, can be invoked by using different user actions if they are implemented by using commands.</span></span> <span data-ttu-id="7c06b-117">Приложение может поддерживать вырезание выделенных объектов или текста путем нажатия определенной кнопки, выбора пункта меню или сочетания клавиш, например CTRL+X.</span><span class="sxs-lookup"><span data-stu-id="7c06b-117">An application might allow a user to cut selected objects or text by either clicking a button, choosing an item in a menu, or using a key combination, such as CTRL+X.</span></span> <span data-ttu-id="7c06b-118">С помощью команд можно привязать разные типы действий пользователя к одной логике.</span><span class="sxs-lookup"><span data-stu-id="7c06b-118">By using commands, you can bind each type of user action to the same logic.</span></span>  
  
 <span data-ttu-id="7c06b-119">Другой целью применения команд является указание того, доступно ли действие.</span><span class="sxs-lookup"><span data-stu-id="7c06b-119">Another purpose of commands is to indicate whether an action is available.</span></span> <span data-ttu-id="7c06b-120">Продолжая пример вырезания объекта или текста, действие имеет смысл, только если что-либо выбрано.</span><span class="sxs-lookup"><span data-stu-id="7c06b-120">To continue the example of cutting an object or text, the action only makes sense when something is selected.</span></span> <span data-ttu-id="7c06b-121">Если пользователь попытается вырезать объект или текст, не выбрав его, ничего не произойдет.</span><span class="sxs-lookup"><span data-stu-id="7c06b-121">If a user tries to cut an object or text without having anything selected, nothing would happen.</span></span> <span data-ttu-id="7c06b-122">Чтобы уведомить пользователя об этом, во многих приложениях кнопки и пункты меню отключаются, чтобы пользователь понял, что это действие выполнить невозможно.</span><span class="sxs-lookup"><span data-stu-id="7c06b-122">To indicate this to the user, many applications disable buttons and menu items so that the user knows whether it is possible to perform an action.</span></span> <span data-ttu-id="7c06b-123">Можно указать команды, возможна ли действие путем реализации <xref:System.Windows.Input.ICommand.CanExecute%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="7c06b-123">A command can indicate whether an action is possible by implementing the <xref:System.Windows.Input.ICommand.CanExecute%2A> method.</span></span> <span data-ttu-id="7c06b-124">Кнопки можно подписаться на <xref:System.Windows.Input.ICommand.CanExecuteChanged> событий и отключен, если <xref:System.Windows.Input.ICommand.CanExecute%2A> возвращает `false` или включать, если <xref:System.Windows.Input.ICommand.CanExecute%2A> возвращает `true`.</span><span class="sxs-lookup"><span data-stu-id="7c06b-124">A button can subscribe to the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event and be disabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `false` or be enabled if <xref:System.Windows.Input.ICommand.CanExecute%2A> returns `true`.</span></span>  
  
 <span data-ttu-id="7c06b-125">Семантика команды может быть согласованной в разных приложениях и классах, однако логика действия зависит от конкретного объекта, к которому она применяется.</span><span class="sxs-lookup"><span data-stu-id="7c06b-125">The semantics of a command can be consistent across applications and classes, but the logic of the action is specific to the particular object acted upon.</span></span> <span data-ttu-id="7c06b-126">Сочетание клавиш CTRL+X вызывает команду **Вырезать** в классах текста, классах изображений и веб-браузерах, однако фактическая логика для выполнения операции **Вырезать** определяется приложением, которое ее выполняет.</span><span class="sxs-lookup"><span data-stu-id="7c06b-126">The key combination CTRL+X invokes the **Cut** command in text classes, image classes, and Web browsers, but the actual logic for performing the **Cut** operation is defined by the application that performs the cut.</span></span> <span data-ttu-id="7c06b-127">Объект <xref:System.Windows.Input.RoutedCommand> позволяет клиентам реализовать логику.</span><span class="sxs-lookup"><span data-stu-id="7c06b-127">A <xref:System.Windows.Input.RoutedCommand> enables clients to implement the logic.</span></span> <span data-ttu-id="7c06b-128">Текстовый объект может вырезать выделенный текст в буфер обмена, а объект изображения может вырезать выбранное изображение.</span><span class="sxs-lookup"><span data-stu-id="7c06b-128">A text object may cut the selected text into the clipboard, while an image object may cut the selected image.</span></span> <span data-ttu-id="7c06b-129">Когда приложение обрабатывает <xref:System.Windows.Input.CommandManager.Executed> событие, он имеет доступ к целевому команды и предпринять соответствующие действия в зависимости от типа целевого объекта.</span><span class="sxs-lookup"><span data-stu-id="7c06b-129">When an application handles the <xref:System.Windows.Input.CommandManager.Executed> event, it has access to the target of the command and can take appropriate action depending on the target's type.</span></span>  
  
<a name="simple_command"></a>   
## <a name="simple-command-example-in-wpf"></a><span data-ttu-id="7c06b-130">Пример простой команды в WPF</span><span class="sxs-lookup"><span data-stu-id="7c06b-130">Simple Command Example in WPF</span></span>  
 <span data-ttu-id="7c06b-131">Самый простой способ использования команды в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] заключается в использовании предопределенного <xref:System.Windows.Input.RoutedCommand> из одного из классов библиотеки команд; используйте элемент управления с собственной поддержкой обработки команд; и использование элемента управления с собственной поддержкой вызова команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-131">The simplest way to use a command in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to use a predefined <xref:System.Windows.Input.RoutedCommand> from one of the command library classes; use a control that has native support for handling the command; and use a control that has native support for invoking a command.</span></span>  <span data-ttu-id="7c06b-132"><xref:System.Windows.Input.ApplicationCommands.Paste%2A> Команда является одной из предопределенных команд в <xref:System.Windows.Input.ApplicationCommands> класса.</span><span class="sxs-lookup"><span data-stu-id="7c06b-132">The <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is one of the predefined commands in the <xref:System.Windows.Input.ApplicationCommands> class.</span></span>  <span data-ttu-id="7c06b-133"><xref:System.Windows.Controls.TextBox> Управления содержит встроенную логику для обработки <xref:System.Windows.Input.ApplicationCommands.Paste%2A> команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-133">The <xref:System.Windows.Controls.TextBox> control has built in logic for handling the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command.</span></span>  <span data-ttu-id="7c06b-134">И <xref:System.Windows.Controls.MenuItem> класс имеет собственную поддержку для вызова команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-134">And the <xref:System.Windows.Controls.MenuItem> class has native support for invoking commands.</span></span>  
  
 <span data-ttu-id="7c06b-135">В следующем примере показано, как настроить <xref:System.Windows.Controls.MenuItem> так, что при его выборе вызывается <xref:System.Windows.Input.ApplicationCommands.Paste%2A> на <xref:System.Windows.Controls.TextBox>, исходя из <xref:System.Windows.Controls.TextBox> фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="7c06b-135">The following example shows how to set up a <xref:System.Windows.Controls.MenuItem> so that when it is clicked it will invoke the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command on a <xref:System.Windows.Controls.TextBox>, assuming the <xref:System.Windows.Controls.TextBox> has keyboard focus.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewSimpleCommand](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewsimplecommand)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Four_main_Concepts"></a>   
## <a name="four-main-concepts-in-wpf-commanding"></a><span data-ttu-id="7c06b-136">Четыре основных понятия в системе команд WPF</span><span class="sxs-lookup"><span data-stu-id="7c06b-136">Four Main Concepts in WPF Commanding</span></span>  
 <span data-ttu-id="7c06b-137">Модель перенаправляемых команд [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] можно разбить на четыре основных понятия: команда, источник команды, цель команды и привязка команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-137">The routed command model in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can be broken up into four main concepts: the command, the command source, the command target, and the command binding:</span></span>  
  
-   <span data-ttu-id="7c06b-138">*Команда* — это выполняемое действие.</span><span class="sxs-lookup"><span data-stu-id="7c06b-138">The *command* is the action to be executed.</span></span>  
  
-   <span data-ttu-id="7c06b-139">*Источник команды* — это объект, который вызывает команду.</span><span class="sxs-lookup"><span data-stu-id="7c06b-139">The *command source* is the object which invokes the command.</span></span>  
  
-   <span data-ttu-id="7c06b-140">*Цель команды* — это объект, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="7c06b-140">The *command target* is the object that the command is being executed on.</span></span>  
  
-   <span data-ttu-id="7c06b-141">*Привязка команды* — это объект, сопоставляющий логику команды с командой.</span><span class="sxs-lookup"><span data-stu-id="7c06b-141">The *command binding* is the object which maps the command logic to the command.</span></span>  
  
 <span data-ttu-id="7c06b-142">В предыдущем примере <xref:System.Windows.Input.ApplicationCommands.Paste%2A> команду, <xref:System.Windows.Controls.MenuItem> — источник команды <xref:System.Windows.Controls.TextBox> — цель команды и привязка команды предоставляется свойством <xref:System.Windows.Controls.TextBox> элемента управления.</span><span class="sxs-lookup"><span data-stu-id="7c06b-142">In the previous example, the <xref:System.Windows.Input.ApplicationCommands.Paste%2A> command is the command, the <xref:System.Windows.Controls.MenuItem> is the command source, the <xref:System.Windows.Controls.TextBox> is the command target, and the command binding is supplied by the <xref:System.Windows.Controls.TextBox> control.</span></span>  <span data-ttu-id="7c06b-143">Стоит отметить, что это не всегда так, <xref:System.Windows.Input.CommandBinding> предоставляется элементом управления, который является целевой класс команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-143">It is worth noting that it is not always the case that the <xref:System.Windows.Input.CommandBinding> is supplied by the control that is the command target class.</span></span>  <span data-ttu-id="7c06b-144">Довольно часто <xref:System.Windows.Input.CommandBinding> должны создаваться разработчиком приложения, или <xref:System.Windows.Input.CommandBinding> могут быть присоединены к предку целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-144">Quite often the <xref:System.Windows.Input.CommandBinding> must be created by the application developer, or the <xref:System.Windows.Input.CommandBinding> might be attached to an ancestor of the command target.</span></span>  
  
<a name="Commands"></a>   
### <a name="commands"></a><span data-ttu-id="7c06b-145">Команды</span><span class="sxs-lookup"><span data-stu-id="7c06b-145">Commands</span></span>  
 <span data-ttu-id="7c06b-146">Команды в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] создаются путем реализации <xref:System.Windows.Input.ICommand> интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7c06b-146">Commands in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are created by implementing the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="7c06b-147"><xref:System.Windows.Input.ICommand>предоставляет два метода, <xref:System.Windows.Input.ICommand.Execute%2A>, и <xref:System.Windows.Input.ICommand.CanExecute%2A>и для события <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-147"><xref:System.Windows.Input.ICommand> exposes two methods, <xref:System.Windows.Input.ICommand.Execute%2A>, and <xref:System.Windows.Input.ICommand.CanExecute%2A>, and an event, <xref:System.Windows.Input.ICommand.CanExecuteChanged>.</span></span> <span data-ttu-id="7c06b-148"><xref:System.Windows.Input.ICommand.Execute%2A>выполняет действия, связанные с командой.</span><span class="sxs-lookup"><span data-stu-id="7c06b-148"><xref:System.Windows.Input.ICommand.Execute%2A> performs the actions that are associated with the command.</span></span> <span data-ttu-id="7c06b-149"><xref:System.Windows.Input.ICommand.CanExecute%2A>Определяет, может ли команда выполняться на текущей цели команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-149"><xref:System.Windows.Input.ICommand.CanExecute%2A> determines whether the command can execute on the current command target.</span></span> <span data-ttu-id="7c06b-150"><xref:System.Windows.Input.ICommand.CanExecuteChanged>возникает, если диспетчер команд, команд, обнаруживает изменения в источнике команды, может сделать недействительным команду, которая возникает, но еще не выполнена с помощью привязки команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-150"><xref:System.Windows.Input.ICommand.CanExecuteChanged> is raised if the command manager that centralizes the commanding operations detects a change in the command source that might invalidate a command that has been raised but not yet executed by the command binding.</span></span>  <span data-ttu-id="7c06b-151">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Реализация <xref:System.Windows.Input.ICommand> — <xref:System.Windows.Input.RoutedCommand> класса и рассматривается в этом обзоре.</span><span class="sxs-lookup"><span data-stu-id="7c06b-151">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] implementation of <xref:System.Windows.Input.ICommand> is the <xref:System.Windows.Input.RoutedCommand> class and is the focus of this overview.</span></span>  
  
 <span data-ttu-id="7c06b-152">Основными источниками входных данных в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] являются мышь, клавиатура, рукописный ввод и перенаправленные команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-152">The main sources of input in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the mouse, the keyboard, ink, and routed commands.</span></span>  <span data-ttu-id="7c06b-153">Использовать входные данные аппаратно ориентированном <xref:System.Windows.RoutedEvent> уведомление объектов на странице приложения произошедшего события ввода.</span><span class="sxs-lookup"><span data-stu-id="7c06b-153">The more device-oriented inputs use a <xref:System.Windows.RoutedEvent> to notify objects in an application page that an input event has occurred.</span></span>  <span data-ttu-id="7c06b-154">Объект <xref:System.Windows.Input.RoutedCommand> ничем не отличается.</span><span class="sxs-lookup"><span data-stu-id="7c06b-154">A <xref:System.Windows.Input.RoutedCommand> is no different.</span></span>  <span data-ttu-id="7c06b-155"><xref:System.Windows.Input.RoutedCommand.Execute%2A> И <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> методы <xref:System.Windows.Input.RoutedCommand> не содержат логику приложения для команды, но вместо вызовет этот туннель перенаправленные события и растут по дереву элементов, пока они обнаружить объект с <xref:System.Windows.Input.CommandBinding>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-155">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> and <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> methods of a <xref:System.Windows.Input.RoutedCommand> do not contain the application logic for the command, but rather they raise routed events that tunnel and bubble through the element tree until they encounter an object with a <xref:System.Windows.Input.CommandBinding>.</span></span>  <span data-ttu-id="7c06b-156"><xref:System.Windows.Input.CommandBinding> Содержит обработчики для этих событий, а также обработчики, предназначенные для выполнения команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-156">The <xref:System.Windows.Input.CommandBinding> contains the handlers for these events and it is the handlers that perform the command.</span></span>  <span data-ttu-id="7c06b-157">Дополнительные сведения о маршрутизации событий в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] см. в разделе [Общие сведения о перенаправленных событиях](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span><span class="sxs-lookup"><span data-stu-id="7c06b-157">For more information on event routing in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="7c06b-158"><xref:System.Windows.Input.RoutedCommand.Execute%2A> Метод <xref:System.Windows.Input.RoutedCommand> вызывает <xref:System.Windows.Input.CommandManager.PreviewExecuted> и <xref:System.Windows.Input.CommandManager.Executed> событий для целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-158">The <xref:System.Windows.Input.RoutedCommand.Execute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.PreviewExecuted> and the <xref:System.Windows.Input.CommandManager.Executed> events on the command target.</span></span>  <span data-ttu-id="7c06b-159"><xref:System.Windows.Input.RoutedCommand.CanExecute%2A> Метод <xref:System.Windows.Input.RoutedCommand> вызывает <xref:System.Windows.Input.CommandManager.CanExecute> и <xref:System.Windows.Input.CommandManager.PreviewCanExecute> событий для целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-159">The <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method on a <xref:System.Windows.Input.RoutedCommand> raises the <xref:System.Windows.Input.CommandManager.CanExecute> and <xref:System.Windows.Input.CommandManager.PreviewCanExecute> events on the command target.</span></span>  <span data-ttu-id="7c06b-160">Эти события проходят и поднимаются по дереву элементов, пока они обнаружить объект с <xref:System.Windows.Input.CommandBinding> для этой конкретной команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-160">These events tunnel and bubble through the element tree until they encounter an object which has a <xref:System.Windows.Input.CommandBinding> for that particular command.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7c06b-161">предоставляет набор общих команд перенаправленное распределены между несколькими классами: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, и <xref:System.Windows.Documents.EditingCommands>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-161"> supplies a set of common routed commands spread across several classes: <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.ComponentCommands>, and <xref:System.Windows.Documents.EditingCommands>.</span></span>  <span data-ttu-id="7c06b-162">Эти классы состоят только из <xref:System.Windows.Input.RoutedCommand> объекты и не логика реализации команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-162">These classes consist only of the <xref:System.Windows.Input.RoutedCommand> objects and not the implementation logic of the command.</span></span>  <span data-ttu-id="7c06b-163">За реализацию логики команды отвечает объект, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="7c06b-163">The implementation logic is the responsibility of the object on which the command is being executed on.</span></span>  
  
<a name="Command_Sources"></a>   
### <a name="command-sources"></a><span data-ttu-id="7c06b-164">Источники команд</span><span class="sxs-lookup"><span data-stu-id="7c06b-164">Command Sources</span></span>  
 <span data-ttu-id="7c06b-165">Источник команды — это объект, который вызывает команду.</span><span class="sxs-lookup"><span data-stu-id="7c06b-165">A command source is the object which invokes the command.</span></span>  <span data-ttu-id="7c06b-166">Примерами источников команды являются <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, и <xref:System.Windows.Input.KeyGesture>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-166">Examples of command sources are <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.Button>, and <xref:System.Windows.Input.KeyGesture>.</span></span>  
  
 <span data-ttu-id="7c06b-167">Источники команд в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] обычно реализуют <xref:System.Windows.Input.ICommandSource> интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7c06b-167">Command sources in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] generally implement the <xref:System.Windows.Input.ICommandSource> interface.</span></span>  
  
 <span data-ttu-id="7c06b-168"><xref:System.Windows.Input.ICommandSource>предоставляет три свойства: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, и <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span><span class="sxs-lookup"><span data-stu-id="7c06b-168"><xref:System.Windows.Input.ICommandSource> exposes three properties: <xref:System.Windows.Input.ICommandSource.Command%2A>, <xref:System.Windows.Input.ICommandSource.CommandTarget%2A>, and <xref:System.Windows.Input.ICommandSource.CommandParameter%2A>:</span></span>  
  
-   <span data-ttu-id="7c06b-169"><xref:System.Windows.Input.ICommandSource.Command%2A>является команда, которая выполняется при вызове источника команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-169"><xref:System.Windows.Input.ICommandSource.Command%2A> is the command to execute when the command source is invoked.</span></span>  
  
-   <span data-ttu-id="7c06b-170"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A>— Это объект, на котором выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="7c06b-170"><xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is the object on which to execute the command.</span></span>  <span data-ttu-id="7c06b-171">Следует отметить, что в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> свойство <xref:System.Windows.Input.ICommandSource> применимо, только когда <xref:System.Windows.Input.ICommand> — <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-171">It is worth noting that in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="7c06b-172">Если <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> устанавливается на <xref:System.Windows.Input.ICommandSource> и соответствующей команды не <xref:System.Windows.Input.RoutedCommand>, целевой объект команды учитывается.</span><span class="sxs-lookup"><span data-stu-id="7c06b-172">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span> <span data-ttu-id="7c06b-173">Если <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> не задано, элемент с фокусом клавиатуры будет целевой объект команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-173">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is not set, the element with keyboard focus will be the command target.</span></span>  
  
-   <span data-ttu-id="7c06b-174"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A>команда реализует тип пользовательских данных, используется для передачи данных в обработчик.</span><span class="sxs-lookup"><span data-stu-id="7c06b-174"><xref:System.Windows.Input.ICommandSource.CommandParameter%2A> is a user-defined data type used to pass information to the handlers implementing the command.</span></span>  
  
 <span data-ttu-id="7c06b-175">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Классы, реализующие <xref:System.Windows.Input.ICommandSource> , <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, и <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-175">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes that implement <xref:System.Windows.Input.ICommandSource> are <xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Documents.Hyperlink>, and <xref:System.Windows.Input.InputBinding>.</span></span>  <span data-ttu-id="7c06b-176"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, и <xref:System.Windows.Documents.Hyperlink> вызова команды при щелчке и <xref:System.Windows.Input.InputBinding> вызывает команду при <xref:System.Windows.Input.InputGesture> связанных с она выполняется.</span><span class="sxs-lookup"><span data-stu-id="7c06b-176"><xref:System.Windows.Controls.Primitives.ButtonBase>, <xref:System.Windows.Controls.MenuItem>, and <xref:System.Windows.Documents.Hyperlink> invoke a command when they are clicked, and an <xref:System.Windows.Input.InputBinding> invokes a command when the <xref:System.Windows.Input.InputGesture> associated with it is performed.</span></span>  
  
 <span data-ttu-id="7c06b-177">В следующем примере показано, как использовать <xref:System.Windows.Controls.MenuItem> в <xref:System.Windows.Controls.ContextMenu> в качестве источника команды для <xref:System.Windows.Input.ApplicationCommands.Properties%2A> команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-177">The following example shows how to use a <xref:System.Windows.Controls.MenuItem> in a <xref:System.Windows.Controls.ContextMenu> as a command source for the <xref:System.Windows.Input.ApplicationCommands.Properties%2A> command.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewCmdSourceXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewcmdsourcexaml)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcmdsource)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCmdSource](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcmdsource)]  
  
 <span data-ttu-id="7c06b-178">Как правило, источник команды будет осуществлять прослушивание <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> событий.</span><span class="sxs-lookup"><span data-stu-id="7c06b-178">Typically, a command source will listen to the <xref:System.Windows.Input.RoutedCommand.CanExecuteChanged> event.</span></span>  <span data-ttu-id="7c06b-179">Это событие сообщает источнику команды о том, что возможность выполнения команды для текущего целевого объекта команды может быть изменена.</span><span class="sxs-lookup"><span data-stu-id="7c06b-179">This event informs the command source that the ability of the command to execute on the current command target may have changed.</span></span>  <span data-ttu-id="7c06b-180">Источник команды может запрашивать текущее состояние <xref:System.Windows.Input.RoutedCommand> с помощью <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="7c06b-180">The command source can query the current status of the <xref:System.Windows.Input.RoutedCommand> by using the <xref:System.Windows.Input.RoutedCommand.CanExecute%2A> method.</span></span>  <span data-ttu-id="7c06b-181">Источник команды может затем отключаться, если не удается выполнить команду.</span><span class="sxs-lookup"><span data-stu-id="7c06b-181">The command source can then disable itself if the command cannot execute.</span></span>  <span data-ttu-id="7c06b-182">Примером этого является <xref:System.Windows.Controls.MenuItem> серым цветом когда невозможно выполнить команду.</span><span class="sxs-lookup"><span data-stu-id="7c06b-182">An example of this is a <xref:System.Windows.Controls.MenuItem> graying itself out when a command cannot execute.</span></span>  
  
 <span data-ttu-id="7c06b-183"><xref:System.Windows.Input.InputGesture> Можно использовать в качестве источника команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-183">An <xref:System.Windows.Input.InputGesture> can be used as a command source.</span></span>  <span data-ttu-id="7c06b-184">Два типа входных жестов в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] , <xref:System.Windows.Input.KeyGesture> и <xref:System.Windows.Input.MouseGesture>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-184">Two types of input gestures in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are the <xref:System.Windows.Input.KeyGesture> and <xref:System.Windows.Input.MouseGesture>.</span></span>  <span data-ttu-id="7c06b-185">Можно представить <xref:System.Windows.Input.KeyGesture> как сочетания клавиш, например CTRL + C.</span><span class="sxs-lookup"><span data-stu-id="7c06b-185">You can think of a <xref:System.Windows.Input.KeyGesture> as a keyboard shortcut, such as CTRL+C.</span></span>  <span data-ttu-id="7c06b-186">Объект <xref:System.Windows.Input.KeyGesture> состоит из <xref:System.Windows.Input.Key> и набор <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-186">A <xref:System.Windows.Input.KeyGesture> is comprised of a <xref:System.Windows.Input.Key> and a set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  <span data-ttu-id="7c06b-187">Объект <xref:System.Windows.Input.MouseGesture> состоит из <xref:System.Windows.Input.MouseAction> и необязательный набор <xref:System.Windows.Input.ModifierKeys>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-187">A <xref:System.Windows.Input.MouseGesture> is comprised of a <xref:System.Windows.Input.MouseAction> and an optional set of <xref:System.Windows.Input.ModifierKeys>.</span></span>  
  
 <span data-ttu-id="7c06b-188">Чтобы <xref:System.Windows.Input.InputGesture> в качестве источника команды, она должна быть связана с помощью команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-188">In order for an <xref:System.Windows.Input.InputGesture> to act as a command source, it must be associated with a command.</span></span> <span data-ttu-id="7c06b-189">Это можно настроить несколькими способами.</span><span class="sxs-lookup"><span data-stu-id="7c06b-189">There are a few ways to accomplish this.</span></span>  <span data-ttu-id="7c06b-190">Один способ — использовать <xref:System.Windows.Input.InputBinding>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-190">One way is to use an <xref:System.Windows.Input.InputBinding>.</span></span>  
  
 <span data-ttu-id="7c06b-191">В следующем примере показано, как создать <xref:System.Windows.Input.KeyBinding> между <xref:System.Windows.Input.KeyGesture> и <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-191">The following example shows how to create a <xref:System.Windows.Input.KeyBinding> between a <xref:System.Windows.Input.KeyGesture> and a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlkeybinding)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeybinding)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyBinding](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeybinding)]  
  
 <span data-ttu-id="7c06b-192">Другой способ связать <xref:System.Windows.Input.InputGesture> для <xref:System.Windows.Input.RoutedCommand> заключается в добавлении <xref:System.Windows.Input.InputGesture> для <xref:System.Windows.Input.InputGestureCollection> на <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-192">Another way to associate an <xref:System.Windows.Input.InputGesture> to a <xref:System.Windows.Input.RoutedCommand> is to add the <xref:System.Windows.Input.InputGesture> to the <xref:System.Windows.Input.InputGestureCollection> on the <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 <span data-ttu-id="7c06b-193">Следующий пример демонстрирует добавление <xref:System.Windows.Input.KeyGesture> для <xref:System.Windows.Input.InputGestureCollection> из <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-193">The following example shows how to add a <xref:System.Windows.Input.KeyGesture> to the <xref:System.Windows.Input.InputGestureCollection> of a <xref:System.Windows.Input.RoutedCommand>.</span></span>  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewkeygestureoncmd)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewKeyGestureOnCmd](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewkeygestureoncmd)]  
  
<a name="Command_Binding"></a>   
### <a name="commandbinding"></a><span data-ttu-id="7c06b-194">CommandBinding</span><span class="sxs-lookup"><span data-stu-id="7c06b-194">CommandBinding</span></span>  
 <span data-ttu-id="7c06b-195">Объект <xref:System.Windows.Input.CommandBinding> связывает команду с обработчиками событий, которые реализуют команду.</span><span class="sxs-lookup"><span data-stu-id="7c06b-195">A <xref:System.Windows.Input.CommandBinding> associates a command with the event handlers that implement the command.</span></span>  
  
 <span data-ttu-id="7c06b-196"><xref:System.Windows.Input.CommandBinding> Класс содержит <xref:System.Windows.Input.CommandBinding.Command%2A> свойство, и <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, и <xref:System.Windows.Input.CommandBinding.CanExecute> события.</span><span class="sxs-lookup"><span data-stu-id="7c06b-196">The <xref:System.Windows.Input.CommandBinding> class contains a <xref:System.Windows.Input.CommandBinding.Command%2A> property, and <xref:System.Windows.Input.CommandBinding.PreviewExecuted>, <xref:System.Windows.Input.CommandBinding.Executed>, <xref:System.Windows.Input.CommandBinding.PreviewCanExecute>, and <xref:System.Windows.Input.CommandBinding.CanExecute> events.</span></span>  
  
 <span data-ttu-id="7c06b-197"><xref:System.Windows.Input.CommandBinding.Command%2A>команда, <xref:System.Windows.Input.CommandBinding> , связанного с.</span><span class="sxs-lookup"><span data-stu-id="7c06b-197"><xref:System.Windows.Input.CommandBinding.Command%2A> is the command that the <xref:System.Windows.Input.CommandBinding> is being associated with.</span></span>  <span data-ttu-id="7c06b-198">Обработчики событий, которые привязываются к <xref:System.Windows.Input.CommandBinding.PreviewExecuted> и <xref:System.Windows.Input.CommandBinding.Executed> события реализовывать логику команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-198">The event handlers which are attached to the <xref:System.Windows.Input.CommandBinding.PreviewExecuted> and <xref:System.Windows.Input.CommandBinding.Executed> events implement the command logic.</span></span>  <span data-ttu-id="7c06b-199">Обработчики событий, присоединенные к <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> и <xref:System.Windows.Input.CommandBinding.CanExecute> события определяют, если данная команда выполняться на текущей цели команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-199">The event handlers attached to the <xref:System.Windows.Input.CommandBinding.PreviewCanExecute> and <xref:System.Windows.Input.CommandBinding.CanExecute> events determine if the command can execute on the current command target.</span></span>  
  
 <span data-ttu-id="7c06b-200">В следующем примере показано, как создать <xref:System.Windows.Input.CommandBinding> в корне <xref:System.Windows.Window> приложения.</span><span class="sxs-lookup"><span data-stu-id="7c06b-200">The following example shows how to create a <xref:System.Windows.Input.CommandBinding> on the root <xref:System.Windows.Window> of an application.</span></span>  <span data-ttu-id="7c06b-201"><xref:System.Windows.Input.CommandBinding> Связывает <xref:System.Windows.Input.ApplicationCommands.Open%2A> с <xref:System.Windows.Input.CommandManager.Executed> и <xref:System.Windows.Input.CommandBinding.CanExecute> обработчиков.</span><span class="sxs-lookup"><span data-stu-id="7c06b-201">The <xref:System.Windows.Input.CommandBinding> associates the <xref:System.Windows.Input.ApplicationCommands.Open%2A> command with <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandBinding.CanExecute> handlers.</span></span>  
  
 [!code-xaml[commandwithhandler#CommandHandlerCommandBinding](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml#commandhandlercommandbinding)]  
  
 [!code-csharp[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandHandlerProcedural/CSharp/Window1.xaml.cs#commandhandlerbindinginit)]
 [!code-vb[CommandHandlerProcedural#CommandHandlerBindingInit](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandHandlerProcedural/visualbasic/window1.xaml.vb#commandhandlerbindinginit)]  
  
 <span data-ttu-id="7c06b-202">Далее, <xref:System.Windows.Input.ExecutedRoutedEventHandler> и <xref:System.Windows.Input.CanExecuteRoutedEventHandler> создаются.</span><span class="sxs-lookup"><span data-stu-id="7c06b-202">Next, the <xref:System.Windows.Input.ExecutedRoutedEventHandler> and a <xref:System.Windows.Input.CanExecuteRoutedEventHandler> are created.</span></span>  <span data-ttu-id="7c06b-203"><xref:System.Windows.Input.ExecutedRoutedEventHandler> Открывает <xref:System.Windows.MessageBox> котором отображаются сведения о том, выполнена команда.</span><span class="sxs-lookup"><span data-stu-id="7c06b-203">The <xref:System.Windows.Input.ExecutedRoutedEventHandler> opens a <xref:System.Windows.MessageBox> that displays a string saying the command has been executed.</span></span>  <span data-ttu-id="7c06b-204"><xref:System.Windows.Input.CanExecuteRoutedEventHandler> Задает <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> свойства `true`.</span><span class="sxs-lookup"><span data-stu-id="7c06b-204">The <xref:System.Windows.Input.CanExecuteRoutedEventHandler> sets the <xref:System.Windows.Input.CanExecuteRoutedEventArgs.CanExecute%2A> property to `true`.</span></span>  
  
 [!code-csharp[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlerexecutedhandler)]
 [!code-vb[commandwithhandler#CommandHandlerExecutedHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlerexecutedhandler)]  
  
 [!code-csharp[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/csharp/VS_Snippets_Wpf/commandWithHandler/CSharp/Window1.xaml.cs#commandhandlercanexecutehandler)]
 [!code-vb[commandwithhandler#CommandHandlerCanExecuteHandler](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/commandWithHandler/VisualBasic/Window1.xaml.vb#commandhandlercanexecutehandler)]  
  
 <span data-ttu-id="7c06b-205">Объект <xref:System.Windows.Input.CommandBinding> присоединяется к конкретному объекту, например корневой <xref:System.Windows.Window> приложения или элемента управления.</span><span class="sxs-lookup"><span data-stu-id="7c06b-205">A <xref:System.Windows.Input.CommandBinding> is attached to a specific object, such as the root <xref:System.Windows.Window> of the application or a control.</span></span>  <span data-ttu-id="7c06b-206">Объект, <xref:System.Windows.Input.CommandBinding> присоединяется к определяет область привязки.</span><span class="sxs-lookup"><span data-stu-id="7c06b-206">The object that the <xref:System.Windows.Input.CommandBinding> is attached to defines the scope of the binding.</span></span>  <span data-ttu-id="7c06b-207">Например <xref:System.Windows.Input.CommandBinding> присоединенного к предку команды целевой можно осуществлять путем <xref:System.Windows.Input.CommandBinding.Executed> событий, но <xref:System.Windows.Input.CommandBinding> присоединенного потомку команды не могут использоваться целевой.</span><span class="sxs-lookup"><span data-stu-id="7c06b-207">For example, a <xref:System.Windows.Input.CommandBinding> attached to an ancestor of the command target can be reached by the <xref:System.Windows.Input.CommandBinding.Executed> event, but a <xref:System.Windows.Input.CommandBinding> attached to a descendant of the command target cannot be reached.</span></span>  <span data-ttu-id="7c06b-208">Это напрямую связано способ <xref:System.Windows.RoutedEvent> туннели и может передаваться из объекта, который вызывает событие.</span><span class="sxs-lookup"><span data-stu-id="7c06b-208">This is a direct consequence of the way a <xref:System.Windows.RoutedEvent> tunnels and bubbles from the object that raises the event.</span></span>  
  
 <span data-ttu-id="7c06b-209">В некоторых случаях <xref:System.Windows.Input.CommandBinding> присоединяется к целевой объект команды, такие как с <xref:System.Windows.Controls.TextBox> класса и <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, и <xref:System.Windows.Input.ApplicationCommands.Paste%2A> команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-209">In some situations the <xref:System.Windows.Input.CommandBinding> is attached to the command target itself, such as with the <xref:System.Windows.Controls.TextBox> class and the <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.ApplicationCommands.Copy%2A>, and <xref:System.Windows.Input.ApplicationCommands.Paste%2A> commands.</span></span> <span data-ttu-id="7c06b-210">Довольно часто менее, он является более удобным для присоединения <xref:System.Windows.Input.CommandBinding> к предку целевого объекта команды, например main <xref:System.Windows.Window> или объекта приложения, особенно в том случае, если же <xref:System.Windows.Input.CommandBinding> может использоваться для нескольких целей команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-210">Quite often though, it is more convenient to attach the <xref:System.Windows.Input.CommandBinding> to an ancestor of the command target, such as the main <xref:System.Windows.Window> or the Application object, especially if the same <xref:System.Windows.Input.CommandBinding> can be used for multiple command targets.</span></span>  <span data-ttu-id="7c06b-211">Это необходимо учитывать при создании инфраструктуры системы команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-211">These are design decisions you will want to consider when you are creating your commanding infrastructure.</span></span>  
  
<a name="Commane_Target"></a>   
### <a name="command-target"></a><span data-ttu-id="7c06b-212">Цель команды</span><span class="sxs-lookup"><span data-stu-id="7c06b-212">Command Target</span></span>  
 <span data-ttu-id="7c06b-213">Целью команды является элемент, для которого выполняется команда.</span><span class="sxs-lookup"><span data-stu-id="7c06b-213">The command target is the element on which the command is executed.</span></span>  <span data-ttu-id="7c06b-214">По отношении к <xref:System.Windows.Input.RoutedCommand>, цель команды — элемент, расположенный какие маршрутизацию <xref:System.Windows.Input.CommandManager.Executed> и <xref:System.Windows.Input.CommandManager.CanExecute> запускает.</span><span class="sxs-lookup"><span data-stu-id="7c06b-214">With regards to a <xref:System.Windows.Input.RoutedCommand>, the command target is the element at which routing of the <xref:System.Windows.Input.CommandManager.Executed> and <xref:System.Windows.Input.CommandManager.CanExecute> starts.</span></span>  <span data-ttu-id="7c06b-215">Как было отмечено ранее, в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> свойство <xref:System.Windows.Input.ICommandSource> применимо, только когда <xref:System.Windows.Input.ICommand> — <xref:System.Windows.Input.RoutedCommand>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-215">As noted previously, in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> property on <xref:System.Windows.Input.ICommandSource> is only applicable when the <xref:System.Windows.Input.ICommand> is a <xref:System.Windows.Input.RoutedCommand>.</span></span>  <span data-ttu-id="7c06b-216">Если <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> устанавливается на <xref:System.Windows.Input.ICommandSource> и соответствующей команды не <xref:System.Windows.Input.RoutedCommand>, целевой объект команды учитывается.</span><span class="sxs-lookup"><span data-stu-id="7c06b-216">If the <xref:System.Windows.Input.ICommandSource.CommandTarget%2A> is set on an <xref:System.Windows.Input.ICommandSource> and the corresponding command is not a <xref:System.Windows.Input.RoutedCommand>, the command target is ignored.</span></span>  
  
 <span data-ttu-id="7c06b-217">Источник команды может явно задавать целевой объект команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-217">The command source can explicitly set the command target.</span></span>  <span data-ttu-id="7c06b-218">Если цель команды не определена, в качестве целевого объекта будет использоваться элемент с фокусом клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="7c06b-218">If the command target is not defined, the element with keyboard focus will be used as the command target.</span></span>  <span data-ttu-id="7c06b-219">Одно из преимуществ использования элемента с фокусом клавиатуры в качестве цели команды является то, что это позволяет разработчику приложения использовать один источник команды для вызова команд для нескольких целей без необходимости отслеживания целевого объекта команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-219">One of the benefits of using the element with keyboard focus as the command target is that it allows the application developer to use the same command source to invoke a command on multiple targets without having to keep track of the command target.</span></span>  <span data-ttu-id="7c06b-220">Например если <xref:System.Windows.Controls.MenuItem> вызывает **вставить** команду в приложении, которое имеет <xref:System.Windows.Controls.TextBox> управления и <xref:System.Windows.Controls.PasswordBox> элемент управления, целевой объект может быть либо <xref:System.Windows.Controls.TextBox> или <xref:System.Windows.Controls.PasswordBox> в зависимости от того, что элемент управления имеет фокус клавиатуры.</span><span class="sxs-lookup"><span data-stu-id="7c06b-220">For example, if a <xref:System.Windows.Controls.MenuItem> invokes the **Paste** command in an application that has a <xref:System.Windows.Controls.TextBox> control and a <xref:System.Windows.Controls.PasswordBox> control, the target can be either the <xref:System.Windows.Controls.TextBox> or <xref:System.Windows.Controls.PasswordBox> depending on which control has keyboard focus.</span></span>  
  
 <span data-ttu-id="7c06b-221">В следующем примере показано явное задание цели команды в разметке и в коде программной части.</span><span class="sxs-lookup"><span data-stu-id="7c06b-221">The following example shows how to explicitly set the command target in markup and in code behind.</span></span>  
  
 [!code-xaml[CommandingOverviewSnippets#CommandingOverviewXAMLCommandTarget](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml#commandingoverviewxamlcommandtarget)]  
  
 [!code-csharp[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/csharp/VS_Snippets_Wpf/CommandingOverviewSnippets/CSharp/Window1.xaml.cs#commandingoverviewcommandtargetcodebehind)]
 [!code-vb[CommandingOverviewSnippets#CommandingOverviewCommandTargetCodeBehind](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/CommandingOverviewSnippets/visualbasic/window1.xaml.vb#commandingoverviewcommandtargetcodebehind)]  
  
<a name="Command_Manager"></a>   
### <a name="the-commandmanager"></a><span data-ttu-id="7c06b-222">Диспетчер команд CommandManager</span><span class="sxs-lookup"><span data-stu-id="7c06b-222">The CommandManager</span></span>  
 <span data-ttu-id="7c06b-223"><xref:System.Windows.Input.CommandManager> Представлен ряд команд, связанных с ними функциях.</span><span class="sxs-lookup"><span data-stu-id="7c06b-223">The <xref:System.Windows.Input.CommandManager> serves a number of command related functions.</span></span>  <span data-ttu-id="7c06b-224">Она предоставляет набор статических методов для добавления и удаления <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, и <xref:System.Windows.Input.CommandManager.CanExecute> обработчики событий в и из конкретного элемента.</span><span class="sxs-lookup"><span data-stu-id="7c06b-224">It provides a set of static methods for adding and removing <xref:System.Windows.Input.CommandManager.PreviewExecuted>, <xref:System.Windows.Input.CommandManager.Executed>, <xref:System.Windows.Input.CommandManager.PreviewCanExecute>, and <xref:System.Windows.Input.CommandManager.CanExecute> event handlers to and from a specific element.</span></span>  <span data-ttu-id="7c06b-225">Она предоставляет средства для регистрации <xref:System.Windows.Input.CommandBinding> и <xref:System.Windows.Input.InputBinding> объектов определенного класса.</span><span class="sxs-lookup"><span data-stu-id="7c06b-225">It provides a means to register <xref:System.Windows.Input.CommandBinding> and <xref:System.Windows.Input.InputBinding> objects onto a specific class.</span></span>  <span data-ttu-id="7c06b-226"><xref:System.Windows.Input.CommandManager> Также предоставляет средства, с помощью <xref:System.Windows.Input.CommandManager.RequerySuggested> событий для уведомления команды о необходимости вызова <xref:System.Windows.Input.ICommand.CanExecuteChanged> событий.</span><span class="sxs-lookup"><span data-stu-id="7c06b-226">The <xref:System.Windows.Input.CommandManager> also provides a means, through the <xref:System.Windows.Input.CommandManager.RequerySuggested> event, to notify a command when it should raise the <xref:System.Windows.Input.ICommand.CanExecuteChanged> event.</span></span>  
  
 <span data-ttu-id="7c06b-227"><xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> Заставляет метод <xref:System.Windows.Input.CommandManager> для вызова <xref:System.Windows.Input.CommandManager.RequerySuggested> событий.</span><span class="sxs-lookup"><span data-stu-id="7c06b-227">The <xref:System.Windows.Input.CommandManager.InvalidateRequerySuggested%2A> method forces the <xref:System.Windows.Input.CommandManager> to raise the <xref:System.Windows.Input.CommandManager.RequerySuggested> event.</span></span>  <span data-ttu-id="7c06b-228">Это полезно для условий, которые следует включить или отключить команду, но это не условия, которые <xref:System.Windows.Input.CommandManager> известно.</span><span class="sxs-lookup"><span data-stu-id="7c06b-228">This is useful for conditions that should disable/enable a command but are not conditions that the <xref:System.Windows.Input.CommandManager> is aware of.</span></span>  
  
<a name="Command_Library"></a>   
## <a name="command-library"></a><span data-ttu-id="7c06b-229">Библиотека команд</span><span class="sxs-lookup"><span data-stu-id="7c06b-229">Command Library</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="7c06b-230"> предоставляет набор стандартных команд.</span><span class="sxs-lookup"><span data-stu-id="7c06b-230"> provides a set of predefined commands.</span></span>  <span data-ttu-id="7c06b-231">Библиотека команд включает следующие классы: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>и <xref:System.Windows.Input.ComponentCommands>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-231">The command library consists of the following classes: <xref:System.Windows.Input.ApplicationCommands>, <xref:System.Windows.Input.NavigationCommands>, <xref:System.Windows.Input.MediaCommands>, <xref:System.Windows.Documents.EditingCommands>, and the <xref:System.Windows.Input.ComponentCommands>.</span></span>  <span data-ttu-id="7c06b-232">Эти классы предоставляют команд, таких как <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> и <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, и <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-232">These classes provide commands such as <xref:System.Windows.Input.ApplicationCommands.Cut%2A>, <xref:System.Windows.Input.NavigationCommands.BrowseBack%2A> and <xref:System.Windows.Input.NavigationCommands.BrowseForward%2A>, <xref:System.Windows.Input.MediaCommands.Play%2A>, <xref:System.Windows.Input.MediaCommands.Stop%2A>, and <xref:System.Windows.Input.MediaCommands.Pause%2A>.</span></span>  
  
 <span data-ttu-id="7c06b-233">Многие из этих команд содержат набор привязок ввода по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="7c06b-233">Many of these commands include a set of default input bindings.</span></span>  <span data-ttu-id="7c06b-234">Например, если вы задаете обработку приложением команды копирования, вы автоматически получаете привязку CTRL+C. Кроме того, вы получаете привязки для других устройств ввода, таких как ввод с помощью пера и голосовых данных [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)].</span><span class="sxs-lookup"><span data-stu-id="7c06b-234">For example, if you specify that your application handles the copy command, you automatically get the keyboard binding "CTRL+C" You also get bindings for other input devices, such as [!INCLUDE[TLA2#tla_tpc](../../../../includes/tla2sharptla-tpc-md.md)] pen gestures and speech information.</span></span>  
  
 <span data-ttu-id="7c06b-235">При ссылке на команды в различных библиотеках команд с помощью [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], обычно можно опустить имя класса библиотеки, который предоставляет статическое свойство команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-235">When you reference commands in the various command libraries using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can usually omit the class name of the library class that exposes the static command property.</span></span> <span data-ttu-id="7c06b-236">Как правило, имена команд задаются однозначно в виде строк и существуют типы владельца, которые обеспечивает логическую группировку команд, однако они не являются необходимыми для устранения неоднозначности.</span><span class="sxs-lookup"><span data-stu-id="7c06b-236">Generally, the command names are unambiguous as strings, and the owning types exist to provide a logical grouping of commands but are not necessary for disambiguation.</span></span> <span data-ttu-id="7c06b-237">Например, можно указать `Command="Cut"` вместо более подробной команды `Command="ApplicationCommands.Cut"`.</span><span class="sxs-lookup"><span data-stu-id="7c06b-237">For instance, you can specify `Command="Cut"` rather than the more verbose `Command="ApplicationCommands.Cut"`.</span></span> <span data-ttu-id="7c06b-238">Это удобный механизм встроен в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] обработчик команд (точнее, это поведение преобразователя типа <xref:System.Windows.Input.ICommand>, который [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] процессора ссылки во время загрузки).</span><span class="sxs-lookup"><span data-stu-id="7c06b-238">This is a convenience mechanism that is built in to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor for commands (more precisely, it is a type converter behavior of <xref:System.Windows.Input.ICommand>, which the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processor references at load time).</span></span>  
  
<a name="creating_commands"></a>   
## <a name="creating-custom-commands"></a><span data-ttu-id="7c06b-239">Создание настраиваемых команд</span><span class="sxs-lookup"><span data-stu-id="7c06b-239">Creating Custom Commands</span></span>  
 <span data-ttu-id="7c06b-240">Если команды в классах библиотеки команд не соответствуют вашим потребностям, вы можете создать собственные команды.</span><span class="sxs-lookup"><span data-stu-id="7c06b-240">If the commands in the command library classes do not meet your needs, then you can create your own commands.</span></span>  <span data-ttu-id="7c06b-241">Настраиваемые команды можно создать двумя способами.</span><span class="sxs-lookup"><span data-stu-id="7c06b-241">There are two ways to create a custom command.</span></span>  <span data-ttu-id="7c06b-242">Первый — для запуска с нуля и реализовать <xref:System.Windows.Input.ICommand> интерфейса.</span><span class="sxs-lookup"><span data-stu-id="7c06b-242">The first is to start from the ground up and implement the <xref:System.Windows.Input.ICommand> interface.</span></span>  <span data-ttu-id="7c06b-243">Другим способом, а также наиболее распространенный подход — создание <xref:System.Windows.Input.RoutedCommand> или <xref:System.Windows.Input.RoutedUICommand>.</span><span class="sxs-lookup"><span data-stu-id="7c06b-243">The other way, and the more common approach, is to create a <xref:System.Windows.Input.RoutedCommand> or a <xref:System.Windows.Input.RoutedUICommand>.</span></span>  
  
 <span data-ttu-id="7c06b-244">Пример создания пользовательской <xref:System.Windows.Input.RoutedCommand>, в разделе [создать пользовательский образец RoutedCommand](http://go.microsoft.com/fwlink/?LinkID=159980).</span><span class="sxs-lookup"><span data-stu-id="7c06b-244">For an example of creating a custom <xref:System.Windows.Input.RoutedCommand>, see [Create a Custom RoutedCommand Sample](http://go.microsoft.com/fwlink/?LinkID=159980).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c06b-245">См. также</span><span class="sxs-lookup"><span data-stu-id="7c06b-245">See Also</span></span>  
 <xref:System.Windows.Input.RoutedCommand>  
 <xref:System.Windows.Input.CommandBinding>  
 <xref:System.Windows.Input.InputBinding>  
 <xref:System.Windows.Input.CommandManager>  
 [<span data-ttu-id="7c06b-246">Общие сведения о входных данных</span><span class="sxs-lookup"><span data-stu-id="7c06b-246">Input Overview</span></span>](../../../../docs/framework/wpf/advanced/input-overview.md)  
 [<span data-ttu-id="7c06b-247">Общие сведения о перенаправленных событиях</span><span class="sxs-lookup"><span data-stu-id="7c06b-247">Routed Events Overview</span></span>](../../../../docs/framework/wpf/advanced/routed-events-overview.md)  
 [<span data-ttu-id="7c06b-248">Реализация ICommandSource</span><span class="sxs-lookup"><span data-stu-id="7c06b-248">Implement ICommandSource</span></span>](../../../../docs/framework/wpf/advanced/how-to-implement-icommandsource.md)  
 [<span data-ttu-id="7c06b-249">Практическое руководство. Добавление команды в объект MenuItem</span><span class="sxs-lookup"><span data-stu-id="7c06b-249">How to: Add a Command to a MenuItem</span></span>](http://msdn.microsoft.com/library/013d68a0-5373-4a68-bd91-5de574307370)  
 [<span data-ttu-id="7c06b-250">Создание примера настраиваемой команды RoutedCommand</span><span class="sxs-lookup"><span data-stu-id="7c06b-250">Create a Custom RoutedCommand Sample</span></span>](http://go.microsoft.com/fwlink/?LinkID=159980)
