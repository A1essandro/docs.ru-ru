---
title: "Общие сведения об источниках привязки | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-wpf"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "привязка данных, привязка к источникам"
  - "привязка к источникам"
  - "привязка данных, источник привязки"
ms.assetid: 2df2cd11-6aac-4bdf-ab7b-ea5f464cd5ca
caps.latest.revision: 25
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 24
---
# Общие сведения об источниках привязки
В привязке данных объект\-[источник привязки](GTMT) означает объект, из которого получаются данные.  В этом разделе рассматриваются типы объектов, которые можно использовать в качестве источника привязки.  
  
 [!INCLUDE[autoOutline](../Token/autoOutline_md.md)]  
  
<a name="binding_sources"></a>   
## Типы источников привязки  
 Привязка данных [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] поддерживает следующие типы [источника привязки](GTMT):  
  
|Источник привязки|Описание|  
|-----------------------|--------------|  
|Объекты [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)]|Можно выполнять привязку к открытым свойствам, подсвойствам, а также индексаторам любого объекта [!INCLUDE[TLA#tla_clr](../../../../includes/tlasharptla-clr-md.md)].  Обработчик привязки использует отражение [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] для получения значений свойств.  Кроме того, объекты, которые реализуют <xref:System.ComponentModel.ICustomTypeDescriptor> или имеют зарегистрированные <xref:System.ComponentModel.TypeDescriptionProvider>, также работают с обработчиком привязки.<br /><br /> Дополнительные сведения о реализации класса, который можно использовать как источник привязки, см. в подразделе [Реализация класса, используемого как источник привязки](#classes) далее в этом разделе.|  
|Динамические объекты|Можно выполнять привязку к доступным свойствам и индексаторам объекта, реализующего интерфейс <xref:System.Dynamic.IDynamicMetaObjectProvider>.  Если к элементу можно обратиться в коде, к нему можно выполнить привязку.  Например, если динамический объект позволяет обратиться к методу в коде через свойство `someObjet.AProperty`, к нему можно выполнить привязку, указав путь привязки `AProperty`.|  
|Объекты [!INCLUDE[TLA#tla_adonet](../../../../includes/tlasharptla-adonet-md.md)]|Можно выполнять привязку к объектам [!INCLUDE[TLA2#tla_adonet](../../../../includes/tla2sharptla-adonet-md.md)], таким как <xref:System.Data.DataTable>. Объект <xref:System.Data.DataView> [!INCLUDE[TLA2#tla_adonet](../../../../includes/tla2sharptla-adonet-md.md)] реализует интерфейс <xref:System.ComponentModel.IBindingList>, предоставляющий уведомления об изменениях, ожидаемые модулем привязки.|  
|Объекты [!INCLUDE[TLA#tla_xml](../../../../includes/tlasharptla-xml-md.md)]|Можно выполнять привязку и запросы `XPath` для объектов <xref:System.Xml.XmlNode>, <xref:System.Xml.XmlDocument> и <xref:System.Xml.XmlElement>.  Удобный способ доступа к данным [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)], которые являются [источником привязки](GTMT) в разметке, заключается в использовании объекта <xref:System.Windows.Data.XmlDataProvider>.  Дополнительные сведения см. в разделе [Привязка к XML\-данным с помощью XMLDataProvider и запросов XPath](../../../../docs/framework/wpf/data/how-to-bind-to-xml-data-using-an-xmldataprovider-and-xpath-queries.md).<br /><br /> Также можно выполнять привязку к объектам <xref:System.Xml.Linq.XElement> и <xref:System.Xml.Linq.XDocument> и к результатам запросов, выполняемых для объектов этих типов с помощью средства LINQ to XML.  Удобный способ доступа к данным XML, являющимся источником привязки, с помощью средства LINQ to XML в разметке заключается в использовании объекта <xref:System.Windows.Data.ObjectDataProvider>.  Дополнительные сведения см. в разделе [Привязка к XDocument, XElement или LINQ для результатов запросов XML](../../../../docs/framework/wpf/data/how-to-bind-to-xdocument-xelement-or-linq-for-xml-query-results.md).|  
|Объекты <xref:System.Windows.DependencyObject>|Можно выполнять привязку к [свойствам зависимости](GTMT) любого объекта <xref:System.Windows.DependencyObject>.  Пример см. в разделе [Привязка свойств двух элементов управления](../../../../docs/framework/wpf/data/how-to-bind-the-properties-of-two-controls.md).|  
  
<a name="classes"></a>   
## Реализация класса, используемого как источник привязки  
 Можно создавать собственные источники привязки.  В этом разделе приводятся сведения, необходимые для реализации класса, используемого как источник привязки.  
  
### Предоставление уведомлений об изменениях  
 Если используется привязка <xref:System.Windows.Data.BindingMode> или <xref:System.Windows.Data.BindingMode> \(поскольку требуется, чтобы [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] обновлялся при динамическом изменении свойств источника привязки\), необходимо реализовать подходящий механизм уведомления об изменениях свойств.  Рекомендуемым механизмом для классов [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] и динамических классов является реализация интерфейса <xref:System.ComponentModel.INotifyPropertyChanged>.  Дополнительные сведения см. в разделе [Реализация уведомления об изменении свойства](../../../../docs/framework/wpf/data/how-to-implement-property-change-notification.md).  
  
 Если создать объект [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)], в котором не реализован <xref:System.ComponentModel.INotifyPropertyChanged>, необходимо реализовать свою систему уведомлений, обеспечивающую обновление данных, используемых в привязке.  Вы можете предоставить уведомление об изменениях при помощи шаблона `PropertyChanged` для каждого свойства для которого вам требуются уведомления об изменении.  Для этого необходимо определить событие *PropertyName*Changed для каждого свойства, где *PropertyName* — это имя свойства.  Вы вызываете событие каждый раз при изменении свойства.  
  
 Если в источнике привязки реализован один или несколько таких механизмов уведомления, целевой объект обновляется автоматически.  Если по какой\-либо причине источник привязки не обеспечивает соответствующие уведомления об изменениях свойств, можно использовать метод <xref:System.Windows.Data.BindingExpression.UpdateTarget%2A> для обновления целевого свойства явным образом.  
  
### Другие характеристики  
 Ниже приведены другие важные моменты:  
  
-   Если вам требуется создать объект в [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], класс должен иметь конструктор по умолчанию.  В некоторых языках [!INCLUDE[TLA2#tla_net](../../../../includes/tla2sharptla-net-md.md)], таких как [!INCLUDE[TLA#tla_cshrp](../../../../includes/tlasharptla-cshrp-md.md)], конструктор по умолчанию может быть уже создан для вас.  
  
-   Свойства, используемые в качестве свойств источника привязки, должны быть открытыми свойствами класса.  Явно определенные свойства интерфейса не могут использоваться для привязки, так же как и защищенные, закрытые, внутренние и виртуальные свойства, не имеющие базовой реализации.  
  
-   Можно выполнять привязку к открытым полям.  
  
-   Тип свойства, объявленного в вашем классе, является типом, передаваемым привязке.  Однако тип используемой привязки в конечном счете зависит от типа свойства [цели привязки](GTMT), а не свойства источника привязки.  Если есть разница в типе, вам может потребоваться написать преобразователь для обработки того, как ваше пользовательское свойство по умолчанию передается привязке.  Дополнительные сведения см. в разделе <xref:System.Windows.Data.IValueConverter>.  
  
<a name="objects"></a>   
## Использование всего объекта в качестве источника привязки  
 В качестве объекта привязки можно использовать весь объект.  Можно указать источник привязки с помощью свойства <xref:System.Windows.Data.Binding.Source%2A> или <xref:System.Windows.FrameworkElement.DataContext%2A>, затем добавить пустое определение привязки: `{Binding}`.  Сценарии, в которых это полезно, включают привязку к объектам строкового типа, привязку к объектам с несколькими интересующими вас свойствами или привязку к коллекции объектов.  Пример привязки к целому объекту коллекции содержится в разделе [Использование шаблона "главный\-подчиненный" с иерархическими данными](../../../../docs/framework/wpf/data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).  
  
 Обратите внимание, что вам, возможно, потребуется применить пользовательскую логику, чтобы данные были применимы к вашему привязанному свойству цели.  Пользовательская логика может быть в виде пользовательского преобразователя \(если не существует преобразования типа по умолчанию\) или <xref:System.Windows.DataTemplate>.  Дополнительные сведения о преобразователях см. в подразделе "Преобразование данных" раздела [Общие сведения о связывании данных](../../../../docs/framework/wpf/data/data-binding-overview.md).  Дополнительные сведения о шаблонах данных см. в разделе [Общие сведения о шаблонах данных](../../../../docs/framework/wpf/data/data-templating-overview.md).  
  
<a name="collections"></a>   
## Использование объекта коллекции в качестве источника привязки  
 Нередко возникает необходимость использовать в качестве источника привязки объект, являющийся коллекцией пользовательских объектов.  Каждый объект играет роль источника для одного экземпляра повторной привязки.  Допустим, к примеру, что имеется коллекция `CustomerOrders`, состоящая из объектов `CustomerOrder`, и разрабатываемое приложение поочередно рассматривает элементы коллекции, пытаясь определить, сколько существует заказов, и прочитать данные, содержащиеся в каждом из них.  
  
 Пользователь может выполнить перечисление элементов любой коллекции, реализующей интерфейс <xref:System.Collections.IEnumerable>.  Однако чтобы настроить динамические привязки таким образом, чтобы вставки и удаления элементов в коллекции автоматически обновляли [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], в коллекции должен быть реализован интерфейс <xref:System.Collections.Specialized.INotifyCollectionChanged>.  Этот интерфейс предоставляет событие, которое должно быть вызвано при изменении базовой коллекции.  
  
 Класс <xref:System.Collections.ObjectModel.ObservableCollection%601> является встроенной реализацией коллекции данных, предоставляющей интерфейс <xref:System.Collections.Specialized.INotifyCollectionChanged>.  Отдельные объекты данных в коллекции должны удовлетворять требованиям, описанным в разделах выше.  Пример см. в разделе [Создание и привязка ObservableCollection](../../../../docs/framework/wpf/data/how-to-create-and-bind-to-an-observablecollection.md).  До реализации собственной коллекции рассмотрите возможность использования класса <xref:System.Collections.ObjectModel.ObservableCollection%601> или одного из существующих классов коллекций, таких как <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ObjectModel.Collection%601> и <xref:System.ComponentModel.BindingList%601> \(среди многих прочих\).  
  
 WPF никогда не реализует прямую привязку к коллекции.  Если в качестве источника привязки указана коллекция, WPF выполняет привязку к представлению коллекции по умолчанию.  Сведения о представлениях по умолчанию см. в разделе [Общие сведения о связывании данных](../../../../docs/framework/wpf/data/data-binding-overview.md).  
  
 В более сложных случаях, когда требуется самостоятельно реализовать коллекцию, рассмотрите возможность использования интерфейса <xref:System.Collections.IList>.  Интерфейс <xref:System.Collections.IList> предоставляет неуниверсальную коллекцию объектов, к каждому из которых можно обратиться по индексу, что позволяет повысить производительность.  
  
<a name="permissions"></a>   
## Необходимые разрешения при использовании привязки данных  
 При использовании привязки данных необходимо учитывать уровень доверия приложения.  В следующей таблице перечислено, какие типы свойств могут быть привязаны в приложении, выполняющемся либо при полном доверии, либо при частичном доверии:  
  
|Тип свойства<br /><br /> \(все модификаторы доступа\)|Свойство динамического объекта|Свойство динамического объекта|Свойство среды CLR|Свойство среды CLR|Свойство зависимости|Свойство зависимости|  
|---------------------------------------------------|------------------------------------|------------------------------------|------------------------|------------------------|--------------------------|--------------------------|  
|**Уровень доверия**|**Полное доверие**|**Частичное доверие**|**Полное доверие**|**Частичное доверие**|**Полное доверие**|**Частичное доверие**|  
|Открытый класс|Да|Да|Да|Да|Да|Да|  
|Не открытый класс|Да|Нет|Да|Нет|Да|Да|  
  
 В этой таблице описаны следующие важные моменты для требований разрешений в привязке данных:  
  
-   Для свойств [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] привязка данных действует, только если обработчик привязки может обращаться к свойству источника привязки с помощью отражения.  В противном случае обработчик привязки выдает предупреждение о том, что свойство не найдено, и использует запасное значение или значение по умолчанию, если оно доступно.  
  
-   Можно выполнять привязку к свойствам динамических объектов, определенных во время компиляции или выполнения.  
  
-   Всегда можно осуществить привязку к [свойствам зависимости](GTMT).  
  
 Требование разрешений для привязки [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] является аналогичным. В песочнице с частичным доверием происходит сбой поставщика <xref:System.Windows.Data.XmlDataProvider>, если у него нет разрешений для доступа к указанным данным.  
  
 Объекты анонимных типов являются внутренними.  Привязку к свойствам внутренних типов можно выполнять только при запуске приложения с полным доверием.  Дополнительные сведения об анонимных типах см. в разделе [Анонимные типы \(Руководство по программированию в C\#\)](../Topic/Anonymous%20Types%20\(C%23%20Programming%20Guide\).md) или [Анонимные типы \(Visual Basic\)](../Topic/Anonymous%20Types%20\(Visual%20Basic\).md) \(Visual Basic\).  
  
 Дополнительные сведения о безопасности частичного доверия содержатся в разделе [Безопасность частичного доверия в WPF](../../../../docs/framework/wpf/wpf-partial-trust-security.md).  
  
## См. также  
 <xref:System.Windows.Data.ObjectDataProvider>   
 <xref:System.Windows.Data.XmlDataProvider>   
 [Указание источника привязки](../../../../docs/framework/wpf/data/how-to-specify-the-binding-source.md)   
 [Общие сведения о связывании данных](../../../../docs/framework/wpf/data/data-binding-overview.md)   
 [Практические руководства](../../../../docs/framework/wpf/data/data-binding-how-to-topics.md)   
 [Общие сведения о связывании с данными в WPF с помощью LINQ to XML](../Topic/WPF%20Data%20Binding%20with%20LINQ%20to%20XML%20Overview.md)   
 [Привязка данных](../../../../docs/framework/wpf/advanced/optimizing-performance-data-binding.md)