---
title: "Общие сведения о надстройках WPF"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
caps.latest.revision: "36"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: ffd45957b41cdfd8488aedd865aa70ef5b2634b2
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2018
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="eca89-102">Общие сведения о надстройках WPF</span><span class="sxs-lookup"><span data-stu-id="eca89-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="eca89-103">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] включает модель надстроек, которую разработчики могут использовать для создания приложений, поддерживающих расширения среды с использованием надстроек.</span><span class="sxs-lookup"><span data-stu-id="eca89-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="eca89-104">Эта модель позволяет создавать надстройки, которые интегрируются с функциональностью приложения и расширяют ее.</span><span class="sxs-lookup"><span data-stu-id="eca89-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="eca89-105">В некоторых сценариях приложения также должны отображать [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], которые предоставляются надстройками. В данном разделе показано, как [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] расширяет модель надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для поддержки этих сценариев, описаны ее архитектура, преимущества и ограничения.</span><span class="sxs-lookup"><span data-stu-id="eca89-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="eca89-106">Предварительные требования</span><span class="sxs-lookup"><span data-stu-id="eca89-106">Prerequisites</span></span>  
 <span data-ttu-id="eca89-107">Необходимо ознакомиться с моделью надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="eca89-108">Дополнительные сведения см. в разделе [Надстройки и расширяемость](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="eca89-109">Общие сведения о надстройках</span><span class="sxs-lookup"><span data-stu-id="eca89-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="eca89-110">Чтобы избежать сложностей повторной компиляции и развертывания приложений для включения новых функциональных возможностей, приложения реализуют механизмы расширяемости, которые позволяют разработчикам (как собственным, так и сторонним) создавать другие приложения с поддержкой интеграции.</span><span class="sxs-lookup"><span data-stu-id="eca89-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="eca89-111">Наиболее распространенным способом поддержки этого типа расширяемости является использование надстроек (также называемых "подключаемыми модулями").</span><span class="sxs-lookup"><span data-stu-id="eca89-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="eca89-112">Примеры реальных приложений, которые обеспечивают расширяемость с помощью надстроек:</span><span class="sxs-lookup"><span data-stu-id="eca89-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="eca89-113">Надстройки Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="eca89-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="eca89-114">Надстройки проигрывателя Windows Media.</span><span class="sxs-lookup"><span data-stu-id="eca89-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="eca89-115">Надстройки Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="eca89-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="eca89-116">Например, модель надстроек проигрывателя Windows Media позволяет сторонним разработчикам реализовать "подключаемые модули", расширяющие возможности проигрывателя Windows Media различными способами, включая создание декодеров и кодировщиков для форматов мультимедиа, изначально не поддерживаемых проигрывателем Windows Media (например: DVD, MP3), а также звуковых эффектов и обложек.</span><span class="sxs-lookup"><span data-stu-id="eca89-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="eca89-117">Каждая модель надстройки создается для предоставления функций, уникальных для приложения, хотя существует несколько элементов и поведений, общих для всех моделей.</span><span class="sxs-lookup"><span data-stu-id="eca89-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="eca89-118">Тремя основными сущностями типичных решений расширяемости являются *контракты*, *надстройки* и *ведущие приложения*.</span><span class="sxs-lookup"><span data-stu-id="eca89-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="eca89-119">Контракты определяют интеграцию надстроек с ведущими приложениями двумя способами:</span><span class="sxs-lookup"><span data-stu-id="eca89-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="eca89-120">Надстройки интегрируются с функциональными возможностями, реализуемыми ведущими приложениями.</span><span class="sxs-lookup"><span data-stu-id="eca89-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="eca89-121">Ведущие приложения предоставляют функциональные возможности для надстроек, с которыми интегрируются.</span><span class="sxs-lookup"><span data-stu-id="eca89-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="eca89-122">Чтобы использовать надстройки, ведущие приложения должны найти их и загрузить во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eca89-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="eca89-123">Следовательно, приложения, поддерживающие надстройки, имеют следующие дополнительные обязанности:</span><span class="sxs-lookup"><span data-stu-id="eca89-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="eca89-124">**Обнаружение**: поиск надстроек, которые соответствуют контрактам, поддерживаемым ведущими приложениями.</span><span class="sxs-lookup"><span data-stu-id="eca89-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="eca89-125">**Активация**: загрузка, запуск и установка связи с надстройками.</span><span class="sxs-lookup"><span data-stu-id="eca89-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="eca89-126">**Изоляция**: использование доменов приложений или процессов для установления границ изоляции, защищающих приложения от потенциальных проблем безопасности и выполнения, связанных с надстройками.</span><span class="sxs-lookup"><span data-stu-id="eca89-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="eca89-127">**Обмен данными**: разрешение надстройкам и ведущим приложениям взаимодействовать друг с другом через границы изоляции путем вызова методов и передачи данных.</span><span class="sxs-lookup"><span data-stu-id="eca89-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="eca89-128">**Управление жизненным циклом объекта**: загрузка и выгрузка доменов приложений и процессов ясным, прогнозируемым способом (см. [Домены приложений](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="eca89-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="eca89-129">**Управление версиями**: гарантия возможности взаимодействия ведущих приложений и надстроек после создания их новых версий.</span><span class="sxs-lookup"><span data-stu-id="eca89-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="eca89-130">В конечном счете разработка надежной модели надстройки является нетривиальный задачей.</span><span class="sxs-lookup"><span data-stu-id="eca89-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="eca89-131">По этой причине [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] обеспечивает инфраструктуру для создания моделей надстроек.</span><span class="sxs-lookup"><span data-stu-id="eca89-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="eca89-132">Более подробные сведения о надстройках см. в разделе [Надстройки и расширения среды](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="eca89-133">Общие сведения о модели надстроек платформы .NET Framework</span><span class="sxs-lookup"><span data-stu-id="eca89-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="eca89-134">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Добавить в модель, находящаяся в <xref:System.AddIn> имен, содержит набор типов, которые предназначены для упрощения разработки расширяемости надстроек.</span><span class="sxs-lookup"><span data-stu-id="eca89-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="eca89-135">Основной единицей модели надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] является *контракт*, который определяет, как ведущее приложение и надстройка взаимодействуют друг с другом.</span><span class="sxs-lookup"><span data-stu-id="eca89-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="eca89-136">Контракт предоставляется ведущему приложению с помощью специфичного для ведущего приложения *представления* контракта.</span><span class="sxs-lookup"><span data-stu-id="eca89-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="eca89-137">Аналогичным образом надстройке предоставляется специфичное для нее *представление* контракта.</span><span class="sxs-lookup"><span data-stu-id="eca89-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="eca89-138">*Адаптер* позволяет ведущему приложению и надстройке обмениваться данными между соответствующими представлениями контракта.</span><span class="sxs-lookup"><span data-stu-id="eca89-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="eca89-139">Контракты, представления и адаптеры называются сегментами, а набор связанных сегментов составляет *конвейер*.</span><span class="sxs-lookup"><span data-stu-id="eca89-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="eca89-140">Конвейеры — это основа, на базе которой модель надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] поддерживает обнаружение, активацию, изоляцию в целях безопасности, изоляцию выполнения (используя как домены приложений, так и процессы), обмен данными, управление жизненным циклом и управление версиями.</span><span class="sxs-lookup"><span data-stu-id="eca89-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="eca89-141">Эта поддержка в целом позволяет разработчикам создавать надстройки, которые интегрируются с функциональностью ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="eca89-142">Однако в некоторых сценариях требуется, чтобы ведущее приложение отображало [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], предоставляемое надстройками. Поскольку каждая технология представления в [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] имеет свою собственную модель реализации [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], модель надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] не поддерживает какую-либо определенную технологию представления.</span><span class="sxs-lookup"><span data-stu-id="eca89-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="eca89-143">Вместо этого [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] расширяет модель надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] с помощью поддержки [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] для надстроек.</span><span class="sxs-lookup"><span data-stu-id="eca89-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="eca89-144">Надстройки WPF</span><span class="sxs-lookup"><span data-stu-id="eca89-144">WPF Add-Ins</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="eca89-145"> в сочетании с моделью надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] позволяет обращаться к широкому спектру сценариев, необходимых ведущим приложениям для отображения [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] из надстроек. В частности, эти сценарии реализуются в [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] с помощью следующих двух моделей программирования.</span><span class="sxs-lookup"><span data-stu-id="eca89-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="eca89-146">**Надстройка возвращает пользовательский интерфейс**.</span><span class="sxs-lookup"><span data-stu-id="eca89-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="eca89-147">Надстройка возвращает [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ведущему приложению с помощью вызова метода, как это определено контрактом.</span><span class="sxs-lookup"><span data-stu-id="eca89-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="eca89-148">Этот сценарий используется в следующих случаях.</span><span class="sxs-lookup"><span data-stu-id="eca89-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="eca89-149">Внешний вид [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], возвращаемого надстройкой, зависит от данных или условий, которые существуют только во время выполнения, например динамически создаваемые отчеты.</span><span class="sxs-lookup"><span data-stu-id="eca89-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="eca89-150">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] для служб, предоставляемых надстройкой, отличается от [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ведущих приложений, которые могут использовать надстройку.</span><span class="sxs-lookup"><span data-stu-id="eca89-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="eca89-151">Надстройка исполняет службу для ведущего приложения и сообщает ведущему приложению о статусе с помощью [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="eca89-152">**Надстройка — это пользовательский интерфейс**.</span><span class="sxs-lookup"><span data-stu-id="eca89-152">**The add-in is a UI**.</span></span> <span data-ttu-id="eca89-153">Надстройка — это [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], как определено в контракте.</span><span class="sxs-lookup"><span data-stu-id="eca89-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="eca89-154">Этот сценарий используется в следующих случаях.</span><span class="sxs-lookup"><span data-stu-id="eca89-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="eca89-155">Надстройка не предоставляет службы помимо отображения, например рекламного объявления.</span><span class="sxs-lookup"><span data-stu-id="eca89-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="eca89-156">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] для служб, предоставляемых надстройкой, является общим для всех ведущих приложений, которые могут использовать эту надстройку, например калькулятор или палитру.</span><span class="sxs-lookup"><span data-stu-id="eca89-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="eca89-157">Эти сценарии требуют возможности передачи объектов [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] между доменами ведущих приложений и приложений надстроек.</span><span class="sxs-lookup"><span data-stu-id="eca89-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="eca89-158">Поскольку модель надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] основана на удаленном взаимодействии между доменами приложений, передаваемые между ними объекты должны поддерживать удаленную обработку.</span><span class="sxs-lookup"><span data-stu-id="eca89-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="eca89-159">Объект, поддерживающий удаленную обработку, является экземпляром класса, который выполняет одну или несколько из следующих функций:</span><span class="sxs-lookup"><span data-stu-id="eca89-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="eca89-160">Является производным от <xref:System.MarshalByRefObject> класса.</span><span class="sxs-lookup"><span data-stu-id="eca89-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="eca89-161">Реализует интерфейс <xref:System.Runtime.Serialization.ISerializable>.</span><span class="sxs-lookup"><span data-stu-id="eca89-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="eca89-162">Имеет <xref:System.SerializableAttribute> применен атрибут.</span><span class="sxs-lookup"><span data-stu-id="eca89-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="eca89-163">Дополнительные сведения о создании удаленных объектов [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] см. в разделе [Обеспечение поддержки удаленного взаимодействия с объектами](http://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="eca89-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](http://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="eca89-164">Типы [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] не поддерживают удаленное взаимодействие.</span><span class="sxs-lookup"><span data-stu-id="eca89-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="eca89-165">Для решения этой проблемы [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] расширяет модель надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], чтобы разрешить отображение [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], созданных надстройками, из ведущих приложений.</span><span class="sxs-lookup"><span data-stu-id="eca89-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="eca89-166">Эта поддержка обеспечивается [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] двух типов: <xref:System.AddIn.Contract.INativeHandleContract> интерфейс и два статических методов, реализованных <xref:System.AddIn.Pipeline.FrameworkElementAdapters> класса: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> и <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="eca89-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="eca89-167">На высоком уровне эти типы и методы используются следующим образом:</span><span class="sxs-lookup"><span data-stu-id="eca89-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="eca89-168">требуется [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , предоставляемые надстройки — это классы, прямо или косвенно наследующие от <xref:System.Windows.FrameworkElement>, таких как фигуры, элементы управления, пользовательские элементы управления, панели макета и страниц.</span><span class="sxs-lookup"><span data-stu-id="eca89-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="eca89-169">Везде, где контракт объявляет, что пользовательский Интерфейс будет передаваться между надстройкой и ведущим приложением, должен быть объявлен как <xref:System.AddIn.Contract.INativeHandleContract> (не <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> является удаленным представлением надстройки [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] могут передаваться через границы изоляции.</span><span class="sxs-lookup"><span data-stu-id="eca89-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="eca89-170">Перед передачей из надстройки в домен приложения <xref:System.Windows.FrameworkElement> упаковывается в виде <xref:System.AddIn.Contract.INativeHandleContract> путем вызова <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="eca89-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="eca89-171">После передачи домен приложения ведущего приложения, <xref:System.AddIn.Contract.INativeHandleContract> нужно упаковать в <xref:System.Windows.FrameworkElement> путем вызова <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="eca89-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="eca89-172">Как <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, и <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> используются зависит от конкретного сценария.</span><span class="sxs-lookup"><span data-stu-id="eca89-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="eca89-173">В следующих разделах содержатся сведения о каждой модели программирования.</span><span class="sxs-lookup"><span data-stu-id="eca89-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="eca89-174">Надстройка возвращает пользовательский интерфейс</span><span class="sxs-lookup"><span data-stu-id="eca89-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="eca89-175">Чтобы надстройка возвращала [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] в ведущее приложение, необходимо выполнить следующее.</span><span class="sxs-lookup"><span data-stu-id="eca89-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="eca89-176">Ведущее приложение, надстройка и конвейер должны быть созданы в соответствии с документацией [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Надстройки и расширения среды](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="eca89-177">Контракт должен реализовать <xref:System.AddIn.Contract.IContract> и для возврата [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], контракт должен объявить метод с возвращаемым значением типа <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="eca89-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="eca89-178">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , Передаваемого между надстройкой и узлом приложения должен прямо или косвенно наследовать <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="eca89-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="eca89-179">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] , Возвращаемый надстройка должна быть преобразована из <xref:System.Windows.FrameworkElement> для <xref:System.AddIn.Contract.INativeHandleContract> до пересечения границы изоляции.</span><span class="sxs-lookup"><span data-stu-id="eca89-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="eca89-180">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] Возвращается должна быть преобразована из <xref:System.AddIn.Contract.INativeHandleContract> для <xref:System.Windows.FrameworkElement> после пересечения границы изоляции.</span><span class="sxs-lookup"><span data-stu-id="eca89-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="eca89-181">Ведущее приложение отображает возвращаемый <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="eca89-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="eca89-182">Пример, который демонстрирует реализацию надстройки, возвращающей [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], см. в разделе [Создание надстройки, возвращающей пользовательский интерфейс](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="eca89-183">Надстройка является пользовательским интерфейсом</span><span class="sxs-lookup"><span data-stu-id="eca89-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="eca89-184">Если надстройка является [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], необходимо выполнение следующих условий.</span><span class="sxs-lookup"><span data-stu-id="eca89-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="eca89-185">Ведущее приложение, надстройка и конвейер должны быть созданы в соответствии с документацией [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Надстройки и расширения среды](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="eca89-186">Необходимо реализовать интерфейс контракта для надстройки <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="eca89-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="eca89-187">Надстройки, которая передается в ведущее приложение должно прямо или косвенно наследовать <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="eca89-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="eca89-188">Надстройка должна быть преобразована из <xref:System.Windows.FrameworkElement> для <xref:System.AddIn.Contract.INativeHandleContract> до пересечения границы изоляции.</span><span class="sxs-lookup"><span data-stu-id="eca89-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="eca89-189">Надстройка должна быть преобразована из <xref:System.AddIn.Contract.INativeHandleContract> для <xref:System.Windows.FrameworkElement> после пересечения границы изоляции.</span><span class="sxs-lookup"><span data-stu-id="eca89-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="eca89-190">Ведущее приложение отображает возвращаемый <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="eca89-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="eca89-191">Пример реализации надстройки, которая является [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], см. в разделе [Создание надстройки, являющейся пользовательским интерфейсом](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="eca89-192">Возвращение нескольких пользовательских интерфейсов из надстройки</span><span class="sxs-lookup"><span data-stu-id="eca89-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="eca89-193">Надстройки часто предоставляют несколько [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] для отображения ведущими приложениями.</span><span class="sxs-lookup"><span data-stu-id="eca89-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="eca89-194">Например, рассмотрим надстройку, являющуюся [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], которая также предоставляет ведущему приложению сведения о состоянии, аналогично [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="eca89-195">Такие надстройки можно реализовать с помощью сочетания методов из моделей [Надстройка возвращает пользовательский интерфейс](#ReturnUIFromAddInContract) и [Надстройка является пользовательским интерфейсом](#AddInIsAUI).</span><span class="sxs-lookup"><span data-stu-id="eca89-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="eca89-196">Надстройки и приложения браузера XAML</span><span class="sxs-lookup"><span data-stu-id="eca89-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="eca89-197">В приведенных примерах ведущее приложение было установленным автономным приложением.</span><span class="sxs-lookup"><span data-stu-id="eca89-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="eca89-198">Однако [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] также может размещать надстройки, хотя при этом применяются следующие дополнительные требования к сборке и реализации.</span><span class="sxs-lookup"><span data-stu-id="eca89-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="eca89-199">Манифест приложения [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] должен быть настроен специально для загрузки конвейера (папок и сборок) и сборки надстройки в кэш приложения [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] на клиентской машине в той же папке, где находится [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="eca89-200">Код [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] для обнаружения и загрузки надстроек должен использовать кэш приложения [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] для [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] в качестве расположения конвейера и надстройки.</span><span class="sxs-lookup"><span data-stu-id="eca89-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="eca89-201">[!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] должен загрузить надстройку в специальный контекст безопасности, если надстройка ссылается на свободные файлы, расположенные на исходном узле. Если они размещаются в [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], надстройки могут ссылаться только на свободные файлы, расположенные на исходном узле ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="eca89-202">Эти задачи подробно описаны в следующих подразделах.</span><span class="sxs-lookup"><span data-stu-id="eca89-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="eca89-203">Настройка конвейера и надстройки для развертывания ClickOnce</span><span class="sxs-lookup"><span data-stu-id="eca89-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)]<span data-ttu-id="eca89-204"> загружается в безопасную папку в [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] кэше развертывания и запускается из нее.</span><span class="sxs-lookup"><span data-stu-id="eca89-204"> are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="eca89-205">Для размещения надстройки в [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] конвейер и сборка надстройки также должны быть загружены в безопасную папку.</span><span class="sxs-lookup"><span data-stu-id="eca89-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="eca89-206">Для этого нужно настроить манифест приложения для включения и конвейера и сборки надстройки для загрузки.</span><span class="sxs-lookup"><span data-stu-id="eca89-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="eca89-207">Проще всего это сделать в [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], хотя сборка конвейера и надстройки должна находиться в корневой папке проекта [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], чтобы [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] мог обнаружить сборочные узлы конвейера.</span><span class="sxs-lookup"><span data-stu-id="eca89-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="eca89-208">Следовательно, первый шаг — создать сборку конвейера и надстройки в корне проекта [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], настроив выходные данные построения для каждого проекта сборки конвейера и сборки надстройки.</span><span class="sxs-lookup"><span data-stu-id="eca89-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="eca89-209">В следующей таблице показаны выходные пути построения для проектов сборки конвейера и проекта сборки надстройки, которые находятся в том же решении и корневой папке, что и проект ведущего приложения [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="eca89-210">Таблица 1. Создание выходных путей построения для сборок конвейера, размещаемых в XBAP</span><span class="sxs-lookup"><span data-stu-id="eca89-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="eca89-211">Проект сборки конвейера</span><span class="sxs-lookup"><span data-stu-id="eca89-211">Pipeline assembly project</span></span>|<span data-ttu-id="eca89-212">Выходной путь сборки</span><span class="sxs-lookup"><span data-stu-id="eca89-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="eca89-213">Контракт</span><span class="sxs-lookup"><span data-stu-id="eca89-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="eca89-214">Представление надстройки</span><span class="sxs-lookup"><span data-stu-id="eca89-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="eca89-215">Адаптер надстройки</span><span class="sxs-lookup"><span data-stu-id="eca89-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="eca89-216">Адаптер приложения</span><span class="sxs-lookup"><span data-stu-id="eca89-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="eca89-217">Надстройка</span><span class="sxs-lookup"><span data-stu-id="eca89-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="eca89-218">Следующим шагом является указание сборок конвейера и сборки надстройки как файлов содержимого [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] в [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] следующим образом.</span><span class="sxs-lookup"><span data-stu-id="eca89-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="eca89-219">Включение сборки конвейера и надстройки в проект. Для этого следует щелкнуть правой кнопкой мыши каждую папку конвейера в обозревателе решений и выбрать вариант **Включить в проект**.</span><span class="sxs-lookup"><span data-stu-id="eca89-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="eca89-220">Установка для **Действия при построении** для каждой сборки конвейера и надстройки значения **Содержимое** в окне **Свойства**.</span><span class="sxs-lookup"><span data-stu-id="eca89-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="eca89-221">Последним шагом является настройка манифеста приложения для включения файлов сборки конвейера и файла сборки надстройки для загрузки.</span><span class="sxs-lookup"><span data-stu-id="eca89-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="eca89-222">Файлы должны располагаться в папках в корне папки в кэше [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], занимаемом приложением [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="eca89-223">Эта конфигурация может реализовываться в [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] следующим образом:</span><span class="sxs-lookup"><span data-stu-id="eca89-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="eca89-224">Щелкните правой кнопкой мыши проект [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], выберите **Свойства**, **Публиковать**, а затем нажмите кнопку **Файлы приложения**.</span><span class="sxs-lookup"><span data-stu-id="eca89-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="eca89-225">В диалоговом окне **Файлы приложения** установите для параметра **Состояния публикации** каждой DLL конвейера и надстройки значение **Включить (авто)**, а для **Группы загрузки** для каждой DLL конвейера и надстройки — значение **(обязательно)**.</span><span class="sxs-lookup"><span data-stu-id="eca89-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="eca89-226">Использование конвейера и надстройки из базовой папки приложения</span><span class="sxs-lookup"><span data-stu-id="eca89-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="eca89-227">Если конвейер и надстройка настроены для развертывания [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], они загружаются в ту же папку кэша [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], что и [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="eca89-228">Чтобы использовать конвейер и надстройку из [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], код [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] должен получить их из базовой папки приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="eca89-229">Различные типы и элементы модели надстроек [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для использования конвейеров и надстроек обеспечивают специальную поддержку этого сценария.</span><span class="sxs-lookup"><span data-stu-id="eca89-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="eca89-230">Во-первых, путь определяется по <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> значение перечисления.</span><span class="sxs-lookup"><span data-stu-id="eca89-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="eca89-231">Это значение используется при перегрузках соответствующих элементов надстройки для использования конвейеров, которые включают следующее:</span><span class="sxs-lookup"><span data-stu-id="eca89-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="eca89-232">Доступ к исходному узлу ведущего приложения</span><span class="sxs-lookup"><span data-stu-id="eca89-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="eca89-233">Чтобы надстройка могла ссылаться на файлы с исходного узла, она должна быть загружена с изоляцией безопасности, эквивалентной ведущему приложению.</span><span class="sxs-lookup"><span data-stu-id="eca89-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="eca89-234">Этот уровень безопасности определяется <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> значение перечисления и передается <xref:System.AddIn.Hosting.AddInToken.Activate%2A> метод при активизации add-in.</span><span class="sxs-lookup"><span data-stu-id="eca89-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="eca89-235">Архитектура надстроек WPF</span><span class="sxs-lookup"><span data-stu-id="eca89-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="eca89-236">На высоком уровне как мы увидели, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] позволяет [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] надстройки для реализации [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (прямо или косвенно, производные от <xref:System.Windows.FrameworkElement>) с помощью <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> и <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="eca89-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="eca89-237">Результат заключается в том, что ведущее приложение возвращается <xref:System.Windows.FrameworkElement> , берется из [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] в ведущем приложении.</span><span class="sxs-lookup"><span data-stu-id="eca89-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="eca89-238">Для простых сценариев надстройки [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] этих сведений достаточно для разработчиков.</span><span class="sxs-lookup"><span data-stu-id="eca89-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="eca89-239">В более сложных сценариях, в частности тех, где предпринимается попытка использовать дополнительные службы [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], такие как макет, ресурсы и привязки данных, для понимания всех преимуществ и ограничений нужны более подробные сведения о том, как [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] расширяет модель надстройки [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] с помощью поддержки [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="eca89-240">По существу, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] не передает [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] из надстройки в ведущее приложение. Вместо этого [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] передает дескриптор окна Win32 для [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], используя взаимодействие [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="eca89-241">Таким образом, когда [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] из надстройки передается в ведущее приложение, происходит следующее.</span><span class="sxs-lookup"><span data-stu-id="eca89-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="eca89-242">На стороне надстройки [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] получает дескриптор окна для [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], который будет отображаться ведущим приложением.</span><span class="sxs-lookup"><span data-stu-id="eca89-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="eca89-243">Дескриптор окна инкапсулируется внутренним [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] класс, производный от <xref:System.Windows.Interop.HwndSource> и реализует <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="eca89-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="eca89-244">Экземпляр этого класса возвращается с <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> и маршалируется из надстройки в домен приложения в домен приложения ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="eca89-245">На стороне ведущего приложения [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] переупаковывает <xref:System.Windows.Interop.HwndSource> как внутренний [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] класс, производный от <xref:System.Windows.Interop.HwndHost> и использует <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="eca89-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="eca89-246">Экземпляр этого класса возвращается с <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> в ведущее приложение.</span><span class="sxs-lookup"><span data-stu-id="eca89-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="eca89-247"><xref:System.Windows.Interop.HwndHost>существует для отображения [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], определенные с дескрипторами окон из [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="eca89-248">Более подробную информацию см. в разделе [Взаимодействие WPF и Win32](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="eca89-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="eca89-249">Таким образом <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, и <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> , позволяющие дескриптор окна для [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] должен передаваться из надстройки в ведущее приложение, где он инкапсулируется <xref:System.Windows.Interop.HwndHost> и отображается в узле приложения [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="eca89-250">Поскольку ведущее приложение получает <xref:System.Windows.Interop.HwndHost>, ведущее приложение не может преобразовать объект, возвращаемый <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> в тип реализуется как надстройки (например, <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="eca89-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="eca89-251">По своей природе <xref:System.Windows.Interop.HwndHost> имеет определенные ограничения, которые влияют на то, как ведущие приложения могут их использовать.</span><span class="sxs-lookup"><span data-stu-id="eca89-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="eca89-252">Тем не менее [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] расширяет <xref:System.Windows.Interop.HwndHost> несколькими возможностями для сценариев надстройки.</span><span class="sxs-lookup"><span data-stu-id="eca89-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="eca89-253">Эти преимущества и ограничения описаны ниже.</span><span class="sxs-lookup"><span data-stu-id="eca89-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="eca89-254">Преимущества надстройки WPF</span><span class="sxs-lookup"><span data-stu-id="eca89-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="eca89-255">Поскольку [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] надстройки [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] отображаются из ведущих приложений, используя внутренний класс, производный от <xref:System.Windows.Interop.HwndHost>, в которых [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] ограниченные возможности <xref:System.Windows.Interop.HwndHost> по отношению к [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] службы, такие как макет, подготовки к просмотру, привязка данных, стили, шаблоны и ресурсы.</span><span class="sxs-lookup"><span data-stu-id="eca89-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="eca89-256">Тем не менее [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] дополняет свой внутренний <xref:System.Windows.Interop.HwndHost> подкласс с дополнительными возможностями, которые включают следующее:</span><span class="sxs-lookup"><span data-stu-id="eca89-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="eca89-257">Переход между [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ведущего приложения и [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки.</span><span class="sxs-lookup"><span data-stu-id="eca89-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="eca89-258">Обратите внимание, что «надстройка — это [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]"модель программирования требует адаптера стороне надстройки для переопределения <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> Включение переходов, надстройка полное доверие или с частичным доверием.</span><span class="sxs-lookup"><span data-stu-id="eca89-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="eca89-259">Выполнение требований к поддержке специальных возможностей для [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] надстройки, отображаемых из ведущего приложения [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="eca89-260">Поддержка безопасного выполнения приложений [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] в нескольких сценариях домена приложений.</span><span class="sxs-lookup"><span data-stu-id="eca89-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="eca89-261">Предотвращение незаконного доступа к дескрипторам окон [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки, когда надстройки выполняются в режиме изоляции безопасности (то есть находятся в частично доверенной изолированной среде безопасности).</span><span class="sxs-lookup"><span data-stu-id="eca89-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="eca89-262">Вызов <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> гарантирует безопасности:</span><span class="sxs-lookup"><span data-stu-id="eca89-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="eca89-263">Для «Надстройка возвращает [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]"модель программирования, единственный способ передачи дескриптор окна для добавления в [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] через изоляцию границ заключается в вызове <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="eca89-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="eca89-264">Для «надстройка — это [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]"программирования модели, переопределение <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> для адаптера на стороне надстройки, а вызов метода <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (как показано в предыдущих примерах) является обязательным, как при вызове адаптера на стороне надстройки `QueryContract` реализации из адаптера узла.</span><span class="sxs-lookup"><span data-stu-id="eca89-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="eca89-265">Предоставление защиты выполнения нескольких доменов приложений.</span><span class="sxs-lookup"><span data-stu-id="eca89-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="eca89-266">Из-за ограничений, связанных с доменами приложений, необработанные исключения, которые появляются в доменах приложений надстроек, вызывают сбой всего приложения, несмотря на наличие границы изоляции.</span><span class="sxs-lookup"><span data-stu-id="eca89-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="eca89-267">Тем не менее [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] и модель [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] надстройки предоставляют простой способ решения этой проблемы и повышают стабильность работы приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="eca89-268">Объект [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] надстройки, отображающий [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] создает <xref:System.Windows.Threading.Dispatcher> потока, который выполняется в домене приложения, если хост-приложения [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="eca89-269">Можно обнаружить все необработанные исключения, возникающие в домене приложения, обрабатывая <xref:System.Windows.Threading.Dispatcher.UnhandledException> событие [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] надстройки <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="eca89-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="eca89-270">Вы можете получить <xref:System.Windows.Threading.Dispatcher> из <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> свойство.</span><span class="sxs-lookup"><span data-stu-id="eca89-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="eca89-271">Ограничения надстройки WPF</span><span class="sxs-lookup"><span data-stu-id="eca89-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="eca89-272">Кроме преимуществ, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] добавляет к поведению по умолчанию, предоставляемые <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>и дескрипторами окна, существуют также ограничения для надстройки [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , которые отображаются из ведущих приложений:</span><span class="sxs-lookup"><span data-stu-id="eca89-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="eca89-273">[!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] надстройки, отображаемый из ведущего приложения, не учитывает поведение ведущего приложения при обрезке.</span><span class="sxs-lookup"><span data-stu-id="eca89-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="eca89-274">Концепция *свободного пространства* в сценариях взаимодействия также применяется к надстройкам (см. [Общие сведения о технологических областях](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="eca89-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="eca89-275">Службы [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ведущих приложений, такие как наследование ресурса, привязка данных и команды, недоступны автоматически для [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] надстройки.</span><span class="sxs-lookup"><span data-stu-id="eca89-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="eca89-276">Чтобы предоставить эти службы для надстройки, необходимо обновить конвейер.</span><span class="sxs-lookup"><span data-stu-id="eca89-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="eca89-277">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки нельзя поворачивать, масштабировать, отклонять или преобразовывать иным образом (см. [Общие сведения о преобразованиях](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="eca89-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="eca89-278">Содержимое внутри надстройки [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] , визуализируется рисования из <xref:System.Drawing> пространство имен может включать альфа-смешение.</span><span class="sxs-lookup"><span data-stu-id="eca89-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="eca89-279">Однако как [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки, так и [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] ведущего приложения, которое его содержит, должны быть полностью непрозрачными. Другими словами, для их свойства `Opacity` должно быть установлено значение 1.</span><span class="sxs-lookup"><span data-stu-id="eca89-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="eca89-280">Если <xref:System.Windows.Window.AllowsTransparency%2A> свойства окна в ведущем приложении, содержащий add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] имеет значение `true`, надстройка невидим.</span><span class="sxs-lookup"><span data-stu-id="eca89-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="eca89-281">Это верно даже в том случае, если [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки полностью непрозрачно (то есть свойство `Opacity` имеет значение 1).</span><span class="sxs-lookup"><span data-stu-id="eca89-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="eca89-282">[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки должно появляться поверх других элементов [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] в том же окне верхнего уровня.</span><span class="sxs-lookup"><span data-stu-id="eca89-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="eca89-283">Часть надстройки [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] может осуществляться с помощью <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="eca89-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="eca89-284">Вместо этого надстройка может сделать моментальный снимок созданного [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], чтобы создать растровое изображение, которое может быть передано ведущему приложению с использованием методов, определенных в контракте.</span><span class="sxs-lookup"><span data-stu-id="eca89-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="eca89-285">Невозможно воспроизвести файлы мультимедиа из <xref:System.Windows.Controls.MediaElement> в надстройке [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eca89-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="eca89-286">События мыши, созданные для [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки, не получаются и не вызываются ведущим приложением, а свойство `IsMouseOver` для ведущего приложения [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] имеет значение `false`.</span><span class="sxs-lookup"><span data-stu-id="eca89-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="eca89-287">Когда фокус смещается между элементами управления в [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки, `GotFocus` и `LostFocus` события не получаются и не вызываются ведущим приложением.</span><span class="sxs-lookup"><span data-stu-id="eca89-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="eca89-288">Часть ведущего приложения, содержащая [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки, выглядит пустой при печати.</span><span class="sxs-lookup"><span data-stu-id="eca89-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="eca89-289">Все диспетчеры (см. <xref:System.Windows.Threading.Dispatcher>) созданные надстройки [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] должна быть завершена вручную перед надстройки владельца выгрузкой Если ведущее приложение продолжает выполнение.</span><span class="sxs-lookup"><span data-stu-id="eca89-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="eca89-290">Контракт может реализовывать методы, которые позволяют ведущему приложению сигнализировать надстройке до того, как надстройка будет выгружена, тем самым позволяя [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] надстройки закрыть свои диспетчеры.</span><span class="sxs-lookup"><span data-stu-id="eca89-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="eca89-291">Если надстройка [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] — <xref:System.Windows.Controls.InkCanvas> или содержит <xref:System.Windows.Controls.InkCanvas>, не удается выгрузить надстройку.</span><span class="sxs-lookup"><span data-stu-id="eca89-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="eca89-292">Оптимизация производительности</span><span class="sxs-lookup"><span data-stu-id="eca89-292">Performance Optimization</span></span>  
 <span data-ttu-id="eca89-293">По умолчанию при использовании нескольких доменов приложений различные сборки [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], необходимые для каждого приложения, загружаются в домен приложения.</span><span class="sxs-lookup"><span data-stu-id="eca89-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="eca89-294">В результате время, необходимое для создания новых доменов приложений и запуска приложений в них, может повлиять на производительность.</span><span class="sxs-lookup"><span data-stu-id="eca89-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="eca89-295">Однако [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] предоставляет способ сократить время запуска, передавая приложениям инструкции по совместному использованию сборок всеми доменами приложений, если они уже загружены.</span><span class="sxs-lookup"><span data-stu-id="eca89-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="eca89-296">Это делается с помощью <xref:System.LoaderOptimizationAttribute> атрибут, который необходимо применить к методу точки входа (`Main`).</span><span class="sxs-lookup"><span data-stu-id="eca89-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="eca89-297">В данном случае необходимо использовать только код для реализации определения приложения (см. [Общие сведения об управлении приложением](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="eca89-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="eca89-298">См. также</span><span class="sxs-lookup"><span data-stu-id="eca89-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="eca89-299">Надстройки и расширения среды</span><span class="sxs-lookup"><span data-stu-id="eca89-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="eca89-300">Домены приложений</span><span class="sxs-lookup"><span data-stu-id="eca89-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="eca89-301">Обзор удаленного взаимодействия .NET framework</span><span class="sxs-lookup"><span data-stu-id="eca89-301">.NET Framework Remoting Overview</span></span>](http://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="eca89-302">Создание удаленных объектов</span><span class="sxs-lookup"><span data-stu-id="eca89-302">Making Objects Remotable</span></span>](http://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="eca89-303">Разделы практического руководства</span><span class="sxs-lookup"><span data-stu-id="eca89-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
