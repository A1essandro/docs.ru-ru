---
title: "Общие сведения о приложениях браузера WPF XAML | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-wpf"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "приложения, размещаемые в браузере [WPF]"
  - "приложения браузера WPF XAML (XBAP)"
  - "XAML-приложения браузера (XBAP)"
  - "XBAP, приложение браузера XAML"
ms.assetid: 3a7a86a8-75d5-4898-96b9-73da151e5e16
caps.latest.revision: 47
author: "dotnet-bot"
ms.author: "dotnetcontent"
manager: "wpickett"
caps.handback.revision: 47
---
# Общие сведения о приложениях браузера WPF XAML
<a name="introduction"></a> [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] объединяет возможности веб\-приложений и многофункциональных клиентских приложений.  Как веб\-приложения, XBAP можно разворачивать на веб\-сервере и запускать из Internet Explorer или Firefox.  Как многофункциональные клиентские приложения, XBAP могут воспользоваться преимуществами возможностей [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].  Разработка XBAP также аналогична многофункциональной клиентской разработке.  В этой теме предоставляется простое, высокоуровневое введение в разработку XBAP, а также отмечается, где разработка XBAP отличается от стандартной многофункциональной клиентской разработки.  
  
 В этом разделе содержатся следующие подразделы.  
  
-   [Создание нового приложения браузера XAML \(XBAP\)](#creating_a_new_xaml_browser_application_xbap)  
  
-   [Развертывание XBAP](#deploying_a_xbap)  
  
-   [Взаимодействие с веб\-страницей основного приложения](#communicating_with_the_host_web_page)  
  
-   [Соображения безопасности XBAP](#xbap_security_considerations)  
  
-   [Вопросы производительности запуска XBAP](#xbap_start_time_performance_considerations)  
  
<a name="creating_a_new_xaml_browser_application_xbap"></a>   
## Создание нового приложения браузера XAML \(XBAP\)  
 Проще всего создать новый проект XBAP с помощью [!INCLUDE[vs_dev10_ext](../../../../includes/vs-dev10-ext-md.md)].  При создании нового проекта выберите в списке шаблонов **Приложение браузера WPF**.  Дополнительные сведения см. в разделе [Практическое руководство. Создание нового проекта приложения браузера WPF](http://msdn.microsoft.com/ru-ru/72ef4d90-e163-42a1-8df0-ea7ccfd1901f).  
  
 При запуске проекта XBAP он открывается в окне браузера, а не в отдельном окне.  При отладке XBAP в [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)] приложение выполняется с разрешениями зоны Интернета и, следовательно, при превышении этих разрешений возникают исключения безопасности.  Дополнительные сведения см. в разделах [Безопасность](../../../../docs/framework/wpf/security-wpf.md) и [Безопасность частичного доверия в WPF](../../../../docs/framework/wpf/wpf-partial-trust-security.md).  
  
> [!NOTE]
>  При отсутствии опыта разработки в [!INCLUDE[TLA#tla_visualstu](../../../../includes/tlasharptla-visualstu-md.md)] или при делании изучить файлы проекта подробнее см. раздел [Построение приложения WPF](../../../../docs/framework/wpf/app-development/building-a-wpf-application-wpf.md).  
  
<a name="deploying_a_xbap"></a>   
## Развертывание XBAP  
 При построении XBAP выходной результат включает три файла, приведенные ниже.  
  
|Файл|Описание|  
|----------|--------------|  
|Исполняемый файл \(EXE\-файл\)|Он содержит скомпилированный код и имеет расширение .exe.|  
|Манифест приложения \(MANIFEST\-файл\)|Содержит метаданные, связанные с приложением, и имеет расширение .manifest.|  
|Манифест развертывания \(XBAP\-файл\)|Этот файл содержит сведения, которые [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] использует для развертывания приложения, и имеет расширение XBAP.|  
  
 XBAP разворачиваются на веб\-сервере, например на [!INCLUDE[TLA#tla_iis50](../../../../includes/tlasharptla-iis50-md.md)] и более поздних версий.  Не нужно устанавливать [!INCLUDE[TLA2#tla_winfx](../../../../includes/tla2sharptla-winfx-md.md)] на веб\-сервере, но необходимо зарегистрировать типы [!INCLUDE[TLA#tla_mime](../../../../includes/tlasharptla-mime-md.md)] [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] и расширения имен файлов.  Дополнительные сведения см. в разделе [Настройка служб IIS 5.0 и IIS 6.0 для развертывания приложений WPF](../../../../docs/framework/wpf/app-development/how-to-configure-iis-5-0-and-iis-6-0-to-deploy-wpf-applications.md).  
  
 Чтобы подготовить XBAP для развертывания, скопируйте EXE\-файл и соответствующие манифесты на веб\-сервер.  Создайте HTML\-страницу, содержащую гиперссылку для открытия манифеста развертывания, который является файлом с расширением XBAP.  Когда пользователь нажимает ссылку на XBAP\-файл, [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] автоматически обрабатывает механизм загрузки и запуска приложения.  В следующем примере кода показана HTML\-страница, которая содержит гиперссылку, указывающую на XBAP.  
  
```  
<html>   
  <head></head>  
  <body>   
    <a href="XbapEx.xbap">Click this link to launch the application</a>  
  </body>   
</html>  
  
```  
  
 Можно также разместить XBAP во фрейме веб\-страницы.  Создайте веб\-страницу с одним или несколькими фреймами.  Установите свойство источника фрейма в файл манифеста развертывания.  Если для взаимодействия между этой веб\-страницей и XBAP планируется использовать встроенный механизм, необходимо поместить приложение во фрейм.  В следующем примере кода показана HTML\-страница с двумя фреймами, и XBAP установлен в качестве источника для второго фрейма.  
  
```  
<html>   
  <head>A page with frames.</head>  
    <frameset cols="50%,50%">   
      <frame src="introduction.htm" >   
      <frame src="XbapEx.xbap" >   
  </frameset>   
</html>  
```  
  
### Очистка кэшированных XBAP  
 В некоторых случаях после повторного построения и запуска XBAP может оказаться, что открыта предыдущая версия XBAP.  Например, это может произойти, когда номер версии сборки XBAP статический, и XBAP запускается из командной строки.  В этом случае, поскольку номер кэшированной версии \(версией, запущенной ранее\) и новой версии остается тем же, новая версия XBAP не загружается.  Вместо нее загружается кэшированная версия.  
  
 В таких случаях можно удалить кэшированную версию с помощью команды **Mage** \(устанавливается с [!INCLUDE[TLA2#tla_lhsdk](../../../../includes/tla2sharptla-lhsdk-md.md)]\) из командной строки:  Следующая команда выполняет очистку кэша приложения.  
  
 `Mage.exe -cc`  
  
 Эта команда гарантирует, что будет запущена последняя версия XBAP.  При отладке приложения в [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] должна быть запущена последняя версия XBAP. Обычно следует обновлять номер версии развертывания при каждом построении.  Дополнительные сведения о программе Mage см. в разделе [Mage.exe \(средство создания и редактирования манифеста\)](../../../../docs/framework/tools/mage-exe-manifest-generation-and-editing-tool.md).  
  
<a name="communicating_with_the_host_web_page"></a>   
## Взаимодействие с веб\-страницей основного приложения  
 Когда приложение расположено во фрейме HTML, можно взаимодействовать с веб\-страницей, содержащей XBAP.  Это можно делать путем извлечения свойства <xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A> объекта <xref:System.Windows.Interop.BrowserInteropHelper>.  Это свойство возвращает объект скрипта, представляющий окно HTML.  Затем можно получать доступ к свойствам, методам и событиям в [объекте окна](http://go.microsoft.com/fwlink/?LinkId=160274) с помощью обычного синтаксиса с точками.  Можно также получить доступ к методам скрипта и к глобальным переменным.  В следующем примере показано, как извлечь объект скрипта и закрыть браузер.  
  
 [!code-csharp[XbapBrowserInterop#10](../../../../samples/snippets/csharp/VS_Snippets_Wpf/xbapbrowserinterop/cs/page1.xaml.cs#10)]
 [!code-vb[XbapBrowserInterop#10](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/xbapbrowserinterop/vb/page1.xaml.vb#10)]  
  
### Отладка XBAP, использующих HostScript  
 Если XBAP использует объект <xref:System.Windows.Interop.BrowserInteropHelper.HostScript%2A> для взаимодействия с окном HTML, необходимо указать два параметра для запуска и отладки этого приложения в [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)].  Приложение должно иметь доступ к своему исходному сайту, и запускать его необходимо со страницы HTML, содержащей XBAP.  Приведенные далее действия описывают, как проверить эти два параметра.  
  
1.  Откройте свойства проекта в Visual Studio.  
  
2.  На вкладке **Безопасность** нажмите **Дополнительно**.  
  
     Откроется диалоговое окно "Дополнительные параметры безопасности".  
  
3.  Убедитесь, что флажок **Предоставить приложению доступ к своему исходному сайту** установлен, и нажмите кнопку **ОК**.  
  
4.  На вкладке **Отладка** выберите параметр **Запустить браузер, используя URL\-адрес** и укажите URL\-адрес для страницы HTML, которая содержит XBAP.  
  
5.  В Internet Explorer нажмите кнопку **Сервис** выберите пункт **Свойства обозревателя**.  
  
     Откроется диалоговое окно "Свойства браузера".  
  
6.  Выберите вкладку **Дополнительно**.  
  
7.  В списке **Параметры** раздела **Безопасность** установите флажок **Разрешать запуск активного содержимого файлов на моем компьютере**.  
  
8.  Нажмите кнопку **ОК**.  
  
     Изменения вступают в силу после перезапуска Internet Explorer.  
  
> [!CAUTION]
>  Включение активного содержимого в Internet Explorer может подвергнуть компьютер риску.  Дополнительные сведения см. в статье [Функции безопасности и конфиденциальности в Internet Explorer \(статья может быть на английском языке\)](http://go.microsoft.com/fwlink/?linkid=35807).  Если не планируется изменять параметры безопасности Internet Explorer, можно запустить HTML\-страницу с сервера и подключить к процессу отладчик [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)].  
  
<a name="xbap_security_considerations"></a>   
## Соображения безопасности XBAP  
 XBAP обычно выполняются в "песочнице" безопасности с частичным доверием, которая ограничена набором разрешений зоны Интернета.  Следовательно, реализация должна поддерживать подмножество элементов [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], которые поддерживаются в зоне Интернета, или же необходимо повысить уровень разрешений приложения.  Дополнительные сведения см. в разделе [Безопасность](../../../../docs/framework/wpf/security-wpf.md).  
  
 При использовании в приложении элемента управления <xref:System.Windows.Controls.WebBrowser> WPF внутренним образом устанавливает собственный элемент управления ActiveX WebBrowser.  Когда приложение является XBAP в режиме частичного доверия, выполняющимся в Internet Explorer, элемент управления ActiveX выполняется в выделенном потоке процесса Internet Explorer.  Следовательно, действуют приведенные ниже ограничения.  
  
-   Элемент управления <xref:System.Windows.Controls.WebBrowser> должен обеспечивать поведение, аналогичное браузеру узла, включая ограничения безопасности.  Некоторыми из этих ограничений безопасности можно управлять с помощью параметров безопасности Internet Explorer.  Дополнительные сведения см. в разделе [Безопасность](../../../../docs/framework/wpf/security-wpf.md).  
  
-   Когда XBAP загружается между доменами в HTML\-странице, создается исключение.  
  
-   Ввод выполняется в отдельном от <xref:System.Windows.Controls.WebBrowser> WPF потоке, поэтому ввод с клавиатуры не может перехватываться, и состояние IME не используется совместно.  
  
-   Время или порядок переходов может отличаться вследствие выполнения элемента управления ActiveX в другом потоке.  Например, переход на страницу не всегда прекращается при запуске другого навигационного запроса.  
  
-   Пользовательский элемент управления ActiveX может иметь проблемы с взаимодействием, поскольку приложение WPF выполняется в отдельном потоке.  
  
-   <xref:System.Windows.Interop.HwndHost.MessageHook> не возникает, поскольку <xref:System.Windows.Interop.HwndHost> не может включать как подкласс окно, выполняющееся в другом потоке или процессе.  
  
### Создание XBAP с полным доверием  
 Если XBAP необходимо полное доверие, можно изменить проект, чтобы включить это разрешение.  Ниже приведены действия, показывающие, как включить полное доверие.  
  
1.  Откройте свойства проекта в Visual Studio.  
  
2.  На вкладке **Безопасность** выберите параметр **Это приложение с полным доверием**.  
  
 Этот параметр вносит следующие изменения:  
  
-   в файле проекта элемент `<TargetZone>` изменяется на `Custom`;  
  
-   в манифесте приложения \(файл app.manifest\) к элементу `PermissionSet` добавляется атрибут `Unrestricted="true"`.  
  
    ```  
    <PermissionSet class="System.Security.PermissionSet"   
        version="1"   
        ID="Custom"   
        SameSite="site"   
        Unrestricted="true"   
    />  
    ```  
  
### Развертывание XBAP с полным доверием  
 При развертывании XBAP с полным доверием, не следующего модели доверенного развертывания ClickOnce, поведение при запуске пользователем приложения будет зависеть от зоны безопасности.  В некоторых случаях пользователю выдается предупреждение при попытке установки.  Пользователь может выбрать, продолжить или отменить установку.  В следующей таблице описывается поведение приложения в каждой зоне безопасности и указываются действия, необходимые, чтобы приложение получило полное доверие.  
  
|Зона безопасности|Поведение|Получение полного доверия|  
|-----------------------|---------------|-------------------------------|  
|Локальный компьютер|Автоматическое получение полного доверия|Никаких действий не требуется.|  
|Интрасеть и надежные сайты|Вывод диалогового окна с запросом о полном доверии|Заверьте модуль XBAP сертификатом, чтобы его источник отображался в диалоговом окне запроса.|  
|Internet|Сбой с сообщением "Доверие не предоставлено"|Заверьте модуль XBAP сертификатом.|  
  
> [!NOTE]
>  Поведение, приведенное в предыдущей таблице, относится к XBAP, не следующим модели доверенного развертывания ClickOnce.  
  
 Рекомендуется использовать модель доверенного развертывания ClickOnce для развертывания XBAP с полным доверием.  Эта модель позволяет автоматически предоставить полное доверие XBAP, независимо от зоны безопасности, так что пользователь не запрашивается.  В качестве части этой модели необходимо подписать приложение с помощью сертификата от надежного издателя.  Дополнительные сведения см. в разделе [Общие сведения о развертывании доверенных приложений](../Topic/Trusted%20Application%20Deployment%20Overview.md) и в статье [Общие сведения о подписи кода \(статья может быть на английском языке\)](http://go.microsoft.com/fwlink/?LinkId=166327).  
  
<a name="xbap_start_time_performance_considerations"></a>   
## Вопросы производительности запуска XBAP  
 Важным аспектом производительности XBAP является время его запуска.  Если XBAP является первым загружаемым приложением WPF, то время *холодного запуска* может составить десять секунд или больше.  Это связано с тем, что WPF выполняет визуализацию страницы хода выполнения, и для отображения приложения должен быть выполнен холодный запуск среды CLR и WPF.  
  
 Начиная с версии [!INCLUDE[net_v35SP1_short](../../../../includes/net-v35sp1-short-md.md)], время холодного запуска XBAP уменьшено путем отображения неуправляемой страницы хода выполнения ранее в цикле развертывания. Страница хода выполнения открывается почти сразу после запуска приложения, так как она отображается машинным кодом размещения и прорисовывается в HTML.  
  
 Кроме того, улучшенный параллелизм последовательности загрузки [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] сокращает время запуска почти на десять процентов.  После того как [!INCLUDE[ndptecclick](../../../../includes/ndptecclick-md.md)] загрузит и проверит манифесты, следует загрузка приложения, и индикатор выполнения начинает обновляться.  
  
## См. также  
 [Настройка Visual Studio 2005 для отладки приложений браузера XAML для вызова веб\-службы](../../../../docs/framework/wpf/app-development/configure-vs-to-debug-a-xaml-browser-to-call-a-web-service.md)   
 [Развертывание приложений WPF](../../../../docs/framework/wpf/app-development/deploying-a-wpf-application-wpf.md)