---
title: Общие сведения об отрисовке графики в WPF
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- graphics [WPF], rendering
- rendering graphics [WPF]
ms.assetid: 6dec9657-4d8c-4e46-8c54-40fb80008265
ms.openlocfilehash: c1d7654dc190b00363fa6cc47c362b5f9e90d8f9
ms.sourcegitcommit: 0c48191d6d641ce88d7510e319cf38c0e35697d0
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/05/2019
ms.locfileid: "57375536"
---
# <a name="wpf-graphics-rendering-overview"></a><span data-ttu-id="eee5b-102">Общие сведения об отрисовке графики в WPF</span><span class="sxs-lookup"><span data-stu-id="eee5b-102">WPF Graphics Rendering Overview</span></span>
<span data-ttu-id="eee5b-103">В этом разделе приведены общие сведения о визуальном слое [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eee5b-103">This topic provides an overview of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual layer.</span></span> <span data-ttu-id="eee5b-104">Основное внимание в нем уделено роли класса <xref:System.Windows.Media.Visual> в поддержке отрисовки в модели [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eee5b-104">It focuses on the role of the <xref:System.Windows.Media.Visual> class for rendering support in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] model.</span></span>  
  
  
<a name="role_of_visual_object"></a>   
## <a name="role-of-the-visual-object"></a><span data-ttu-id="eee5b-105">Роль объекта Visual</span><span class="sxs-lookup"><span data-stu-id="eee5b-105">Role of the Visual Object</span></span>  
 <span data-ttu-id="eee5b-106">Класс <xref:System.Windows.Media.Visual> — это базовая абстракция, и каждый объект <xref:System.Windows.FrameworkElement> является производным от него.</span><span class="sxs-lookup"><span data-stu-id="eee5b-106">The <xref:System.Windows.Media.Visual> class is the basic abstraction from which every <xref:System.Windows.FrameworkElement> object derives.</span></span> <span data-ttu-id="eee5b-107">Эта абстракция также служит точкой входа для написания новых элементов управления [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], и во многих случаях ее можно рассматривать как аналог дескриптора окна (HWND) в модели приложений Win32.</span><span class="sxs-lookup"><span data-stu-id="eee5b-107">It also serves as the entry point for writing new controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], and in many ways can be thought of as the window handle (HWND) in the Win32 application model.</span></span>  
  
 <span data-ttu-id="eee5b-108">Объект <xref:System.Windows.Media.Visual> — это основной объект [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], главная роль которого заключается в поддержке отрисовки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-108">The <xref:System.Windows.Media.Visual> object is a core [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] object, whose primary role is to provide rendering support.</span></span> <span data-ttu-id="eee5b-109">Элементы управления пользовательского интерфейса, такие как <xref:System.Windows.Controls.Button> и <xref:System.Windows.Controls.TextBox>, являются производными от класса <xref:System.Windows.Media.Visual> и используют его для сохранения данных отрисовки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-109">User interface controls, such as <xref:System.Windows.Controls.Button> and <xref:System.Windows.Controls.TextBox>, derive from the <xref:System.Windows.Media.Visual> class, and use it for persisting their rendering data.</span></span> <span data-ttu-id="eee5b-110">Объект <xref:System.Windows.Media.Visual> обеспечивает поддержку следующих функций:</span><span class="sxs-lookup"><span data-stu-id="eee5b-110">The <xref:System.Windows.Media.Visual> object provides support for:</span></span>  
  
-   <span data-ttu-id="eee5b-111">Отображение выходных данных: Визуализация сохраненного, сериализованного содержимого визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="eee5b-111">Output display: Rendering the persisted, serialized drawing content of a visual.</span></span>  
  
-   <span data-ttu-id="eee5b-112">Преобразования: Выполнение преобразования на визуальный элемент.</span><span class="sxs-lookup"><span data-stu-id="eee5b-112">Transformations: Performing transformations on a visual.</span></span>  
  
-   <span data-ttu-id="eee5b-113">Отсечение: Позволяет указать область отсечения для визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="eee5b-113">Clipping: Providing clipping region support for a visual.</span></span>  
  
-   <span data-ttu-id="eee5b-114">Проверка нажатия: Определяет, содержится ли координата или геометрическая фигура в пределах границ визуального объекта.</span><span class="sxs-lookup"><span data-stu-id="eee5b-114">Hit testing: Determining whether a coordinate or geometry is contained within the bounds of a visual.</span></span>  
  
-   <span data-ttu-id="eee5b-115">Расчеты ограничивающих прямоугольников: Определение ограничивающего прямоугольника визуального объекта.</span><span class="sxs-lookup"><span data-stu-id="eee5b-115">Bounding box calculations: Determining the bounding rectangle of a visual.</span></span>  
  
 <span data-ttu-id="eee5b-116">Однако объект <xref:System.Windows.Media.Visual> не включает поддержку функций, не относящихся к отрисовке, например:</span><span class="sxs-lookup"><span data-stu-id="eee5b-116">However, the <xref:System.Windows.Media.Visual> object does not include support for non-rendering features, such as:</span></span>  
  
-   <span data-ttu-id="eee5b-117">Обработка событий</span><span class="sxs-lookup"><span data-stu-id="eee5b-117">Event handling</span></span>  
  
-   <span data-ttu-id="eee5b-118">Макет</span><span class="sxs-lookup"><span data-stu-id="eee5b-118">Layout</span></span>  
  
-   <span data-ttu-id="eee5b-119">Стили</span><span class="sxs-lookup"><span data-stu-id="eee5b-119">Styles</span></span>  
  
-   <span data-ttu-id="eee5b-120">Привязка данных</span><span class="sxs-lookup"><span data-stu-id="eee5b-120">Data binding</span></span>  
  
-   <span data-ttu-id="eee5b-121">Глобализация</span><span class="sxs-lookup"><span data-stu-id="eee5b-121">Globalization</span></span>  
  
 <span data-ttu-id="eee5b-122"><xref:System.Windows.Media.Visual> предоставляется в виде открытого абстрактного класса, от которого должны наследоваться дочерние классы.</span><span class="sxs-lookup"><span data-stu-id="eee5b-122"><xref:System.Windows.Media.Visual> is exposed as a public abstract class from which child classes must be derived.</span></span> <span data-ttu-id="eee5b-123">На следующем рисунке показана иерархия визуальных объектов, которые предоставляются в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eee5b-123">The following illustration shows the hierarchy of the visual objects that are exposed in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 <span data-ttu-id="eee5b-124">![Схема классов, производных от объекта Visual](./media/visualclass01.png "VisualClass01")</span><span class="sxs-lookup"><span data-stu-id="eee5b-124">![Diagram of classes derived from the Visual object](./media/visualclass01.png "VisualClass01")</span></span>  
<span data-ttu-id="eee5b-125">Иерархия класса Visual</span><span class="sxs-lookup"><span data-stu-id="eee5b-125">Visual class hierarchy</span></span>  
  
### <a name="drawingvisual-class"></a><span data-ttu-id="eee5b-126">Класс DrawingVisual</span><span class="sxs-lookup"><span data-stu-id="eee5b-126">DrawingVisual Class</span></span>  
 <span data-ttu-id="eee5b-127"><xref:System.Windows.Media.DrawingVisual> — упрощенный класс, используемый для отрисовки фигур, изображений и текста.</span><span class="sxs-lookup"><span data-stu-id="eee5b-127">The <xref:System.Windows.Media.DrawingVisual> is a lightweight drawing class that is used to render shapes, images, or text.</span></span> <span data-ttu-id="eee5b-128">Этот класс считается упрощенным, так как не предоставляет средств для работы с разметкой и обработку событий, что повышает его производительность.</span><span class="sxs-lookup"><span data-stu-id="eee5b-128">This class is considered lightweight because it does not provide layout or event handling, which improves its runtime performance.</span></span> <span data-ttu-id="eee5b-129">Поэтому этот класс идеально подходит для фоновых рисунков или клипов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-129">For this reason, drawings are ideal for backgrounds and clip art.</span></span> <span data-ttu-id="eee5b-130"><xref:System.Windows.Media.DrawingVisual> может быть использован для создания пользовательского визуального объекта.</span><span class="sxs-lookup"><span data-stu-id="eee5b-130">The <xref:System.Windows.Media.DrawingVisual> can be used to create a custom visual object.</span></span> <span data-ttu-id="eee5b-131">Дополнительные сведения см. в разделе [Использование объектов DrawingVisual](using-drawingvisual-objects.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-131">For more information, see [Using DrawingVisual Objects](using-drawingvisual-objects.md).</span></span>  
  
### <a name="viewport3dvisual-class"></a><span data-ttu-id="eee5b-132">Класс Viewport3DVisual</span><span class="sxs-lookup"><span data-stu-id="eee5b-132">Viewport3DVisual Class</span></span>  
 <span data-ttu-id="eee5b-133"><xref:System.Windows.Media.Media3D.Viewport3DVisual> обеспечивает связь между двухмерными <xref:System.Windows.Media.Visual> и объектами <xref:System.Windows.Media.Media3D.Visual3D>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-133">The <xref:System.Windows.Media.Media3D.Viewport3DVisual> provides a bridge between 2D <xref:System.Windows.Media.Visual> and <xref:System.Windows.Media.Media3D.Visual3D> objects.</span></span> <span data-ttu-id="eee5b-134">Класс <xref:System.Windows.Media.Media3D.Visual3D> является базовым классом для всех трехмерных визуальных элементов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-134">The <xref:System.Windows.Media.Media3D.Visual3D> class is the base class for all 3D visual elements.</span></span> <span data-ttu-id="eee5b-135">Для <xref:System.Windows.Media.Media3D.Viewport3DVisual> необходимо определить значения <xref:System.Windows.Media.Media3D.Viewport3DVisual.Camera%2A> и <xref:System.Windows.Media.Media3D.Viewport3DVisual.Viewport%2A>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-135">The <xref:System.Windows.Media.Media3D.Viewport3DVisual> requires that you define a <xref:System.Windows.Media.Media3D.Viewport3DVisual.Camera%2A> value and a <xref:System.Windows.Media.Media3D.Viewport3DVisual.Viewport%2A> value.</span></span> <span data-ttu-id="eee5b-136">Камера (Camera) позволяет просмотреть сцену.</span><span class="sxs-lookup"><span data-stu-id="eee5b-136">The camera allows you to view the scene.</span></span> <span data-ttu-id="eee5b-137">Окно просмотра (Viewport) определяет, где проекция преобразуется в двумерную поверхность.</span><span class="sxs-lookup"><span data-stu-id="eee5b-137">The viewport establishes where the projection maps onto the 2D surface.</span></span> <span data-ttu-id="eee5b-138">Дополнительные сведения о трехмерной графике в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] см. в разделе [Общие сведения о трехмерной графике](3-d-graphics-overview.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-138">For more information on 3D in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [3-D Graphics Overview](3-d-graphics-overview.md).</span></span>  
  
### <a name="containervisual-class"></a><span data-ttu-id="eee5b-139">Класс ContainerVisual</span><span class="sxs-lookup"><span data-stu-id="eee5b-139">ContainerVisual Class</span></span>  
 <span data-ttu-id="eee5b-140">Класс <xref:System.Windows.Media.ContainerVisual> используется как контейнер для коллекции объектов <xref:System.Windows.Media.Visual>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-140">The <xref:System.Windows.Media.ContainerVisual> class is used as a container for a collection of <xref:System.Windows.Media.Visual> objects.</span></span> <span data-ttu-id="eee5b-141">Класс <xref:System.Windows.Media.DrawingVisual> является производным от класса <xref:System.Windows.Media.ContainerVisual>, поэтому он может содержать коллекцию визуальных объектов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-141">The <xref:System.Windows.Media.DrawingVisual> class derives from the <xref:System.Windows.Media.ContainerVisual> class, allowing it to contain a collection of visual objects.</span></span>  
  
### <a name="drawing-content-in-visual-objects"></a><span data-ttu-id="eee5b-142">Рисование содержимого в объектах Visual</span><span class="sxs-lookup"><span data-stu-id="eee5b-142">Drawing Content in Visual Objects</span></span>  
 <span data-ttu-id="eee5b-143">Объект <xref:System.Windows.Media.Visual> хранит свои данные отрисовки в виде **списка инструкций векторной графики**.</span><span class="sxs-lookup"><span data-stu-id="eee5b-143">A <xref:System.Windows.Media.Visual> object stores its render data as a **vector graphics instruction list**.</span></span> <span data-ttu-id="eee5b-144">Каждый элемент в списке инструкций представляет низкоуровневый набор графических данных и связанных ресурсов в сериализованном формате.</span><span class="sxs-lookup"><span data-stu-id="eee5b-144">Each item in the instruction list represents a low-level set of graphics data and associated resources in a serialized format.</span></span> <span data-ttu-id="eee5b-145">Существует четыре различных типа данных отрисовки, которые могут включать графическое содержимое.</span><span class="sxs-lookup"><span data-stu-id="eee5b-145">There are four different types of render data that can contain drawing content.</span></span>  
  
|<span data-ttu-id="eee5b-146">Тип содержимого для отрисовки</span><span class="sxs-lookup"><span data-stu-id="eee5b-146">Drawing content type</span></span>|<span data-ttu-id="eee5b-147">Описание</span><span class="sxs-lookup"><span data-stu-id="eee5b-147">Description</span></span>|  
|--------------------------|-----------------|  
|<span data-ttu-id="eee5b-148">Векторная графика</span><span class="sxs-lookup"><span data-stu-id="eee5b-148">Vector graphics</span></span>|<span data-ttu-id="eee5b-149">Представляет векторные графические данные и все связанные сведения о <xref:System.Windows.Media.Brush> и <xref:System.Windows.Media.Pen>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-149">Represents vector graphics data, and any associated <xref:System.Windows.Media.Brush> and <xref:System.Windows.Media.Pen> information.</span></span>|  
|<span data-ttu-id="eee5b-150">Изображение</span><span class="sxs-lookup"><span data-stu-id="eee5b-150">Image</span></span>|<span data-ttu-id="eee5b-151">Представляет изображение в пределах области, определяемой <xref:System.Windows.Rect>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-151">Represents an image within a region defined by a <xref:System.Windows.Rect>.</span></span>|  
|<span data-ttu-id="eee5b-152">Глиф</span><span class="sxs-lookup"><span data-stu-id="eee5b-152">Glyph</span></span>|<span data-ttu-id="eee5b-153">Представляет рисунок, отображающий объект <xref:System.Windows.Media.GlyphRun>, который представляет собой последовательность глифов для указанного ресурса шрифта.</span><span class="sxs-lookup"><span data-stu-id="eee5b-153">Represents a drawing that renders a <xref:System.Windows.Media.GlyphRun>, which is a sequence of glyphs from a specified font resource.</span></span> <span data-ttu-id="eee5b-154">Таким образом представляется текст.</span><span class="sxs-lookup"><span data-stu-id="eee5b-154">This is how text is represented.</span></span>|  
|<span data-ttu-id="eee5b-155">Видео</span><span class="sxs-lookup"><span data-stu-id="eee5b-155">Video</span></span>|<span data-ttu-id="eee5b-156">Представляет рисунок, отображающий видео.</span><span class="sxs-lookup"><span data-stu-id="eee5b-156">Represents a drawing that renders video.</span></span>|  
  
 <span data-ttu-id="eee5b-157"><xref:System.Windows.Media.DrawingContext> позволяет заполнять <xref:System.Windows.Media.Visual> визуальным содержимым.</span><span class="sxs-lookup"><span data-stu-id="eee5b-157">The <xref:System.Windows.Media.DrawingContext> allows you to populate a <xref:System.Windows.Media.Visual> with visual content.</span></span> <span data-ttu-id="eee5b-158">При использовании команд рисования объекта <xref:System.Windows.Media.DrawingContext> фактически происходит сохранение набора данных отрисовки, которые позже будут использоваться графической системой; рисование на экране в режиме реального времени не выполняется.</span><span class="sxs-lookup"><span data-stu-id="eee5b-158">When you use a <xref:System.Windows.Media.DrawingContext> object's draw commands, you are actually storing a set of render data that will later be used by the graphics system; you are not drawing to the screen in real-time.</span></span>  
  
 <span data-ttu-id="eee5b-159">При создании элементов управления [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], например <xref:System.Windows.Controls.Button>, элемент управления неявно создает данные для своей отрисовки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-159">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control, such as a <xref:System.Windows.Controls.Button>, the control implicitly generates render data for drawing itself.</span></span> <span data-ttu-id="eee5b-160">Например, установка свойства <xref:System.Windows.Controls.ContentControl.Content%2A> элемента управления <xref:System.Windows.Controls.Button> заставляет его сохранить представление отрисовки для глифа.</span><span class="sxs-lookup"><span data-stu-id="eee5b-160">For example, setting the <xref:System.Windows.Controls.ContentControl.Content%2A> property of the <xref:System.Windows.Controls.Button> causes the control to store a rendering representation of a glyph.</span></span>  
  
 <span data-ttu-id="eee5b-161">Объект <xref:System.Windows.Media.Visual> описывает свое содержимое в виде одного или нескольких объектов <xref:System.Windows.Media.Drawing>, содержащихся в <xref:System.Windows.Media.DrawingGroup>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-161">A <xref:System.Windows.Media.Visual> describes its content as one or more <xref:System.Windows.Media.Drawing> objects contained within a <xref:System.Windows.Media.DrawingGroup>.</span></span> <span data-ttu-id="eee5b-162">Объект <xref:System.Windows.Media.DrawingGroup> также описывает маски непрозрачности, преобразования, эффекты для точечных рисунков и другие операции, которые применяются к его содержимому.</span><span class="sxs-lookup"><span data-stu-id="eee5b-162">A <xref:System.Windows.Media.DrawingGroup> also describes opacity masks, transforms, bitmap effects, and other operations that are applied to its contents.</span></span> <span data-ttu-id="eee5b-163">При отрисовке содержимого операции <xref:System.Windows.Media.DrawingGroup> применяются в следующем порядке: <xref:System.Windows.Media.DrawingGroup.OpacityMask%2A>, <xref:System.Windows.Media.DrawingGroup.Opacity%2A>, <xref:System.Windows.Media.DrawingGroup.BitmapEffect%2A>, <xref:System.Windows.Media.DrawingGroup.ClipGeometry%2A>, <xref:System.Windows.Media.DrawingGroup.GuidelineSet%2A>, а затем <xref:System.Windows.Media.DrawingGroup.Transform%2A>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-163"><xref:System.Windows.Media.DrawingGroup> operations are applied in the following order when content is rendered: <xref:System.Windows.Media.DrawingGroup.OpacityMask%2A>, <xref:System.Windows.Media.DrawingGroup.Opacity%2A>, <xref:System.Windows.Media.DrawingGroup.BitmapEffect%2A>, <xref:System.Windows.Media.DrawingGroup.ClipGeometry%2A>, <xref:System.Windows.Media.DrawingGroup.GuidelineSet%2A>, and then <xref:System.Windows.Media.DrawingGroup.Transform%2A>.</span></span>  
  
 <span data-ttu-id="eee5b-164">Ниже показан порядок, в котором операции <xref:System.Windows.Media.DrawingGroup> применяются при отрисовке.</span><span class="sxs-lookup"><span data-stu-id="eee5b-164">The following illustration shows the order in which <xref:System.Windows.Media.DrawingGroup> operations are applied during the rendering sequence.</span></span>  
  
 <span data-ttu-id="eee5b-165">![Порядок операций для DrawingGroup](./media/graphcismm-drawinggroup-order.png "graphcismm_drawinggroup_order")</span><span class="sxs-lookup"><span data-stu-id="eee5b-165">![DrawingGroup order of operations](./media/graphcismm-drawinggroup-order.png "graphcismm_drawinggroup_order")</span></span>  
<span data-ttu-id="eee5b-166">Порядок операций для DrawingGroup</span><span class="sxs-lookup"><span data-stu-id="eee5b-166">Order of DrawingGroup operations</span></span>  
  
 <span data-ttu-id="eee5b-167">Дополнительные сведения см. в разделе [Обзор объектов Drawing](drawing-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-167">For more information, see [Drawing Objects Overview](drawing-objects-overview.md).</span></span>  
  
#### <a name="drawing-content-at-the-visual-layer"></a><span data-ttu-id="eee5b-168">Отображение содержимого на визуальном уровне</span><span class="sxs-lookup"><span data-stu-id="eee5b-168">Drawing Content at the Visual Layer</span></span>  
 <span data-ttu-id="eee5b-169">Вы никогда непосредственно не создаете экземпляр <xref:System.Windows.Media.DrawingContext>, однако можете получить контекст рисования с помощью определенных методов, например <xref:System.Windows.Media.DrawingGroup.Open%2A?displayProperty=nameWithType> и <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-169">You never directly instantiate a <xref:System.Windows.Media.DrawingContext>; you can, however, acquire a drawing context from certain methods, such as <xref:System.Windows.Media.DrawingGroup.Open%2A?displayProperty=nameWithType> and <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="eee5b-170">В следующем примере <xref:System.Windows.Media.DrawingContext> извлекается из <xref:System.Windows.Media.DrawingVisual> и используется для рисования прямоугольника.</span><span class="sxs-lookup"><span data-stu-id="eee5b-170">The following example retrieves a <xref:System.Windows.Media.DrawingContext> from a <xref:System.Windows.Media.DrawingVisual> and uses it to draw a rectangle.</span></span>  
  
 [!code-csharp[drawingvisualsample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#101)]
 [!code-vb[drawingvisualsample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#101)]  
  
#### <a name="enumerating-drawing-content-at-the-visual-layer"></a><span data-ttu-id="eee5b-171">Перечисление содержимого рисования на визуальном уровне</span><span class="sxs-lookup"><span data-stu-id="eee5b-171">Enumerating Drawing Content at the Visual Layer</span></span>  
 <span data-ttu-id="eee5b-172">Наряду с другими своими возможностями, объекты <xref:System.Windows.Media.Drawing> также предоставляют объектную модель для перечисления содержимого <xref:System.Windows.Media.Visual>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-172">In addition to their other uses, <xref:System.Windows.Media.Drawing> objects also provide an object model for enumerating the contents of a <xref:System.Windows.Media.Visual>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="eee5b-173">При перечислении содержимого визуального элемента извлекаются объекты <xref:System.Windows.Media.Drawing>, а не базовое представление данных отрисовки в виде списка инструкций векторной графики.</span><span class="sxs-lookup"><span data-stu-id="eee5b-173">When you are enumerating the contents of the visual, you are retrieving <xref:System.Windows.Media.Drawing> objects, and not the underlying representation of the render data as a vector graphics instruction list.</span></span>  
  
 <span data-ttu-id="eee5b-174">В следующем примере метод <xref:System.Windows.Media.VisualTreeHelper.GetDrawing%2A> используется для извлечения значения <xref:System.Windows.Media.DrawingGroup> из <xref:System.Windows.Media.Visual> и перечисления содержимого группы.</span><span class="sxs-lookup"><span data-stu-id="eee5b-174">The following example uses the <xref:System.Windows.Media.VisualTreeHelper.GetDrawing%2A> method to retrieve the <xref:System.Windows.Media.DrawingGroup> value of a <xref:System.Windows.Media.Visual> and enumerate it.</span></span>  
  
 [!code-csharp[DrawingMiscSnippets_snip#GraphicsMMRetrieveDrawings](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingMiscSnippets_snip/CSharp/EnumerateDrawingsExample.xaml.cs#graphicsmmretrievedrawings)]  
  
<a name="how_visual_objects_are_used_to_build_controls"></a>   
## <a name="how-visual-objects-are-used-to-build-controls"></a><span data-ttu-id="eee5b-175">Использование визуальных объектов для создания элементов управления</span><span class="sxs-lookup"><span data-stu-id="eee5b-175">How Visual Objects are Used to Build Controls</span></span>  
 <span data-ttu-id="eee5b-176">Многие из объектов в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] состоят из других визуальных объектов, то есть они могут содержать различные иерархии объектов-потомков.</span><span class="sxs-lookup"><span data-stu-id="eee5b-176">Many of the objects in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] are composed of other visual objects, meaning they can contain varying hierarchies of descendant objects.</span></span> <span data-ttu-id="eee5b-177">Многие элементы пользовательского интерфейса в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], например элементы управления, состоят из множества визуальных объектов, которые представляют различные типы отрисовываемых элементов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-177">Many of the user interface elements in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], such as controls, are composed of multiple visual objects, representing different types of rendering elements.</span></span> <span data-ttu-id="eee5b-178">Например, элемент управления <xref:System.Windows.Controls.Button> может содержать ряд других объектов, в том числе <xref:Microsoft.Windows.Themes.ClassicBorderDecorator>, <xref:System.Windows.Controls.ContentPresenter> и <xref:System.Windows.Controls.TextBlock>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-178">For example, the <xref:System.Windows.Controls.Button> control can contain a number of other objects, including <xref:Microsoft.Windows.Themes.ClassicBorderDecorator>, <xref:System.Windows.Controls.ContentPresenter>, and <xref:System.Windows.Controls.TextBlock>.</span></span>  
  
 <span data-ttu-id="eee5b-179">В следующем коде показано определение элемента управления <xref:System.Windows.Controls.Button> в разметке.</span><span class="sxs-lookup"><span data-stu-id="eee5b-179">The following code shows a <xref:System.Windows.Controls.Button> control defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet1)]  
  
 <span data-ttu-id="eee5b-180">Если бы мы перечислили визуальные объекты, составляющие стандартный элемент управления <xref:System.Windows.Controls.Button>, обнаружилась бы показанная ниже иерархия визуальных объектов:</span><span class="sxs-lookup"><span data-stu-id="eee5b-180">If you were to enumerate the visual objects that comprise the default <xref:System.Windows.Controls.Button> control, you would find the hierarchy of visual objects illustrated below:</span></span>  
  
 <span data-ttu-id="eee5b-181">![Схема иерархии визуального дерева](./media/visuallayeroverview03.gif "VisualLayerOverview03")</span><span class="sxs-lookup"><span data-stu-id="eee5b-181">![Diagram of visual tree hierarchy](./media/visuallayeroverview03.gif "VisualLayerOverview03")</span></span>  
<span data-ttu-id="eee5b-182">Схема иерархии визуального дерева</span><span class="sxs-lookup"><span data-stu-id="eee5b-182">Diagram of visual tree hierarchy</span></span>  
  
 <span data-ttu-id="eee5b-183">Элемент управления <xref:System.Windows.Controls.Button> содержит элемент <xref:Microsoft.Windows.Themes.ClassicBorderDecorator>, который, в свою очередь, содержит элемент <xref:System.Windows.Controls.ContentPresenter>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-183">The <xref:System.Windows.Controls.Button> control contains a <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element, which in turn, contains a <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="eee5b-184">Элемент <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> отвечает за рисование границ и фона для <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-184">The <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element is responsible for drawing a border and a background for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="eee5b-185">Элемент <xref:System.Windows.Controls.ContentPresenter> отвечает за отображение содержимого <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-185">The <xref:System.Windows.Controls.ContentPresenter> element is responsible for displaying the contents of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="eee5b-186">В данном случае, поскольку отображается текст, элемент <xref:System.Windows.Controls.ContentPresenter> содержит элемент <xref:System.Windows.Controls.TextBlock>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-186">In this case, since you are displaying text, the <xref:System.Windows.Controls.ContentPresenter> element contains a <xref:System.Windows.Controls.TextBlock> element.</span></span> <span data-ttu-id="eee5b-187">Тот факт, что элемент управления <xref:System.Windows.Controls.Button> использует <xref:System.Windows.Controls.ContentPresenter>, означает, что его содержимое можно представить в виде других элементов, например <xref:System.Windows.Controls.Image>, или геометрического объекта, например <xref:System.Windows.Media.EllipseGeometry>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-187">The fact that the <xref:System.Windows.Controls.Button> control uses a <xref:System.Windows.Controls.ContentPresenter> means that the content could be represented by other elements, such as an <xref:System.Windows.Controls.Image> or a geometry, such as an <xref:System.Windows.Media.EllipseGeometry>.</span></span>  
  
### <a name="control-templates"></a><span data-ttu-id="eee5b-188">Шаблоны элементов управления</span><span class="sxs-lookup"><span data-stu-id="eee5b-188">Control Templates</span></span>  
 <span data-ttu-id="eee5b-189">Ключевую роль в развертывании элементов управления в иерархию играет <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-189">The key to the expansion of a control into a hierarchy of controls is the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="eee5b-190">Шаблон элемента управления определяет его визуальную иерархию по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="eee5b-190">A control template specifies the default visual hierarchy for a control.</span></span> <span data-ttu-id="eee5b-191">При явной ссылке на элемент управления вы неявно ссылаетесь на его визуальную иерархию.</span><span class="sxs-lookup"><span data-stu-id="eee5b-191">When you explicitly reference a control, you implicitly reference its visual hierarchy.</span></span> <span data-ttu-id="eee5b-192">Для изменения внешнего вида элемента управления вы можете переопределить значения по умолчанию для его шаблона.</span><span class="sxs-lookup"><span data-stu-id="eee5b-192">You can override the default values for a control template to create a customized visual appearance for a control.</span></span> <span data-ttu-id="eee5b-193">Например, можно изменить значение цвета фона элемента управления <xref:System.Windows.Controls.Button> так, чтобы использовалось значение линейного градиента цвета вместо значения сплошного цвета.</span><span class="sxs-lookup"><span data-stu-id="eee5b-193">For example, you could modify the background color value of the <xref:System.Windows.Controls.Button> control so that it uses a linear gradient color value instead of a solid color value.</span></span> <span data-ttu-id="eee5b-194">Дополнительные сведения см. в разделе [Стили и шаблоны кнопок](../controls/button-styles-and-templates.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-194">For more information, see [Button Styles and Templates](../controls/button-styles-and-templates.md).</span></span>  
  
 <span data-ttu-id="eee5b-195">Элемент пользовательского интерфейса, такие как <xref:System.Windows.Controls.Button> управления, содержит несколько списков инструкций векторной графики, которые описывают полностью определяют отрисовку элемента управления.</span><span class="sxs-lookup"><span data-stu-id="eee5b-195">A user interface element, such as a <xref:System.Windows.Controls.Button> control, contains several vector graphics instruction lists that describe the entire rendering definition of a control.</span></span> <span data-ttu-id="eee5b-196">В следующем коде показано определение элемента управления <xref:System.Windows.Controls.Button> в разметке.</span><span class="sxs-lookup"><span data-stu-id="eee5b-196">The following code shows a <xref:System.Windows.Controls.Button> control defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet2](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet2)]  
  
 <span data-ttu-id="eee5b-197">Если перечислить визуальные объекты и списки инструкций векторной графики, которые составляют элемент управления <xref:System.Windows.Controls.Button>, обнаружится показанная ниже иерархия объектов:</span><span class="sxs-lookup"><span data-stu-id="eee5b-197">If you were to enumerate the visual objects and vector graphics instruction lists that comprise the <xref:System.Windows.Controls.Button> control, you would find the hierarchy of objects illustrated below:</span></span>  
  
 <span data-ttu-id="eee5b-198">![Схема визуального дерева и отрисовки данных](./media/visuallayeroverview04.png "VisualLayerOverview04")</span><span class="sxs-lookup"><span data-stu-id="eee5b-198">![Diagram of visual tree and rendering data](./media/visuallayeroverview04.png "VisualLayerOverview04")</span></span>  
<span data-ttu-id="eee5b-199">Схема визуального дерева и отрисовки данных</span><span class="sxs-lookup"><span data-stu-id="eee5b-199">Diagram of visual tree and rendering data</span></span>  
  
 <span data-ttu-id="eee5b-200">Элемент управления <xref:System.Windows.Controls.Button> содержит элемент <xref:Microsoft.Windows.Themes.ClassicBorderDecorator>, который, в свою очередь, содержит элемент <xref:System.Windows.Controls.ContentPresenter>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-200">The <xref:System.Windows.Controls.Button> control contains a <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element, which in turn, contains a <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="eee5b-201"><xref:Microsoft.Windows.Themes.ClassicBorderDecorator> Элемент отвечает за рисование всех отдельных графических элементов, составляющих границу и фон кнопки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-201">The <xref:Microsoft.Windows.Themes.ClassicBorderDecorator> element is responsible for drawing all the discrete graphic elements that make up the border and background of a button.</span></span> <span data-ttu-id="eee5b-202">Элемент <xref:System.Windows.Controls.ContentPresenter> отвечает за отображение содержимого <xref:System.Windows.Controls.Button>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-202">The <xref:System.Windows.Controls.ContentPresenter> element is responsible for displaying the contents of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="eee5b-203">В этом случае, поскольку выполняется отображение изображения, <xref:System.Windows.Controls.ContentPresenter> элемент содержит <xref:System.Windows.Controls.Image> элемент.</span><span class="sxs-lookup"><span data-stu-id="eee5b-203">In this case, since you are displaying an image, the <xref:System.Windows.Controls.ContentPresenter> element contains a <xref:System.Windows.Controls.Image> element.</span></span>  
  
 <span data-ttu-id="eee5b-204">При работе с иерархией визуальных объектов и списками инструкций векторной графики следует учитывать несколько моментов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-204">There are a number of points to note about the hierarchy of visual objects and vector graphics instruction lists:</span></span>  
  
-   <span data-ttu-id="eee5b-205">Порядок иерархии представляет порядок отрисовки графической информации.</span><span class="sxs-lookup"><span data-stu-id="eee5b-205">The ordering in the hierarchy represents the rendering order of the drawing information.</span></span> <span data-ttu-id="eee5b-206">От корневого визуального элемента проход дочерних элементов осуществляется слева направо и сверху вниз.</span><span class="sxs-lookup"><span data-stu-id="eee5b-206">From the root visual element, child elements are traversed, left to right, top to bottom.</span></span> <span data-ttu-id="eee5b-207">Если у элемента есть дочерние визуальные элементы, они проходятся до элементов того же уровня.</span><span class="sxs-lookup"><span data-stu-id="eee5b-207">If an element has visual child elements, they are traversed before the element’s siblings.</span></span>  
  
-   <span data-ttu-id="eee5b-208">Неконечные элементы в иерархии, например <xref:System.Windows.Controls.ContentPresenter>, используются для хранения дочерних элементов — они не содержат списков инструкций.</span><span class="sxs-lookup"><span data-stu-id="eee5b-208">Non-leaf node elements in the hierarchy, such as <xref:System.Windows.Controls.ContentPresenter>, are used to contain child elements—they do not contain instruction lists.</span></span>  
  
-   <span data-ttu-id="eee5b-209">Если визуальный элемент содержит как список инструкций векторной графики, так и визуальные дочерние объекты, то список инструкций в родительском визуальном элементе выполняется перед тем, как будут прорисованы любые визуальные дочерние объекты.</span><span class="sxs-lookup"><span data-stu-id="eee5b-209">If a visual element contains both a vector graphics instruction list and visual children, the instruction list in the parent visual element is rendered before drawings in any of the visual child objects.</span></span>  
  
-   <span data-ttu-id="eee5b-210">Элементы в списке инструкций векторной графики обрабатываются слева направо.</span><span class="sxs-lookup"><span data-stu-id="eee5b-210">The items in the vector graphics instruction list are rendered left to right.</span></span>  
  
<a name="visual_tree"></a>   
## <a name="visual-tree"></a><span data-ttu-id="eee5b-211">Визуальное дерево</span><span class="sxs-lookup"><span data-stu-id="eee5b-211">Visual Tree</span></span>  
 <span data-ttu-id="eee5b-212">Визуальное дерево содержит все визуальные элементы, содержащиеся в пользовательском интерфейсе приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-212">The visual tree contains all visual elements used in an application's user interface.</span></span> <span data-ttu-id="eee5b-213">Поскольку визуальный элемент содержит сохраняемую графическую информацию, визуальное дерево можно представить как граф сцены, содержащий все сведения об отрисовке, необходимые для формирования данных, выводимых на устройство отображения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-213">Since a visual element contains persisted drawing information, you can think of the visual tree as a scene graph, containing all the rendering information needed to compose the output to the display device.</span></span> <span data-ttu-id="eee5b-214">Это дерево представляет собой совокупность всех визуальных элементов, создаваемых непосредственно в приложении (в коде или в разметке).</span><span class="sxs-lookup"><span data-stu-id="eee5b-214">This tree is the accumulation of all visual elements created directly by the application, whether in code or in markup.</span></span> <span data-ttu-id="eee5b-215">Визуальное дерево также содержит все визуальные элементы, создаваемые путем расширения шаблона элементов, например элементы управления и объекты данных.</span><span class="sxs-lookup"><span data-stu-id="eee5b-215">The visual tree also contains all visual elements created by the template expansion of elements such as controls and data objects.</span></span>  
  
 <span data-ttu-id="eee5b-216">В следующем коде показан элемент <xref:System.Windows.Controls.StackPanel>, определенный в разметке.</span><span class="sxs-lookup"><span data-stu-id="eee5b-216">The following code shows a <xref:System.Windows.Controls.StackPanel> element defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet3](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet3)]  
  
 <span data-ttu-id="eee5b-217">Если перечислить визуальные объекты, которые составляют элемент <xref:System.Windows.Controls.StackPanel> в примере разметки, обнаружится показанная ниже иерархия визуальных объектов:</span><span class="sxs-lookup"><span data-stu-id="eee5b-217">If you were to enumerate the visual objects that comprise the <xref:System.Windows.Controls.StackPanel> element in the markup example, you would find the hierarchy of visual objects illustrated below:</span></span>  
  
 <span data-ttu-id="eee5b-218">![Схема иерархии визуального дерева](./media/visuallayeroverview05.gif "VisualLayerOverview05")</span><span class="sxs-lookup"><span data-stu-id="eee5b-218">![Diagram of visual tree hierarchy](./media/visuallayeroverview05.gif "VisualLayerOverview05")</span></span>  
<span data-ttu-id="eee5b-219">Схема иерархии визуального дерева</span><span class="sxs-lookup"><span data-stu-id="eee5b-219">Diagram of visual tree hierarchy</span></span>  
  
### <a name="rendering-order"></a><span data-ttu-id="eee5b-220">Порядок отрисовки</span><span class="sxs-lookup"><span data-stu-id="eee5b-220">Rendering Order</span></span>  
 <span data-ttu-id="eee5b-221">Визуальное дерево определяет порядок отрисовки визуальных элементов и графических объектов [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eee5b-221">The visual tree determines the rendering order of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual and drawing objects.</span></span> <span data-ttu-id="eee5b-222">Обработка начинается с корневого визуального элемента, самого верхнего узла в визуальном дереве.</span><span class="sxs-lookup"><span data-stu-id="eee5b-222">The order of traversal starts with the root visual, which is the top-most node in the visual tree.</span></span> <span data-ttu-id="eee5b-223">Затем обрабатываются дочерние элементы корневого визуального элемента слева направо.</span><span class="sxs-lookup"><span data-stu-id="eee5b-223">The root visual’s children are then traversed, left to right.</span></span> <span data-ttu-id="eee5b-224">Если у визуального элемента есть дочерние элементы, они обрабатываются перед элементами, находящимися на одном уровне с визуальным элементом.</span><span class="sxs-lookup"><span data-stu-id="eee5b-224">If a visual has children, its children are traversed before the visual’s siblings.</span></span> <span data-ttu-id="eee5b-225">Это означает, что содержимое дочерних визуальных элементов отображается перед содержимым самого визуального элемента.</span><span class="sxs-lookup"><span data-stu-id="eee5b-225">This means that the content of a child visual is rendered in front of the visual's own content.</span></span>  
  
 <span data-ttu-id="eee5b-226">![Схема порядка отрисовки визуального дерева](./media/visuallayeroverview06.gif "VisualLayerOverview06")</span><span class="sxs-lookup"><span data-stu-id="eee5b-226">![Diagram of visual tree rendering order](./media/visuallayeroverview06.gif "VisualLayerOverview06")</span></span>  
<span data-ttu-id="eee5b-227">Схема порядка отрисовки визуального дерева</span><span class="sxs-lookup"><span data-stu-id="eee5b-227">Diagram of visual tree rendering order</span></span>  
  
### <a name="root-visual"></a><span data-ttu-id="eee5b-228">Корневой визуальный элемент</span><span class="sxs-lookup"><span data-stu-id="eee5b-228">Root Visual</span></span>  
 <span data-ttu-id="eee5b-229">**Корневой визуальный элемент** — это самый верхний элемент в иерархии визуального дерева.</span><span class="sxs-lookup"><span data-stu-id="eee5b-229">The **root visual** is the top-most element in a visual tree hierarchy.</span></span> <span data-ttu-id="eee5b-230">В большинстве приложений базовым классом корневого визуального является либо <xref:System.Windows.Window> или <xref:System.Windows.Navigation.NavigationWindow>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-230">In most applications, the base class of the root visual is either <xref:System.Windows.Window> or <xref:System.Windows.Navigation.NavigationWindow>.</span></span> <span data-ttu-id="eee5b-231">Однако при размещении визуальных объектов в приложении Win32 в качестве корневого визуального элемента использовался бы самый верхний визуальный элемент в окне Win32.</span><span class="sxs-lookup"><span data-stu-id="eee5b-231">However, if you were hosting visual objects in a Win32 application, the root visual would be the top-most visual you were hosting in the Win32 window.</span></span> <span data-ttu-id="eee5b-232">Дополнительные сведения см. в статье [Руководство. По размещению визуальных объектов в приложении Win32](tutorial-hosting-visual-objects-in-a-win32-application.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-232">For more information, see [Tutorial: Hosting Visual Objects in a Win32 Application](tutorial-hosting-visual-objects-in-a-win32-application.md).</span></span>  
  
### <a name="relationship-to-the-logical-tree"></a><span data-ttu-id="eee5b-233">Связь с логическом деревом</span><span class="sxs-lookup"><span data-stu-id="eee5b-233">Relationship to the Logical Tree</span></span>  
 <span data-ttu-id="eee5b-234">Логическое дерево в [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] представляет элементы приложения во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-234">The logical tree in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] represents the elements of an application at run time.</span></span> <span data-ttu-id="eee5b-235">Хотя этим деревом нельзя управлять напрямую, с помощью этой схемы удобно представить наследование свойств и маршрутизацию событий.</span><span class="sxs-lookup"><span data-stu-id="eee5b-235">Although you do not manipulate this tree directly, this view of the application is useful for understanding property inheritance and event routing.</span></span> <span data-ttu-id="eee5b-236">В отличие от визуального дерева, логическое дерево может представлять данные невизуальных объектов, таких как <xref:System.Windows.Documents.ListItem>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-236">Unlike the visual tree, the logical tree can represent non-visual data objects, such as <xref:System.Windows.Documents.ListItem>.</span></span> <span data-ttu-id="eee5b-237">Во многих случаях логическое дерево приближается к определению разметки приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-237">In many cases, the logical tree maps very closely to an application's markup definitions.</span></span> <span data-ttu-id="eee5b-238">В следующем коде показан элемент <xref:System.Windows.Controls.DockPanel>, определенный в разметке.</span><span class="sxs-lookup"><span data-stu-id="eee5b-238">The following code shows a <xref:System.Windows.Controls.DockPanel> element defined in markup.</span></span>  
  
 [!code-xaml[VisualsOverview#VisualsOverviewSnippet5](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml#visualsoverviewsnippet5)]  
  
 <span data-ttu-id="eee5b-239">Если перечислить логические объекты, которые составляют элемент <xref:System.Windows.Controls.DockPanel> в примере разметки, обнаружится иерархия логических объектов, показанная ниже:</span><span class="sxs-lookup"><span data-stu-id="eee5b-239">If you were to enumerate the logical objects that comprise the <xref:System.Windows.Controls.DockPanel> element in the markup example, you would find the hierarchy of logical objects illustrated below:</span></span>  
  
 <span data-ttu-id="eee5b-240">![Диаграмма дерева](./media/tree1-wcp.gif "Tree1_wcp")</span><span class="sxs-lookup"><span data-stu-id="eee5b-240">![Tree diagram](./media/tree1-wcp.gif "Tree1_wcp")</span></span>  
<span data-ttu-id="eee5b-241">Схема логического дерева</span><span class="sxs-lookup"><span data-stu-id="eee5b-241">Diagram of logical tree</span></span>  
  
 <span data-ttu-id="eee5b-242">Визуальное дерево и логическое дерево синхронизируются с текущим набором элементов приложения, отражая добавление, удаление или изменение элементов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-242">Both the visual tree and logical tree are synchronized with the current set of application elements, reflecting any addition, deletion, or modification of elements.</span></span> <span data-ttu-id="eee5b-243">Однако эти деревья отражают различные представления приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-243">However, the trees present different views of the application.</span></span> <span data-ttu-id="eee5b-244">В отличие от визуального дерева, в логическом дереве не ракрываются <xref:System.Windows.Controls.ContentPresenter> элементов управления.</span><span class="sxs-lookup"><span data-stu-id="eee5b-244">Unlike the visual tree, the logical tree does not expand a control's <xref:System.Windows.Controls.ContentPresenter> element.</span></span> <span data-ttu-id="eee5b-245">Это означает, что между логическим деревом и визуальным деревом для одного и того же набора объектов нет прямого однозначного соответствия.</span><span class="sxs-lookup"><span data-stu-id="eee5b-245">This means there is not a direct one-to-one correspondence between a logical tree and a visual tree for the same set of objects.</span></span> <span data-ttu-id="eee5b-246">На самом деле, вызов метода <xref:System.Windows.LogicalTreeHelper.GetChildren%2A> объекта **LogicalTreeHelper** и метода <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> объекта **VisualTreeHelper** с одним и тем же элементом в качестве параметра дает разные результаты.</span><span class="sxs-lookup"><span data-stu-id="eee5b-246">In fact, invoking the **LogicalTreeHelper** object's <xref:System.Windows.LogicalTreeHelper.GetChildren%2A> method and the **VisualTreeHelper** object's <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> method using the same element as a parameter yields differing results.</span></span>  
  
 <span data-ttu-id="eee5b-247">Дополнительные сведения о логическом дереве см. в разделе [Деревья в WPF](../advanced/trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-247">For more information on the logical tree, see [Trees in WPF](../advanced/trees-in-wpf.md).</span></span>  
  
### <a name="viewing-the-visual-tree-with-xamlpad"></a><span data-ttu-id="eee5b-248">Просмотр визуального дерева с помощью XamlPad</span><span class="sxs-lookup"><span data-stu-id="eee5b-248">Viewing the Visual Tree with XamlPad</span></span>  
 <span data-ttu-id="eee5b-249">Средство [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] XamlPad позволяет просматривать и изучать визуальное дерево, соответствующее текущему содержимому [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eee5b-249">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] tool, XamlPad, provides an option for viewing and exploring the visual tree that corresponds to the currently defined [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] content.</span></span> <span data-ttu-id="eee5b-250">Для отображения визуального дерева нажмите кнопку **Показать визуальное дерево**.</span><span class="sxs-lookup"><span data-stu-id="eee5b-250">Click the **Show Visual Tree** button on the menu bar to display the visual tree.</span></span> <span data-ttu-id="eee5b-251">Ниже показано расширение содержимого [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] в узлы визуального дерева на панели **Обозреватель визуального дерева** XamlPad.</span><span class="sxs-lookup"><span data-stu-id="eee5b-251">The following illustrates the expansion of [!INCLUDE[TLA#tla_titlexaml](../../../../includes/tlasharptla-titlexaml-md.md)] content into visual tree nodes in the **Visual Tree Explorer** panel of XamlPad:</span></span>  
  
 <span data-ttu-id="eee5b-252">![Панель обозревателя визуального дерева в XamlPad](./media/visuallayeroverview08.png "VisualLayerOverview08")</span><span class="sxs-lookup"><span data-stu-id="eee5b-252">![Visual Tree Explorer panel in XamlPad](./media/visuallayeroverview08.png "VisualLayerOverview08")</span></span>  
<span data-ttu-id="eee5b-253">Панель обозревателя визуального дерева в XamlPad</span><span class="sxs-lookup"><span data-stu-id="eee5b-253">Visual Tree Explorer panel in XamlPad</span></span>  
  
 <span data-ttu-id="eee5b-254">Обратите внимание, что каждый из элементов управления <xref:System.Windows.Controls.Label>, <xref:System.Windows.Controls.TextBox> и <xref:System.Windows.Controls.Button> отображает отдельную иерархию визуальных объектов в панели **Обозреватель визуального дерева** XamlPad.</span><span class="sxs-lookup"><span data-stu-id="eee5b-254">Notice how the <xref:System.Windows.Controls.Label>, <xref:System.Windows.Controls.TextBox>, and <xref:System.Windows.Controls.Button> controls each display a separate visual object hierarchy in the **Visual Tree Explorer** panel of XamlPad.</span></span> <span data-ttu-id="eee5b-255">Это обусловлено тем, что элементы управления [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] имеют шаблон <xref:System.Windows.Controls.ControlTemplate>, который содержит визуальное дерево этого элемента управления.</span><span class="sxs-lookup"><span data-stu-id="eee5b-255">This is because [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls have a <xref:System.Windows.Controls.ControlTemplate> that contains the visual tree of that control.</span></span> <span data-ttu-id="eee5b-256">При явной ссылке на элемент управления вы неявно ссылаетесь на его визуальную иерархию.</span><span class="sxs-lookup"><span data-stu-id="eee5b-256">When you explicitly reference a control, you implicitly reference its visual hierarchy.</span></span>  
  
### <a name="profiling-visual-performance"></a><span data-ttu-id="eee5b-257">Профилирование производительности для объекта Visual</span><span class="sxs-lookup"><span data-stu-id="eee5b-257">Profiling Visual Performance</span></span>  
 <span data-ttu-id="eee5b-258">В состав [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] входит пакет инструментов для профилирования производительности, с помощью которых можно проанализировать поведение приложения во время выполнения и определить, каким образом можно повысить производительность.</span><span class="sxs-lookup"><span data-stu-id="eee5b-258">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] provides a suite of performance profiling tools that allow you to analyze the run-time behavior of your application and determine the types of performance optimizations you can apply.</span></span> <span data-ttu-id="eee5b-259">Средство Visual Profiler предоставляет подробные данные о производительности в удобном графическом формате, сопоставляя их напрямую с визуальным деревом приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-259">The Visual Profiler tool provides a rich, graphical view of performance data by mapping directly to the application's visual tree.</span></span> <span data-ttu-id="eee5b-260">На этом снимке экрана показан раздел **Использование ЦП** средства Visual Profiler. В этом разделе вы можете получить точное представление об использовании объектом служб [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], таких как отрисовка и разметка.</span><span class="sxs-lookup"><span data-stu-id="eee5b-260">In this screenshot, the **CPU Usage** section of the Visual Profiler gives you a precise breakdown of an object's use of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] services, such as rendering and layout.</span></span>  
  
 <span data-ttu-id="eee5b-261">![Visual Profiler отображает выходные данные](./media/wpfperf-visualprofiler-04.png "WPFPerf_VisualProfiler_04")</span><span class="sxs-lookup"><span data-stu-id="eee5b-261">![Visual Profiler display output](./media/wpfperf-visualprofiler-04.png "WPFPerf_VisualProfiler_04")</span></span>  
<span data-ttu-id="eee5b-262">Отображение данных Visual Profiler</span><span class="sxs-lookup"><span data-stu-id="eee5b-262">Visual Profiler display output</span></span>  
  
<a name="visual_rendering_behavior"></a>   
## <a name="visual-rendering-behavior"></a><span data-ttu-id="eee5b-263">Поведение отрисовки для объекта Visual</span><span class="sxs-lookup"><span data-stu-id="eee5b-263">Visual Rendering Behavior</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="eee5b-264">включает несколько возможностей, влияющих на отрисовку визуальных объектов: абстрактный графический режим, векторная графика и аппаратно независимая графика.</span><span class="sxs-lookup"><span data-stu-id="eee5b-264">introduces several features that affect the rendering behavior of visual objects: retained mode graphics, vector graphics, and device independent graphics.</span></span>  
  
### <a name="retained-mode-graphics"></a><span data-ttu-id="eee5b-265">Абстрактный графический режим</span><span class="sxs-lookup"><span data-stu-id="eee5b-265">Retained Mode Graphics</span></span>  
 <span data-ttu-id="eee5b-266">Для понимания роли объекта Visual необходимо хорошо представлять различие между системами с **непосредственным** и **абстрактным** графическими режимами.</span><span class="sxs-lookup"><span data-stu-id="eee5b-266">One of the keys to understanding the role of the Visual object is to understand the difference between **immediate mode** and **retained mode** graphics systems.</span></span> <span data-ttu-id="eee5b-267">В стандартном приложении Win32 на основе GDI или GDI+ используется непосредственный графический режим.</span><span class="sxs-lookup"><span data-stu-id="eee5b-267">A standard Win32 application based on GDI or GDI+ uses an immediate mode graphics system.</span></span> <span data-ttu-id="eee5b-268">Это означает, что приложение отвечает за перерисовку той части клиентской области, которая стала недействительной из-за таких действий, как изменение размера окна или изменение внешнего вида объекта.</span><span class="sxs-lookup"><span data-stu-id="eee5b-268">This means that the application is responsible for repainting the portion of the client area that is invalidated, due to an action such as a window being resized, or an object changing its visual appearance.</span></span>  
  
 <span data-ttu-id="eee5b-269">![Схема последовательности отрисовки Win32](./media/visuallayeroverview01.png "VisualLayerOverview01")</span><span class="sxs-lookup"><span data-stu-id="eee5b-269">![Diagram of Win32 rendering sequence](./media/visuallayeroverview01.png "VisualLayerOverview01")</span></span>  
<span data-ttu-id="eee5b-270">Схема последовательности отрисовки Win32</span><span class="sxs-lookup"><span data-stu-id="eee5b-270">Diagram of Win32 rendering sequence</span></span>  
  
 <span data-ttu-id="eee5b-271">В [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], напротив, используется абстрактный графический режим.</span><span class="sxs-lookup"><span data-stu-id="eee5b-271">In contrast, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses a retained mode system.</span></span> <span data-ttu-id="eee5b-272">Это означает, что в объектах приложения, у которых есть внешний облик, определяется набор сериализованных графических данных.</span><span class="sxs-lookup"><span data-stu-id="eee5b-272">This means application objects that have a visual appearance define a set of serialized drawing data.</span></span> <span data-ttu-id="eee5b-273">После определения графических данных система отвечает на все запросы перерисовки для отрисовки объектов приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-273">Once the drawing data is defined, the system is responsible thereafter for responding to all repaint requests for rendering the application objects.</span></span> <span data-ttu-id="eee5b-274">Даже во время выполнения можно изменять или создавать объекты приложения, при этом система будет обрабатывать запросы на перерисовку.</span><span class="sxs-lookup"><span data-stu-id="eee5b-274">Even at run time, you can modify or create application objects, and still rely on the system for responding to paint requests.</span></span> <span data-ttu-id="eee5b-275">Преимущество абстрактного режима состоит в том, что данные отрисовки всегда сохраняются приложением в сериализованном виде, при этом за отрисовку отвечает система.</span><span class="sxs-lookup"><span data-stu-id="eee5b-275">The power in a retained mode graphics system is that drawing information is always persisted in a serialized state by the application, but rendering responsibility left to the system.</span></span> <span data-ttu-id="eee5b-276">На следующей схеме показано, как приложение полагается на [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] в обработке запросов на отрисовку.</span><span class="sxs-lookup"><span data-stu-id="eee5b-276">The following diagram shows how the application relies on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] for responding to paint requests.</span></span>  
  
 <span data-ttu-id="eee5b-277">![Схема последовательности отрисовки WPF](./media/visuallayeroverview02.png "VisualLayerOverview02")</span><span class="sxs-lookup"><span data-stu-id="eee5b-277">![Diagram of WPF rendering sequence](./media/visuallayeroverview02.png "VisualLayerOverview02")</span></span>  
<span data-ttu-id="eee5b-278">Схема последовательности отрисовки WPF</span><span class="sxs-lookup"><span data-stu-id="eee5b-278">Diagram of WPF rendering sequence</span></span>  
  
#### <a name="intelligent-redrawing"></a><span data-ttu-id="eee5b-279">Интеллектуальная перерисовка</span><span class="sxs-lookup"><span data-stu-id="eee5b-279">Intelligent Redrawing</span></span>  
 <span data-ttu-id="eee5b-280">Одним из основных преимуществ использования абстрактного графического режима является то, что [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] может эффективно оптимизировать элементы приложения, которые требуют перерисовки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-280">One of the biggest benefits in using retained mode graphics is that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can efficiently optimize what needs to be redrawn in the application.</span></span> <span data-ttu-id="eee5b-281">Даже при наличии сложной сцены с различными уровнями прозрачности разработчикам обычно не нужно писать специальный код для оптимизации перерисовки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-281">Even if you have a complex scene with varying levels of opacity, you generally do not need to write special-purpose code to optimize redrawing.</span></span> <span data-ttu-id="eee5b-282">Сравните это с программированием для Win32, в котором можно потратить значительные усилия на оптимизацию приложения, уменьшая объем перерисовки в области обновления.</span><span class="sxs-lookup"><span data-stu-id="eee5b-282">Compare this with Win32 programming in which you can spend a great deal of effort in optimizing your application by minimizing the amount of redrawing in the update region.</span></span> <span data-ttu-id="eee5b-283">Пример сложного случая оптимизации перерисовки для приложений Win32 см. в разделе [Перерисовка в области обновления](/windows/desktop/gdi/redrawing-in-the-update-region).</span><span class="sxs-lookup"><span data-stu-id="eee5b-283">See [Redrawing in the Update Region](/windows/desktop/gdi/redrawing-in-the-update-region) for an example of the type of complexity involved in optimizing redrawing in Win32 applications.</span></span>  
  
### <a name="vector-graphics"></a><span data-ttu-id="eee5b-284">Векторная графика</span><span class="sxs-lookup"><span data-stu-id="eee5b-284">Vector Graphics</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="eee5b-285">использует **векторную графику** качестве формата данных отрисовки.</span><span class="sxs-lookup"><span data-stu-id="eee5b-285">uses **vector graphics** as its rendering data format.</span></span> <span data-ttu-id="eee5b-286">Векторная графика, к которой относятся масштабируемые векторные рисунки (SVG), метафайлы Windows (WMF) и шрифты TrueType, хранит данные отрисовки и передает их в виде списка инструкций, которые описывают, как воссоздать изображение с помощью графических примитивов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-286">Vector graphics—which include Scalable Vector Graphics (SVG), Windows metafiles (.wmf), and TrueType fonts—store rendering data and transmit it as a list of instructions that describe how to recreate an image using graphics primitives.</span></span> <span data-ttu-id="eee5b-287">Например, шрифты TrueType — это контурные шрифты, которые описывают набор линий, кривых и команд, а не массив точек.</span><span class="sxs-lookup"><span data-stu-id="eee5b-287">For example, TrueType fonts are outline fonts that describe a set of lines, curves, and commands, rather than an array of pixels.</span></span> <span data-ttu-id="eee5b-288">Одним из основных преимуществ векторной графики является возможность масштабирования до любого размера и разрешения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-288">One of the key benefits of vector graphics is the ability to scale to any size and resolution.</span></span>  
  
 <span data-ttu-id="eee5b-289">В отличие от векторной графики в растровой графике данные отрисовки представлены в попиксельном виде для определенного разрешения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-289">Unlike vector graphics, bitmap graphics store rendering data as a pixel-by-pixel representation of an image, pre-rendered for a specific resolution.</span></span> <span data-ttu-id="eee5b-290">Одним из ключевых различий между растровой и векторной графикой является соответствие исходному изображению.</span><span class="sxs-lookup"><span data-stu-id="eee5b-290">One of the key differences between bitmap and vector graphic formats is fidelity to the original source image.</span></span> <span data-ttu-id="eee5b-291">Например, при изменении размера исходного изображения в растровой графике изображение растягивается, тогда как в векторной — масштабируется с сохранением качества.</span><span class="sxs-lookup"><span data-stu-id="eee5b-291">For example, when the size of a source image is modified, bitmap graphics systems stretch the image, whereas vector graphics systems scale the image, preserving the image fidelity.</span></span>  
  
 <span data-ttu-id="eee5b-292">На следующем рисунке показано исходное изображение, которое было увеличено в 3 раза (масштаб 300 %).</span><span class="sxs-lookup"><span data-stu-id="eee5b-292">The following illustration shows a source image that has been resized by 300%.</span></span> <span data-ttu-id="eee5b-293">Обратите внимание на искажения, которые появляются при растяжении исходного изображения в растровом формате по сравнению с векторным.</span><span class="sxs-lookup"><span data-stu-id="eee5b-293">Notice the distortions that appear when the source image is stretched as a bitmap graphics image rather than scaled as a vector graphics image.</span></span>  
  
 <span data-ttu-id="eee5b-294">![Различия между растровой и векторной графикой](./media/vectorgraphics01.png "VectorGraphics01")</span><span class="sxs-lookup"><span data-stu-id="eee5b-294">![Differences between raster and vector graphics](./media/vectorgraphics01.png "VectorGraphics01")</span></span>  
<span data-ttu-id="eee5b-295">Различия между растровой и векторной графикой</span><span class="sxs-lookup"><span data-stu-id="eee5b-295">Differences between raster and vector graphics</span></span>  
  
 <span data-ttu-id="eee5b-296">В следующем примере показано определение двух элементов <xref:System.Windows.Shapes.Path>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-296">The following markup shows two <xref:System.Windows.Shapes.Path> elements defined.</span></span> <span data-ttu-id="eee5b-297">Во втором элементе с помощью <xref:System.Windows.Media.ScaleTransform> к инструкциям отрисовки первого элемента применяется операция изменения размера на 300 %.</span><span class="sxs-lookup"><span data-stu-id="eee5b-297">The second element uses a <xref:System.Windows.Media.ScaleTransform> to resize the drawing instructions of the first element by 300%.</span></span> <span data-ttu-id="eee5b-298">Обратите внимание, что инструкции отрисовки в элементе <xref:System.Windows.Shapes.Path> остаются без изменений.</span><span class="sxs-lookup"><span data-stu-id="eee5b-298">Notice that the drawing instructions in the <xref:System.Windows.Shapes.Path> elements remain unchanged.</span></span>  
  
 [!code-xaml[VectorGraphicsSnippets#VectorGraphicsSnippet1](~/samples/snippets/csharp/VS_Snippets_Wpf/VectorGraphicsSnippets/CS/PageOne.xaml#vectorgraphicssnippet1)]  
  
### <a name="about-resolution-and-device-independent-graphics"></a><span data-ttu-id="eee5b-299">О разрешении и аппаратно независимой графике</span><span class="sxs-lookup"><span data-stu-id="eee5b-299">About Resolution and Device-Independent Graphics</span></span>  
 <span data-ttu-id="eee5b-300">Существуют два фактора, которые определяют размер текста и графики на экране: разрешение и количество точек на дюйм.</span><span class="sxs-lookup"><span data-stu-id="eee5b-300">There are two system factors that determine the size of text and graphics on your screen: resolution and DPI.</span></span> <span data-ttu-id="eee5b-301">Разрешение определяет число пикселей, отображаемых на экране.</span><span class="sxs-lookup"><span data-stu-id="eee5b-301">Resolution describes the number of pixels that appear on the screen.</span></span> <span data-ttu-id="eee5b-302">Чем выше разрешение, тем меньше размер пикселей и тем меньше отображаемые объекты и текст.</span><span class="sxs-lookup"><span data-stu-id="eee5b-302">As the resolution gets higher, pixels get smaller, causing graphics and text to appear smaller.</span></span> <span data-ttu-id="eee5b-303">Изображение на мониторе с разрешением 1024 x 768 значительно уменьшится, если изменить разрешение на 1600 x 1200.</span><span class="sxs-lookup"><span data-stu-id="eee5b-303">A graphic displayed on a monitor set to 1024 x 768 will appear much smaller when the resolution is changed to 1600 x 1200.</span></span>  
  
 <span data-ttu-id="eee5b-304">Другой системный параметр, количество точек на дюйм, описывает размер дюйма экрана в пикселях.</span><span class="sxs-lookup"><span data-stu-id="eee5b-304">The other system setting, DPI, describes the size of a screen inch in pixels.</span></span> <span data-ttu-id="eee5b-305">Для большинства систем [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] количество точек на дюйм составляет 96, т. е. на одном дюйме экрана находится 96 пикселей.</span><span class="sxs-lookup"><span data-stu-id="eee5b-305">Most [!INCLUDE[TLA#tla_mswin](../../../../includes/tlasharptla-mswin-md.md)] systems have a DPI of 96, which means a screen inch is 96 pixels.</span></span> <span data-ttu-id="eee5b-306">При повышении количества точек на дюйм экранный дюйм увеличивается, при понижении — уменьшается.</span><span class="sxs-lookup"><span data-stu-id="eee5b-306">Increasing the DPI setting makes the screen inch larger; decreasing the DPI makes the screen inch smaller.</span></span> <span data-ttu-id="eee5b-307">Это означает, что дюйм экрана не совпадает с размером настоящего дюйма, по крайней мере в большинстве систем.</span><span class="sxs-lookup"><span data-stu-id="eee5b-307">This means that a screen inch isn't the same size as a real-world inch; on most systems, it's probably not.</span></span> <span data-ttu-id="eee5b-308">При увеличении количества точек на дюйм изображения и текст становятся больше, так как увеличивается размер экранного дюйма.</span><span class="sxs-lookup"><span data-stu-id="eee5b-308">As you increase the DPI, DPI-aware graphics and text become larger because you've increased the size of the screen inch.</span></span> <span data-ttu-id="eee5b-309">Увеличение количества точек на дюйм может сделать текст более удобным для чтения, особенно при высоких разрешениях.</span><span class="sxs-lookup"><span data-stu-id="eee5b-309">Increasing the DPI can make text easier to read, especially at high resolutions.</span></span>  
  
 <span data-ttu-id="eee5b-310">Не все приложения поддерживают количество точек на дюйм: в некоторых приложениях в качестве основной единицы измерения используются аппаратно зависимые пиксели, и изменение количества точек на дюйм не влияет на такие приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-310">Not all applications are DPI-aware: some use hardware pixels as the primary unit of measurement; changing the system DPI has no effect on these applications.</span></span> <span data-ttu-id="eee5b-311">Во многих других приложениях количество точек на дюйм используется при описании размеров шрифта, но для остальных элементов используются пиксели.</span><span class="sxs-lookup"><span data-stu-id="eee5b-311">Many other applications use DPI-aware units to describe font sizes, but use pixels to describe everything else.</span></span> <span data-ttu-id="eee5b-312">Слишком маленькое или слишком большое количество точек на дюйм может вызвать проблемы с разметкой для этих приложений, так как размер текста приложения будет изменяться с изменением системного количества точек на дюйм, тогда как интерфейс приложения изменяться не будет.</span><span class="sxs-lookup"><span data-stu-id="eee5b-312">Making the DPI too small or too large can cause layout problems for these applications, because the applications' text scales with the system's DPI setting, but the applications' UI does not.</span></span> <span data-ttu-id="eee5b-313">Для приложений, разработанных с помощью [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], эта проблема устранена.</span><span class="sxs-lookup"><span data-stu-id="eee5b-313">This problem has been eliminated for applications developed using [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="eee5b-314">поддерживает автоматическое масштабирование с помощью аппаратно независимых пикселей вместо аппаратно зависимых пикселей; изображения и текст масштабируются правильно без дополнительных действий со стороны разработчика приложения.</span><span class="sxs-lookup"><span data-stu-id="eee5b-314">supports automatic scaling by using the device independent pixel as its primary unit of measurement, instead of hardware pixels; graphics and text scale properly without any extra work from the application developer.</span></span> <span data-ttu-id="eee5b-315">На следующем рисунке показан пример отображения текста и графики [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] с различными параметрами количества точек на дюйм.</span><span class="sxs-lookup"><span data-stu-id="eee5b-315">The following illustration shows an example of how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] text and graphics are appear at different DPI settings.</span></span>  
  
 <span data-ttu-id="eee5b-316">![Изображения и текст с различными параметрами DPI](./media/graphicsmm-dpi-setting-examples.png "graphicsmm_dpi_setting_examples")</span><span class="sxs-lookup"><span data-stu-id="eee5b-316">![Graphics and text at different DPI settings](./media/graphicsmm-dpi-setting-examples.png "graphicsmm_dpi_setting_examples")</span></span>  
<span data-ttu-id="eee5b-317">Изображения и текст с различными параметрами количества точек на дюйм</span><span class="sxs-lookup"><span data-stu-id="eee5b-317">Graphics and text at different DPI settings</span></span>  
  
<a name="visualtreehelper_class"></a>   
## <a name="visualtreehelper-class"></a><span data-ttu-id="eee5b-318">Класс VisualTreeHelper</span><span class="sxs-lookup"><span data-stu-id="eee5b-318">VisualTreeHelper Class</span></span>  
 <span data-ttu-id="eee5b-319">Класс <xref:System.Windows.Media.VisualTreeHelper> — это статический вспомогательный класс, предоставляющий низкоуровневые функции для программирования на уровне визуального объекта, что полезно в определенных случаях, например при разработке пользовательских элементов управления высокой производительности.</span><span class="sxs-lookup"><span data-stu-id="eee5b-319">The <xref:System.Windows.Media.VisualTreeHelper> class is a static helper class that provides low-level functionality for programming at the visual object level, which is useful in very specific scenarios, such as developing high-performance custom controls.</span></span> <span data-ttu-id="eee5b-320">В большинстве случаев высокоуровневые объекты [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], например <xref:System.Windows.Controls.Canvas> и <xref:System.Windows.Controls.TextBlock>, обладают большей гибкостью и простотой использования.</span><span class="sxs-lookup"><span data-stu-id="eee5b-320">In most case, the higher-level [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] framework objects, such as <xref:System.Windows.Controls.Canvas> and <xref:System.Windows.Controls.TextBlock>, offer greater flexibility and ease of use.</span></span>  
  
### <a name="hit-testing"></a><span data-ttu-id="eee5b-321">Проверка нажатия</span><span class="sxs-lookup"><span data-stu-id="eee5b-321">Hit Testing</span></span>  
 <span data-ttu-id="eee5b-322">Класс <xref:System.Windows.Media.VisualTreeHelper> предоставляет методы проверки нажатия визуальных объектов, если поддержка проверки нажатия по умолчанию не соответствует вашим потребностям.</span><span class="sxs-lookup"><span data-stu-id="eee5b-322">The <xref:System.Windows.Media.VisualTreeHelper> class provides methods for hit testing on visual objects when the default hit test support does not meet your needs.</span></span> <span data-ttu-id="eee5b-323">Можно использовать методы <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> класса <xref:System.Windows.Media.VisualTreeHelper>, чтобы определить, находится ли геометрический объект или значение координат точки в пределах границ заданного объекта, например элемента управления или графического элемента.</span><span class="sxs-lookup"><span data-stu-id="eee5b-323">You can use the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> methods in the <xref:System.Windows.Media.VisualTreeHelper> class to determine whether a geometry or point coordinate value is within the boundary of a given object, such as a control or graphic element.</span></span> <span data-ttu-id="eee5b-324">Например, с помощью проверки нажатия можно определить, попадает ли щелчок мыши в пределах ограничивающего прямоугольника объекта в окружность. Также можно переопределить реализацию проверки нажатия по умолчанию и выполнять собственные вычисления для проверки нажатия.</span><span class="sxs-lookup"><span data-stu-id="eee5b-324">For example, you could use hit testing to determine whether a mouse click within the bounding rectangle of an object falls within the geometry of a circle You can also choose to override the default implementation of hit testing to perform your own custom hit test calculations.</span></span>  
  
 <span data-ttu-id="eee5b-325">Дополнительные сведения о проверке нажатия см. в разделе [Проверка нажатия на визуальном уровне](hit-testing-in-the-visual-layer.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-325">For more information on hit testing, see [Hit Testing in the Visual Layer](hit-testing-in-the-visual-layer.md).</span></span>  
  
### <a name="enumerating-the-visual-tree"></a><span data-ttu-id="eee5b-326">Перечисление визуального дерева</span><span class="sxs-lookup"><span data-stu-id="eee5b-326">Enumerating the Visual Tree</span></span>  
 <span data-ttu-id="eee5b-327">Класс <xref:System.Windows.Media.VisualTreeHelper> предоставляет функциональные возможности для перечисления элементов визуального дерева.</span><span class="sxs-lookup"><span data-stu-id="eee5b-327">The <xref:System.Windows.Media.VisualTreeHelper> class provides functionality for enumerating the members of a visual tree.</span></span> <span data-ttu-id="eee5b-328">Чтобы извлечь родительский объект, вызовите метод <xref:System.Windows.Media.VisualTreeHelper.GetParent%2A>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-328">To retrieve a parent, call the <xref:System.Windows.Media.VisualTreeHelper.GetParent%2A> method.</span></span> <span data-ttu-id="eee5b-329">Чтобы получить дочерний элемент или прямого потомка визуального объекта, вызовите метод <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-329">To retrieve a child, or direct descendant, of a visual object, call the <xref:System.Windows.Media.VisualTreeHelper.GetChild%2A> method.</span></span> <span data-ttu-id="eee5b-330">Этот метод возвращает дочерний элемент <xref:System.Windows.Media.Visual> родительского элемента по указанному индексу.</span><span class="sxs-lookup"><span data-stu-id="eee5b-330">This method returns a child <xref:System.Windows.Media.Visual> of the parent at the specified index.</span></span>  
  
 <span data-ttu-id="eee5b-331">В следующем примере показано, как перечислить всех потомков визуального объекта. Этот метод можно использовать для сериализации всех данных отрисовки в иерархии визуального объекта.</span><span class="sxs-lookup"><span data-stu-id="eee5b-331">The following example shows how to enumerate all the descendants of a visual object, which is a technique you might want to use if you were interested in serializing all the rendering information of a visual object hierarchy.</span></span>  
  
 [!code-csharp[VisualsOverview#101](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml.cs#101)]
 [!code-vb[VisualsOverview#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsOverview/visualbasic/window1.xaml.vb#101)]  
  
 <span data-ttu-id="eee5b-332">В большинстве случаев логическое дерево более удобно для представления элементов приложения [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="eee5b-332">In most cases, the logical tree is a more useful representation of the elements in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application.</span></span> <span data-ttu-id="eee5b-333">Хотя логическое дерево нельзя изменить напрямую, с помощью этой схемы удобно представить наследование свойств и маршрутизацию событий.</span><span class="sxs-lookup"><span data-stu-id="eee5b-333">Although you do not modify the logical tree directly, this view of the application is useful for understanding property inheritance and event routing.</span></span> <span data-ttu-id="eee5b-334">В отличие от визуального дерева, логическое дерево может представлять данные невизуальных объектов, таких как <xref:System.Windows.Documents.ListItem>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-334">Unlike the visual tree, the logical tree can represent non-visual data objects, such as <xref:System.Windows.Documents.ListItem>.</span></span> <span data-ttu-id="eee5b-335">Дополнительные сведения о логическом дереве см. в разделе [Деревья в WPF](../advanced/trees-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="eee5b-335">For more information on the logical tree, see [Trees in WPF](../advanced/trees-in-wpf.md).</span></span>  
  
 <span data-ttu-id="eee5b-336">Класс <xref:System.Windows.Media.VisualTreeHelper> предоставляет методы для получения ограничивающего прямоугольника визуальных объектов.</span><span class="sxs-lookup"><span data-stu-id="eee5b-336">The <xref:System.Windows.Media.VisualTreeHelper> class provides methods for returning the bounding rectangle of visual objects.</span></span> <span data-ttu-id="eee5b-337">Ограничивающий прямоугольник визуального объекта возвращается методом <xref:System.Windows.Media.VisualTreeHelper.GetContentBounds%2A>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-337">You can return the bounding rectangle of a visual object by calling <xref:System.Windows.Media.VisualTreeHelper.GetContentBounds%2A>.</span></span> <span data-ttu-id="eee5b-338">Ограничивающий прямоугольник всех потомков визуального объекта, включая сам визуальный объект, возвращается методом <xref:System.Windows.Media.VisualTreeHelper.GetDescendantBounds%2A>.</span><span class="sxs-lookup"><span data-stu-id="eee5b-338">You can return the bounding rectangle of all the descendants of a visual object, including the visual object itself, by calling <xref:System.Windows.Media.VisualTreeHelper.GetDescendantBounds%2A>.</span></span> <span data-ttu-id="eee5b-339">В следующем коде показано, как вычислить ограничивающий прямоугольник для визуального объекта и всех его потомков.</span><span class="sxs-lookup"><span data-stu-id="eee5b-339">The following code shows how you would calculate the bounding rectangle of a visual object and all its descendants.</span></span>  
  
 [!code-csharp[VisualsOverview#102](~/samples/snippets/csharp/VS_Snippets_Wpf/VisualsOverview/CSharp/Window1.xaml.cs#102)]
 [!code-vb[VisualsOverview#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/VisualsOverview/visualbasic/window1.xaml.vb#102)]  
  
## <a name="see-also"></a><span data-ttu-id="eee5b-340">См. также</span><span class="sxs-lookup"><span data-stu-id="eee5b-340">See also</span></span>
- <xref:System.Windows.Media.Visual>
- <xref:System.Windows.Media.VisualTreeHelper>
- <xref:System.Windows.Media.DrawingVisual>
- [<span data-ttu-id="eee5b-341">Двумерная графика и изображения</span><span class="sxs-lookup"><span data-stu-id="eee5b-341">2D Graphics and Imaging</span></span>](../advanced/optimizing-performance-2d-graphics-and-imaging.md)
- [<span data-ttu-id="eee5b-342">Проверка нажатия на визуальном уровне</span><span class="sxs-lookup"><span data-stu-id="eee5b-342">Hit Testing in the Visual Layer</span></span>](hit-testing-in-the-visual-layer.md)
- [<span data-ttu-id="eee5b-343">Использование объектов DrawingVisual</span><span class="sxs-lookup"><span data-stu-id="eee5b-343">Using DrawingVisual Objects</span></span>](using-drawingvisual-objects.md)
- [<span data-ttu-id="eee5b-344">Учебник. Руководство по размещению визуальных объектов в приложении Win32</span><span class="sxs-lookup"><span data-stu-id="eee5b-344">Tutorial: Hosting Visual Objects in a Win32 Application</span></span>](tutorial-hosting-visual-objects-in-a-win32-application.md)
- [<span data-ttu-id="eee5b-345">Улучшение производительности приложений WPF</span><span class="sxs-lookup"><span data-stu-id="eee5b-345">Optimizing WPF Application Performance</span></span>](../advanced/optimizing-wpf-application-performance.md)
