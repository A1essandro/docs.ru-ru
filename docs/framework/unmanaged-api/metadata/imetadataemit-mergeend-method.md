---
title: "Метод IMetaDataEmit::MergeEnd"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: 
ms.topic: reference
api_name:
- IMetaDataEmit.MergeEnd
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataEmit::MergeEnd
helpviewer_keywords:
- MergeEnd method [.NET Framework metadata]
- IMetaDataEmit::MergeEnd method [.NET Framework metadata]
ms.assetid: 2d64315a-1af1-4c60-aedf-f8a781914aea
topic_type:
- apiref
caps.latest.revision: 
author: mairaw
ms.author: mairaw
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 265fc007b5817e8dffd5846738a7a0003bbddf9d
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="imetadataemitmergeend-method"></a>Метод IMetaDataEmit::MergeEnd
Выполняет слияние в текущей области видимости всех областей метаданных, заданных один или несколько предыдущих вызовами [IMetaDataEmit::Merge](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-merge-method.md).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
HRESULT MergeEnd ();  
```  
  
#### <a name="parameters"></a>Параметры  
 Этот метод не принимает параметры.  
  
## <a name="remarks"></a>Примечания  
 Эта процедура включает фактическое слияние метаданных, всех импорта указаны, поставив в начале вызовы области `IMetaDataEmit::Merge`, в текущей области вывода.  
  
 К слиянию применяются следующие особые условия:  
  
-   Идентификатор версии модуля (MVID) никогда не импортирован, так как он уникален для метаданных в области действия импорта.  
  
-   Нет существующих свойств ко всему модулю перезаписываются.  
  
     Если для текущей области уже заданы свойства модуля, свойства модуля не импортируются. Тем не менее если не были заданы свойства модуля в текущей области, они импортируются только один раз, когда они встречаются впервые. Если эти свойства модуля встречаются снова, они являются дубликатами. Если сравниваются значения всех свойств модуля (за исключением MVID) и не найден, возникает ошибка.  
  
-   Для определения типов (`TypeDef`), без повторений объединяются в текущей области. `TypeDef`объекты проверяются на наличие дубликатов для каждой *объекта полное доменное имя* + *GUID* + *номер версии*. Если совпадение по имени или GUID и любые другие два элемента отличается, возникает ошибка. В противном случае, если совпадают все три элемента, `MergeEnd` поверхностной проверки убедитесь, что записи на самом деле являются дубликатами; в противном случае возникает ошибка. Эта проверка поверхностной выявляет:  
  
    -   Же объявления членов, в том же порядке. Члены, помеченные как `mdPrivateScope` (см. [CorMethodAttr](../../../../docs/framework/unmanaged-api/metadata/cormethodattr-enumeration.md) перечисления) не включаются в эту проверку; специально объединяются.  
  
    -   Тот же макет класса.  
  
     Это означает, что `TypeDef` объект должен всегда быть полностью и единообразно определен во всех областях метаданных в котором она объявлена; если его реализация члена (для класса) распределяются на несколько блоков компиляции, полное определение считается имеется в каждой области действия и не добавочным для каждой области. Например если имена параметров актуальны для контракта, они должны выдавать одинаково во всех областях; Если они не существенны, они не должны выдаваться в метаданные.  
  
     Исключение — `TypeDef` объект может иметь добавочных членов, отмеченных как `mdPrivateScope`. При обнаружении таких `MergeEnd` добавляет их в текущую область, без учета повторяющиеся значения. Поскольку компилятор распознает закрытую область, компилятор должен быть ответственным за реализацию правил.  
  
-   Относительные виртуальные адреса (RVA) не импортируются и объединить; Ожидается, что компилятор выдаст эти сведения повторно.  
  
-   Слияние пользовательских атрибутов выполняется только в том случае, если слияние элемента, к которому они привязаны. Например настраиваемые атрибуты, связанные с классом, объединяются при первом появлении класса. Если настраиваемые атрибуты, связанные с `TypeDef` или `MemberDef` , характерное для блока компиляции (например, метка времени компиляции члена), они не объединяются, и представляет компилятор удалить или обновить эти данные.  
  
## <a name="requirements"></a>Требования  
 **Платформы:** разделе [требования к системе для](../../../../docs/framework/get-started/system-requirements.md).  
  
 **Заголовок:** Cor.h  
  
 **Библиотека:** используется как ресурс в MSCorEE.dll  
  
 **Версии платформы .NET framework:**[!INCLUDE[net_current_v11plus](../../../../includes/net-current-v11plus-md.md)]  
  
## <a name="see-also"></a>См. также  
 [Интерфейс IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)  
 [Интерфейс IMetaDataEmit2](../../../../docs/framework/unmanaged-api/metadata/imetadataemit2-interface.md)
