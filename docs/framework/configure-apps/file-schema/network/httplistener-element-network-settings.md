---
title: "Элемент &lt;httpListener&gt; (параметры сети) | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
ms.assetid: 62f121fd-3f2e-4033-bb39-48ae996bfbd9
caps.latest.revision: 7
author: "mcleblanc"
ms.author: "markl"
manager: "markl"
caps.handback.revision: 7
---
# Элемент &lt;httpListener&gt; (параметры сети)
Настраивает параметры, используемые классом <xref:System.Net.HttpListener>.  
  
## Синтаксис  
  
```  
  
      <httpListener  
  unescapeRequestUrl ="true|false"  
/>  
```  
  
## Тип  
  
## Атрибуты и элементы  
 В следующих разделах описаны атрибуты, дочерние и родительские элементы.  
  
### Атрибуты  
  
|Атрибут|Описание|  
|-------------|--------------|  
|unescapeRequestUrl|Логическое значение, определяющее, использует ли экземпляр<xref:System.Net.HttpListener> не преобразованный в escape\-последовательность URI вместо преобразованного.|  
  
### Дочерние элементы  
 Нет.  
  
### Родительские элементы  
  
|**Элемент**|**Описание**|  
|-----------------|------------------|  
|[settings](../../../../../docs/framework/configure-apps/file-schema/network/settings-element-network-settings.md)|Настраивает основные сетевые параметры для пространства имен <xref:System.Net>.|  
  
## Заметки  
 Атрибут **unescapeRequestUrl** указывает, использует ли <xref:System.Net.HttpListener> необработанный неэкранированный URI вместо преобразованного URI, в котором все закодированные знаками процента значения преобразованы и предприняты другие шаги по нормализации.  
  
 Когда экземпляр <xref:System.Net.HttpListener> получает запрос через службу `http.sys`, он создает экземпляр строки URI, предоставляемый `http.sys` и предоставляет его как свойство <xref:System.Net.HttpListenerRequest.Url%2A?displayProperty=fullName>.  
  
 Служба `http.sys` предоставляет две строки URI запроса.  
  
-   Необработанный универсальный код ресурса \(URI\)  
  
-   Преобразованный универсальный код ресурса \(URI\)  
  
 Необработанный универсальный код ресурса \(URI\) – это <xref:System.Uri?displayProperty=fullName>, предоставляемый в строке запроса HTTP\-запроса:  
  
 `GET /path/`  
  
 `Host: www.contoso.com`  
  
 Необработанным универсальным кодом ресурса \(URI\), предоставляемым `http.sys` для запроса, упомянутого выше, является "\/path\/".  Это представляет строку, следующую за HTTP\-командой, так же, как она была отправлена по сети.  
  
 Служба `http.sys` создает преобразованный универсальный код ресурса \(URI\) из сведений, предоставляемых в запросе, используя URI, предоставленный в строке запроса HTTP и заголовок узла для определения исходного сервера, на который должен быть отправлен запрос.  Это делается путем сравнения сведений из запроса с набором зарегистрированных префиксов URI.  В документации по пакету SDK сервера HTTP этот преобразованный URI называется структурой HTTP\_COOKED\_URL.  
  
 Чтобы иметь возможность сравнить запрос с зарегистрированными префиксами URI, необходимо выполнить некоторую нормализацию в запросе.  Для примера выше преобразованный универсальный код ресурса \(URI\) будет выглядеть следующим образом:  
  
 `http://www.contoso.com/path/`  
  
 Служба `http.sys` объединяет значение свойства <xref:System.Uri.Host%2A?displayProperty=fullName> и строку из запроса для создания преобразованного универсального кода ресурса \(URI\).  Кроме того, классы `http.sys` и <xref:System.Uri?displayProperty=fullName> также выполняют следующее:  
  
-   Учитывает все Отмена процентные значения.  
  
-   Преобразует процентно закодированные символы, не входящие в набор ASCII в символы UTF\-16.  Следует отметить, что символы UTF\-8 и ANSI и двухбайтовой кодировки \(DBCS\) поддерживаются также как знаки Юникода \(кодировка Юникод с использованием формата %uXXXX\).  
  
-   Выполняет другие действия нормализации, такие как сжатие пути.  
  
 Поскольку запрос не содержит никаких сведений о кодировке, используемой для значений в процентной кодировке, может оказаться невозможным определить правильную кодировку, простым разбором значений процентной кодировки.  
  
 Поэтому `http.sys` предоставляет два раздела реестра для изменения процесса:  
  
|Раздел реестра .|Значение по умолчанию|Описание|  
|----------------------|---------------------------|--------------|  
|EnableNonUTF8|1|Если значение равно нулю, `http.sys` принимает только URL\-адреса в кодировке UTF\-8.<br /><br /> Если получено значение, отличное от нуля, `http.sys` также принимает URL\-адреса в запросах в кодировке ANSI или двухбайтовой кодировке \(DBCS\).|  
|FavorUTF8|1|Если получено значение, отличное от нуля, `http.sys` всегда пытается сначала декодировать URL\-адрес как UTF\-8; если это преобразование завершается неудачей, и EnableNonUTF8 не равен нулю, HTTP.sys пытается расшифровать адрес как кодированный ANSI или двухбайтовой кодировкой \(DBCS\).<br /><br /> Если значение равно нулю \(и EnableNonUTF8 не равен нулю\) `http.sys` пытается расшифровать его как ANSI и двухбайтовую кодировку \(DBCS\); если расшифровка не удалась, производится попытка преобразования UTF\-8.|  
  
 Когда <xref:System.Net.HttpListener> получает запрос, он использует преобразованный URI из `http.sys` в качестве входного значения для свойства <xref:System.Net.HttpListenerRequest.Url%2A>.  
  
 Нет необходимости поддерживать символы помимо символов и цифр в URI.  Например, следующий универсальный код ресурса \(URI\), который используется для извлечения сведений клиента для клиента номер «1\/3812»:  
  
 `http://www.contoso.com/Customer('1%2F3812')/`  
  
 Обратите внимание на косую черту процентного кодирования в универсальном коде ресурса \(URI\) \(%2F\).  Это необходимо, поскольку в данном случае косая черта представляет данные, а не является разделителем пути.  
  
 Передачи строки конструктору универсального кода ресурса \(URI\) приведет к следующим универсальным кодам ресурса \(URI\):  
  
 `http://www.contoso.com/Customer('1/3812')/`  
  
 В результате разделения пути на отрезки будут созданы следующие элементы:  
  
 `Customer('1`  
  
 `3812')`  
  
 Это не является целью отправителя запроса.  
  
 Если атрибут **unescapeRequestUrl** имеет значение **false**, то, когда <xref:System.Net.HttpListener> получает запрос, он использует необработанный универсальный код ресурса \(URI\) вместо преобразованного URI из `http.sys` в качестве входного для свойства <xref:System.Net.HttpListenerRequest.Url%2A>.  
  
 По умолчанию атрибут **unescapeRequestUrl** имеет значение **true**.  
  
 Свойство <xref:System.Net.Configuration.HttpListenerElement.UnescapeRequestUrl%2A> может использоваться для получения текущего значения атрибута **unescapeRequestUrl** из применимых файлов конфигурации.  
  
## Пример  
 В следующем примере кода показано, как настроить класс <xref:System.Net.HttpListener>, когда он получает запрос на использование необработанного универсального кода ресурса \(URI\) вместо преобразованного URI из `http.sys` в качестве входного в свойстве <xref:System.Net.HttpListenerRequest.Url%2A>.  
  
```  
<configuration>  
  <system.net>  
    <settings>  
      <httpListener  
        unescapeRequestUrl="false"  
      />  
    </settings>  
  </system.net>  
</configuration>  
```  
  
## Сведения об элементе  
  
|||  
|-|-|  
|Пространство имен|System.Net|  
|Имя схемы||  
|Файл проверки||  
|Может быть пустым||  
  
## См. также  
 <xref:System.Net.Configuration.HttpListenerElement>   
 <xref:System.Net.HttpListener>   
 <xref:System.Net.HttpListenerRequest.Url%2A>   
 [Схема параметров сети](../../../../../docs/framework/configure-apps/file-schema/network/index.md)