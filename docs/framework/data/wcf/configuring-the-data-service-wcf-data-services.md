---
title: "Настройка службы данных (службы WCF Data Services) | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-oob"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "WCF Data Services, настройка"
ms.assetid: 59efd4c8-cc7a-4800-a0a4-d3f8abe6c55c
caps.latest.revision: 10
author: "Erikre"
ms.author: "erikre"
manager: "erikre"
caps.handback.revision: 10
---
# Настройка службы данных (службы WCF Data Services)
С помощью [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] можно создавать службы данных, предоставляющие каналы [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)].  В этих каналах могут находиться данные из различных источников данных.  Службы [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] используют поставщики данных для предоставления этих данных в виде канала [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)].  В число таких поставщиков входят [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)], поставщик отражения, а также набор пользовательских интерфейсов поставщиков служб данных.  Реализация поставщика определяет модель данных для службы.  Для получения дополнительной информации см. [Поставщики служб данных](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md).  
  
 В [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] служба данных является классом, унаследованным от класса <xref:System.Data.Services.DataService%601>, в котором тип службы данных является контейнером сущностей моделей данных.  Этот контейнер сущностей имеет одно или несколько свойств, возвращающих интерфейс <xref:System.Linq.IQueryable%601>, которые используются для доступа к наборам сущностей модели данных.  
  
 Поведение службы данных определяется членами класса <xref:System.Data.Services.DataServiceConfiguration> и класса <xref:System.Data.Services.DataServiceBehavior>, доступ к которому осуществляется через свойство <xref:System.Data.Services.DataServiceConfiguration.DataServiceBehavior%2A> класса <xref:System.Data.Services.DataServiceConfiguration>.  Класс <xref:System.Data.Services.DataServiceConfiguration> предоставляется методу `InitializeService`, реализуемому службой данных, как показано в следующей реализации службы данных Northwind.  
  
 [!code-csharp[Astoria Northwind Service#DataServiceConfigComplete](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria northwind service/cs/northwind.svc.cs#dataserviceconfigcomplete)]
 [!code-vb[Astoria Northwind Service#DataServiceConfigComplete](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria northwind service/vb/northwind.svc.vb#dataserviceconfigcomplete)]  
  
## Параметры конфигурации службы данных  
 Класс <xref:System.Data.Services.DataServiceConfiguration> позволяет задать следующее поведение службы данных.  
  
|Член|Поведение|  
|----------|---------------|  
|<xref:System.Data.Services.DataServiceBehavior.AcceptCountRequests%2A>|Позволяет отключить запросы количества, передаваемые службе данных при использовании сегмента пути `$count` и параметра запроса `$inlinecount`.  Дополнительные сведения см. в разделе [OData: соглашения URI](http://go.microsoft.com/fwlink/?LinkId=185564).|  
|<xref:System.Data.Services.DataServiceBehavior.AcceptProjectionRequests%2A>|Позволяет отключить поддержку проекции данных в запросах, передаваемых службе данных при использовании параметра запроса `$select`.  Дополнительные сведения см. в разделе [OData: соглашения URI](http://go.microsoft.com/fwlink/?LinkId=185564).|  
|<xref:System.Data.Services.DataServiceConfiguration.EnableTypeAccess%2A>|Включает тип данных, предоставляемый в метаданных для динамического поставщика метаданных, определенного с помощью интерфейса <xref:System.Data.Services.Providers.IDataServiceMetadataProvider>.|  
|<xref:System.Data.Services.DataServiceConfiguration.EnableTypeConversion%2A>|Позволяет указать, должна ли среда выполнения службы данных преобразовывать тип, содержащийся в полезных данных, в фактический тип свойства, указанный в запросе.|  
|<xref:System.Data.Services.DataServiceBehavior.InvokeInterceptorsOnLinkDelete%2A>|Позволяет указать, следует ли вызывать перехватчиков зарегистрированных изменений для связанных сущностей при удалении ссылки связи между двумя сущностями.|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxBatchCount%2A>|Позволяет ограничить число наборов изменений и операций запросов, разрешенных в одном пакете.  Дополнительные сведения см. в разделах [OData: пакет](http://go.microsoft.com/fwlink/?LinkId=185602) и [Пакетные операции](../../../../docs/framework/data/wcf/batching-operations-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxChangesetCount%2A>|Позволяет ограничить количество изменений, которые могут быть включены в один набор изменений.  Для получения дополнительной информации см. [Как включить разбиение на страницы для результатов службы данных](../../../../docs/framework/data/wcf/how-to-enable-paging-of-data-service-results-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxExpandCount%2A>|Позволяет ограничить размер ответа путем ограничения количества связанных сущностей, которые могут быть включены в один запрос при использовании оператора запроса `$expand`.  [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)] см. в разделах [OData: соглашения URI](http://go.microsoft.com/fwlink/?LinkId=185564) и [Загрузка отложенного содержимого](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxExpandDepth%2A>|Позволяет ограничить размер ответа путем ограничения глубины графа связанных сущностей, которые могут быть включены в один запрос при использовании оператора запроса `$expand`.  [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)] см. в разделах [OData: соглашения URI](http://go.microsoft.com/fwlink/?LinkId=185564) и [Загрузка отложенного содержимого](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxObjectCountOnInsert%2A>|Позволяет ограничить количество вставляемых сущностей, которые могут содержаться в одном запросе POST.|  
|<xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A>|Определяет версию протокола Atom, используемую службой данных.  Если свойству <xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A> присвоено значение, которое меньше максимального значения <xref:System.Data.Services.Common.DataServiceProtocolVersion>, то последние функции [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] становятся недоступными для клиентов, обращающихся к службе данных.  [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)] [Управление версиями данных](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxResultsPerCollection%2A>|Позволяет ограничить размер ответа путем ограничения количества сущностей в каждом наборе сущностей, возвращаемом в виде канала данных.|  
|<xref:System.Data.Services.DataServiceConfiguration.RegisterKnownType%2A>|Добавляет тип данных в список типов, распознаваемых службой данных.|  
|<xref:System.Data.Services.DataServiceConfiguration.SetEntitySetAccessRule%2A>|Задает права доступа для ресурсов набора сущностей, доступных в службе данных.  Значение «звездочка» \(`*`\) может использоваться в параметре имени для задания доступа того же уровня для всех остальных наборов сущностей.  Для предоставления минимального уровня прав доступа к ресурсам службы данных, необходимым клиентским приложениям рекомендуется задавать доступ к наборам сущностей.  Для получения дополнительной информации см. [Защита служб WCF Data Services](../../../../docs/framework/data/wcf/securing-wcf-data-services.md).  Примеры минимальных прав доступа, необходимых для выполнения данного действия URI и HTTP, см. в таблице, приведенной в разделе [Минимальные требования для доступа к ресурсам](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md#accessRequirements).|  
|<xref:System.Data.Services.DataServiceConfiguration.SetEntitySetPageSize%2A>|Задает максимальный размер страницы для ресурса набора сущностей.  Для получения дополнительной информации см. [Как включить разбиение на страницы для результатов службы данных](../../../../docs/framework/data/wcf/how-to-enable-paging-of-data-service-results-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.SetServiceOperationAccessRule%2A>|Задает права доступа для операций службы, определенных в службе данных.  Для получения дополнительной информации см. [Операции служб](../../../../docs/framework/data/wcf/service-operations-wcf-data-services.md).  Значение «звездочка» \(`*`\) может использоваться в параметре имени для задания доступа того же уровня для всех остальных операций службы.  Рекомендуется задавать операциям службы минимальный уровень прав доступа к ресурсам службы данных, необходимых клиентским приложениям.  Для получения дополнительной информации см. [Защита служб WCF Data Services](../../../../docs/framework/data/wcf/securing-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.UseVerboseErrors%2A>|Этот параметр настройки упрощает процесс устранения неполадок службы данных, возвращая дополнительные сведения в ответном сообщении об ошибке.  Параметр не предназначен для использования в рабочей среде.  Для получения дополнительной информации см. [Разработка и развертывание служб WCF Data Services](../../../../docs/framework/data/wcf/developing-and-deploying-wcf-data-services.md).|  
  
<a name="accessRequirements"></a>   
## Минимальные требования для доступа к ресурсам  
 В следующих сведениях о таблице указаны минимальные права набора сущностей, которые необходимо предоставить для выполнения определенной операции.  Примеры путей основаны на службе данных Northwind, созданной при ознакомлении с [кратким руководством](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md).  Поскольку перечисления <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.ServiceOperationRights> определяются с помощью <xref:System.FlagsAttribute>, для указания нескольких разрешений для одного набора сущностей или операции можно использовать логический оператор OR.  Для получения дополнительной информации см. [Как включить доступ к службе данных](../../../../docs/framework/data/wcf/how-to-enable-access-to-the-data-service-wcf-data-services.md).  
  
|Путь\/действие|`GET`|`DELETE`|`MERGE`|`POST`|`PUT`|  
|--------------------|-----------|--------------|-------------|------------|-----------|  
|`/Customers`|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|  
|`/Customers('ALFKI')`|<xref:System.Data.Services.EntitySetRights>|<xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|<xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|Н\/Д|<xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|  
|`/Customers('ALFKI')/Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights> или <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders` `:` и <xref:System.Data.Services.EntitySetRights>|Не поддерживается|  
|`/Customers('ALFKI')/Orders(10643)`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|  
|`/Orders(10643)/Customer`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>;<br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|Не поддерживается|  
|`/Customers('ALFKI')/$links/Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights> или <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|  
|`/Customers('ALFKI')/$links/Orders(10643)`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights> или <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|Не поддерживается|  
|`/Orders(10643)/$links/Customer`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|`Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights> или <xref:System.Data.Services.EntitySetRights>|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights>;<br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|  
|`/Customers/$count`|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|Не поддерживается|Не поддерживается|  
|`/Customers('ALFKI')/ContactName`|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|<xref:System.Data.Services.EntitySetRights>|  
|`/Customers('ALFKI')/Address/StreetAddress/$value` <sup>1</sup>|<xref:System.Data.Services.EntitySetRights>|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|Не поддерживается|  
|`/Customers('ALFKI')/ContactName/$value`|<xref:System.Data.Services.EntitySetRights>|<xref:System.Data.Services.EntitySetRights> и <xref:System.Data.Services.EntitySetRights>|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|<xref:System.Data.Services.EntitySetRights>|  
|`/Customers('ALFKI')/$value` <sup>2</sup>|<xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|Не поддерживается|<xref:System.Data.Services.EntitySetRights>|  
|`/Customers?$select=Orders/*&$expand=Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|`Customers`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|  
|`/Customers('ALFKI')?$select=Orders/*&$expand=Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights><br /><br /> \- и \-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights>|Не поддерживается|Не поддерживается|Не поддерживается|Не поддерживается|  
  
 <sup>1</sup> В этом примере `Address` представляет свойство сложного типа сущности `Customers`, у которой есть свойство с именем `StreetAddress`.  Модель, которая используется службой данных Northwind, не определяет этот сложный тип явно.  Если модель данных определяется с помощью поставщика [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)], такой сложный тип можно определить с помощью средств модели [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].  Для получения дополнительной информации см. [How to: Create and Modify Complex Types](http://msdn.microsoft.com/ru-ru/afb8e206-0ffe-4597-b6d4-6ab566897e1d).  
  
 <sup>2</sup> Этот URI поддерживается, если свойство, возвращающее большой двоичный объект, определено как ресурс мультимедиа, принадлежащий сущности, являющейся записью ссылки мультимедиа, в данном случае это `Customers`.  Для получения дополнительной информации см. [Потоковый поставщик](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).  
  
<a name="versioning"></a>   
## Требования к управлению версиями  
 Следующим функциям конфигурации службы данных требуется версия 2 \(или более поздняя\) протокола [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)].  
  
-   Поддержка числа запросов.  
  
-   Поддержка параметра запроса $select для проекции.  
  
 Для получения дополнительной информации см. [Управление версиями данных](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).  
  
## См. также  
 [Определение службы WCF Data Services](../../../../docs/framework/data/wcf/defining-wcf-data-services.md)   
 [Размещение службы данных](../../../../docs/framework/data/wcf/hosting-the-data-service-wcf-data-services.md)