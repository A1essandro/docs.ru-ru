---
title: "Строки подключения"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 78d516bc-c99f-4865-8ff1-d856bc1a01c0
caps.latest.revision: "3"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.workload: dotnet
ms.openlocfilehash: 64f2d0fbc54900443046bd2c71215cc0928c8658
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="connection-strings"></a>Строки подключения
Строка подключения содержит сведения для инициализации, передаваемые в виде параметра от поставщика данных в источник данных. Синтаксис зависит от поставщика данных, и при попытке открыть соединение строка соединения анализируется. Строки соединения платформы Entity Framework содержат сведения, которые используются для соединения с базовым поставщиком данных ADO.NET, поддерживающим Entity Framework. Они также содержат сведения о необходимых файлах модели и сопоставления.  
  
 Строка соединения используется поставщиком EntityClient для доступа к метаданным модели и сопоставления, а также для соединения с источником данных. Свойство <xref:System.Data.EntityClient.EntityConnection.ConnectionString%2A> объекта <xref:System.Data.EntityClient.EntityConnection> позволяет получить доступ к строке соединения или задать ее значение. Класс <xref:System.Data.EntityClient.EntityConnectionStringBuilder> может использоваться для построения или обработки программным путем параметров строки соединения. Дополнительные сведения см. в разделе [как: построение строки подключения EntityConnection](../../../../../docs/framework/data/adonet/ef/how-to-build-an-entityconnection-connection-string.md).  
  
 [Средства модели EDM](http://msdn.microsoft.com/en-us/91076853-0881-421b-837a-f582f36be527) создать строку подключения, которая хранится в файле конфигурации приложения. <xref:System.Data.Objects.ObjectContext> автоматически извлекает сведения о соединении при создании запросов объекта. Доступ к соединению <xref:System.Data.EntityClient.EntityConnection>, используемому экземпляром <xref:System.Data.Objects.ObjectContext>, можно получить с помощью свойства <xref:System.Data.Objects.ObjectContext.Connection%2A>. Дополнительные сведения см. в разделе [Управление соединениями и транзакциями](http://msdn.microsoft.com/en-us/b6659d2a-9a45-4e98-acaa-d7a8029e5b99).  
  
## <a name="connection-string-parameters"></a>Параметры строки соединения  
 Формат строки соединения является списком разделенных точкой с запятой пар параметров «ключ-значение»:  
  
 `keyword1=value; keyword2=value;`  
  
 Знак равенства (=) соединяет каждое ключевое слово и его значение. Ключевые слова не учитывают регистр, и пробелы между парами «ключ-значение» не учитываются. Однако в значениях может учитываться регистр в зависимости от источника данных. Любые значения, содержащие точки с запятой, одинарные кавычки или двойные кавычки, должны быть заключены в двойные кавычки. В следующей таблице перечислены допустимые имена для значений ключевых слов в строке соединения <xref:System.Data.EntityClient.EntityConnection.ConnectionString%2A>.  
  
|Ключевое слово|Описание|  
|-------------|-----------------|  
|`Provider`|Необходимо, если не задано ключевое слово `Name`. Имя поставщика, которое используется для получения объекта <xref:System.Data.Common.DbProviderFactory>, относящегося к базовому поставщику. Это - постоянное значение.<br /><br /> Если в строке соединения сущности не содержится ключевое слово `Name`, то необходимо задать непустое значение для ключевого слова `Provider`. Это ключевое слово является взаимоисключающим по отношению к ключевому слову `Name`.|  
|`Provider Connection String`|Необязательно. Указывает зависящую от поставщика строку соединения, которая передается в базовый источник данных. Эта строка соединения должна быть выражена с помощью пар «ключевое слово/значение», допустимых для этого поставщика данных. Применение недопустимого ключевого слова `Provider Connection String` приводит к возникновению ошибки времени выполнения при его проверке в источнике данных.<br /><br /> Это ключевое слово является взаимоисключающим по отношению к ключевому слову `Name`.<br /><br /> Значение `Provider Connection String` должно быть заключено в кавычки. Ниже представлен пример такого кода.<br /><br /> `Provider Connection String ="Server=serverName; User ID = userID";`<br /><br /> Следующий пример работать не будет:<br /><br /> `Provider Connection String =Server=serverName; User ID = userID`|  
|`Metadata`|Необходимо, если не задано ключевое слово `Name`. Список каталогов, файлов и расположений ресурсов с разделителями в виде вертикальной черты (|), в которых будет выполняться поиск сведений о метаданных и сопоставлениях. Ниже представлен пример такого кода.<br /><br /> `Metadata=`<br /><br /> `c:\model &#124; c:\model\sql\mapping.msl;`<br /><br /> Пустые пространства, расположенные с обеих сторон вертикальной черты (|), не учитываются.<br /><br /> Это ключевое слово является взаимоисключающим по отношению к ключевому слову `Name`.|  
|`Name`|По желанию можно определить имя соединения в файле конфигурации приложения, в котором предоставляются необходимые для строки соединения пары «ключевое слово/значение». В этом случае нельзя задавать эти пары непосредственно в строке соединения. Применение ключевого слова `Name` в файле конфигурации не допускается.<br /><br /> Если в строке соединения не содержится ключевое слово `Name`, то необходимо задать непустые значения для ключевого слова Provider.<br /><br /> Это ключевое слово является взаимоисключающим по отношению к другим ключевым словам строки соединения.|  
  
 Ниже приведен пример строки подключения для [модели AdventureWorks Sales](http://msdn.microsoft.com/en-us/f16cd988-673f-4376-b034-129ca93c7832) хранятся в файле конфигурации приложения:  
  
  
  
## <a name="model-and-mapping-file-locations"></a>Расположение файла модели и сопоставления  
 Параметр `Metadata` содержит список местоположений, в которых поставщик `EntityClient` выполняет поиск файлов модели и сопоставления. Файлы модели и сопоставления часто развертываются в том же каталоге, что и исполняемый файл приложения. Эти файлы могут быть также развернуты в конкретном местоположении или включены в виде внедренного ресурса в приложение.  
  
 Внедренные ресурсы задаются следующим образом:  
  
```  
Metadata=res://<assemblyFullName>/<resourceName>.   
```  
  
 Для определения расположения внедренного ресурса доступны следующие способы.  
  
|Параметр|Описание|  
|-|-|  
|`assemblyFullName`|Полное имя сборки с внедренным ресурсом. Это имя включает простое имя, имя версии, поддерживаемую культуру и открытый ключ следующим образом:<br /><br /> `ResourceLib, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null`<br /><br /> Ресурсы можно внедрять в любую сборку, доступную для приложения.<br /><br /> Если указан символ-шаблон (\*) для `assemblyFullName`, среда выполнения платформы Entity Framework будет искать ресурсы в следующих местоположениях в указанном порядке:<br /><br /> 1.  вызывающая сборка;<br />2.  сборки, на которые имеются ссылки;<br />3.  сборки в каталоге исполняемых файлов (bin) приложения.<br /><br /> Если файлы не найдены ни в одном из этих расположений, вызывается исключение. **Примечание:** при использовании подстановочный знак (*), платформа Entity Framework должна обеспечить поиск во всех сборках ресурсов с подходящим именем. В целях повышения производительности задавайте имя сборки, а не символ-шаблон.|  
|`resourceName`|Имена включенных ресурсов, например AdvendtureWorksModel.csdl. Службы метаданных осуществляют поиск файлов или ресурсов только для расширений CSDL, SSDL и MSL. Если имя `resourceName` не указано, то загружаются все ресурсы метаданных. Ресурсы должны иметь в сборке уникальные имена. Если в сборке в разных каталогах указано несколько файлов с одинаковыми именами, то в `resourceName` перед именем ресурса должна быть представлена структура папок, например ИмяПапки.ИмяФайла.csdl.<br /><br /> Указание `resourceName` не требуется, если для `assemblyFullName` задан символ-шаблон (*).|  
  
> [!NOTE]
>  В целях повышения производительности рекомендуется внедрять ресурсы в вызывающую сборку с учетом того, что в приложениях, отличных от веб-приложений, такая рекомендация становится неприменимой, поскольку в вызывающей сборке отсутствуют ссылки на файлы сопоставлений и метаданных.  
  
 В следующем примере загружаются все файлы модели и сопоставления из вызывающей сборки, а также сборок, указанных в ссылках, и других сборок в каталоге bin приложения.  
  
```  
Metadata=res://*/  
```  
  
 В следующем примере загружаются файл model.csdl из сборки AdventureWorks, а также файлы model.ssdl и model.msl из каталога по умолчанию выполняющегося приложения.  
  
```  
Metadata=res://AdventureWorks, 1.0.0.0, neutral, a14f3033def15840/model.csdl|model.ssdl|model.msl  
```  
  
 В следующем примере загружаются три заданных ресурса из указанной сборки.  
  
```  
Metadata=res://AdventureWorks, 1.0.0.0, neutral, a14f3033def15840/model.csdl|   
res://AdventureWorks, 1.0.0.0, neutral, a14f3033def15840/model.ssdl|   
res://AdventureWorks, 1.0.0.0, neutral, a14f3033def15840/model.msl  
```  
  
 В следующем примере из сборки загружаются все внедренные ресурсы с расширениями CSDL, SSDL и MSL.  
  
```  
Metadata=res://AdventureWorks, 1.0.0.0, neutral, a14f3033def15840/  
```  
  
 В следующем примере загружаются все ресурсы в относительного пути к файлу плюс «datadir\metadata\\» из расположения загруженной сборки.  
  
```  
Metadata=datadir\metadata\  
```  
  
 В следующем примере из расположения загруженной сборки загружаются все ресурсы, которые обозначены относительным путем к файлу.  
  
```  
Metadata=.\  
```  
  
## <a name="support-for-the-124datadirectory124-substitution-string-and-the-web-application-root-operator-"></a>Поддержка &#124; DataDirectory &#124; Строка подстановки и оператора корневого веб-приложения (~)  
 `DataDirectory`и ~ оператор, используемый в <xref:System.Data.EntityClient.EntityConnection.ConnectionString%2A> как часть `Metadata` и `Provider Connection String` ключевые слова. В соединении <xref:System.Data.EntityClient.EntityConnection> параметр `DataDirectory` и оператор ~ передаются <xref:System.Data.Metadata.Edm.MetadataWorkspace> и поставщику хранилища соответственно.  
  
|Термин|Описание|  
|----------|-----------------|  
|`&#124;DataDirectory&#124;`|Преобразуется в относительный путь к файлам сопоставлений и метаданных. Это значение определяется с помощью метода `AppDomain.SetData("DataDirectory", objValue)`. Строка подстановки `DataDirectory` должна быть заключена в символы вертикальной черты, причем между именем и символами вертикальной черты не должно быть пробелов. Имя `DataDirectory` обрабатывается без учета регистра.<br /><br /> Если в списке путей метаданных нужно передать имя физического каталога «DataDirectory», то добавьте пробелы с обеих сторон от имени, например: `Metadata="DataDirectory1 &#124; DataDirectory &#124; DataDirectory2"`. Приложения ASP.NET разрешает &#124; DataDirectory &#124; для «\<корневой каталог приложения > / app_data» папки.|  
|~|Преобразуется в корневой каталог веб-приложения. Символ ~ в ведущей позиции всегда интерпретируется как оператор определения корневого каталога веб-приложения (~), хотя и может представлять допустимый локальный подкаталог. Для ссылки на локальный подкаталог пользователь должен явно передать `./~`.|  
  
 Значение `DataDirectory` и оператор ~ должны быть указаны только в начале пути, поскольку их преобразование в любой другой позиции не происходит. Платформа Entity Framework пытается преобразовать `~/data`, но рассматривает `/data/~` как физический путь.  
  
 Путь, начинающийся с `DataDirectory` или оператора ~, нельзя преобразовать в физический путь вне ветви `DataDirectory` и оператора ~. Например, следующие пути будут преобразованы так: `~` , `~/data`, `~/bin/Model/SqlServer`. Попытка преобразования следующих путей завершится ошибкой: `~/..`, `~/../other`.  
  
 `DataDirectory` и оператор «~» могут включать подкаталоги: `|DataDirectory|\Model`, `~/bin/Model`.  
  
 Процесс преобразования строки подстановки `DataDirectory` и оператора ~ является нерекурсивным. Например, если `DataDirectory` включает символ `~`, возникает исключение. Тем самым предотвращается бесконечная рекурсия.  
  
## <a name="see-also"></a>См. также  
 [Работа с поставщиками данных](../../../../../docs/framework/data/adonet/ef/working-with-data-providers.md)  
 [Требования к развертыванию](../../../../../docs/framework/data/adonet/ef/deployment-considerations.md)  
 [Управление соединениями и транзакциями](http://msdn.microsoft.com/en-us/b6659d2a-9a45-4e98-acaa-d7a8029e5b99)  
 [Строки подключения](../../../../../docs/framework/data/adonet/connection-strings.md)
