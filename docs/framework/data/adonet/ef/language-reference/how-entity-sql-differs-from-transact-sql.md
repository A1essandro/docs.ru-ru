---
title: "Отличия Entity SQL и Transact-SQL | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-ado"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
ms.assetid: 9c9ee36d-f294-4c8b-a196-f0114c94f559
caps.latest.revision: 3
author: "JennieHubbard"
ms.author: "jhubbard"
manager: "jhubbard"
caps.handback.revision: 3
---
# Отличия Entity SQL и Transact-SQL
В этом разделе описываются различия между [!INCLUDE[esql](../../../../../../includes/esql-md.md)] и [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)].  
  
## Поддержка наследования и связей  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] работает непосредственно с концептуальными схемами сущности и поддерживает такие функции концептуальных моделей, как наследование и связи.  
  
 При работе с наследованием часто полезно выбрать экземпляры подтипа из коллекции экземпляров супертипа.  Эту возможность предоставляет оператор [oftype](../../../../../../docs/framework/data/adonet/ef/language-reference/oftype-entity-sql.md) языка [!INCLUDE[esql](../../../../../../includes/esql-md.md)] \(аналогичный `oftype` в C\# Sequences\).  
  
## Поддержка коллекций  
 В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] коллекции рассматриваются как сущности первого класса.  Например:  
  
-   Выражения коллекций допускаются в предложении `from`.  
  
-   Вложенные запросы `in` и `exists` были обобщены, чтобы разрешить любые коллекции.  
  
     Вложенный запрос \- один из видов коллекций.  `e1 in e2` и `exists(e)` \- конструкции языка [!INCLUDE[esql](../../../../../../includes/esql-md.md)] для выполнения этих операций.  
  
-   Операторы работы с наборами, такие как `union`, `intersect` и `except`, теперь работают с коллекциями.  
  
-   Операции соединения с коллекциями.  
  
## Поддержка выражений  
 В языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] существуют вложенные запросы \(таблицы\) и выражения \(строки и столбцы\).  
  
 В целях поддержки коллекций и вложенных коллекций все элементы языка [!INCLUDE[esql](../../../../../../includes/esql-md.md)] являются выражениями.  Код [!INCLUDE[esql](../../../../../../includes/esql-md.md)] является более легко компонуемым по сравнению с кодом [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] \- любое выражение может использоваться в любом месте.  Результатом выражения запроса всегда является коллекция проецируемых типов, которая может быть использована везде, где разрешено выражение коллекции.  Сведения о выражениях [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)], которые не поддерживаются в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)], см. в разделе [Не поддерживаемые выражения](../../../../../../docs/framework/data/adonet/ef/language-reference/unsupported-expressions-entity-sql.md).  
  
 Допустимы все приведенные ниже запросы [!INCLUDE[esql](../../../../../../includes/esql-md.md)]:  
  
```  
1+2 *3  
"abc"  
row(1 as a, 2 as b)  
{ 1, 3, 5}   
e1 union all e2  
set(e1)  
```  
  
## Единая обработка вложенных запросов  
 Из\-за ориентированности на таблицы язык [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] выполняет контекстную интерпретацию вложенных запросов.  Например, вложенный запрос в предложении `from` считается мультинабором \(таблица\).  Тот же вложенный запрос в предложении `select` считается скалярным вложенным запросом.  Аналогично вложенный запрос, используемый в левой части оператора `in`, считается скалярным вложенным запросом, а с правой стороны предполагается вложенный запрос мультинабора.  
  
 Эти различия устранены в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)].  Выражение имеет единую интерпретацию, которая не зависит от контекста, в котором оно использовано.  В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] все вложенные запросы считаются вложенными запросами мультинабора.  Если из вложенного запроса нужно получить скалярное значение, то в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] имеется оператор `anyelement`, который обращается к коллекции \(в данном случае вложенному запросу\) и извлекает из нее одноэлементное значение.  
  
### Устранение неявных приведений для вложенных запросов  
 Побочный эффект единообразной обработки вложенных запросов \- неявное преобразование вложенных запросов к скалярным значениям.  В частности, в языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] мультинабор строк \(с единственным полем\) неявно преобразуется в скалярную величину, тип данных которой совпадает с типом данных поля.  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает такое неявное приведение.  В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] предусмотрены оператор ANYELEMENT, который извлекает одноэлементное значение из коллекции, и предложение `select value`, позволяющее избежать создания оболочки строк в выражении запроса.  
  
## Выбранное значение: устранение неявной оболочки строк  
 Предложение SELECT во вложенном запросе [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] неявно создает оболочку строк вокруг элементов в предложении.  Это означает, что нельзя создавать коллекции скалярных величин или объектов.  Язык [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] обеспечивает неявное приведение между типом строки с одним полем и одноэлементным значением того же типа данных.  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] предоставляет предложение `select value`, чтобы пропустить неявное построение строки.  В предложении `select value` можно указать только один элемент.  При использовании такого предложения не создается оболочка строк вокруг элементов в предложении `select`, что позволяет получить коллекцию необходимой формы, например: `select value a`.  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] поддерживает также конструктор строк, позволяющий создавать произвольные строки.  Предложение `select` принимает один или несколько элементов в проекции и возвращает результаты в записи данных с полями, следующим образом:  
  
 `select a, b, c`  
  
## Левая корреляция и задание псевдонимов  
 В языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] выражения в данной области \(отдельное предложение, такое как `select` или `from`\) не могут ссылаться на выражения, определенные ранее в той же области.  Некоторые диалекты SQL \(в том числе [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)]\) поддерживают их ограниченные формы в предложении `from`.  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] обобщает левые корреляции в предложении `from` и одинаково их обрабатывает.  Выражения в предложении `from` могут содержать ссылки на более ранние определения \(определения слева\) в том же предложении без дополнительных синтаксических конструкций.  
  
 В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] также налагаются дополнительные ограничения на запросы, включающие предложения `group by`.  Выражения в предложении `select` и предложении `having` таких запросов могут ссылаться на ключи `group by` только через псевдонимы.  Следующая конструкция допустима в языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)], но не в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)].  
  
```  
select t.x + t.y from T as t group by t.x + t.y  
```  
  
 На языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] необходимо написать:  
  
```  
select k from T as t group by (t.x + t.y) as k  
```  
  
## Ссылочные столбцы \(свойства\) таблиц \(коллекций\)  
 Все ссылочные столбцы в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] должны быть квалифицированы с псевдонимом таблицы.  Следующая конструкция \(предполагается, что `a` является допустимым столбцом таблицы `T`\) допустима в [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)], но недопустима в [!INCLUDE[esql](../../../../../../includes/esql-md.md)].  
  
```  
select a from T  
```  
  
 Форма [!INCLUDE[esql](../../../../../../includes/esql-md.md)]:  
  
```  
select t.a as A from T as t  
```  
  
 Псевдонимы таблицы в предложении `from` необязательны.  Имя таблицы используется как неявный псевдоним.  В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] допустима также следующая форма:  
  
```  
select Tab.a from Tab  
```  
  
## Перемещение по объектам  
 В языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] для ссылок на столбцы \(строки\) таблицы используется символ «.».  В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] этот подход \(заимствованный из языков программирования\) расширен и позволяет перемещаться по свойствам объекта  
  
 Например, если `p` \- выражение типа Person, с помощью следующего синтаксиса [!INCLUDE[esql](../../../../../../includes/esql-md.md)] можно ссылаться на город в его адресе.  
  
```  
p.Address.City   
```  
  
## Не поддерживается \*  
 Язык [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] поддерживает использование синтаксиса \* в качестве псевдонима для всей строки и уточненного синтаксиса \* \(t.\*\) в качестве шаблона для ее полей.  Кроме того, в [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] разрешается специальное статистическое выражение count\(\*\), включающее значения NULL.  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает конструкцию «\*».  Запросы [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] в форме `select * from T` и `select T1.* from T1, T2...` могут быть выражены в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] как `select value t from T as t` и `select value t1 from T1 as t1, T2 as t2...`, соответственно.  Эти конструкции также обеспечивают наследование \(заменяемость значений\), в то время как варианты `select *` ограничены свойствами верхнего уровня объявленного типа.  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает статистическую функцию `count(*)`.  Взамен рекомендуется использовать `count(0)`.  
  
## Изменения на предложение Group By  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] поддерживает псевдонимы ключей `group by`.  Выражения в предложении `select` и предложении `having` таких запросов должны ссылаться на ключи `group by` через псевдонимы. Например, следующий синтаксис [!INCLUDE[esql](../../../../../../includes/esql-md.md)]:  
  
```  
select k1, count(t.a), sum(t.a)  
from T as t  
group by t.b + t.c as k1  
```  
  
 ...эквивалентна следующей конструкции [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)]:  
  
```  
select b + c, count(*), sum(a)   
from T  
group by b + c  
```  
  
## Статистические функции на основе коллекций  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] поддерживает два типа статистических функций.  
  
 Статистические функции на основе коллекций работают с коллекциями и возвращают результат статистической обработки.  Они могут применяться в любом месте в запросе и не требуют предложения `group by`.  Например:  
  
```  
select t.a as a, count({1,2,3}) as b from T as t     
```  
  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] также поддерживает статистические функции в стиле SQL.  Например:  
  
```  
select a, sum(t.b) from T as t group by t.a as a  
```  
  
## Использование предложения ORDER BY  
 В языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] предложения ORDER BY могут быть указаны только в самом верхнем блоке инструкции SELECT .. FROM ..  WHERE.  В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] можно использовать вложенное выражение ORDER BY, которое может быть размещено в любом месте запроса, однако упорядочение во вложенном запросе не сохраняется.  
  
```  
-- The following query will order the results by the last name  
SELECT C1.FirstName, C1.LastName  
        FROM AdventureWorks.Contact as C1  
        ORDER BY C1.LastName  
```  
  
```  
-- In the following query ordering of the nested query is ignored.  
SELECT C2.FirstName, C2.LastName  
    FROM (SELECT C1.FirstName, C1.LastName  
        FROM AdventureWorks.Contact as C1  
        ORDER BY C1.LastName) as C2  
```  
  
## Идентификаторы  
 В языке [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] сравнение идентификаторов всегда осуществляется с учетом параметров сортировки текущей базы данных.  В [!INCLUDE[esql](../../../../../../includes/esql-md.md)] идентификаторы всегда чувствительны к регистру и диакритическим знакам \(то есть [!INCLUDE[esql](../../../../../../includes/esql-md.md)] различает диакритические знаки, например «а» отличается от «ấ»\). [!INCLUDE[esql](../../../../../../includes/esql-md.md)] обрабатывает версии букв, которые кажутся такими же, но являются другими символами и происходят из других кодовых страниц.  Для получения дополнительной информации см. [Набор символов ввода](../../../../../../docs/framework/data/adonet/ef/language-reference/input-character-set-entity-sql.md).  
  
## Функциональность Transact\-SQL, недоступная в Entity SQL  
 Следующая функциональность [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] недоступна в языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)].  
  
 DML  
 В настоящее время язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает инструкции DML \(вставка, обновление, удаление\).  
  
 DDL  
 Текущая версия [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает DDL.  
  
 Командное программирование  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает командное программирование в отличие от [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)].  Используйте вместо этого языки программирования.  
  
 Функции группирования  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] пока не поддерживает функции группирования \(например, CUBE, ROLLUP и GROUPING\_SET\).  
  
 Функции аналитики  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не предоставляет \(пока\) поддержку функций аналитики.  
  
 Встроенные функции, операторы  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] поддерживает подмножество встроенных функций и операторов [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)].  Вероятно, эти операторы и функции будут реализованы ведущими поставщиками хранилищ.  В языке [!INCLUDE[esql](../../../../../../includes/esql-md.md)] используются специальные функции для хранилищ, объявленные в манифесте поставщика.  Кроме того, модель [!INCLUDE[adonet_ef](../../../../../../includes/adonet-ef-md.md)] позволяет объявлять встроенные и пользовательские функции хранилища для использования в [!INCLUDE[esql](../../../../../../includes/esql-md.md)].  
  
 Подсказки  
 Язык [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не предоставляет механизм подсказок в запросах.  
  
 Пакетирование результатов запроса  
 [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживает пакетирование результатов запросов.  Например, допустим следующий запрос [!INCLUDE[tsql](../../../../../../includes/tsql-md.md)] \(отправляемый как пакет\):  
  
```  
select * from products;  
select * from catagories;  
```  
  
 Однако эквивалент [!INCLUDE[esql](../../../../../../includes/esql-md.md)] не поддерживается.  
  
```  
Select value p from Products as p;  
Select value c from Categories as c;  
```  
  
 [!INCLUDE[esql](../../../../../../includes/esql-md.md)] поддерживает только запросы, которые выдают один результат на одну команду.  
  
## См. также  
 [Общие сведения о языке Entity SQL](../../../../../../docs/framework/data/adonet/ef/language-reference/entity-sql-overview.md)   
 [Не поддерживаемые выражения](../../../../../../docs/framework/data/adonet/ef/language-reference/unsupported-expressions-entity-sql.md)