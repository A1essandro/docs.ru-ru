---
title: "Вопросы переноса (платформа Entity Framework) | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-ado"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
ms.assetid: c85b6fe8-cc32-4642-8f0a-dc0e5a695936
caps.latest.revision: 6
author: "JennieHubbard"
ms.author: "jhubbard"
manager: "jhubbard"
caps.handback.revision: 5
---
# Вопросы переноса (платформа Entity Framework)
Платформа [!INCLUDE[vstecado](../../../../../includes/vstecado-md.md)] Entity Framework предоставляет существующим приложениям ряд преимуществ.  Наиболее важным из них является возможность использования концептуальной модели для отделения структур данных, используемых приложением, от схемы в источнике данных.  Это позволяет в дальнейшем значительно упростить внесение изменений в модель хранения или сам источник данных, устранив необходимость внесения соответствующих изменений в приложение.  Дополнительные сведения о преимуществах использования [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] см. в разделах [Общие сведения о платформе Entity Framework](../../../../../docs/framework/data/adonet/ef/overview.md) и [Модель EDM](../../../../../docs/framework/data/adonet/entity-data-model.md).  
  
 Чтобы воспользоваться преимуществами, которые дает [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)], необходимо перенести существующее приложение на [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)].  Некоторые задачи являются общими для всех перенесенных приложений.  В их число входит обновление приложения для использования версии [!INCLUDE[dnprdnshort](../../../../../includes/dnprdnshort-md.md)], начиная с 3.5 с пакетом обновления 1 \(SP1\), определение моделей и сопоставлений, а также настройка платформы Entity Framework.  При переносе приложения на [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] необходимо рассмотреть ряд дополнительных вопросов.  Каких именно \- зависит от типа переносимого приложения и реализуемых им функциональных возможностей.  Этот раздел содержит сведения, которые помогут подобрать наилучший подход при обновлении существующих приложений.  
  
## Общие рекомендации по переносу  
 Следующие соображения относятся к переносу на [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] любых приложений.  
  
-   Любое приложение, использующее [!INCLUDE[dnprdnshort](../../../../../includes/dnprdnshort-md.md)], начиная с версии 3.5 с пакетом обновления 1 \(SP1\), может быть перенесено на платформу Entity Framework, если эту платформу поддерживает поставщик источника данных, используемого приложением.  
  
-   Платформа Entity Framework может поддерживать не все функции поставщика источника данных, даже если поставщик поддерживает платформу Entity Framework.  
  
-   Большие и сложные приложения не обязательно переносить на платформу Entity Framework сразу и полностью.  При этом, однако, те части приложения, которые не используют Entity Framework, будут по\-прежнему требовать изменения при изменении источника данных.  
  
-   Соединение с поставщиком данных, используемое платформой Entity Framework, может быть общим для нескольких частей приложения, поскольку на платформе [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] для доступа к источнику данных служат поставщики данных [!INCLUDE[vstecado](../../../../../includes/vstecado-md.md)].  Например, поставщик SqlClient используется платформой Entity Framework для доступа к базе данных SQL Server.  Дополнительные сведения см. в разделе [Поставщик EntityClient для платформы Entity Framework](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md).  
  
## Типичные задачи переноса  
 Путь переноса существующего приложения на платформу [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] зависит как от типа приложения, так и от существующей стратегии доступа к данным.  Но при переносе любого существующего приложения на платформу [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] всегда приходится выполнять следующие задачи.  
  
> [!NOTE]
>  Все эти задачи выполняются автоматически при использовании средств модели EDM, начиная с [!INCLUDE[vsOrcas](../../../../../includes/vsorcas-md.md)].  Дополнительные сведения см. в разделе [How to: Use the Entity Data Model Wizard](http://msdn.microsoft.com/ru-ru/dadb058a-c5d9-4c5c-8b01-28044112231d).  
  
1.  Обновление приложения.  
  
     Проект, созданный в предыдущей версии среды [!INCLUDE[vsprvs](../../../../../includes/vsprvs-md.md)] и платформы [!INCLUDE[dnprdnshort](../../../../../includes/dnprdnshort-md.md)], необходимо обновить для использования среды [!INCLUDE[vsOrcas](../../../../../includes/vsorcas-md.md)] с пакетом обновления 1 \(SP1\) и платформы [!INCLUDE[dnprdnshort](../../../../../includes/dnprdnshort-md.md)], начиная с версии 3.5 с пакетом обновления 1 \(SP1\).  
  
2.  Определение моделей и сопоставлений.  
  
     Файлы модели и сопоставления определяют сущности в концептуальной модели, структуры в источнике данных \(таблицы, хранимые процедуры, представления и т. д.\), а также сопоставление между сущностями и структурами источника данных.  Дополнительные сведения см. в разделе [How to: Manually Define the Model and Mapping Files](http://msdn.microsoft.com/ru-ru/d4fd6864-f2a1-48f0-aa32-1e318775a99a).  
  
     Типы, определенные в модели хранения, должны соответствовать именам объектов в источнике данных.  Если существующее приложение предоставляет доступ к данным в виде объектов, необходимо убедиться в том, что сущности и свойства, определенные в концептуальной модели, соответствуют именам существующих классов и свойств данных.  Дополнительные сведения см. в разделе [How to: Customize Modeling and Mapping Files to Work with Custom Objects](http://msdn.microsoft.com/ru-ru/bb40c4db-0121-4e45-a167-8fb06707a708).  
  
    > [!NOTE]
    >  Конструктор моделей EDM позволяет переименовывать сущности концептуальной модели для обеспечения соответствия существующим объектам.  Дополнительные сведения см. в разделе [Entity Data Model Designer](http://msdn.microsoft.com/ru-ru/4ccd7ad6-b934-4f7c-82a0-cfd2d4a95faf).  
  
3.  Определение строки соединения.  
  
     В платформе [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] для выполнения запросов к концептуальной модели используется специальный формат строки соединения.  В нее инкапсулированы сведения о файлах модели и сопоставления, а также о соединении с источником данных.  Дополнительные сведения см. в разделе [Как определить строки соединения.](../../../../../docs/framework/data/adonet/ef/how-to-define-the-connection-string.md).  
  
4.  Настройка проекта [!INCLUDE[vsprvs](../../../../../includes/vsprvs-md.md)].  
  
     Ссылки на сборки платформы [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] и файлы модели и сопоставления должны быть добавлены в проект [!INCLUDE[vsprvs](../../../../../includes/vsprvs-md.md)].  Можно также добавить в проект файлы сопоставления, чтобы выполнялось их развертывание в каталоге, указанном в строке соединения.  Дополнительные сведения см. в разделе [How to: Manually Configure an Entity Framework Project](http://msdn.microsoft.com/ru-ru/73f6ae1d-b3b2-4577-aebd-ad5a75954e9e).  
  
## Приложения с существующими объектами  
 Начиная с [!INCLUDE[dnprdnshort](../../../../../includes/dnprdnshort-md.md)] версии 4, [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] поддерживает традиционные объекты среды CLR \(POCO\), которые называются также объектами, игнорирующими сохраняемость.  В большинстве случаев существующие объекты могут работать с [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] при внесении незначительных изменений.  Дополнительные сведения см. в разделе [Working with POCO Entities](http://msdn.microsoft.com/ru-ru/5e0fb82a-b6d1-41a1-b37b-c12db61629d3). Можно также перенести приложение в [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] и использовать классы данных, сформированные средствами платформы Entity Framework.  Дополнительные сведения см. в разделе [How to: Use the Entity Data Model Wizard](http://msdn.microsoft.com/ru-ru/dadb058a-c5d9-4c5c-8b01-28044112231d).  
  
## Приложения, использующие поставщики ADO.NET  
 Поставщики [!INCLUDE[vstecado](../../../../../includes/vstecado-md.md)], например, SqlClient, позволяют выполнять запросы к источнику данных, возвращающие табличные данные.  Кроме того, данные могут быть загружены в объект DataSet [!INCLUDE[vstecado](../../../../../includes/vstecado-md.md)].  В следующем списке приведены соображения по обновлению приложений, пользующихся существующими поставщиками [!INCLUDE[vstecado](../../../../../includes/vstecado-md.md)].  
  
 Отображение табличных данных с помощью модуля чтения данных.  
 Можно попробовать выполнить запрос [!INCLUDE[esql](../../../../../includes/esql-md.md)] при помощи поставщика EntityClient и выполнить перечисление по возвращенному объекту <xref:System.Data.EntityClient.EntityDataReader>.  Этим способом следует пользоваться только в том случае, если приложение отображает табличные данные с помощью модуля чтения данных и не нуждается в предоставляемых [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] возможностях по материализации данных в объекты, отслеживанию изменений и выполнению обновлений. Можно продолжать пользоваться существующим кодом доступа к данным, который выполняет обновления источника данных, но пользоваться для этого соединением, доступным через свойство <xref:System.Data.EntityClient.EntityConnection.StoreConnection%2A> объекта <xref:System.Data.EntityClient.EntityConnection>.  Дополнительные сведения см. в разделе [Поставщик EntityClient для платформы Entity Framework](../../../../../docs/framework/data/adonet/ef/entityclient-provider-for-the-entity-framework.md).  
  
 Работа с DataSet.  
 Платформа [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] предоставляет во многом те же функциональные возможности, что и DataSet, включая сохраняемость в памяти, отслеживание изменений, привязку данных и сериализацию объектов в виде XML\-данных.  Дополнительные сведения см. в разделе [Работа с объектами](../../../../../docs/framework/data/adonet/ef/working-with-objects.md).  
  
 Если [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] не реализует нужные приложению функциональные возможности DataSet, то можно задействовать для этого возможности [!INCLUDE[linq_dataset](../../../../../includes/linq-dataset-md.md)].  Дополнительные сведения см. в разделе [LINQ to DataSet](../../../../../docs/framework/data/adonet/linq-to-dataset.md).  
  
## Приложения с привязкой данных к элементам управления  
 Платформа [!INCLUDE[dnprdnshort](../../../../../includes/dnprdnshort-md.md)] позволяет инкапсулировать данные в источнике данных, таком как DataSet или элемент управления источником данных [!INCLUDE[vstecasp](../../../../../includes/vstecasp-md.md)], а затем привязывать элементы пользовательского интерфейса к этим элементам управления данными.  В следующем списке приведены соображения, касающиеся привязки элементов управления к данным платформы Entity Framework.  
  
 Привязка данных к элементам управления.  
 При обработке запроса к концептуальной модели [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] возвращает данные в виде объектов, которые являются экземплярами типов сущностей.  Эти объекты могут быть привязаны непосредственно к элементам управления, причем такая привязка поддерживает обновление данных. Это означает, что любое изменение данных в элементе управления \(например, изменение строки в <xref:System.Windows.Forms.DataGridView>\) будет автоматически сохранено в базе данных при вызове метода <xref:System.Data.Objects.ObjectContext.SaveChanges%2A>.  
  
 Если в приложении применяется перечисление результатов запроса для отображения данных в <xref:System.Windows.Forms.DataGridView> или любом другом элементе управления, поддерживающем привязку к данным, то можно модифицировать это приложение для привязки элемента управления к результату <xref:System.Data.Objects.ObjectQuery%601>.  
  
 Дополнительные сведения см. в разделе [Binding Objects to Controls](http://msdn.microsoft.com/ru-ru/2fd34855-929b-4303-a91e-4bb69d958f2b).  
  
 Элементы управления источником данных [!INCLUDE[vstecasp](../../../../../includes/vstecasp-md.md)].  
 Платформа [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] включает элемент управления источником данных, предназначенный для упрощения привязки данных в веб\-приложениях [!INCLUDE[vstecasp](../../../../../includes/vstecasp-md.md)].  Дополнительные сведения см. в разделе [Элемент управления источником данных Entity Framework](../Topic/EntityDataSource%20Web%20Server%20Control%20Overview.md).  
  
## Другие вопросы  
 Далее приведены вопросы, которые могут потребовать рассмотрения при переносе на платформу Entity Framework некоторых типов приложений.  
  
 Приложения, реализующие службы данных.  
 Веб\-службы и приложения, созданные на основе технологии WCF, предоставляют доступ к данным из базового источника данных с использованием формата обмена сообщениями «запрос\-ответ» XML.  Платформа [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] поддерживает сериализацию объектов сущностей с использованием двоичной сериализации, сериализации XML или контрактной сериализации данных WCF.  Двоичная сериализация и сериализация WCF поддерживают полную сериализацию графов объектов.  Дополнительные сведения см. в разделе [Building N\-Tier Applications](http://msdn.microsoft.com/ru-ru/9439d2ba-6b5f-44e8-be65-8a442d922cbb).  
  
 Приложения, использующие XML\-данные.  
 Сериализация объектов позволяет создать службы данных на платформе [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)].  Такие службы поставляют данные приложениям, принимающим XML\-данные, например, интернет\-приложениям на основе технологии AJAX.  В этом случае попробуйте использовать [!INCLUDE[ssAstoria](../../../../../includes/ssastoria-md.md)].  Эти службы данных основаны на модели EDM и предоставляют динамический доступ к данным сущностей через стандартные операции REST протокола HTTP, такие как GET, PUT и POST.  Дополнительные сведения см. в разделе [Службы WCF Data Services 4.5](../../../../../docs/framework/data/wcf/index.md).  
  
 Платформа [!INCLUDE[adonet_ef](../../../../../includes/adonet-ef-md.md)] не поддерживает собственный тип данных XML.  Это означает, что если сущность сопоставлена с таблицей, имеющей XML\-столбец, то эквивалентное свойство сущности для столбца XML является строковым.  Объекты могут быть отсоединены и сериализованы в виде XML.  Дополнительные сведения см. в разделе [Serializing Objects](http://msdn.microsoft.com/ru-ru/06c77f9b-5b2e-4c78-b3e3-8c148ba0ea99).  
  
 Если в приложении необходимо предусмотреть возможность запрашивать XML\-данных, то можно воспользоваться преимуществами запросов LINQ на основе применения LINQ to XML.  Дополнительные сведения см. в разделе [LINQ to XML](../../../../../ocs/visual-basic/programming-guide/concepts/linq/linq-to-xml.md).  
  
 Приложения, сохраняющие состояние.  
 Часто веб\-приложению [!INCLUDE[vstecasp](../../../../../includes/vstecasp-md.md)] необходимо сохранение состояния веб\-страницы или сеанса пользователя.  Объекты экземпляра <xref:System.Data.Objects.ObjectContext> могут быть сохранены в состоянии просмотра на клиенте или в состоянии сеанса на сервере, а затем получены и заново присоединены к новому контексту объекта.  Дополнительные сведения см. в разделе [Attaching and Detaching Objects](http://msdn.microsoft.com/ru-ru/41d5c1ef-1b78-4502-aa10-7e1438d62d23).  
  
## См. также  
 [Требования к развертыванию](../../../../../docs/framework/data/adonet/ef/deployment-considerations.md)   
 [Терминология платформы Entity Framework](../../../../../docs/framework/data/adonet/ef/terminology.md)