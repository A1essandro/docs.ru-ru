---
title: "Пошаговое руководство. Простая модель объектов и простой запрос (Visual Basic) (LINQ to SQL). | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-ado"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: c878e457-f715-46e4-a136-ff14d6c86018
caps.latest.revision: 3
author: "JennieHubbard"
ms.author: "jhubbard"
manager: "jhubbard"
caps.handback.revision: 3
---
# Пошаговое руководство. Простая модель объектов и простой запрос (Visual Basic) (LINQ to SQL).
В данном пошаговом руководстве представлен основной и полный сценарий [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] с подробным объяснением выполняемых действий.  В нем создается класс сущностей, который моделирует таблицу Customers в учебной базе данных Northwind.  После этого создается простой запрос на получение списка клиентов, находящихся в Лондоне.  
  
 Данное руководство ориентировано на создание кода, чтобы продемонстрировать основные понятия технологии [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].  Как правило, создание собственной модели объектов выполняется с помощью [!INCLUDE[vs_ordesigner_long](../../../../../../includes/vs-ordesigner-long-md.md)].  
  
 [!INCLUDE[note_settings_general](../../../../../../includes/note-settings-general-md.md)]  
  
 Это пошаговое руководство было написано с помощью параметров разработки Visual Basic.  
  
## Обязательные компоненты  
  
-   Для хранения файлов используется выделенная папка \("c:\\linqtest"\).  Прежде чем приступить к выполнению задач, создайте такую папку.  
  
-   В данном пошаговом руководстве требуется доступ к учебной базе данных Northwind.  Если база данных не установлена на компьютере разработчика, загрузите ее с веб\-узла Центра загрузки Майкрософт.  Инструкции см. в разделе [Загрузка образцов баз данных](../../../../../../docs/framework/data/adonet/sql/linq/downloading-sample-databases.md).  После загрузки базы данных скопируйте полученный файл в папку c:\\linqtest.  
  
## Обзор  
 Данное пошаговое руководство состоит из шести основных задач.  
  
-   Создание решения [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] в среде [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)].  
  
-   Сопоставление класса с таблицей базы данных.  
  
-   Назначение свойств классу для представления столбцов базы данных.  
  
-   Указание подключения к базе данных Northwind.  
  
-   Создание простого запроса к базе данных.  
  
-   Выполнение запроса и просмотр результатов.  
  
## Создание решения LINQ to SQL  
 В первой задаче создается решение [!INCLUDE[vs_current_short](../../../../../../includes/vs-current-short-md.md)], которое содержит ссылки, необходимые для построения и выполнения проекта [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].  
  
#### Создание решения LINQ to SQL  
  
1.  В меню **Файл** выберите команду **Создать проект**.  
  
2.  В диалоговом окне **Создание проекта** в области **Тип проекта** выберите **Visual Basic**.  
  
3.  В области **Шаблоны** щелкните **Консольное приложение**.  
  
4.  В поле **Имя** введите LinqConsoleApp.  
  
5.  Нажмите кнопку **ОК**.  
  
## Добавление ссылок и директив LINQ  
 В этом пошаговом руководстве используются сборки, которые могут быть не установлены по умолчанию в проект.  Если `System.Data.Linq` не входит в список ссылок проекта \(щелкните **Показать все файлы** в **обозревателе решений** и разверните узел **Ссылки**\), добавьте ее, как описано в следующих действиях.  
  
#### Добавление сборки System.Data.Linq  
  
1.  В **Обозревателе решений** щелкните правой кнопкой мыши узел **Ссылки** и выберите команду **Добавить ссылку**.  
  
2.  В диалоговом окне **Добавление ссылки** щелкните **.NET**, выберите сборку System.Data.Linq, а затем нажмите кнопку **ОК**.  
  
     Сборка будет добавлена в проект.  
  
3.  Кроме того, в диалоговом окне **Добавление ссылки** щелкните **.NET**, прокрутите список вниз, выберите сборку System.Windows.Forms, а затем нажмите кнопку **ОК**.  
  
     Эта сборка, которая поддерживает окно сообщений в данном пошаговом руководстве, будет добавлена в проект.  
  
4.  Добавьте следующие директивы перед `Module1`.  
  
     [!code-vb[DLinqWalk1VB#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#1)]  
  
## Сопоставление класса с таблицей базы данных  
 На этом этапе создается класс, который сопоставляется с таблицей базы данных.  Подобный класс называется *классом сущностей*.  Обратите внимание, что сопоставление осуществляется простым добавлением атрибута <xref:System.Data.Linq.Mapping.TableAttribute>.  Свойство <xref:System.Data.Linq.Mapping.TableAttribute.Name%2A> задает имя таблицы в базе данных.  
  
#### Создание класса сущностей и его сопоставление с таблицей базы данных  
  
-   Введите или вставьте следующий код в файл Module1.vb непосредственно перед методом `Sub Main`.  
  
     [!code-vb[DLinqWalk1VB#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#2)]  
  
## Назначение свойств классу для представления столбцов базы данных.  
 На этом этапе выполняется несколько задач.  
  
-   Используется атрибут <xref:System.Data.Linq.Mapping.ColumnAttribute> для назначения классу сущностей свойств `CustomerID` и `City`, представляющих столбцы в таблице базы данных.  
  
-   Назначается свойство `CustomerID`, представляющее столбец первичного ключа в базе данных.  
  
-   Назначаются поля `_CustomerID` и `_City` для закрытого хранения.  После этого [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] сможет напрямую сохранять и извлекать значения, вместо вызова открытых методов доступа, которые могут содержать бизнес\-логику.  
  
#### Представление характеристик двух столбцов базы данных  
  
-   Введите или вставьте следующий код в файл Module1.vb непосредственно перед методом `End Class`.  
  
     [!code-vb[DLinqWalk1VB#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#3)]  
  
## Указание подключения к базе данных Northwind  
 На этом этапе для установки подключения между основанными на коде структурами данных и самой базой данных используется объект <xref:System.Data.Linq.DataContext>.  Основным каналом, через который извлекаются объекты из базы данных и отправляются изменения, является класс <xref:System.Data.Linq.DataContext>.  
  
 Также объявляется объект `Table(Of Customer)`, который действует как логическая типизированная таблица для запросов к таблице Customers в базе данных.  Эти запросы создаются и выполняются в последующих действиях.  
  
#### Указание подключения к базе данных  
  
-   Введите или вставьте следующий код в метод `Sub Main`.  
  
     Обратите внимание: предполагается, что файл `northwnd.mdf` находится в папке "linqtest".  Дополнительные сведения см. в разделе "Предварительные требования" ранее в этом руководстве.  
  
     [!code-vb[DLinqWalk1VB#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1VB/vb/Module1.vb#4)]  
  
## Создание простого запроса  
 На этом этапе создается запрос для поиска клиентов из таблицы Customers базы данных, находящихся в Лондоне.  Код запроса, создаваемый на этом шаге, только описывает запрос.  но не выполняет его.  Подобный метод называется *отложенным выполнением*.  Дополнительные сведения см. в разделе [Introduction to LINQ Queries \(C\#\)](../Topic/Introduction%20to%20LINQ%20Queries%20\(C%23\).md).  
  
 Можно также записать выходные данные в журнал, чтобы продемонстрировать команды SQL, создаваемые технологией [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)].  Функция ведения журнала \(которая использует метод <xref:System.Data.Linq.DataContext.Log%2A>\) очень полезна при отладке, а также при проверке того, что команды, отправляемые в базу данных, точно соответствуют запросу.  
  
#### Создание простого запроса  
  
-   Введите или вставьте следующий код в метод `Sub Main` после объявления `Table(Of Customer)`.  
  
     [!code-vb[DLinqWalk1AVB#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#5)]  
  
## Выполнение запроса  
 На этом шаге производится фактическое выполнение запроса.  Выражения запроса, созданные на предыдущем этапе, не оцениваются до тех пор, пока не понадобятся результаты.  После начала итерации `For Each` выполняется команда SQL для базы данных и материализуются объекты.  
  
#### Порядок выполнения запроса  
  
1.  Введите или вставьте следующий код в конце метода `Sub Main` \(после описания запроса\).  
  
     [!code-vb[DLinqWalk1AVB#6](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk1AVB/vb/Module1.vb#6)]  
  
2.  Нажмите клавишу F5, чтобы начать отладку приложения.  
  
    > [!NOTE]
    >  Если во время выполнения приложение создает ошибку, см. подраздел "Устранение неполадок" раздела [Обучение с помощью пошаговых руководств](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md).  
  
     В окне сообщения отображается список из шести клиентов.  В окне консоли отображается созданный код SQL.  
  
3.  Нажмите кнопку **ОК**, чтобы закрыть окно сообщения.  
  
     Приложение закрывается.  
  
4.  В меню **Файл** выберите команду **Сохранить все**.  
  
     Это приложение потребуется при выполнении следующего пошагового руководства.  
  
## Следующие действия  
 Продолжение этого пошагового руководства см. в разделе [Пошаговое руководство. Выполнение запросов со связями \(Visual Basic\)](../../../../../../docs/framework/data/adonet/sql/linq/walkthrough-querying-across-relationships-visual-basic.md).  В пошаговом руководстве "Выполнение запросов в связях" демонстрируется, как технология [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] может выполнять запросы между таблицами, аналогичные *соединениям* в реляционных базах данных.  
  
 Если требуется выполнить пошаговое руководство "Выполнение запросов в связях", необходимо сохранить решение, созданное в процессе только что завершенного пошагового руководства. Это обязательное условие.  
  
## См. также  
 [Обучение с помощью пошаговых руководств](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)