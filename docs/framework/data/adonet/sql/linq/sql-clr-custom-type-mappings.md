---
title: "Настраиваемые сопоставления типов SQL-CLR"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d916c7fb-4b56-4214-acbe-5e23365047b2
caps.latest.revision: "2"
author: douglaslMS
ms.author: douglasl
manager: craigg
ms.workload: dotnet
ms.openlocfilehash: 9ead5c43d295a5dc42f09deb21955de46fa1a576
ms.sourcegitcommit: ed26cfef4e18f6d93ab822d8c29f902cff3519d1
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/17/2018
---
# <a name="sql-clr-custom-type-mappings"></a><span data-ttu-id="a108d-102">Настраиваемые сопоставления типов SQL-CLR</span><span class="sxs-lookup"><span data-stu-id="a108d-102">SQL-CLR Custom Type Mappings</span></span>
<span data-ttu-id="a108d-103">Сопоставление типов SQL Server и среды CLR автоматически указывается при использовании средства командной строки SQLMetal и реляционного конструктора объектов.</span><span class="sxs-lookup"><span data-stu-id="a108d-103">Type mapping between SQL Server and the common language runtime (CLR) is automatically specified when you use the SQLMetal command-line tool, Object Relational Designer (O/R Designer).</span></span>  
  
 <span data-ttu-id="a108d-104">Когда пользовательское сопоставление не выполняется, эти средства назначения по умолчанию сопоставления типов, как описано в [сопоставление типов SQL-CLR](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="a108d-104">When no customized mapping is performed, these tools assign default type mappings as described in [SQL-CLR Type Mapping](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md).</span></span> <span data-ttu-id="a108d-105">Если вы хотите сопоставлять типы иначе, чем по умолчанию, необходимо выполнить определенную настройку сопоставления типов.</span><span class="sxs-lookup"><span data-stu-id="a108d-105">If you want to type mappings differently from these defaults, you need to do some customization of the type mappings.</span></span>  
  
 <span data-ttu-id="a108d-106">При проведении пользовательского сопоставления типов рекомендуется выполнять изменения в промежуточном DBML-файле.</span><span class="sxs-lookup"><span data-stu-id="a108d-106">When customizing type mappings, the recommended approach is to make the changes in an intermediary DBML file.</span></span> <span data-ttu-id="a108d-107">После этого настроенный DBML-файл следует применять при создании кода и файлов сопоставления с помощью SQLMetal или реляционного конструктора объектов.</span><span class="sxs-lookup"><span data-stu-id="a108d-107">Then, your customized DBML file should be used when you create you code and mapping files with SQLMetal or O/R Designer.</span></span>  
  
 <span data-ttu-id="a108d-108">Как только из кода и файлов сопоставления будет создан экземпляр объекта <xref:System.Data.Linq.DataContext>, метод <xref:System.Data.Linq.DataContext.CreateDatabase%2A?displayProperty=nameWithType> создаст базу данных на основании указанных сопоставлений.</span><span class="sxs-lookup"><span data-stu-id="a108d-108">Once you instantiate the <xref:System.Data.Linq.DataContext> object from the code and mapping files, the <xref:System.Data.Linq.DataContext.CreateDatabase%2A?displayProperty=nameWithType> method creates a database based on the type mappings that are specified.</span></span> <span data-ttu-id="a108d-109">Если в этих сопоставлениях нет указанных атрибутов CLR `type`, будут применяться сопоставления по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="a108d-109">If there are no CLR `type` attributes specified in the mappings, the default type mappings will be used.</span></span>  
  
## <a name="customization-with-sqlmetal-or-or-designer"></a><span data-ttu-id="a108d-110">Настройка с помощью SQLMetal или реляционного конструктора объектов</span><span class="sxs-lookup"><span data-stu-id="a108d-110">Customization with SQLMetal or O/R Designer</span></span>  
 <span data-ttu-id="a108d-111">С помощью SQLMetal и реляционного конструктора объектов можно автоматически создать модель объектов, которая будет включать сведения о сопоставлении типов внутри или вне файла кода.</span><span class="sxs-lookup"><span data-stu-id="a108d-111">With SQLMetal and O/R Designer, you can automatically create an object model that includes the type mapping information inside or outside the code file.</span></span> <span data-ttu-id="a108d-112">Поскольку эти файлы переписываются средствами SQLMetal и реляционного конструктора объектов при каждом повторном создании сопоставлений, рекомендуемым подходом к указанию пользовательских сопоставлений типов является настройка DBML-файла.</span><span class="sxs-lookup"><span data-stu-id="a108d-112">Because these files are overwritten by SQLMetal or O/R Designer, each time you recreate your mappings, the recommended approach to specifying custom type mappings is to customize a DBML file.</span></span>  
  
 <span data-ttu-id="a108d-113">Чтобы настроить сопоставления типов с помощью SQLMetal или реляционного конструктора объектов, сначала создайте файл DBML.</span><span class="sxs-lookup"><span data-stu-id="a108d-113">To customize type mappings with SQLMetal or O/R Designer, first generate a DBML file.</span></span> <span data-ttu-id="a108d-114">Затем, прежде чем создавать файл кода или файл сопоставления, измените DBML-файл, чтобы идентифицировать желаемые сопоставления типов.</span><span class="sxs-lookup"><span data-stu-id="a108d-114">Then, before generating the code file or mapping file, modify the DBML file to identify the desired type mappings.</span></span> <span data-ttu-id="a108d-115">При использовании SQLMetal необходимо вручную изменить атрибуты `Type` и `DbType` в DBML-файле, чтобы настроить пользовательские сопоставления типов.</span><span class="sxs-lookup"><span data-stu-id="a108d-115">With SQLMetal, you have to manually change the `Type` and `DbType` attributes in the DBML file to make your type mapping customizations.</span></span> <span data-ttu-id="a108d-116">При использовании реляционного конструктора объектов изменения можно внести средствами конструктора.</span><span class="sxs-lookup"><span data-stu-id="a108d-116">With O/R Designer, you can make your changes within the Designer.</span></span> <span data-ttu-id="a108d-117">Дополнительные сведения об использовании реляционного конструктора объектов см. в разделе [средства LINQ to SQL в Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span><span class="sxs-lookup"><span data-stu-id="a108d-117">For more information about using the O/R Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a108d-118">Некоторые сопоставления типов могут приводить к возникновению исключений переполнения или потери данных в ходе преобразования данных в базу данных или из нее.</span><span class="sxs-lookup"><span data-stu-id="a108d-118">Some type mappings may result in overflow or data loss exceptions while translating to or from the database.</span></span> <span data-ttu-id="a108d-119">Внимательно просмотрите Таблица правил сопоставления типов во время выполнения в [сопоставление типов SQL-CLR](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md) перед внесением все настройки.</span><span class="sxs-lookup"><span data-stu-id="a108d-119">Carefully review the Type Mapping Run-time Behavior Matrix in [SQL-CLR Type Mapping](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md) before making any customizations.</span></span>  
  
 <span data-ttu-id="a108d-120">Чтобы настройки сопоставления типов распознавались средством SQLMetal или реляционным конструктором объектов, при формировании файла кода или внешнего файла сопоставления убедитесь в том, что у них имеется путь к пользовательскому файлу DBML.</span><span class="sxs-lookup"><span data-stu-id="a108d-120">In order for your type mapping customizations to be recognized by SQLMetal or O/R Designer, you need to make sure that these tools are supplied with the path to your custom DBML file when you generate your code file or external mapping file.</span></span> <span data-ttu-id="a108d-121">Хотя этого и не требуется для настройки сопоставления типов, рекомендуется всегда отделять сведения о сопоставлении типов от файла кода и создавать дополнительный внешний файл сопоставления.</span><span class="sxs-lookup"><span data-stu-id="a108d-121">Although not required for type mapping customization, it is recommended that you always separate your type mapping information from your code file and generate the additional external type mapping file.</span></span> <span data-ttu-id="a108d-122">Это придаст некоторую гибкость, поскольку не придется перекомпилировать файл кода.</span><span class="sxs-lookup"><span data-stu-id="a108d-122">Doing so will leave some flexibility by not requiring that the code file be recompiled.</span></span>  
  
## <a name="incorporating-database-changes"></a><span data-ttu-id="a108d-123">Интеграция изменений баз данных</span><span class="sxs-lookup"><span data-stu-id="a108d-123">Incorporating Database Changes</span></span>  
 <span data-ttu-id="a108d-124">При изменении базы данных потребуется обновлять DBML-файл, чтобы он отражал эти изменения.</span><span class="sxs-lookup"><span data-stu-id="a108d-124">When your database changes, you will need to update your DBML file to reflect those changes.</span></span> <span data-ttu-id="a108d-125">Один из способов реализации этого состоит в автоматическом создании нового DBML-файла и последующем повторном выполнении настройки сопоставления типов.</span><span class="sxs-lookup"><span data-stu-id="a108d-125">One way to do this is to automatically create a new DBML file and then re-do your type mapping customizations.</span></span> <span data-ttu-id="a108d-126">Альтернативный способ заключается в сравнении различий между новым файлом DBML и настроенным файлом DBML и последующем обновлении вручную настроенного DBML-файла, чтобы он отражал изменения базы данных.</span><span class="sxs-lookup"><span data-stu-id="a108d-126">Alternatively, you could compare the differences between your new DBML file and your customized DBML file and update your custom DBML file manually to reflect the database change.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a108d-127">См. также</span><span class="sxs-lookup"><span data-stu-id="a108d-127">See Also</span></span>  
 [<span data-ttu-id="a108d-128">Сопоставление типов SQL-CLR</span><span class="sxs-lookup"><span data-stu-id="a108d-128">SQL-CLR Type Mapping</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/sql-clr-type-mapping.md)  
 [<span data-ttu-id="a108d-129">Создание кода в LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="a108d-129">Code Generation in LINQ to SQL</span></span>](../../../../../../docs/framework/data/adonet/sql/linq/code-generation-in-linq-to-sql.md)
