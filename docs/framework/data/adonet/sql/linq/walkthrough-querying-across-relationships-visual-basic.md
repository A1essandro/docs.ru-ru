---
title: "Пошаговое руководство. Выполнение запросов со связями (Visual Basic) | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework-4.6"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-ado"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: a7da43e3-769f-4e07-bcd6-552b8bde66f4
caps.latest.revision: 2
author: "JennieHubbard"
ms.author: "jhubbard"
manager: "jhubbard"
caps.handback.revision: 2
---
# Пошаговое руководство. Выполнение запросов со связями (Visual Basic)
В данном пошаговом руководстве демонстрируется использование *ассоциаций* [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] для представления связей внешних ключей в базе данных.  
  
 [!INCLUDE[note_settings_general](../../../../../../includes/note-settings-general-md.md)]  
  
 Это пошаговое руководство было написано с помощью параметров разработки Visual Basic.  
  
## Обязательные компоненты  
 Необходимо выполнить [Пошаговое руководство. Простая модель объектов и простой запрос \(Visual Basic\) \(LINQ to SQL\).](../../../../../../docs/framework/data/adonet/sql/linq/walkthrough-simple-object-model-and-query-visual-basic.md).  На этом пошаговом руководстве основано руководство, описываемое в данном разделе. В частности на компьютере должен иметься файл northwnd.mdf в папке c:\\linqtest.  
  
## Обзор  
 Данное пошаговое руководство состоит из трех основных задач.  
  
-   Добавление класса сущности, который представляет таблицу "Orders" в базе данных "Northwind".  
  
-   Добавление примечаний к классу `Customer`, чтобы расширить связи между классами `Customer` и `Order`.  
  
-   Создание и выполнение запроса для тестирования процесса получения сведений класса `Order` с помощью класса `Customer`.  
  
## Сопоставление связей между таблицами  
 После определения класса `Customer` создайте определение класса сущностей `Order`, включающее следующий код, который указывает, что свойство `Orders.Customer` связано как внешний ключ со свойством `Customers.CustomerID`.  
  
#### Добавление класса сущностей "Order"  
  
-   Введите или вставьте следующий код после определения класса `Customer`.  
  
     [!code-vb[DLinqWalk2VB#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk2VB/vb/Module1.vb#1)]  
  
## Добавление примечаний к классу "Customer"  
 На этом этапе добавляются примечания к классу `Customer`, чтобы указать его связь с классом `Order`.  \(Это добавление не является обязательным, поскольку для создания связи достаточно создать определение связи в любом направлении.  Однако добавление этого примечания позволит с легкостью переходить по объектам в любом направлении.\)  
  
#### Добавление примечаний к классу "Customer"  
  
-   Введите или вставьте следующий код в класс `Customer`.  
  
     [!code-vb[DLinqWalk2VB#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk2VB/vb/Module1.vb#2)]  
  
## Создание и выполнение запроса в рамках связи "Customer\-Order"  
 Теперь можно получить доступ к объектам `Order` непосредственно из объектов `Customer` или в обратном направлении.  *Объединять* явным образом клиентов и заказы не требуется.  
  
#### Получение доступа к объектам "Order" с помощью объектов "Customer"  
  
1.  Измените метод `Sub Main` посредством ввода или вставки в метод следующего кода:  
  
     [!code-vb[DLinqWalk2VB#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk2VB/vb/Module1.vb#3)]  
  
2.  Нажмите клавишу F5, чтобы начать отладку приложения.  
  
     В окне сообщения отобразятся два имени, и в окне "Консоль" появится созданный код SQL.  
  
3.  Закройте окно сообщения, чтобы остановить отладку.  
  
## Создание строго типизированного представления базы данных  
 Общая процедура становится гораздо проще, если в начале использовать строго типизированное представление базы данных.  Задавая строгую типизацию объекта <xref:System.Data.Linq.DataContext>, можно избежать вызовов метода <xref:System.Data.Linq.DataContext.GetTable%2A>.  Строго типизированные таблицы можно использовать в запросах только при использовании строго типизированного объекта <xref:System.Data.Linq.DataContext>.  
  
 В представленных ниже шагах создается объект `Customers` в качестве строго типизированной таблицы, которая сопоставляется с таблицей "Customers" в базе данных.  
  
#### Установка строгой типизации объекта "DataContext"  
  
1.  Добавьте следующий код непосредственно перед объявлением класса `Customer`.  
  
     [!code-vb[DLinqWalk2VB#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk2VB/vb/Module1.vb#4)]  
  
2.  Измените метод `Sub Main`, чтобы использовать строго типизированный объект <xref:System.Data.Linq.DataContext>, как показано ниже:  
  
     [!code-vb[DLinqWalk2VB#5](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqWalk2VB/vb/Module1.vb#5)]  
  
3.  Нажмите клавишу F5, чтобы начать отладку приложения.  
  
     В окне «Консоль"» отобразится следующее.  
  
     `ID=WHITC`  
  
4.  Чтобы закрыть приложение, в окне "Консоль" нажмите клавишу ВВОД.  
  
5.  Если требуется сохранить приложение, в меню **Файл** выберите команду **Сохранить все**.  
  
## Следующие действия  
 В следующем пошаговом руководстве \([Пошаговое руководство. Обработка данных \(Visual Basic\)](../../../../../../docs/framework/data/adonet/sql/linq/walkthrough-manipulating-data-visual-basic.md)\) демонстрируется управление данными.  Для этого пошагового руководства не требуется сохранять два пошаговых руководства, которые уже выполнены в этой серии.  
  
## См. также  
 [Обучение с помощью пошаговых руководств](../../../../../../docs/framework/data/adonet/sql/linq/learning-by-walkthroughs.md)