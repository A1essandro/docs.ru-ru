---
title: "Настройка параметров и типы данных параметров"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-ado
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
caps.latest.revision: "6"
author: JennieHubbard
ms.author: jhubbard
manager: jhubbard
ms.openlocfilehash: 9119b6db6b1d3c2099af3c7bdbe042ced4dca94e
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="c2dfb-102">Настройка параметров и типы данных параметров</span><span class="sxs-lookup"><span data-stu-id="c2dfb-102">Configuring Parameters and Parameter Data Types</span></span>
<span data-ttu-id="c2dfb-103">Объекты команды используют параметры для передачи значений в выражения SQL или хранимые процедуры, обеспечивая проверку типов и правильности.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="c2dfb-104">В отличие от текста команд, входные параметры обрабатываются как буквенные значения, а не как исполняемый код.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="c2dfb-105">Это помогает защищаться от атак путем внедрения кода SQL, при которых злоумышленник вставляет в инструкцию SQL команду, ставящую под угрозу безопасность сервера.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>  
  
 <span data-ttu-id="c2dfb-106">Параметризованные команды также позволяют повысить производительность при выполнении запроса, поскольку при их использовании сервер баз данных может точно сопоставить входящей команде правильный кэшированных план запроса.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="c2dfb-107">Дополнительные сведения см. в разделах [Кэширование и повторное использование плана выполнения](http://go.microsoft.com/fwlink/?LinkId=120424) и [Повторное использование параметров и плана выполнения](http://go.microsoft.com/fwlink/?LinkId=120423) электронной документации по SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-107">For more information, see [Execution Plan Caching and Reuse](http://go.microsoft.com/fwlink/?LinkId=120424) and [Parameters and Execution Plan Reuse](http://go.microsoft.com/fwlink/?LinkId=120423) in SQL Server Books Online.</span></span> <span data-ttu-id="c2dfb-108">Помимо повышения безопасности и производительности параметризованные команды обеспечивают удобный метод организации значений, передающихся в источник данных.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>  
  
 <span data-ttu-id="c2dfb-109">Объект <xref:System.Data.Common.DbParameter> можно создать при помощи конструктора или путем добавления его в коллекцию <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> с помощью метода `Add` коллекции <xref:System.Data.Common.DbParameterCollection> .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="c2dfb-110">Метод `Add` принимает в качестве входных данных либо аргументы конструктора, либо существующий объект параметра - в зависимости от поставщика данных.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>  
  
## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="c2dfb-111">Указание свойства ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="c2dfb-111">Supplying the ParameterDirection Property</span></span>  
 <span data-ttu-id="c2dfb-112">При добавлении параметров необходимо указать свойство <xref:System.Data.ParameterDirection> для параметров, не являющихся входными.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="c2dfb-113">В следующей таблице показаны значения `ParameterDirection` , которые можно использовать с перечислением <xref:System.Data.ParameterDirection> .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>  
  
|<span data-ttu-id="c2dfb-114">Имя члена</span><span class="sxs-lookup"><span data-stu-id="c2dfb-114">Member name</span></span>|<span data-ttu-id="c2dfb-115">Описание</span><span class="sxs-lookup"><span data-stu-id="c2dfb-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="c2dfb-116">Параметр является входным.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-116">The parameter is an input parameter.</span></span> <span data-ttu-id="c2dfb-117">Это значение по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-117">This is the default.</span></span>|  
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="c2dfb-118">Параметр можно использовать как для ввода, так и для вывода.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-118">The parameter can perform both input and output.</span></span>|  
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="c2dfb-119">Параметр является выходным.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-119">The parameter is an output parameter.</span></span>|  
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="c2dfb-120">Параметр представляет значение, возвращаемое как результат операции, например хранимой процедуры, встроенной функции или определяемой пользователем функции.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|  
  
## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="c2dfb-121">Работа с местозаполнителями параметров</span><span class="sxs-lookup"><span data-stu-id="c2dfb-121">Working with Parameter Placeholders</span></span>  
 <span data-ttu-id="c2dfb-122">Синтаксис местозаполнителей параметров зависит от источника данных.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="c2dfb-123">Для поставщиков данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] используются разные способы задания имен и указания параметров и их местозаполнителей.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-123">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="c2dfb-124">Синтаксис зависит от конкретного источника данных, как описано в следующей таблице.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-124">This syntax is customized to a specific data source, as described in the following table.</span></span>  
  
|<span data-ttu-id="c2dfb-125">Поставщик данных</span><span class="sxs-lookup"><span data-stu-id="c2dfb-125">Data provider</span></span>|<span data-ttu-id="c2dfb-126">Синтаксис именования параметров</span><span class="sxs-lookup"><span data-stu-id="c2dfb-126">Parameter naming syntax</span></span>|  
|-------------------|-----------------------------|  
|<xref:System.Data.SqlClient>|<span data-ttu-id="c2dfb-127">Использует именованные параметры в формате `@`*имяпараметра*.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-127">Uses named parameters in the format `@`*parametername*.</span></span>|  
|<xref:System.Data.OleDb>|<span data-ttu-id="c2dfb-128">Использует маркеры позиционных параметров, указываемые знаком вопроса (`?`).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.Odbc>|<span data-ttu-id="c2dfb-129">Использует маркеры позиционных параметров, указываемые знаком вопроса (`?`).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|  
|<xref:System.Data.OracleClient>|<span data-ttu-id="c2dfb-130">Использует именованные параметры в формате `:`*имяпараметра* (или *имяпараметра*).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|  
  
## <a name="specifying-parameter-data-types"></a><span data-ttu-id="c2dfb-131">Указание типов данных параметров</span><span class="sxs-lookup"><span data-stu-id="c2dfb-131">Specifying Parameter Data Types</span></span>  
 <span data-ttu-id="c2dfb-132">Тип данных параметра зависит от поставщика данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-132">The data type of a parameter is specific to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider.</span></span> <span data-ttu-id="c2dfb-133">При указании типа значение `Parameter` преобразуется в тип поставщика данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] до передачи значения в источник данных.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-133">Specifying the type converts the value of the `Parameter` to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type before passing the value to the data source.</span></span> <span data-ttu-id="c2dfb-134">Можно также указать тип `Parameter` универсальным способом, задав свойству `DbType` объекта `Parameter` определенное значение <xref:System.Data.DbType>.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>  
  
 <span data-ttu-id="c2dfb-135">Тип поставщика данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] объекта `Parameter` выводится из типа [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] значения `Value` объекта `Parameter` или из `DbType` объекта `Parameter` .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-135">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data provider type of a `Parameter` object is inferred from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="c2dfb-136">Следующая таблица показывает тип `Parameter` , выводимый из объекта, переданного как значение `Parameter` , или указанного значения `DbType`.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>  
  
|<span data-ttu-id="c2dfb-137">Тип платформы .NET Framework</span><span class="sxs-lookup"><span data-stu-id="c2dfb-137">.NET Framework type</span></span>|<span data-ttu-id="c2dfb-138">DbType</span><span class="sxs-lookup"><span data-stu-id="c2dfb-138">DbType</span></span>|<span data-ttu-id="c2dfb-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="c2dfb-139">SqlDbType</span></span>|<span data-ttu-id="c2dfb-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="c2dfb-140">OleDbType</span></span>|<span data-ttu-id="c2dfb-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="c2dfb-141">OdbcType</span></span>|<span data-ttu-id="c2dfb-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="c2dfb-142">OracleType</span></span>|  
|-------------------------|------------|---------------|---------------|--------------|----------------|  
|<xref:System.Boolean>|<span data-ttu-id="c2dfb-143">Boolean</span><span class="sxs-lookup"><span data-stu-id="c2dfb-143">Boolean</span></span>|<span data-ttu-id="c2dfb-144">Разряд</span><span class="sxs-lookup"><span data-stu-id="c2dfb-144">Bit</span></span>|<span data-ttu-id="c2dfb-145">Boolean</span><span class="sxs-lookup"><span data-stu-id="c2dfb-145">Boolean</span></span>|<span data-ttu-id="c2dfb-146">Разряд</span><span class="sxs-lookup"><span data-stu-id="c2dfb-146">Bit</span></span>|<span data-ttu-id="c2dfb-147">Byte</span><span class="sxs-lookup"><span data-stu-id="c2dfb-147">Byte</span></span>|  
|<xref:System.Byte>|<span data-ttu-id="c2dfb-148">Byte</span><span class="sxs-lookup"><span data-stu-id="c2dfb-148">Byte</span></span>|<span data-ttu-id="c2dfb-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-149">TinyInt</span></span>|<span data-ttu-id="c2dfb-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-150">UnsignedTinyInt</span></span>|<span data-ttu-id="c2dfb-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-151">TinyInt</span></span>|<span data-ttu-id="c2dfb-152">Byte</span><span class="sxs-lookup"><span data-stu-id="c2dfb-152">Byte</span></span>|  
|<span data-ttu-id="c2dfb-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="c2dfb-153">byte[]</span></span>|<span data-ttu-id="c2dfb-154">Binary</span><span class="sxs-lookup"><span data-stu-id="c2dfb-154">Binary</span></span>|<span data-ttu-id="c2dfb-155">VarBinary`.` это неявное преобразование завершится ошибкой, если массив байтов больше, чем максимальный размер varbinary, который составляет 8000 байт. Байтовые массивы, размер которых превышает 8000 байт, явно задать <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-155">VarBinary`.` This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="c2dfb-156">VarBinary</span><span class="sxs-lookup"><span data-stu-id="c2dfb-156">VarBinary</span></span>|<span data-ttu-id="c2dfb-157">Binary</span><span class="sxs-lookup"><span data-stu-id="c2dfb-157">Binary</span></span>|<span data-ttu-id="c2dfb-158">Raw</span><span class="sxs-lookup"><span data-stu-id="c2dfb-158">Raw</span></span>|  
|<xref:System.Char>|``|<span data-ttu-id="c2dfb-159">Вывод типа <xref:System.Data.SqlDbType> из типа char не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-159">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="c2dfb-160">Char</span><span class="sxs-lookup"><span data-stu-id="c2dfb-160">Char</span></span>|<span data-ttu-id="c2dfb-161">Char</span><span class="sxs-lookup"><span data-stu-id="c2dfb-161">Char</span></span>|<span data-ttu-id="c2dfb-162">Byte</span><span class="sxs-lookup"><span data-stu-id="c2dfb-162">Byte</span></span>|  
|<xref:System.DateTime>|<span data-ttu-id="c2dfb-163">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-163">DateTime</span></span>|<span data-ttu-id="c2dfb-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-164">DateTime</span></span>|<span data-ttu-id="c2dfb-165">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="c2dfb-165">DBTimeStamp</span></span>|<span data-ttu-id="c2dfb-166">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-166">DateTime</span></span>|<span data-ttu-id="c2dfb-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-167">DateTime</span></span>|  
|<xref:System.DateTimeOffset>|<span data-ttu-id="c2dfb-168">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="c2dfb-168">DateTimeOffset</span></span>|<span data-ttu-id="c2dfb-169">Тип DateTimeOffset в SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-169">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="c2dfb-170">Вывод типа <xref:System.Data.SqlDbType> из типа DateTimeOffset не поддерживается в версиях SQL Server до SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-170">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="c2dfb-171">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-171">DateTime</span></span>|  
|<xref:System.Decimal>|<span data-ttu-id="c2dfb-172">Десятичное число</span><span class="sxs-lookup"><span data-stu-id="c2dfb-172">Decimal</span></span>|<span data-ttu-id="c2dfb-173">Десятичное число</span><span class="sxs-lookup"><span data-stu-id="c2dfb-173">Decimal</span></span>|<span data-ttu-id="c2dfb-174">Десятичное число</span><span class="sxs-lookup"><span data-stu-id="c2dfb-174">Decimal</span></span>|<span data-ttu-id="c2dfb-175">Numeric</span><span class="sxs-lookup"><span data-stu-id="c2dfb-175">Numeric</span></span>|<span data-ttu-id="c2dfb-176">Числовой</span><span class="sxs-lookup"><span data-stu-id="c2dfb-176">Number</span></span>|  
|<xref:System.Double>|<span data-ttu-id="c2dfb-177">Double</span><span class="sxs-lookup"><span data-stu-id="c2dfb-177">Double</span></span>|<span data-ttu-id="c2dfb-178">Float</span><span class="sxs-lookup"><span data-stu-id="c2dfb-178">Float</span></span>|<span data-ttu-id="c2dfb-179">Double</span><span class="sxs-lookup"><span data-stu-id="c2dfb-179">Double</span></span>|<span data-ttu-id="c2dfb-180">Double</span><span class="sxs-lookup"><span data-stu-id="c2dfb-180">Double</span></span>|<span data-ttu-id="c2dfb-181">Double</span><span class="sxs-lookup"><span data-stu-id="c2dfb-181">Double</span></span>|  
|<xref:System.Single>|<span data-ttu-id="c2dfb-182">Single</span><span class="sxs-lookup"><span data-stu-id="c2dfb-182">Single</span></span>|<span data-ttu-id="c2dfb-183">Real</span><span class="sxs-lookup"><span data-stu-id="c2dfb-183">Real</span></span>|<span data-ttu-id="c2dfb-184">Single</span><span class="sxs-lookup"><span data-stu-id="c2dfb-184">Single</span></span>|<span data-ttu-id="c2dfb-185">Real</span><span class="sxs-lookup"><span data-stu-id="c2dfb-185">Real</span></span>|<span data-ttu-id="c2dfb-186">Float</span><span class="sxs-lookup"><span data-stu-id="c2dfb-186">Float</span></span>|  
|<xref:System.Guid>|<span data-ttu-id="c2dfb-187">Guid</span><span class="sxs-lookup"><span data-stu-id="c2dfb-187">Guid</span></span>|<span data-ttu-id="c2dfb-188">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="c2dfb-188">UniqueIdentifier</span></span>|<span data-ttu-id="c2dfb-189">Guid</span><span class="sxs-lookup"><span data-stu-id="c2dfb-189">Guid</span></span>|<span data-ttu-id="c2dfb-190">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="c2dfb-190">UniqueIdentifier</span></span>|<span data-ttu-id="c2dfb-191">Raw</span><span class="sxs-lookup"><span data-stu-id="c2dfb-191">Raw</span></span>|  
|<xref:System.Int16 >|<span data-ttu-id="c2dfb-192">Int16</span><span class="sxs-lookup"><span data-stu-id="c2dfb-192">Int16</span></span>|<span data-ttu-id="c2dfb-193">SmallInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-193">SmallInt</span></span>|<span data-ttu-id="c2dfb-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-194">SmallInt</span></span>|<span data-ttu-id="c2dfb-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-195">SmallInt</span></span>|<span data-ttu-id="c2dfb-196">Int16</span><span class="sxs-lookup"><span data-stu-id="c2dfb-196">Int16</span></span>|  
|<xref:System.Int32>|<span data-ttu-id="c2dfb-197">Int32</span><span class="sxs-lookup"><span data-stu-id="c2dfb-197">Int32</span></span>|<span data-ttu-id="c2dfb-198">Int</span><span class="sxs-lookup"><span data-stu-id="c2dfb-198">Int</span></span>|<span data-ttu-id="c2dfb-199">Int</span><span class="sxs-lookup"><span data-stu-id="c2dfb-199">Int</span></span>|<span data-ttu-id="c2dfb-200">Int</span><span class="sxs-lookup"><span data-stu-id="c2dfb-200">Int</span></span>|<span data-ttu-id="c2dfb-201">Int32</span><span class="sxs-lookup"><span data-stu-id="c2dfb-201">Int32</span></span>|  
|<xref:System.Int64>|<span data-ttu-id="c2dfb-202">Int64</span><span class="sxs-lookup"><span data-stu-id="c2dfb-202">Int64</span></span>|<span data-ttu-id="c2dfb-203">BigInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-203">BigInt</span></span>|<span data-ttu-id="c2dfb-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-204">BigInt</span></span>|<span data-ttu-id="c2dfb-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-205">BigInt</span></span>|<span data-ttu-id="c2dfb-206">Числовой</span><span class="sxs-lookup"><span data-stu-id="c2dfb-206">Number</span></span>|  
|<xref:System.Object>|<span data-ttu-id="c2dfb-207">Объект</span><span class="sxs-lookup"><span data-stu-id="c2dfb-207">Object</span></span>|<span data-ttu-id="c2dfb-208">Вариант</span><span class="sxs-lookup"><span data-stu-id="c2dfb-208">Variant</span></span>|<span data-ttu-id="c2dfb-209">Вариант</span><span class="sxs-lookup"><span data-stu-id="c2dfb-209">Variant</span></span>|<span data-ttu-id="c2dfb-210">Вывод типа OdbcType из типа Object не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-210">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="c2dfb-211">Blob</span><span class="sxs-lookup"><span data-stu-id="c2dfb-211">Blob</span></span>|  
|<xref:System.String>|<span data-ttu-id="c2dfb-212">Строка</span><span class="sxs-lookup"><span data-stu-id="c2dfb-212">String</span></span>|<span data-ttu-id="c2dfb-213">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-213">NVarChar.</span></span> <span data-ttu-id="c2dfb-214">Это неявное преобразование завершится ошибкой, если строка превышает максимальный размер для типа NVarChar (4000 символов).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-214">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="c2dfb-215">Для строк длиннее 4000 символов явно установите значение <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-215">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="c2dfb-216">VarWChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-216">VarWChar</span></span>|<span data-ttu-id="c2dfb-217">NVarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-217">NVarChar</span></span>|<span data-ttu-id="c2dfb-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-218">NVarChar</span></span>|  
|<xref:System.TimeSpan>|<span data-ttu-id="c2dfb-219">Время</span><span class="sxs-lookup"><span data-stu-id="c2dfb-219">Time</span></span>|<span data-ttu-id="c2dfb-220">Тип Time в SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-220">Time in SQL Server 2008.</span></span> <span data-ttu-id="c2dfb-221">Вывод типа <xref:System.Data.SqlDbType> из типа TimeSpan не поддерживается в версиях SQL Server до SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-221">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="c2dfb-222">DBTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-222">DBTime</span></span>|<span data-ttu-id="c2dfb-223">Время</span><span class="sxs-lookup"><span data-stu-id="c2dfb-223">Time</span></span>|<span data-ttu-id="c2dfb-224">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-224">DateTime</span></span>|  
|<xref:System.UInt16>|<span data-ttu-id="c2dfb-225">UInt16</span><span class="sxs-lookup"><span data-stu-id="c2dfb-225">UInt16</span></span>|<span data-ttu-id="c2dfb-226">Вывод типа <xref:System.Data.SqlDbType> из типа UInt16 не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-226">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="c2dfb-227">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-227">UnsignedSmallInt</span></span>|<span data-ttu-id="c2dfb-228">Int</span><span class="sxs-lookup"><span data-stu-id="c2dfb-228">Int</span></span>|<span data-ttu-id="c2dfb-229">UInt16</span><span class="sxs-lookup"><span data-stu-id="c2dfb-229">UInt16</span></span>|  
|<xref:System.UInt32>|<span data-ttu-id="c2dfb-230">UInt32</span><span class="sxs-lookup"><span data-stu-id="c2dfb-230">UInt32</span></span>|<span data-ttu-id="c2dfb-231">Вывод типа <xref:System.Data.SqlDbType> из типа UInt32 не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-231">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="c2dfb-232">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-232">UnsignedInt</span></span>|<span data-ttu-id="c2dfb-233">BigInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-233">BigInt</span></span>|<span data-ttu-id="c2dfb-234">UInt32</span><span class="sxs-lookup"><span data-stu-id="c2dfb-234">UInt32</span></span>|  
|<xref:System.UInt64>|<span data-ttu-id="c2dfb-235">UInt64</span><span class="sxs-lookup"><span data-stu-id="c2dfb-235">UInt64</span></span>|<span data-ttu-id="c2dfb-236">Вывод типа <xref:System.Data.SqlDbType> из типа UInt64 не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-236">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="c2dfb-237">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-237">UnsignedBigInt</span></span>|<span data-ttu-id="c2dfb-238">Numeric</span><span class="sxs-lookup"><span data-stu-id="c2dfb-238">Numeric</span></span>|<span data-ttu-id="c2dfb-239">Числовой</span><span class="sxs-lookup"><span data-stu-id="c2dfb-239">Number</span></span>|  
||<span data-ttu-id="c2dfb-240">AnsiString</span><span class="sxs-lookup"><span data-stu-id="c2dfb-240">AnsiString</span></span>|<span data-ttu-id="c2dfb-241">VarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-241">VarChar</span></span>|<span data-ttu-id="c2dfb-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-242">VarChar</span></span>|<span data-ttu-id="c2dfb-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-243">VarChar</span></span>|<span data-ttu-id="c2dfb-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-244">VarChar</span></span>|  
||<span data-ttu-id="c2dfb-245">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="c2dfb-245">AnsiStringFixedLength</span></span>|<span data-ttu-id="c2dfb-246">Char</span><span class="sxs-lookup"><span data-stu-id="c2dfb-246">Char</span></span>|<span data-ttu-id="c2dfb-247">Char</span><span class="sxs-lookup"><span data-stu-id="c2dfb-247">Char</span></span>|<span data-ttu-id="c2dfb-248">Char</span><span class="sxs-lookup"><span data-stu-id="c2dfb-248">Char</span></span>|<span data-ttu-id="c2dfb-249">Char</span><span class="sxs-lookup"><span data-stu-id="c2dfb-249">Char</span></span>|  
|``|<span data-ttu-id="c2dfb-250">Валюта</span><span class="sxs-lookup"><span data-stu-id="c2dfb-250">Currency</span></span>|<span data-ttu-id="c2dfb-251">Money</span><span class="sxs-lookup"><span data-stu-id="c2dfb-251">Money</span></span>|<span data-ttu-id="c2dfb-252">Валюта</span><span class="sxs-lookup"><span data-stu-id="c2dfb-252">Currency</span></span>|<span data-ttu-id="c2dfb-253">Вывод типа `OdbcType` из типа `Currency` не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-253">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="c2dfb-254">Числовой</span><span class="sxs-lookup"><span data-stu-id="c2dfb-254">Number</span></span>|  
|``|<span data-ttu-id="c2dfb-255">Дата</span><span class="sxs-lookup"><span data-stu-id="c2dfb-255">Date</span></span>|<span data-ttu-id="c2dfb-256">Тип Date в SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-256">Date in SQL Server 2008.</span></span> <span data-ttu-id="c2dfb-257">Вывод типа <xref:System.Data.SqlDbType> из типа Date не поддерживается в версиях SQL Server до SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-257">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="c2dfb-258">DBDate</span><span class="sxs-lookup"><span data-stu-id="c2dfb-258">DBDate</span></span>|<span data-ttu-id="c2dfb-259">Дата</span><span class="sxs-lookup"><span data-stu-id="c2dfb-259">Date</span></span>|<span data-ttu-id="c2dfb-260">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-260">DateTime</span></span>|  
|``|<span data-ttu-id="c2dfb-261">SByte</span><span class="sxs-lookup"><span data-stu-id="c2dfb-261">SByte</span></span>|<span data-ttu-id="c2dfb-262">Вывод типа <xref:System.Data.SqlDbType> из типа SByte не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-262">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="c2dfb-263">TinyInt</span><span class="sxs-lookup"><span data-stu-id="c2dfb-263">TinyInt</span></span>|<span data-ttu-id="c2dfb-264">Вывод типа `OdbcType` из типа SByte не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-264">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="c2dfb-265">SByte</span><span class="sxs-lookup"><span data-stu-id="c2dfb-265">SByte</span></span>|  
||<span data-ttu-id="c2dfb-266">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="c2dfb-266">StringFixedLength</span></span>|<span data-ttu-id="c2dfb-267">NChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-267">NChar</span></span>|<span data-ttu-id="c2dfb-268">WChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-268">WChar</span></span>|<span data-ttu-id="c2dfb-269">NChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-269">NChar</span></span>|<span data-ttu-id="c2dfb-270">NChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-270">NChar</span></span>|  
||<span data-ttu-id="c2dfb-271">Время</span><span class="sxs-lookup"><span data-stu-id="c2dfb-271">Time</span></span>|<span data-ttu-id="c2dfb-272">Тип Time в SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-272">Time in SQL Server 2008.</span></span> <span data-ttu-id="c2dfb-273">Вывод типа <xref:System.Data.SqlDbType> из типа Time не поддерживается в версиях SQL Server до SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-273">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="c2dfb-274">DBTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-274">DBTime</span></span>|<span data-ttu-id="c2dfb-275">Время</span><span class="sxs-lookup"><span data-stu-id="c2dfb-275">Time</span></span>|<span data-ttu-id="c2dfb-276">DateTime</span><span class="sxs-lookup"><span data-stu-id="c2dfb-276">DateTime</span></span>|  
||<span data-ttu-id="c2dfb-277">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="c2dfb-277">VarNumeric</span></span>|<span data-ttu-id="c2dfb-278">Вывод типа <xref:System.Data.SqlDbType> из типа VarNumeric не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-278">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="c2dfb-279">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="c2dfb-279">VarNumeric</span></span>|<span data-ttu-id="c2dfb-280">Вывод типа `OdbcType` из типа VarNumeric не поддерживается.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-280">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="c2dfb-281">Числовой</span><span class="sxs-lookup"><span data-stu-id="c2dfb-281">Number</span></span>|  
|<span data-ttu-id="c2dfb-282">определяемый пользователем тип (объект с <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span><span class="sxs-lookup"><span data-stu-id="c2dfb-282">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="c2dfb-283">Объект или строка в зависимости от поставщика (SqlClient всегда возвращает объект, ODBC всегда возвращает строку, а поставщик данных, управляемый OleDb, может вернуть и то и другое).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-283">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="c2dfb-284">SqlDbType.Udt, если присутствует <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> , в противном случае Variant</span><span class="sxs-lookup"><span data-stu-id="c2dfb-284">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="c2dfb-285">OleDbType.VarWChar (при значении NULL), в противном случае OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-285">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="c2dfb-286">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="c2dfb-286">OdbcType.NVarChar</span></span>|<span data-ttu-id="c2dfb-287">не поддерживается</span><span class="sxs-lookup"><span data-stu-id="c2dfb-287">not supported</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="c2dfb-288">Преобразования из типа decimal в другие типы являются сужающими. Они округляют десятичное значение до ближайшего целого в направлении нуля.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-288">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="c2dfb-289">Если результат преобразования нельзя представить в целевом типе, возникает исключение <xref:System.OverflowException> .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-289">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c2dfb-290">При передаче на сервер значения null в качестве параметра необходимо указать значение <xref:System.DBNull>, а не `null` (`Nothing` в [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-290">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in [!INCLUDE[vbprvb](../../../../includes/vbprvb-md.md)]).</span></span> <span data-ttu-id="c2dfb-291">В системе значение null - это пустой объект, не имеющий значения.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-291">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="c2dfb-292">Для представления значений null используется тип<xref:System.DBNull> .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-292"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="c2dfb-293">Дополнительные сведения о значении NULL базы данных см. в разделе [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-293">For more information about database nulls, see [Handling Null Values](../../../../docs/framework/data/adonet/sql/handling-null-values.md).</span></span>  
  
## <a name="deriving-parameter-information"></a><span data-ttu-id="c2dfb-294">Выведение информации о параметрах</span><span class="sxs-lookup"><span data-stu-id="c2dfb-294">Deriving Parameter Information</span></span>  
 <span data-ttu-id="c2dfb-295">Информацию о параметрах можно вывести из хранимой процедуры с помощью класса `DbCommandBuilder` .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-295">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="c2dfb-296">Оба класса, `SqlCommandBuilder` и `OleDbCommandBuilder` , обеспечивают статический метод `DeriveParameters`, который автоматически заполняет коллекцию параметров объекта команд, использующего информацию о параметрах от хранимой процедуры.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-296">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="c2dfb-297">Обратите внимание, что метод `DeriveParameters` перезаписывает существующую информацию о параметрах для команды.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-297">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c2dfb-298">Выведение информации о параметрах снижает производительность, так как для этого требуется дополнительный обмен данных с источником данных.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-298">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="c2dfb-299">Если информация о параметрах известна во время разработки, можно увеличить производительность приложения, задав параметры явным образом.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-299">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>  
  
 <span data-ttu-id="c2dfb-300">Дополнительные сведения см. в разделе [создание команд с помощью построителей команд](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-300">For more information, see [Generating Commands with CommandBuilders](../../../../docs/framework/data/adonet/generating-commands-with-commandbuilders.md).</span></span>  
  
## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="c2dfb-301">Использование параметров с объектом SqlCommand и хранимой процедурой</span><span class="sxs-lookup"><span data-stu-id="c2dfb-301">Using Parameters with a SqlCommand and a Stored Procedure</span></span>  
 <span data-ttu-id="c2dfb-302">Хранимые процедуры дают множество преимуществ в приложениях, управляемых данными.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-302">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="c2dfb-303">С помощью хранимых процедур операции с базой данных можно инкапсулировать в одну команду, оптимизированную для производительности и обладающую повышенной безопасностью.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-303">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="c2dfb-304">Хотя хранимые процедуры можно вызывать и с помощью инструкции SQL, указывая в ней имя процедуры и ее аргументы, использование коллекции <xref:System.Data.Common.DbCommand.Parameters%2A> объекта [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] в <xref:System.Data.Common.DbCommand> позволяет более явно задать параметры процедуры, а также обращаться к выходным параметрам и возвращаемым значениям.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-304">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c2dfb-305">Параметризованные инструкции выполняются на сервере с помощью хранимой процедуры `sp_executesql,` которая позволяет повторно использовать планы запросов.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-305">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="c2dfb-306">Локальные курсоры или переменные в пакете `sp_executesql` недоступны пакету, вызвавшему `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-306">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="c2dfb-307">Изменения в контексте базы данных длятся только до завершения выполнения инструкции `sp_executesql` .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-307">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="c2dfb-308">Дополнительные сведения см. в электронной документации по SQL Server.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-308">For more information, see SQL Server Books Online.</span></span>  
  
 <span data-ttu-id="c2dfb-309">Если параметры используются с объектом <xref:System.Data.SqlClient.SqlCommand> для выполнения хранимой процедуры SQL Server, то имена параметров, добавляемых в коллекцию <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> , должны соответствовать именам маркеров параметров в хранимой процедуре.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-309">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="c2dfb-310">Поставщик данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для SQL Server не поддерживает местозаполнитель (?) для передачи параметров в инструкции SQL и хранимые процедуры.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-310">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="c2dfb-311">Он обрабатывает параметры в хранимой процедуре как именованные параметры и ищет соответствующие маркеры параметров.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-311">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="c2dfb-312">Например, хранимая процедура `CustOrderHist` определяется с использованием параметра `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-312">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="c2dfb-313">Когда программа выполняет эта хранимую процедуру, она также должна использовать параметр `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-313">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>  
  
```  
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)  
```  
  
### <a name="example"></a><span data-ttu-id="c2dfb-314">Пример</span><span class="sxs-lookup"><span data-stu-id="c2dfb-314">Example</span></span>  
 <span data-ttu-id="c2dfb-315">Этот пример показывает, как вызвать хранимую процедуру SQL Server в образце базы данных `Northwind` .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-315">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="c2dfb-316">Имя хранимой процедуры – `dbo.SalesByCategory` . Она имеет входной параметр `@CategoryName` с типом данных `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-316">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="c2dfb-317">Код создает создает новый объект класса <xref:System.Data.SqlClient.SqlConnection> в блоке Using, чтобы в конце процедуры соединение удалялось.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-317">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="c2dfb-318">Создаются объекты <xref:System.Data.SqlClient.SqlCommand> и <xref:System.Data.SqlClient.SqlParameter> устанавливаются их свойства.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-318">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="c2dfb-319">Объект класса <xref:System.Data.SqlClient.SqlDataReader> выполняет `SqlCommand` и возвращает результирующий набор из хранимой процедуры, отображая выходные данные в окне консоли.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-319">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c2dfb-320">Вместо того, чтобы создавать объекты `SqlCommand` и `SqlParameter` и затем задавать их свойства в отдельных инструкциях, можно использовать один из перегруженных конструкторов и задать свойства в одной инструкции.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-320">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>  
  
 [!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
 [!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]  
  
## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="c2dfb-321">Использование параметров с OleDbCommand или OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="c2dfb-321">Using Parameters with an OleDbCommand or OdbcCommand</span></span>  
 <span data-ttu-id="c2dfb-322">Если с объектами <xref:System.Data.OleDb.OleDbCommand> или <xref:System.Data.Odbc.OdbcCommand>используются параметры, порядок параметров, добавляемых в коллекцию `Parameters` , должен соответствовать порядку параметров, заданных в хранимой процедуре.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-322">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="c2dfb-323">Поставщик данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для OLE DB и поставщик данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для ODBC обрабатывают параметры в хранимой процедуре как местозаполнители и применяют значения параметров в правильном порядке.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-323">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="c2dfb-324">Кроме того, параметры возвращаемых значений должны быть первыми параметрами, добавляемыми в коллекцию `Parameters` .</span><span class="sxs-lookup"><span data-stu-id="c2dfb-324">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>  
  
 <span data-ttu-id="c2dfb-325">Поставщик данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для OLE DB и поставщик данных [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] для ODBC не поддерживают именованные параметры для передачи параметров в инструкции SQL и хранимые процедуры.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-325">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for OLE DB and [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="c2dfb-326">В этом случае необходимо использовать местозаполнитель (?), как в следующем примере.</span><span class="sxs-lookup"><span data-stu-id="c2dfb-326">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>  
  
```  
SELECT * FROM Customers WHERE CustomerID = ?  
```  
  
 <span data-ttu-id="c2dfb-327">В результате порядок добавления объектов `Parameter` в коллекцию `Parameters` должен строго соответствовать позиции</span><span class="sxs-lookup"><span data-stu-id="c2dfb-327">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="c2dfb-328">местозаполнителя параметра (?).</span><span class="sxs-lookup"><span data-stu-id="c2dfb-328">placeholder for the parameter.</span></span>  
  
### <a name="oledb-example"></a><span data-ttu-id="c2dfb-329">Пример OleDb</span><span class="sxs-lookup"><span data-stu-id="c2dfb-329">OleDb Example</span></span>  
  
```vb  
Dim command As OleDbCommand = New OleDbCommand( _  
  "SampleProc", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OleDbParameter = command.Parameters.Add( _  
  "RETURN_VALUE", OleDbType.Integer)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OleDbType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OleDbType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OleDbCommand command = new OleDbCommand("SampleProc", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OleDbParameter parameter = command.Parameters.Add(  
  "RETURN_VALUE", OleDbType.Integer);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add(  
  "@InputParm", OleDbType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add(  
  "@OutputParm", OleDbType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="odbc-example"></a><span data-ttu-id="c2dfb-330">Пример Odbc</span><span class="sxs-lookup"><span data-stu-id="c2dfb-330">Odbc Example</span></span>  
  
```vb  
Dim command As OdbcCommand = New OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection)  
command.CommandType = CommandType.StoredProcedure  
  
Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)  
parameter.Direction = ParameterDirection.ReturnValue  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12)  
parameter.Value = "Sample Value"  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28)  
parameter.Direction = ParameterDirection.Output  
```  
  
```csharp  
OdbcCommand command = new OdbcCommand( _  
  "{ ? = CALL SampleProc(?, ?) }", connection);  
command.CommandType = CommandType.StoredProcedure;  
  
OdbcParameter parameter = command.Parameters.Add( _  
  "RETURN_VALUE", OdbcType.Int);  
parameter.Direction = ParameterDirection.ReturnValue;  
  
parameter = command.Parameters.Add( _  
  "@InputParm", OdbcType.VarChar, 12);  
parameter.Value = "Sample Value";  
  
parameter = command.Parameters.Add( _  
  "@OutputParm", OdbcType.VarChar, 28);  
parameter.Direction = ParameterDirection.Output;  
```  
  
## <a name="see-also"></a><span data-ttu-id="c2dfb-331">См. также</span><span class="sxs-lookup"><span data-stu-id="c2dfb-331">See Also</span></span>  
 [<span data-ttu-id="c2dfb-332">Команды и параметры</span><span class="sxs-lookup"><span data-stu-id="c2dfb-332">Commands and Parameters</span></span>](../../../../docs/framework/data/adonet/commands-and-parameters.md)  
 [<span data-ttu-id="c2dfb-333">Параметры DataAdapter</span><span class="sxs-lookup"><span data-stu-id="c2dfb-333">DataAdapter Parameters</span></span>](../../../../docs/framework/data/adonet/dataadapter-parameters.md)  
 [<span data-ttu-id="c2dfb-334">Сопоставления типов данных в ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c2dfb-334">Data Type Mappings in ADO.NET</span></span>](../../../../docs/framework/data/adonet/data-type-mappings-in-ado-net.md)  
 [<span data-ttu-id="c2dfb-335">Центр разработчиков наборов данных и управляемых поставщиков ADO.NET</span><span class="sxs-lookup"><span data-stu-id="c2dfb-335">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
