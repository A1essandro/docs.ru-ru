---
title: "Выбор и проверка сертификата | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
ms.assetid: c933aca2-4cd0-4ff1-9df9-267143f25a6f
caps.latest.revision: 15
author: "mcleblanc"
ms.author: "markl"
manager: "markl"
caps.handback.revision: 15
---
# Выбор и проверка сертификата
Классы <xref:System.Net> поддерживают несколько способов выбора и проверить <xref:System.Security.Cryptography.X509Certificates> уровня сокетов Безопасного соединения \(SSL\).  Клиент может выбрать один или несколько сертификатов для подтверждения своей подлинности при подключении к серверу.  Сервер может потребовать сертификат клиента имеет одно или несколько конкретных атрибуты для проверки подлинности.  
  
## Определение  
 Сертификат потока байтов ASCII, содержащий открытый ключ, атрибуты \(такие как номер версии, порядкового номера, и дата окончания\) и цифровую подпись из центра сертификации.  Сертификаты используются для установления зашифрованного соединения или проверить подлинность клиента к серверу.  
  
## Выделение и проверка сертификата клиента  
 Клиент может выбрать один или несколько сертификатов для конкретного соединения ssl.  Клиентские сертификаты могут быть связаны с ssl\-соединения на веб\-сервер или почтовому smtp\-серверу.  Клиент добавляет в коллекцию сертификатов <xref:System.Security.Cryptography.X509Certificates.X509Certificate> или объектов класса <xref:System.Security.Cryptography.X509Certificates.X509Certificate2>.  Использование электронной почте в качестве примера коллекция сертификатов экземпляр <xref:System.Security.Cryptography.X509Certificates.X509CertificateCollection>\), связанного со свойством <xref:System.Net.Mail.SmtpClient.ClientCertificates%2A> класса <xref:System.Net.Mail.SmtpClient>.  Класс <xref:System.Net.HttpWebRequest> имеет аналогичное свойство <xref:System.Net.HttpWebRequest.ClientCertificates%2A>.  
  
 Основным различием между <xref:System.Security.Cryptography.X509Certificates.X509Certificate> и классом <xref:System.Security.Cryptography.X509Certificates.X509Certificate2>, что закрытый ключ должен находиться в хранилище сертификатов для класса <xref:System.Security.Cryptography.X509Certificates.X509Certificate>.  
  
 Даже если сертификаты добавлены к коллекции и сопоставлены с конкретным ssl\-соединения, отсутствуют сертификаты не будут отправлены к серверу, если сервер не будут запрошены.  Если несколько клиентских сертификатов, установленных на соединение, то будет использоваться лучше всего одно на основе алгоритма, который проверяет соответствие между списком издателей сертификата, предоставленных сервером и имени поставщика сертификата клиента.  
  
 Класс <xref:System.Net.Security.SslStream> предоставляет еще более элемент управления над подтверждениями SSL.  Клиент может определить делегат для выбора, сертификат клиента, который будет использоваться.  
  
 Удаленный сервер может проверить, что сертификат клиента являются допустимыми, текущие и подписанный соответствующим центром сертификации.  Делегат можно добавить в <xref:System.Net.ServicePointManager.ServerCertificateValidationCallback%2A> для обеспечения проверки сертификата.  
  
## Выделение сертификата клиента  
 Платформа .NET Framework выберите сертификат клиента, чтобы представить на сервере следующим образом:  
  
1.  Если сертификат клиента заранее к серверу, то сертификат будет кэширован, когда сначала, представленный и повторно использован для последующих запросов для сертификата клиента.  
  
2.  Если делегат, то всегда используйте результат из делегата, как сертификат клиента для выбора.  Попробуйте использовать кэшированный сертификат, если возможно, но не использовать кэшированные учетные данные анонимного если делегат возвращал значение null, а коллекция сертификатов не пуста.  
  
3.  Если это первая возможность для сертификата клиента, то .NET Framework создает сертификаты в <xref:System.Security.Cryptography.X509Certificates.X509Certificate> или объекты класса <xref:System.Security.Cryptography.X509Certificates.X509Certificate2>, связанные с соединение, выполняя поиск соответствия между списком издателей сертификата, предоставленных сервером и имени поставщика сертификата клиента.  Первый сертификат, соответствующий переданы на сервер.  Если сертификат не соответствует сертификату или коллекция пуста, то анонимная учетные данные отправлена к серверу.  
  
## Средства для конфигурации сертификата  
 Несколько средств, доступных для конфигурации клиента и сертификат сервера.  
  
 Средство *Winhttpcertcfg.exe* можно использовать для настройки сертификатов клиента.  Средство *Winhttpcertcfg.exe* предоставляется в качестве одного из средств с дополнением 2003 ресурсов сервера Windows.  Это средство также доступен в качестве дополнения загрузки в составе средств 2003 ресурсов сервера Windows на www.microsoft.com.  
  
 Средство *HttpCfg.exe* можно использовать для настройки сертификаты сервера для класса <xref:System.Net.HttpListener>.  Средство *HttpCfg.exe* предоставляется в качестве одного из средств поддержки Windows и на сервер 2003 с пакетом обновления 2 \(sp2\); Windows XP.  *HttpCfg.exe* и другие средства поддержки установленного по умолчанию не является либо на сервере Windows 2003 или Windows XP.  На сервере Windows 2003.  средства поддержки установлены отдельно от следующей папке и хранятся на компакт\-диске 2003 сервера Windows:  
  
 \\Support\\Tools\\Suptools.msi  
  
 Для использования с пакетом обновления 2, Windows XP, средства поддержки Windows XP доступны как загрузить с узла www.microsoft.com.  
  
 Исходный код к версии средства *HttpCfg.exe* приведен пример того, как в пакет SDK сервера Windows.  Исходный код в образце *HttpCfg.exe* задано по умолчанию с образцами сети как часть пакета SDK Windows в следующей папке:  
  
 *C:\\Program Files\\Microsoft SDKs\\Windows\\v1.0\\Samples\\NetDS\\http\\serviceconfig*  
  
 В дополнение к этим средствам, классы <xref:System.Security.Cryptography.X509Certificates.X509Certificate> и <xref:System.Security.Cryptography.X509Certificates.X509Certificate2> предоставляют методы для загрузки сертификата из файловой системы.  
  
## См. также  
 [Безопасность в сетевом программировании](../../../docs/framework/network-programming/security-in-network-programming.md)   
 [Сетевое программирование в .NET Framework](../../../docs/framework/network-programming/index.md)