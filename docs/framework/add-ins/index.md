---
title: Надстройки и расширения среды
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: ''
ms.suite: ''
ms.technology:
- dotnet-clr
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- extensibility [.NET Framework], add-ins
- add-ins [.NET Framework]
- add-ins [.NET Framework], about
- hosts [.NET Framework], compared to add-ins
- .NET Framework, add-ins
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], compared to hosts
- .NET Framework, extensibility
- versioning [.NET Framework], add-ins
ms.assetid: 8dd45b02-7218-40f9-857d-40d7b98b850b
caps.latest.revision: 42
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload:
- dotnet
ms.openlocfilehash: 4d288d321063512f91ad94b417bb1a6bf38c9ef9
ms.sourcegitcommit: cf22b29db780e532e1090c6e755aa52d28273fa6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/01/2018
---
# <a name="add-ins-and-extensibility"></a>Надстройки и расширения среды
<a name="top"></a> Надстройки предоставляют расширенные возможности или службы для ведущего приложения. Платформа [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] предоставляет модель программирования, которую разработчики могут использовать для разработки надстроек и их активации в ведущем приложении. Для этого создается конвейер взаимодействия между ведущим приложением и надстройкой. Модель реализуется с помощью типов в пространствах имен <xref:System.AddIn>, <xref:System.AddIn.Hosting>, <xref:System.AddIn.Pipeline>и <xref:System.AddIn.Contract> .  
  
 Обзор включает следующие разделы.  
  
-   [Модель надстроек](#addin_model)  
  
-   [Отличия между надстройками и ведущими приложениями](#distinguishing_between_addins_and_hosts)  
  
-   [Связанные разделы](#related_topics)  
  
-   [Ссылки](#reference)  
  
> [!NOTE]
>  Дополнительные примеры кода и CTP-версии средств для построения конвейеров надстроек можно найти на сайте [CodePlex в разделе, посвященном управлению расширениями и надстройками](http://go.microsoft.com/fwlink/?LinkId=121190).  
  
<a name="addin_model"></a>   
## <a name="add-in-model"></a>Модель надстроек  
 Модель надстроек состоит из ряда сегментов, составляющих конвейер надстройки (также известный как конвейер взаимодействия), который отвечает за весь обмен данными между надстройкой и ведущим приложением. Конвейер — это симметричная модель взаимодействия сегментов, служащих для обмена данными между надстройкой и ведущим приложением. Разработка этих сегментов между ведущим приложением и надстройкой обеспечивает необходимые уровни абстракции, которые поддерживают управление версиями и изоляцию надстройки.  
  
 На рисунке ниже показан конвейер.  
  
 ![Добавить &#45; в модель конвейера. ] (../../../docs/framework/add-ins/media/addin1.png "AddIn1")  
Конвейер надстройки  
  
 Сборки для этих сегментов могут и не находиться в одном и том же домене приложения. Вы можете загрузить надстройку в новый домен приложения, в существующий домен приложения или даже в домен приложения ведущего приложения. Несколько надстроек можно загрузить в один домен приложения, что позволяет им совместно использовать ресурсы и контексты безопасности.  
  
 Модель надстроек поддерживает рекомендуемую, но необязательную границу между ведущим приложением и надстройкой, которая называется границей изоляции (или границей удаленного взаимодействия). Эта граница может быть границей домена приложения или процесса.  
  
 Сегмент контракта в середине конвейера загружается в домен приложения ведущего приложения и в домен приложения надстройки. Контракт определяет виртуальные методы, используемые ведущим приложением и надстройкой для обмена типами друг с другом.  
  
 Для передачи через границу изоляции типы должны быть контрактами или сериализуемыми типами. Типы, не являющиеся контрактами или сериализуемыми типами, необходимо преобразовать в контракты с помощью сегментов адаптера в конвейере.  
  
 Сегменты представления конвейера являются абстрактными базовыми классами или интерфейсами, которые предоставляют ведущему приложению и надстройке представление совместно используемых ими методов, как определено в контракте.  
  
 Подробнее о разработке сегментов конвейера см. в разделе [Pipeline Development](../../../docs/framework/add-ins/pipeline-development.md).  
  
 В последующих разделах описаны возможности модели надстроек.  
  
### <a name="independent-versioning"></a>Независимое управление версиями  
 Модель надстроек позволяет раздельно управлять версиями основных приложений и надстроек. Соответственно, модель надстроек делает возможными следующие сценарии:  
  
-   создание адаптера, который позволяет ведущему приложению использовать надстройку, созданную для предыдущей версии ведущего приложения;  
  
-   создание адаптера, который позволяет ведущему приложению использовать надстройку, созданную для более поздней версии ведущего приложения;  
  
-   создание адаптера, который позволяет ведущему приложению использовать надстройку, созданную для другого ведущего приложения.  
  
### <a name="discovery-and-activation"></a>Обнаружение и активация  
 Надстройку можно активировать с помощью токена из коллекции, которая представляет надстройки, обнаруженные в банке данных. Надстройки обнаруживаются путем поиска типа, который определяет представление ведущего приложения надстройки. Кроме того, определенную надстройку можно найти по типу, который ее определяет. Банк данных состоит из двух файлов кэша: хранилища конвейеров и хранилища надстроек.  
  
 Сведения об обновлении и повторном построении банка данных см. в разделе [обнаружение надстройки](http://msdn.microsoft.com/library/5d268dde-11df-4c4d-a022-f58d88bbc421). Сведения об активации надстроек см. в разделе [активация надстройки](http://msdn.microsoft.com/library/bedcbcdf-5964-4215-b5f3-3299798b2b3f) и [как: активация надстроек с другими параметрами изоляции и безопасности](http://msdn.microsoft.com/library/7afe7ec8-5158-4350-9119-5df0ecab8aa5).  
  
### <a name="isolation-levels-and-external-processes"></a>Уровни изоляции и внешние процессы  
 Модель надстроек поддерживает несколько уровней изоляции между надстройкой и ведущим приложением или между несколькими надстройками. Ниже перечислены эти уровни, начиная с наименее изолированного.  
  
-   Надстройка выполняется в том же домене приложения, что и ведущее приложение. Эта схема не рекомендуется, так как утрачивается изоляция и возможности выгрузки, которые появляются при использовании разных доменов приложений.  
  
-   Несколько надстроек загружаются в один домен приложения, который отличается от домена приложения, используемого ведущим приложением.  
  
-   Каждая надстройка загружается отдельно в свой собственный домен приложения. Это наиболее распространенный уровень изоляции.  
  
-   Несколько надстроек загружаются в один домен приложения во внешнем процессе.  
  
-   Каждая надстройка загружается отдельно в свой собственный домен приложения во внешнем процессе. Это схема с максимальной изоляцией.  
  
 Дополнительные сведения об использовании внешних процессов см. в разделе [как: активация надстроек с другими параметрами изоляции и безопасности](http://msdn.microsoft.com/library/7afe7ec8-5158-4350-9119-5df0ecab8aa5).  
  
### <a name="lifetime-management"></a>Управление жизненным циклом объекта  
 Так как модель надстроек распространяется на границы домена приложения и процесса, сборки мусора самой по себе недостаточно для освобождения и восстановления объектов. Модель надстроек предоставляет механизм управления жизненным циклом, в котором используются токены и подсчет ссылок. Этот механизм обычно не требует написания дополнительного кода. Дополнительные сведения см. в разделе [управления жизненным циклом](http://msdn.microsoft.com/library/57a9c87e-394c-4fef-89f2-aa4223a2aeb5).  
  
 [К началу](#top)  
  
<a name="distinguishing_between_addins_and_hosts"></a>   
## <a name="distinguishing-between-add-ins-and-hosts"></a>Отличия между надстройками и ведущими приложениями  
 Разница между надстройкой и ведущим приложением состоит единственно в том, что ведущее приложение активирует надстройку. Ведущее приложение может быть больше надстройки, например в случае с текстовым редактором и его средством проверки орфографии, или меньше надстройки, например в случае с клиентом обмена мгновенными сообщениями, в который встроен проигрыватель. Модель надстроек поддерживает надстройки в клиентских и серверных сценариях. Примерами серверных надстроек служат надстройки, предоставляющие для почтовых серверов проверку на наличие вирусов, фильтрацию нежелательной почты и защиту протокола IP. Примерами добавить клиента могут быть надстройки для текстовых редакторов, специальные функциональные возможности графических программ и игр и поиска вирусов для локальных почтовых клиентов.  
  
 [К началу](#top)  
  
<a name="related_topics"></a>   
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание:|  
|-----------|-----------------|  
|[Pipeline Development](../../../docs/framework/add-ins/pipeline-development.md)|Описывается конвейер взаимодействия сегментов от ведущего приложения к надстройке. Приводятся примеры кода в пошаговых руководствах, в которых описывается построение конвейера и развертывание сегментов в конвейере в [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)].|  
|[Домены приложений и сборки](http://msdn.microsoft.com/library/433b04ae-4ba8-4849-9dbd-79194f240346)|Описывается связь между доменами приложений, образующими границу изоляции для обеспечения безопасности, надежности и управления версиями, и сборками.|  
  
 [К началу](#top)  
  
<a name="reference"></a>   
## <a name="reference"></a>Ссылка  
 <xref:System.AddIn?displayProperty=nameWithType>  
  
 <xref:System.AddIn.Contract?displayProperty=nameWithType>  
  
 <xref:System.AddIn.Hosting?displayProperty=nameWithType>  
  
 <xref:System.AddIn.Pipeline?displayProperty=nameWithType>  
  
 [К началу](#top)