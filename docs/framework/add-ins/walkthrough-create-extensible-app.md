---
title: Пошаговое руководство. Создание расширяемого приложения
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- views [.NET Framework], add-in pipeline
- host-side adapters for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], creating
- add-in-side adapter [.NET Framework]
- contracts for add-in pipelines [.NET Framework]
ms.assetid: 694a33c5-a040-450d-aed5-ac49fc88ce61
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 5d2aaeaffaf3abbe1e8efcdb57d40e6ae60f89b5
ms.sourcegitcommit: 64f4baed249341e5bf64d1385bf48e3f2e1a0211
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2018
ms.locfileid: "44080726"
---
# <a name="walkthrough-creating-an-extensible-application"></a>Пошаговое руководство. Создание расширяемого приложения
В этом пошаговом руководстве описывается, как создать конвейер для надстройки, которая выполняет функции простого калькулятора. Он не демонстрирует реальной ситуации; Вместо этого он демонстрирует основные функциональные возможности конвейера, и как надстройка может предоставлять службы для узла.  
  
 В этом пошаговом руководстве описаны следующие задачи:  
  
-   Создание решения Visual Studio.  
  
-   Создание структуры каталогов конвейера.  
  
-   Создание контракта и представлений.  
  
-   Создание адаптера на стороне надстройки.  
  
-   Создание адаптера на стороне узла.  
  
-   Создание основного приложения.  
  
-   Создание надстройки.  
  
-   Развертывание конвейера.  
  
-   Запуск основного приложения.  
  
 Этот конвейер передает только сериализуемые типы (<xref:System.Double> и <xref:System.String>), между узлом и надстройки. Пример, в котором показано, как передавать коллекции сложных типов данных, см. в разделе [Пошаговое руководство: передача коллекций между узлами и Add-Ins](https://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5).  
  
 Контракт для этого конвейера определяет модель объекта из четырех арифметических операций: добавить, вычесть, умножить и разделить. Узел предоставляет надстройки с помощью формулы для вычисления, например 2 + 2, и надстройка возвращает результат к узлу.  
  
 Версия 2 надстройки калькулятора предоставляются дополнительные возможности вычисления и показано управление версиями. Он описан в [Пошаговое руководство: Включение обратной совместимости, как узел изменений](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848).  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения данного пошагового руководства необходимо следующее:  
  
-   Visual Studio.  
  
## <a name="creating-a-visual-studio-solution"></a>Создание решения Visual Studio  
 Используйте решение в Visual Studio будут содержаться проекты сегментов конвейера.  
  
#### <a name="to-create-the-pipeline-solution"></a>Чтобы создать решение конвейера  
  
1.  В Visual Studio создайте новый проект с именем `Calc1Contract`. Основу **библиотеки классов** шаблона.  
  
2.  Назовите решение `CalculatorV1`.  
  
## <a name="creating-the-pipeline-directory-structure"></a>Создание структуры каталогов конвейера  
 Модель надстроек требуется сборок сегмента конвейера размещены в указанную структуру каталогов. Дополнительные сведения о структуре конвейера см. в разделе [требования к разработке конвейера](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
#### <a name="to-create-the-pipeline-directory-structure"></a>Для создания структуры каталогов конвейера  
  
1.  Создайте папку приложения в любом месте на компьютере.  
  
2.  В этой папке создайте следующую структуру:  
  
    ```  
    Pipeline  
      AddIns  
        CalcV1  
        CalcV2  
      AddInSideAdapters  
      AddInViews  
      Contracts  
      HostSideAdapters  
    ```  
  
     Нет необходимости размещать структуру папок конвейера в папке приложения; Это делается только для удобства. На определенном этапе пошагового руководства объясняется, как изменения кода в том случае, если используется структура папок конвейера в другом месте. См. в обсуждении требований каталогов конвейера в [требования к разработке конвейера](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
    > [!NOTE]
    >  `CalcV2` Папку в этом пошаговом руководстве не используется; он является заполнителем для [Пошаговое руководство: Включение обратной совместимости, как узел изменений](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848).  
  
## <a name="creating-the-contract-and-views"></a>Создание контракта и представлений  
 Определяет сегмент контракта для этого конвейера `ICalc1Contract` интерфейс, который определяет четыре метода: `add`, `subtract`, `multiply`, и `divide`.  
  
#### <a name="to-create-the-contract"></a>Создание контракта  
  
1.  В решении Visual Studio с именем `CalculatorV1`откройте `Calc1Contract` проекта.  
  
2.  В **обозревателе решений**, добавьте ссылки на следующие сборки `Calc1Contract` проекта:  
  
     System.AddIn.Contract.dll  
  
     System.AddIn.dll  
  
3.  В **обозревателе решений**, исключите класс по умолчанию, который добавляется новое **библиотеки классов** проектов.  
  
4.  В **обозревателе решений**, добавьте новый элемент в проект с помощью **интерфейс** шаблона. В **Добавление нового элемента** диалоговом окне имя интерфейса `ICalc1Contract`.  
  
5.  В файле интерфейса добавьте ссылки на пространства имен для <xref:System.AddIn.Contract> и <xref:System.AddIn.Pipeline>.  
  
6.  Используйте следующий код, чтобы завершить этот сегмент контракта. Обратите внимание, что этот интерфейс должен иметь <xref:System.AddIn.Pipeline.AddInContractAttribute> атрибута.  
  
     [!code-csharp[AddInP1Contract#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1Contract/cs/ICalc1Contract.cs#1)]
     [!code-vb[AddInP1Contract#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1Contract/vb/ICalc1Contract.vb#1)]  
  
7.  При необходимости создайте решение Visual Studio. Решение не может выполняться, пока последняя процедура, но ее построение после каждой процедуры гарантирует, что каждый проект исправления.  
  
 Так как представление надстройки и узлом представление надстройки обычно имеют один и тот же код, особенно в первой версии надстройки, вы можете легко создавать представления в то же время. Они отличаются только одним из факторов: требуется представление надстройки <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут, хотя серверное представление надстройки не требует какие-либо атрибуты.  
  
#### <a name="to-create-the-add-in-view"></a>Создание представления "надстройки"  
  
1.  Добавление нового проекта с именем `Calc1AddInView` для `CalculatorV1` решения. Основу **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылку на System.AddIn.dll для `Calc1AddInView` проекта.  
  
3.  В **обозревателе решений**, исключите класс по умолчанию, который добавляется новое **библиотеки классов** проектов и добавить новый элемент в проект с помощью **интерфейс** шаблона. В **Добавление нового элемента** диалоговом окне имя интерфейса `ICalculator`.  
  
4.  В файле интерфейса добавьте ссылку на пространство имен <xref:System.AddIn.Pipeline>.  
  
5.  Используйте следующий код для завершения этого представления надстройки. Обратите внимание, что этот интерфейс должен иметь <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибута.  
  
     [!code-csharp[AddInP1AddInViews#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1AddInViews/cs/Calc1AddInView.cs#1)]
     [!code-vb[AddInP1AddInViews#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1AddInViews/vb/Calc1AddInView.vb#1)]  
  
6.  При необходимости создайте решение Visual Studio.  
  
#### <a name="to-create-the-host-view-of-the-add-in"></a>Чтобы создать серверное представление надстройки  
  
1.  Добавление нового проекта с именем `Calc1HVA` для `CalculatorV1` решения. Основу **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, исключите класс по умолчанию, который добавляется новое **библиотеки классов** проектов и добавить новый элемент в проект с помощью **интерфейс** шаблона. В **Добавление нового элемента** диалоговом окне имя интерфейса `ICalculator`.  
  
3.  В файле интерфейса используйте следующий код для завершения серверное представление надстройки.  
  
     [!code-csharp[AddInP1HVA#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1HVA/cs/calc1hva.cs#1)]
     [!code-vb[AddInP1HVA#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1HVA/vb/Calc1HVA.vb#1)]  
  
4.  При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-add-in-side-adapter"></a>Создание адаптера на стороне надстройки  
 Этот адаптер на стороне надстройки состоит из одного адаптера представление контракт. Этот сегмент конвейера преобразует типы из представления надстройки в контракт.  
  
 В этом конвейере надстройка предоставляет службу для размещения и типы направляются из надстройки к узлу. Так как никакие типы не направляются от ведущего приложения надстройки, у вас нет необходимости включать контракт представление адаптер со стороны надстройки этот конвейер.  
  
#### <a name="to-create-the-add-in-side-adapter"></a>Чтобы создать адаптер на стороне надстройки  
  
1.  Добавление нового проекта с именем `Calc1AddInSideAdapter` для `CalculatorV1` решения. Основу **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылки на следующие сборки `Calc1AddInSideAdapter` проекта:  
  
     System.AddIn.dll  
  
     System.AddIn.Contract.dll  
  
3.  Добавьте ссылки проекта на проекты прилегающих сегментов конвейера:  
  
     `Calc1AddInView`  
  
     `Calc1Contract`  
  
4.  Выберите ссылку каждого проекта и в **свойства** задать **Копировать локально** для **False**. В Visual Basic, использовать **ссылки** вкладке **свойства проекта** присвоить **Копировать локально** для **False** для двух ссылки проекта.  
  
5.  Переименуйте класс по умолчанию проекта `CalculatorViewToContractAddInSideAdapter`.  
  
6.  В файле класса добавьте ссылки на пространства имен для <xref:System.AddIn.Pipeline>.  
  
7.  В файле класса добавьте ссылки на пространства имен для соседних сегментов: `CalcAddInViews` и `CalculatorContracts`. (В Visual Basic, эти ссылки на пространства имен являются `Calc1AddInView.CalcAddInViews` и `Calc1Contract.CalculatorContracts`, если вы не отключали функцию пространства имен по умолчанию в проектах Visual Basic.)  
  
8.  Применить <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибут `CalculatorViewToContractAddInSideAdapter` класса, чтобы он определялся как адаптер на стороне надстройки.  
  
9. Сделать `CalculatorViewToContractAddInSideAdapter` наследовать класс <xref:System.AddIn.Pipeline.ContractBase>, который предоставляет реализацию по умолчанию <xref:System.AddIn.Contract.IContract> интерфейс и реализовать интерфейс контракта для конвейера, `ICalc1Contract`.  
  
10. Добавьте открытый конструктор, принимающий `ICalculator`, кэширует его в скрытом поле и вызывает конструктор базового класса.  
  
11. Чтобы реализовать члены `ICalc1Contract`, просто вызовите соответствующими членами объекта `ICalculator` экземпляр, который передается в конструктор и возвращает результаты. Это адаптирует представление (`ICalculator`) к контракту (`ICalc1Contract`).  
  
     Приведенный ниже показан завершенный адаптер на стороне надстройки.  
  
     [!code-csharp[AddInP1AddInSideAdapters#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1AddInSideAdapters/cs/Calc1ViewToContractAddInSideAdapter.cs#1)]
     [!code-vb[AddInP1AddInSideAdapters#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1AddInSideAdapters/vb/Calc1ViewToContractAddInSideAdapter.vb#1)]  
  
12. При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-host-side-adapter"></a>Создание адаптера на стороне узла  
 Этот адаптер состоит из одного адаптера контракт представление. Этот сегмент адаптирует контракт для серверное представление надстройки.  
  
 В этом конвейере надстройка предоставляет службу, на узел и последовательности типов из надстройки к узлу. Так как никакие типы не направляются от ведущего приложения надстройки, у вас нет для включения адаптера представление контракт.  
  
 Для реализации управления жизненным циклом, используйте <xref:System.AddIn.Pipeline.ContractHandle> объект необходимо подключить маркер времени жизни на контракте. Необходимо хранить ссылку на этот дескриптор в порядке для управления жизненным циклом для работы. После применения маркера без дополнительного программирования не требуется, поскольку система надстройки может удалить объекты, если они больше не используются и сделать их доступными для сборки мусора. Дополнительные сведения см. в разделе [управления жизненным циклом](https://msdn.microsoft.com/library/57a9c87e-394c-4fef-89f2-aa4223a2aeb5).  
  
#### <a name="to-create-the-host-side-adapter"></a>Чтобы создать адаптер на стороне узла  
  
1.  Добавление нового проекта с именем `Calc1HostSideAdapter` для `CalculatorV1` решения. Основу **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылки на следующие сборки `Calc1HostSideAdapter` проекта:  
  
     System.AddIn.dll  
  
     System.AddIn.Contract.dll  
  
3.  Добавление ссылок на проект в проекты прилегающих сегментов:  
  
     `Calc1Contract`  
  
     `Calc1HVA`  
  
4.  Выберите ссылку каждого проекта и в **свойства** задать **Копировать локально** для **False**. В Visual Basic, использовать **ссылки** вкладке **свойства проекта** присвоить **Копировать локально** для **False** для двух ссылки проекта.  
  
5.  Переименуйте класс по умолчанию проекта `CalculatorContractToViewHostSideAdapter`.  
  
6.  В файле класса добавьте ссылки на пространства имен для <xref:System.AddIn.Pipeline>.  
  
7.  В файле класса добавьте ссылки на пространства имен для соседних сегментов: `CalcHVAs` и `CalculatorContracts`. (В Visual Basic, эти ссылки на пространства имен являются `Calc1HVA.CalcHVAs` и `Calc1Contract.CalculatorContracts`, если вы не отключали функцию пространства имен по умолчанию в проектах Visual Basic.)  
  
8.  Применить <xref:System.AddIn.Pipeline.HostAdapterAttribute> атрибут `CalculatorContractToViewHostSideAdapter` класса, чтобы он определялся как сегмент адаптера узла.  
  
9. Сделать `CalculatorContractToViewHostSideAdapter` класс реализует интерфейс, представляющий серверное представление надстройки: `Calc1HVAs.ICalculator` (`Calc1HVA.CalcHVAs.ICalculator` в Visual Basic).  
  
10. Добавьте открытый конструктор, который принимает тип контракта конвейера `ICalc1Contract`. Конструктор должен кэшировать ссылку на контракт. Необходимо также создать и кэшировать новый <xref:System.AddIn.Pipeline.ContractHandle> для контракта, для управления временем жизни надстройки.  
  
    > [!IMPORTANT]
    >  <xref:System.AddIn.Pipeline.ContractHandle> Является критически важным для управления жизненным циклом. Если не сохранить ссылку на <xref:System.AddIn.Pipeline.ContractHandle> объекта, сборщик мусора освободит его, а конвейер завершит работу, когда приложение не ожидает ее. Это может привести к ошибкам, которые трудно диагностировать, например <xref:System.AppDomainUnloadedException>. Завершение работы является неотъемлемым этапом работы конвейера, поэтому нет способа для кода управления временем существования обнаружить, что это состояние возникает ошибка.  
  
11. Чтобы реализовать члены `ICalculator`, просто вызовите соответствующими членами объекта `ICalc1Contract` экземпляр, который передается в конструктор и возвращает результаты. Это адаптирует контракт (`ICalc1Contract`) в представление (`ICalculator`).  
  
     Приведенный ниже показан завершенный адаптер на стороне узла.  
  
     [!code-csharp[AddInP1HostSideAdapters#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1HostSideAdapters/cs/Calc1ContractToViewHostSideAdapter.cs#1)]
     [!code-vb[AddInP1HostSideAdapters#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1HostSideAdapters/vb/Calc1ContractToViewHostSideAdapter.vb#1)]  
  
12. При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-host"></a>Создание основного приложения  
 Ведущее приложение взаимодействует с надстройкой через серверное представление надстройки. Он использует, чтобы добавить в методы обнаружения и активации предоставляемых <xref:System.AddIn.Hosting.AddInStore> и <xref:System.AddIn.Hosting.AddInToken> классы для следующих целей:  
  
-   Обновите кэш данных конвейера и надстройки.  
  
-   Поиск надстроек типа представления узла `ICalculator`, в корневом каталоге указанного конвейера.  
  
-   Запрос, чтобы пользователь указал, что надстройка для использования.  
  
-   Активация выбранной надстройки в новом домене приложения с выбранным уровнем доверия.  
  
-   Запуска специального `RunCalculator` метод, который вызывает методы add в соответствии с серверное представление надстройки.  
  
#### <a name="to-create-the-host"></a>Чтобы создать узел  
  
1.  Добавление нового проекта с именем `Calc1Host` для `CalculatorV1` решения. Основу **консольное приложение** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылку на сборку System.AddIn.dll `Calc1Host` проекта.  
  
3.  Добавьте в проект ссылку на `Calc1HVA` проекта. Выберите ссылку на проект, а затем в **свойства** задать **Копировать локально** для **False**. В Visual Basic, использовать **ссылки** вкладке **свойства проекта** присвоить **Копировать локально** для **False**.  
  
4.  Переименуйте файл (модуль в Visual Basic) класса `MathHost1`.  
  
5.  В Visual Basic, использовать **приложения** вкладке **свойства проекта** диалоговое окно, чтобы задать **автоматически запускаемый объект** для **Sub Main**.  
  
6.  В файле класса или модуля, добавьте ссылку на пространство имен <xref:System.AddIn.Hosting>.  
  
7.  В файле класса или модуля, добавьте ссылку на пространство имен для серверного представления надстройки: `CalcHVAs`. (В Visual Basic — это ссылка на пространство имен `Calc1HVA.CalcHVAs`, если вы не отключали функцию пространства имен по умолчанию в проектах Visual Basic.)  
  
8.  В **обозревателе решений**, выберите решение и из **проекта** меню выберите команду **свойства**. В **страницы свойств решения** диалоговом окне set **один запускаемый проект** быть этот проект ведущего приложения.  
  
9. В файле класса или модуля, используйте <xref:System.AddIn.Hosting.AddInStore.Update%2A?displayProperty=nameWithType> метод для обновления кэша. Используйте <xref:System.AddIn.Hosting.AddInStore.FindAddIn%2A?displayProperty=nameWithType> метод для получения коллекции маркеров и <xref:System.AddIn.Hosting.AddInToken.Activate%2A?displayProperty=nameWithType> метод для активации надстройки.  
  
     В следующем коде показано завершение основного приложения.  
  
     [!code-csharp[AddInP1Host#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1Host/cs/MathHost1.cs#1)]
     [!code-vb[AddInP1Host#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1Host/vb/MathHost1.vb#1)]  
  
    > [!NOTE]
    >  Этот код предполагает, что структура папок конвейера находится в папке приложения. Если находится в другом месте, измените строку кода, который задает `addInRoot` переменной, таким образом, чтобы переменная содержит путь к структуре каталогов конвейера.  
  
     Код использует `ChooseCalculator` метод для отображения списка токенов и предлагать пользователю выбрать надстройку. `RunCalculator` Метод запрашивает у пользователя простые математические выражения, с помощью `Parser` класс и отображаются результаты, возвращенные надстройкой.  
  
10. При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-add-in"></a>Создание надстройки  
 Надстройка реализует методы, указанные представления надстройки. Эта надстройка реализует `Add`, `Subtract`, `Multiply`, и `Divide` операции и возвращает результаты на узел.  
  
#### <a name="to-create-the-add-in"></a>Чтобы создать надстройку  
  
1.  Добавление нового проекта с именем `AddInCalcV1` для `CalculatorV1` решения. Основу **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте в проект ссылку на сборку System.AddIn.dll.  
  
3.  Добавьте в проект ссылку на `Calc1AddInView` проекта. Выберите ссылку на проект, а затем в **свойства**, задайте **Копировать локально** для **False**. В Visual Basic, использовать **ссылки** вкладке **свойства проекта** присвоить **Копировать локально** для **False** для ссылки на проект.  
  
4.  Переименуйте класс `AddInCalcV1`.  
  
5.  В файле класса добавьте ссылку на пространство имен <xref:System.AddIn> и сегмент представления надстройки: `CalcAddInViews` (`Calc1AddInView.CalcAddInViews` в Visual Basic).  
  
6.  Применить <xref:System.AddIn.AddInAttribute> атрибут `AddInCalcV1` класса, чтобы идентифицировать класс как надстройку.  
  
7.  Сделать `AddInCalcV1` класс реализует интерфейс, представляющий представление надстройки: `CalcAddInViews.ICalculator` (`Calc1AddInView.CalcAddInViews.ICalculator` в Visual Basic).  
  
8.  Реализовать члены `ICalculator` возвращаются результаты соответствующих вычислений.  
  
     В следующем коде показано законченная надстройка.  
  
     [!code-csharp[AddInP1AddInCalcV1#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1AddInCalcV1/cs/AddInCalcV1.cs#1)]
     [!code-vb[AddInP1AddInCalcV1#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1AddInCalcV1/vb/AddInCalcV1.vb#1)]  
  
9. При необходимости создайте решение Visual Studio.  
  
## <a name="deploying-the-pipeline"></a>Развертывание конвейера  
 Теперь вы готовы для создания и развертывания в структуре каталогов конвейера требуется сегменты надстройки.  
  
#### <a name="to-deploy-the-segments-to-the-pipeline"></a>Чтобы развернуть сегменты в конвейере  
  
1.  Для каждого проекта в решении, используйте **построения** вкладке **свойства проекта** ( **компиляции** вкладке в Visual Basic) для задания значения **выходной путь**  ( **выходной путь построения** в Visual Basic). Если имя папки приложения `MyApp`, к примеру, построение проектов будет осуществляться в следующих папках:  
  
    |Проект|Путь|  
    |-------------|----------|  
    |AddInCalcV1|MyApp\Pipeline\AddIns\CalcV1|  
    |Calc1AddInSideAdapter|MyApp\Pipeline\AddInSideAdapters|  
    |Calc1AddInView|MyApp\Pipeline\AddInViews|  
    |Calc1Contract|MyApp\Pipeline\Contracts|  
    |Calc1Host|MyApp|  
    |Calc1HostSideAdapter|MyApp\Pipeline\HostSideAdapters|  
    |Calc1HVA|MyApp|  
  
    > [!NOTE]
    >  Если вы решили разместить структуру папок конвейера в папке, отличной от папки приложения, необходимо изменить пути, приведенные в таблице, соответствующим образом. См. в обсуждении требований каталогов конвейера в [требования к разработке конвейера](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
2.  Выполните сборку решения в Visual Studio.  
  
3.  Проверьте каталоги приложения и конвейера, чтобы убедиться, что сборки были скопированы в соответствующие папки и что нет дополнительных копий сборок установлены в других папках.  
  
    > [!NOTE]
    >  Если вы не изменяли **Копировать локально** для **False** для `Calc1AddInView` ссылку на в проект `AddInCalcV1` проекта, проблемы контекст загрузчика будет препятствовать надстройки, чтобы искать его.  
  
     Сведения о развертывании в конвейер, см. в разделе [требования к разработке конвейера](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
## <a name="running-the-host-application"></a>Запуск основного приложения  
 Теперь вы готовы запустить узел и взаимодействовать с надстройки.  
  
#### <a name="to-run-the-host-application"></a>Для запуска ведущего приложения  
  
1.  В командной строке перейдите в каталог приложения и запустите ведущим приложением, `Calc1Host.exe`.  
  
2.  Узел находит все доступные надстройки его типа и вам будет предложено выбрать надстройку. Введите **1** только доступные надстройки.  
  
3.  Введите формулу для калькулятора, такие как **2 + 2**. Должно быть пробелов между номером и оператора.  
  
4.  Тип **выйти из** и нажмите клавишу **ввод** клавишу, чтобы закрыть приложение.  
  
## <a name="see-also"></a>См. также  
 [Пошаговое руководство: Включение обратной совместимости при изменении основного приложения](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
 [Пошаговое руководство: Передача коллекций между узлами и надстройки](https://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
 [Требования к разработке конвейера](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5)  
 [Контракты, представления и адаптеры](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c)  
 [Разработка конвейера](../../../docs/framework/add-ins/pipeline-development.md)
