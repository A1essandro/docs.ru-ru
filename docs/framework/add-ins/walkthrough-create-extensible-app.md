---
title: Пошаговое руководство. Создание расширяемого приложения
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- views [.NET Framework], add-in pipeline
- host-side adapters for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], creating
- add-in-side adapter [.NET Framework]
- contracts for add-in pipelines [.NET Framework]
ms.assetid: 694a33c5-a040-450d-aed5-ac49fc88ce61
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 292447fa3cf2dbad70dbfef32b7c184b250ed25e
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="walkthrough-creating-an-extensible-application"></a>Пошаговое руководство. Создание расширяемого приложения
В этом пошаговом руководстве описывается создание конвейера надстройки, выполняющий функции простого калькулятора. Здесь не показаны реальном сценарии; Вместо этого он демонстрирует основные функциональные возможности конвейера и как надстройка может предоставлять службы для узла.  
  
 В этом пошаговом руководстве описаны следующие задачи:  
  
-   Создание решения Visual Studio.  
  
-   Создание структуры каталогов конвейера.  
  
-   Создание контракта и представлений.  
  
-   Создание адаптера на стороне надстройки.  
  
-   Создание адаптера на стороне узла.  
  
-   Создание узла.  
  
-   Создание надстройки.  
  
-   Развертывание конвейера.  
  
-   Запуск основного приложения.  
  
 Этот конвейер передает только сериализуемых типов (<xref:System.Double> и <xref:System.String>), между основным приложением и надстройкой. Пример, демонстрирующий способы передачи коллекций сложных типов данных см. в разделе [Пошаговое руководство: передача коллекций между узлами и надстройки](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5).  
  
 Контракт для этого конвейера определяет модель объекта из четырех арифметических операций: добавить, вычесть, умножить и разделить. Узел предоставляет надстройки формулу для вычисления, например 2 + 2, и надстройка возвращает результат на узел.  
  
 Версия 2 надстройки калькулятора предоставляются дополнительные возможности вычисления и показано управление версиями. Он описан в [Пошаговое руководство: Включение обратной совместимости, как узел изменений](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848).  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения данного пошагового руководства необходимо следующее:  
  
-   Visual Studio.  
  
## <a name="creating-a-visual-studio-solution"></a>Создание решения Visual Studio  
 Используйте решение в Visual Studio, чтобы разместить проекты сегментов конвейера.  
  
#### <a name="to-create-the-pipeline-solution"></a>Чтобы создать решение конвейера  
  
1.  В Visual Studio создайте новый проект с именем `Calc1Contract`. Он должен быть основан на **библиотеки классов** шаблона.  
  
2.  Присвойте решению имя `CalculatorV1`.  
  
## <a name="creating-the-pipeline-directory-structure"></a>Создание структуры каталогов конвейера  
 Модель надстроек требуется сборки сегментов конвейера помещается в указанную структуру каталогов. Дополнительные сведения о структуре конвейера см. в разделе [требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
#### <a name="to-create-the-pipeline-directory-structure"></a>Чтобы создать структуру каталогов конвейера  
  
1.  Создайте папку приложения в любом месте на компьютере.  
  
2.  В этой папке создайте следующую структуру:  
  
    ```  
    Pipeline  
      AddIns  
        CalcV1  
        CalcV2  
      AddInSideAdapters  
      AddInViews  
      Contracts  
      HostSideAdapters  
    ```  
  
     Нет необходимости размещать структуру папок конвейера в папке приложения; Это делается только для удобства. На определенном этапе пошагового руководства объясняется, как изменить код, если структура папок конвейера в другом месте. В разделе описания каталогов конвейера в [требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
    > [!NOTE]
    >  `CalcV2` Папки в этом пошаговом руководстве не используется; он является заполнителем для [Пошаговое руководство: Включение обратной совместимости, как узел изменений](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848).  
  
## <a name="creating-the-contract-and-views"></a>Создание контракта и представлений  
 Сегмент контракта для этого конвейера определяет `ICalc1Contract` интерфейс, который определяет четыре метода: `add`, `subtract`, `multiply`, и `divide`.  
  
#### <a name="to-create-the-contract"></a>Создание контракта  
  
1.  В решение Visual Studio, с именем `CalculatorV1`откройте `Calc1Contract` проекта.  
  
2.  В **обозревателе решений**, добавьте ссылки на следующие сборки для `Calc1Contract` проекта:  
  
     System.AddIn.Contract.dll  
  
     System.AddIn.dll  
  
3.  В **обозревателе решений**, исключите класс по умолчанию, который добавляется новый **библиотеки классов** проектов.  
  
4.  В **обозревателе решений**, добавьте новый элемент в проект с помощью **интерфейс** шаблона. В **Добавление нового элемента** диалоговом имя интерфейса `ICalc1Contract`.  
  
5.  В файле интерфейса добавьте ссылки на пространства имен для <xref:System.AddIn.Contract> и <xref:System.AddIn.Pipeline>.  
  
6.  Используйте следующий код для завершения этого сегмента контракта. Обратите внимание, что этот интерфейс должен иметь <xref:System.AddIn.Pipeline.AddInContractAttribute> атрибута.  
  
     [!code-csharp[AddInP1Contract#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1Contract/cs/ICalc1Contract.cs#1)]
     [!code-vb[AddInP1Contract#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1Contract/vb/ICalc1Contract.vb#1)]  
  
7.  При необходимости создайте решение Visual Studio. Решение не может выполняться, пока заключительную процедуру, но ее построение после каждой процедуры гарантирует, что каждый проект исправления.  
  
 Так как представление надстройки и узлом представление надстройки обычно имеют один и тот же код, особенно в первой версии надстройки, можно легко создавать представления в то же время. Они отличаются только в одном: представление надстройки требует <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибута, пока хост-представление надстройки не нуждается в атрибутах.  
  
#### <a name="to-create-the-add-in-view"></a>Чтобы создать представление надстройки  
  
1.  Добавьте новый проект с именем `Calc1AddInView` для `CalculatorV1` решения. Он должен быть основан на **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылку на System.AddIn.dll для `Calc1AddInView` проекта.  
  
3.  В **обозревателе решений**, исключите класс по умолчанию, который добавляется новый **библиотеки классов** проектов и добавить новый элемент в проект с помощью **интерфейс** шаблона. В **Добавление нового элемента** диалоговом имя интерфейса `ICalculator`.  
  
4.  В файле интерфейса добавьте ссылку на пространство имен <xref:System.AddIn.Pipeline>.  
  
5.  Используйте следующий код для завершения этого представления надстройки. Обратите внимание, что этот интерфейс должен иметь <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибута.  
  
     [!code-csharp[AddInP1AddInViews#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1AddInViews/cs/Calc1AddInView.cs#1)]
     [!code-vb[AddInP1AddInViews#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1AddInViews/vb/Calc1AddInView.vb#1)]  
  
6.  При необходимости создайте решение Visual Studio.  
  
#### <a name="to-create-the-host-view-of-the-add-in"></a>Для создания представления узла надстройки  
  
1.  Добавьте новый проект с именем `Calc1HVA` для `CalculatorV1` решения. Он должен быть основан на **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, исключите класс по умолчанию, который добавляется новый **библиотеки классов** проектов и добавить новый элемент в проект с помощью **интерфейс** шаблона. В **Добавление нового элемента** диалоговом имя интерфейса `ICalculator`.  
  
3.  В файле интерфейса используйте следующий код для завершения серверное представление надстройки.  
  
     [!code-csharp[AddInP1HVA#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1HVA/cs/calc1hva.cs#1)]
     [!code-vb[AddInP1HVA#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1HVA/vb/Calc1HVA.vb#1)]  
  
4.  При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-add-in-side-adapter"></a>Создание адаптера на стороне надстройки  
 Этот адаптер на стороне надстройки состоит из одного адаптера представление контракт. Этот сегмент конвейера преобразует типы из представления надстройки в контракт.  
  
 В этом конвейере надстройка предоставляет службу на узле, а типы передаются из надстройки узла. Так как никакие типы не направляются от ведущего приложения надстройки, включают в себя адаптер контракта для просмотра на стороне надстройки в этом конвейере нет.  
  
#### <a name="to-create-the-add-in-side-adapter"></a>Чтобы создать адаптер на стороне надстройки  
  
1.  Добавьте новый проект с именем `Calc1AddInSideAdapter` для `CalculatorV1` решения. Он должен быть основан на **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылки на следующие сборки для `Calc1AddInSideAdapter` проекта:  
  
     System.AddIn.dll  
  
     System.AddIn.Contract.dll  
  
3.  Добавьте ссылки проекта на проекты сегментов конвейера смежные:  
  
     `Calc1AddInView`  
  
     `Calc1Contract`  
  
4.  Выберите ссылку каждого проекта и в **свойства** задать **Копировать локально** для **False**. В Visual Basic, используйте **ссылки** вкладке **свойства проекта** для задания **Копировать локально** для **False** для две ссылки на проект.  
  
5.  Переименуйте класс по умолчанию проекта `CalculatorViewToContractAddInSideAdapter`.  
  
6.  В файле класса добавьте ссылки на пространства имен для <xref:System.AddIn.Pipeline>.  
  
7.  В файле класса добавьте ссылки на пространства имен для соседних сегментов: `CalcAddInViews` и `CalculatorContracts`. (В Visual Basic, ссылки на следующие пространства имен `Calc1AddInView.CalcAddInViews` и `Calc1Contract.CalculatorContracts`, если вы отключили пространства имен по умолчанию в проектах Visual Basic.)  
  
8.  Применить <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибут `CalculatorViewToContractAddInSideAdapter` класса, чтобы он определялся как адаптер со стороны надстройки.  
  
9. Сделать `CalculatorViewToContractAddInSideAdapter` наследовать класс <xref:System.AddIn.Pipeline.ContractBase>, который предоставляет реализацию по умолчанию <xref:System.AddIn.Contract.IContract> интерфейса и реализует интерфейс контракта для конвейера, `ICalc1Contract`.  
  
10. Добавьте открытый конструктор, принимающий `ICalculator`, кэширует его в закрытом поле и вызывает конструктор базового класса.  
  
11. Чтобы реализовать члены `ICalc1Contract`, просто вызовите соответствующие элементы из `ICalculator` экземпляр, который передается в конструктор и возвращает результаты. Это адаптирует представление (`ICalculator`) для контракта (`ICalc1Contract`).  
  
     Следующий код показывает завершенный адаптер на стороне надстройки.  
  
     [!code-csharp[AddInP1AddInSideAdapters#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1AddInSideAdapters/cs/Calc1ViewToContractAddInSideAdapter.cs#1)]
     [!code-vb[AddInP1AddInSideAdapters#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1AddInSideAdapters/vb/Calc1ViewToContractAddInSideAdapter.vb#1)]  
  
12. При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-host-side-adapter"></a>Создание адаптера на стороне узла  
 Этот адаптер узла состоит из одного адаптера контракта для просмотра. Этот сегмент адаптирует контракт для хост-представление надстройки.  
  
 В этом конвейере надстройка предоставляет службу, в узел, а также типы потока из надстройки на узел. Так как никакие типы не направляются от ведущего приложения надстройки, включают в себя представление контракт адаптер нет.  
  
 Для управления временем существования, используйте <xref:System.AddIn.Pipeline.ContractHandle> , который необходимо подключить к контракту токен срока существования. Необходимо сохранить ссылку на этот дескриптор для управления временем жизни для работы. После применения маркера без дополнительного программирования является обязательным, поскольку система надстройки может удалить объекты, если они больше не используются и сделать их доступными для сборки мусора. Дополнительные сведения см. в разделе [управления жизненным циклом](http://msdn.microsoft.com/library/57a9c87e-394c-4fef-89f2-aa4223a2aeb5).  
  
#### <a name="to-create-the-host-side-adapter"></a>Для создания адаптера узла  
  
1.  Добавьте новый проект с именем `Calc1HostSideAdapter` для `CalculatorV1` решения. Он должен быть основан на **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылки на следующие сборки для `Calc1HostSideAdapter` проекта:  
  
     System.AddIn.dll  
  
     System.AddIn.Contract.dll  
  
3.  Добавьте ссылки проекта на проекты соседних сегментов:  
  
     `Calc1Contract`  
  
     `Calc1HVA`  
  
4.  Выберите ссылку каждого проекта и в **свойства** задать **Копировать локально** для **False**. В Visual Basic, используйте **ссылки** вкладке **свойства проекта** для задания **Копировать локально** для **False** для две ссылки на проект.  
  
5.  Переименуйте класс по умолчанию проекта `CalculatorContractToViewHostSideAdapter`.  
  
6.  В файле класса добавьте ссылки на пространства имен для <xref:System.AddIn.Pipeline>.  
  
7.  В файле класса добавьте ссылки на пространства имен для соседних сегментов: `CalcHVAs` и `CalculatorContracts`. (В Visual Basic, ссылки на следующие пространства имен `Calc1HVA.CalcHVAs` и `Calc1Contract.CalculatorContracts`, если вы отключили пространства имен по умолчанию в проектах Visual Basic.)  
  
8.  Применить <xref:System.AddIn.Pipeline.HostAdapterAttribute> атрибут `CalculatorContractToViewHostSideAdapter` класса, чтобы он определялся как адаптер сегмента.  
  
9. Сделать `CalculatorContractToViewHostSideAdapter` класс реализует интерфейс, представляющий серверное представление надстройки: `Calc1HVAs.ICalculator` (`Calc1HVA.CalcHVAs.ICalculator` в Visual Basic).  
  
10. Добавьте открытый конструктор, который принимает тип контракта конвейера `ICalc1Contract`. Конструктор должен кэшировать ссылки на контракт. Необходимо также создать и кэшировать новый <xref:System.AddIn.Pipeline.ContractHandle> для контракта, для управления временем жизни надстройки.  
  
    > [!IMPORTANT]
    >  <xref:System.AddIn.Pipeline.ContractHandle> Крайне важно для управления жизненным циклом. Если не удалось сохранить ссылку на <xref:System.AddIn.Pipeline.ContractHandle> объекта, сборщик мусора будет восстановить его и конвейера будет завершать работу, если приложение не ожидает его. Это может привести к ошибкам, которые трудно диагностировать, например <xref:System.AppDomainUnloadedException>. Завершение работы является неотъемлемым этапом жизненного цикла конвейера, поэтому нет возможности для кода управления временем существования обнаружить, что это условие является ошибкой.  
  
11. Чтобы реализовать члены `ICalculator`, просто вызовите соответствующие элементы из `ICalc1Contract` экземпляр, который передается в конструктор и возвращает результаты. Это адаптирует контракт (`ICalc1Contract`) в представление (`ICalculator`).  
  
     Следующий код показывает завершенный адаптер на стороне узла.  
  
     [!code-csharp[AddInP1HostSideAdapters#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1HostSideAdapters/cs/Calc1ContractToViewHostSideAdapter.cs#1)]
     [!code-vb[AddInP1HostSideAdapters#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1HostSideAdapters/vb/Calc1ContractToViewHostSideAdapter.vb#1)]  
  
12. При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-host"></a>Создание узла  
 Основное приложение взаимодействует с надстройкой посредством серверное представление надстройки. Она использует надстройки обнаружение и активация методы, предоставляемые <xref:System.AddIn.Hosting.AddInStore> и <xref:System.AddIn.Hosting.AddInToken> классы делать следующее:  
  
-   Обновите кэш данных конвейера и надстройки.  
  
-   Обнаружение надстроек типа представления узла `ICalculator`, корневом каталоге указанного конвейера.  
  
-   Предложить пользователю указать, что надстройки для использования.  
  
-   Активация выбранной надстройки в новом домене приложения с выбранным уровнем доверия.  
  
-   Запуска пользовательского `RunCalculator` метод, который вызывает методы надстройки в соответствии с хост-представление надстройки.  
  
#### <a name="to-create-the-host"></a>Для создания узла  
  
1.  Добавьте новый проект с именем `Calc1Host` для `CalculatorV1` решения. Он должен быть основан на **консольное приложение** шаблона.  
  
2.  В **обозревателе решений**, добавьте ссылку на сборку System.AddIn.dll `Calc1Host` проекта.  
  
3.  Добавьте ссылку на проект `Calc1HVA` проекта. Выберите ссылку на проект и в **свойства** задать **Копировать локально** для **False**. В Visual Basic, используйте **ссылки** вкладке **свойства проекта** для задания **Копировать локально** для **False**.  
  
4.  Переименуйте файл (модуль в Visual Basic) класса `MathHost1`.  
  
5.  В Visual Basic, используйте **приложения** вкладке **свойства проекта** диалоговое окно «», чтобы задать **автоматически запускаемый объект** для **Sub Main**.  
  
6.  В файле класса или модуля добавьте ссылку на пространство имен <xref:System.AddIn.Hosting>.  
  
7.  В файле класса или модуля добавьте ссылку на пространство имен для серверного представления надстройки: `CalcHVAs`. (В Visual Basic — это ссылки на пространство имен `Calc1HVA.CalcHVAs`, если вы отключили пространства имен по умолчанию в проектах Visual Basic.)  
  
8.  В **обозревателе решений**, выберите решение и из **проекта** меню щелкните **свойства**. В **страницы свойств решения** диалоговое окно, набор **один запускаемый проект** как этот проект основного приложения.  
  
9. В файле класса или модуля, используйте <xref:System.AddIn.Hosting.AddInStore.Update%2A?displayProperty=nameWithType> метод для обновления кэша. Используйте <xref:System.AddIn.Hosting.AddInStore.FindAddIn%2A?displayProperty=nameWithType> метод для получения коллекции маркеров и <xref:System.AddIn.Hosting.AddInToken.Activate%2A?displayProperty=nameWithType> метод, чтобы активировать надстройку.  
  
     В следующем коде показано завершение основного приложения.  
  
     [!code-csharp[AddInP1Host#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1Host/cs/MathHost1.cs#1)]
     [!code-vb[AddInP1Host#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1Host/vb/MathHost1.vb#1)]  
  
    > [!NOTE]
    >  Данный код предполагает, что структура папок конвейера находится в папке приложения. Если находится в другом месте, измените строку кода, который задает `addInRoot` переменной, чтобы переменная содержит путь к структуре каталогов конвейера.  
  
     Код использует `ChooseCalculator` метод для отображения списка маркеров и предложить пользователю выбрать надстройку. `RunCalculator` Метод запросит у пользователя простые математические выражения, с помощью `Parser` класс и отображаются результаты, возвращенные надстройкой.  
  
10. При необходимости создайте решение Visual Studio.  
  
## <a name="creating-the-add-in"></a>Создание надстройки  
 Надстройка реализует методы, указанные в представлении надстройки. Эта надстройка реализует `Add`, `Subtract`, `Multiply`, и `Divide` операции и возвращает результаты на узел.  
  
#### <a name="to-create-the-add-in"></a>Чтобы создать надстройку  
  
1.  Добавьте новый проект с именем `AddInCalcV1` для `CalculatorV1` решения. Он должен быть основан на **библиотеки классов** шаблона.  
  
2.  В **обозревателе решений**, добавьте в проект ссылку на сборку System.AddIn.dll.  
  
3.  Добавьте ссылку на проект `Calc1AddInView` проекта. Выберите ссылку на проект и в **свойства**, задайте **Копировать локально** для **False**. В Visual Basic, используйте **ссылки** вкладке **свойства проекта** для задания **Копировать локально** для **False** для ссылки на проект.  
  
4.  Переименуйте класс `AddInCalcV1`.  
  
5.  В файле класса добавьте ссылку на пространство имен <xref:System.AddIn> и сегмент представления надстройки: `CalcAddInViews` (`Calc1AddInView.CalcAddInViews` в Visual Basic).  
  
6.  Применить <xref:System.AddIn.AddInAttribute> атрибут `AddInCalcV1` класса, чтобы идентифицировать класс как add-in.  
  
7.  Сделать `AddInCalcV1` класс реализует интерфейс, представляющий представление надстройки: `CalcAddInViews.ICalculator` (`Calc1AddInView.CalcAddInViews.ICalculator` в Visual Basic).  
  
8.  Реализовать члены `ICalculator` посредством возвращения результатов соответствующих вычислений.  
  
     В следующем коде показано завершить надстройку.  
  
     [!code-csharp[AddInP1AddInCalcV1#1](../../../samples/snippets/csharp/VS_Snippets_CLR/AddInP1AddInCalcV1/cs/AddInCalcV1.cs#1)]
     [!code-vb[AddInP1AddInCalcV1#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/AddInP1AddInCalcV1/vb/AddInCalcV1.vb#1)]  
  
9. При необходимости создайте решение Visual Studio.  
  
## <a name="deploying-the-pipeline"></a>Развертывание конвейера  
 Теперь вы готовы построить и развернуть сегменты надстройки в требуемой структуре каталогов конвейера.  
  
#### <a name="to-deploy-the-segments-to-the-pipeline"></a>Развертывание сегментов в конвейере  
  
1.  Для каждого проекта в решении, используйте **построения** вкладке **свойства проекта** ( **компиляции** вкладки в Visual Basic) для задания значения **выходной путь**  ( **выходной путь построения** в Visual Basic). Если имя папки приложения `MyApp`, например, построение проектов будет осуществляться в следующих папках:  
  
    |Проект|Путь|  
    |-------------|----------|  
    |AddInCalcV1|MyApp\Pipeline\AddIns\CalcV1|  
    |Calc1AddInSideAdapter|MyApp\Pipeline\AddInSideAdapters|  
    |Calc1AddInView|MyApp\Pipeline\AddInViews|  
    |Calc1Contract|MyApp\Pipeline\Contracts|  
    |Calc1Host|MyApp|  
    |Calc1HostSideAdapter|MyApp\Pipeline\HostSideAdapters|  
    |Calc1HVA|MyApp|  
  
    > [!NOTE]
    >  Если вы решили разместить структуру папок конвейера в месте, отличном от папки приложения, необходимо изменить путям, показанным в таблице, соответствующим образом. В разделе описания каталогов конвейера в [требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
2.  Выполните сборку решения в Visual Studio.  
  
3.  Проверьте каталоги приложения и конвейера, чтобы убедиться, что сборки были скопированы в соответствующие папки и что нет дополнительных копий сборок были установлены в других папках.  
  
    > [!NOTE]
    >  Если не были изменены **Копировать локально** для **False** для `Calc1AddInView` ссылку в проект `AddInCalcV1` проекта, проблем контекста загрузчика помешает надстройки они находятся.  
  
     Сведения о развертывании в конвейер, см. в разделе [требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
## <a name="running-the-host-application"></a>Запуск основного приложения  
 Теперь вы готовы запустить узел и взаимодействовать с надстройкой.  
  
#### <a name="to-run-the-host-application"></a>Для запуска ведущего приложения  
  
1.  В командной строке перейдите в каталог приложения и запустите основное приложение `Calc1Host.exe`.  
  
2.  Основное приложение находит все доступные надстройки его типа и вам будет предложено выбрать add-in. Введите **1** только доступные надстройки.  
  
3.  Введите формулу для калькулятора, такие как **2 + 2**. Должно быть пробелов между цифрами и знаком.  
  
4.  Тип **выхода** и нажмите клавишу **ввод** клавишу, чтобы закрыть приложение.  
  
## <a name="see-also"></a>См. также  
 [Пошаговое руководство: Включение обратной совместимости, как изменения узла](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
 [Пошаговое руководство: Передача коллекций между узлами и надстройки](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
 [Требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5)  
 [Контракты, представления и адаптеры](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c)  
 [Разработка конвейера](../../../docs/framework/add-ins/pipeline-development.md)
