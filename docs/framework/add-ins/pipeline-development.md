---
title: Разработка конвейера
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 2d889b7de4bc766deda9b91877ceefb4aebfc551
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/03/2018
---
# <a name="pipeline-development"></a><span data-ttu-id="72d5e-102">Разработка конвейера</span><span class="sxs-lookup"><span data-stu-id="72d5e-102">Pipeline Development</span></span>
<span data-ttu-id="72d5e-103">Конвейер надстройки — это путь сегментов конвейера, ведущее приложение и его надстройки необходимо использовать для взаимодействия друг с другом.</span><span class="sxs-lookup"><span data-stu-id="72d5e-103">The add-in pipeline is the path of pipeline segments that the host application and its add-in must use to communicate with each other.</span></span>  
  
 <span data-ttu-id="72d5e-104">Ниже показан конвейер взаимодействия и его сегменты.</span><span class="sxs-lookup"><span data-stu-id="72d5e-104">The following illustration shows the communication pipeline and its segments.</span></span>  
  
 <span data-ttu-id="72d5e-105">![Добавить&#45;в модель конвейера. ] (../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span><span class="sxs-lookup"><span data-stu-id="72d5e-105">![Add&#45;in pipeline model.](../../../docs/framework/add-ins/media/addin1.png "AddIn1")</span></span>  
<span data-ttu-id="72d5e-106">Конвейер надстройки</span><span class="sxs-lookup"><span data-stu-id="72d5e-106">Add-in pipeline</span></span>  
  
 <span data-ttu-id="72d5e-107">Основное приложение находится на одном конце конвейера и надстройки — на другом конце.</span><span class="sxs-lookup"><span data-stu-id="72d5e-107">The host application is at one end of the pipeline and the add-in is at the other end.</span></span> <span data-ttu-id="72d5e-108">Начиная с каждого конца и перемещаясь к середине, ведущее приложение и надстройка имеют абстрактный базовый класс, который определяет представление объектной модели, совместно используемое ими.</span><span class="sxs-lookup"><span data-stu-id="72d5e-108">Starting from each end and moving toward the middle, both the host application and the add-in have an abstract base class that defines a view of the object model that they both share.</span></span> <span data-ttu-id="72d5e-109">Эти типы (классы) составляют сегмента конвейера представление надстройки и серверное представление сегмента конвейера надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-109">These types (classes) make up the add-in view pipeline segment and the host view of the add-in pipeline segment.</span></span> <span data-ttu-id="72d5e-110">Сегмент трубопровода представления надстройки часто содержит более одного абстрактного класса, но надстройка наследует класс называется базой надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-110">The add-in view pipeline segment often contains more than one abstract class but the class that the add-in inherits from is known as the add-in base.</span></span>  
  
 <span data-ttu-id="72d5e-111">Сегмент трубопровода адаптера на стороне надстройки и адаптера узла конвейера сегмент convert поток типов между их сегменты представления конвейера и сегмент контракта в конвейер.</span><span class="sxs-lookup"><span data-stu-id="72d5e-111">The add-in-side adapter pipeline segment and the host-side adapter pipeline segment convert the flow of types between their view pipeline segments and the contract pipeline segment.</span></span> <span data-ttu-id="72d5e-112">Контракт, который является производным от является центральным сегментом конвейера <xref:System.AddIn.Contract.IContract> интерфейса.</span><span class="sxs-lookup"><span data-stu-id="72d5e-112">The central segment of the pipeline is a contract that is derived from the <xref:System.AddIn.Contract.IContract> interface.</span></span> <span data-ttu-id="72d5e-113">Этот контракт определяет методы, которые ведущим приложением и надстройкой будут использоваться.</span><span class="sxs-lookup"><span data-stu-id="72d5e-113">This contract defines the methods that the host application and its add-in will both use.</span></span>  
  
 <span data-ttu-id="72d5e-114">При загрузке основным приложением и надстройкой в отдельных доменах приложений, у вас есть границу изоляции, который разделяет области ведущего приложения из области действия надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-114">If you load the host and the add-in into separate application domains, you have an isolation boundary that separates the scope of the host application from the scope of the add-in.</span></span> <span data-ttu-id="72d5e-115">Контракт является только сборка, которая загружается на узле и доменами приложений надстроек.</span><span class="sxs-lookup"><span data-stu-id="72d5e-115">The contract is the only assembly that is loaded in both the host and add-in application domains.</span></span> <span data-ttu-id="72d5e-116">Основным приложением и надстройкой каждого ссылаться только на их просмотр методы контракта.</span><span class="sxs-lookup"><span data-stu-id="72d5e-116">The host and the add-in each refer only to their view of the contract methods.</span></span> <span data-ttu-id="72d5e-117">Таким образом они разделяются уровень абстракции от контракта.</span><span class="sxs-lookup"><span data-stu-id="72d5e-117">Therefore, they are separated by a layer of abstraction from the contract.</span></span>  
  
 <span data-ttu-id="72d5e-118">При разработке сегментов конвейера, необходимо создать структуру каталогов, которая будет содержать их.</span><span class="sxs-lookup"><span data-stu-id="72d5e-118">To develop pipeline segments, you must create a directory structure that will contain them.</span></span> <span data-ttu-id="72d5e-119">Дополнительные сведения о требованиях к разработки и рекомендации по области см. в разделе [требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span><span class="sxs-lookup"><span data-stu-id="72d5e-119">For more information about development requirements and scope guidelines, see [Pipeline Development Requirements](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).</span></span>  
  
 <span data-ttu-id="72d5e-120">Ниже показаны типы, которые составляют сегменты конвейера.</span><span class="sxs-lookup"><span data-stu-id="72d5e-120">The following illustration shows the types that make up the pipeline segments.</span></span> <span data-ttu-id="72d5e-121">Имена типов, показанных на рисунке произвольны, но всех типов, за исключением узел и узел просматривать атрибуты требуются надстройки, поэтому они могут быть обнаружены методы, составляющие хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="72d5e-121">The names of the types shown in the illustration are arbitrary, but all types except for the host and the host view of the add-in require attributes so they can be discovered by methods that construct an information store.</span></span>  
  
 <span data-ttu-id="72d5e-122">![Добавить&#45;в модели с обязательными атрибутами для типов. ] (../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span><span class="sxs-lookup"><span data-stu-id="72d5e-122">![Add&#45;in model with required attributes on types.](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")</span></span>  
<span data-ttu-id="72d5e-123">Конвейер надстройки с типами</span><span class="sxs-lookup"><span data-stu-id="72d5e-123">Add-in pipeline with types</span></span>  
  
 <span data-ttu-id="72d5e-124">В следующей таблице описаны сегменты конвейера для активации надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-124">The following table describes the pipeline segments for activating an add-in.</span></span> <span data-ttu-id="72d5e-125">Дополнительные сведения об этих сегментах см. в разделе [контракты, представления и адаптеры](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span><span class="sxs-lookup"><span data-stu-id="72d5e-125">For more information about these segments, see [Contracts, Views, and Adapters](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).</span></span>  
  
|<span data-ttu-id="72d5e-126">Сегмент конвейера</span><span class="sxs-lookup"><span data-stu-id="72d5e-126">Pipeline segment</span></span>|<span data-ttu-id="72d5e-127">Описание</span><span class="sxs-lookup"><span data-stu-id="72d5e-127">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="72d5e-128">Ведущее приложение</span><span class="sxs-lookup"><span data-stu-id="72d5e-128">Host</span></span>|<span data-ttu-id="72d5e-129">Сборка приложения, которая создает экземпляр надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-129">The application assembly that creates an instance of an add-in.</span></span>|  
|<span data-ttu-id="72d5e-130">Хост-представление надстройки</span><span class="sxs-lookup"><span data-stu-id="72d5e-130">Host view of the add-in</span></span>|<span data-ttu-id="72d5e-131">Представляет представление типов объектов и методов, используемых для взаимодействия с надстройкой ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="72d5e-131">Represents the host application's view of the object types and methods used to communicate with the add-in.</span></span> <span data-ttu-id="72d5e-132">Представление основного приложения — это абстрактный базовый класс или интерфейс.</span><span class="sxs-lookup"><span data-stu-id="72d5e-132">The host view is an abstract base class or interface.</span></span>|  
|<span data-ttu-id="72d5e-133">Адаптер узла</span><span class="sxs-lookup"><span data-stu-id="72d5e-133">Host-side adapter</span></span>|<span data-ttu-id="72d5e-134">Сборка с одного или нескольких классов, преобразует методы для и от контракта.</span><span class="sxs-lookup"><span data-stu-id="72d5e-134">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="72d5e-135">Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.HostAdapterAttribute> атрибута.</span><span class="sxs-lookup"><span data-stu-id="72d5e-135">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.HostAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="72d5e-136">Многомодульные сборки не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="72d5e-136">Multi-module assemblies are not supported.</span></span>|  
|<span data-ttu-id="72d5e-137">Контракт</span><span class="sxs-lookup"><span data-stu-id="72d5e-137">Contract</span></span>|<span data-ttu-id="72d5e-138">Интерфейс, который является производным от <xref:System.AddIn.Contract.IContract> интерфейс и который определяет протокол для взаимодействующих типов между основным приложением и надстройкой.</span><span class="sxs-lookup"><span data-stu-id="72d5e-138">An interface that is derived from the <xref:System.AddIn.Contract.IContract> interface and that defines the protocol for communicating types between the host and its add-in.</span></span><br /><br /> <span data-ttu-id="72d5e-139">Этот сегмент конвейера определяется <xref:System.AddIn.Pipeline.AddInContractAttribute> атрибута.</span><span class="sxs-lookup"><span data-stu-id="72d5e-139">This pipeline segment is identified by setting the <xref:System.AddIn.Pipeline.AddInContractAttribute> attribute.</span></span>|  
|<span data-ttu-id="72d5e-140">Адаптер на стороне надстройки</span><span class="sxs-lookup"><span data-stu-id="72d5e-140">Add-in-side adapter</span></span>|<span data-ttu-id="72d5e-141">Сборка с одного или нескольких классов, преобразует методы для и от контракта.</span><span class="sxs-lookup"><span data-stu-id="72d5e-141">An assembly with one or more classes that adapts methods to and from the contract.</span></span><br /><br /> <span data-ttu-id="72d5e-142">Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибута.</span><span class="sxs-lookup"><span data-stu-id="72d5e-142">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="72d5e-143">Каждая сборка в каталоге адаптера на стороне надстройки, который содержит тип, имеющий <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибут загружается в домен приложения надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-143">Each assembly in the add-in-side adapter directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInAdapterAttribute> attribute is loaded into the add-in's application domain.</span></span><br /><br /> <span data-ttu-id="72d5e-144">Каждая сборка в каталоге стороне надстройки загружается в свой собственный домен приложения.</span><span class="sxs-lookup"><span data-stu-id="72d5e-144">Each assembly in the add-in-side directory is loaded in its own application domain.</span></span><br /><br /> <span data-ttu-id="72d5e-145">Многомодульные сборки не поддерживаются.</span><span class="sxs-lookup"><span data-stu-id="72d5e-145">Multi-module assemblies are not supported</span></span>|  
|<span data-ttu-id="72d5e-146">Представление надстройки</span><span class="sxs-lookup"><span data-stu-id="72d5e-146">Add-in view</span></span>|<span data-ttu-id="72d5e-147">Сборку, которая представляет надстройки в представление типов объектов и методы, используемые для взаимодействия с узлом.</span><span class="sxs-lookup"><span data-stu-id="72d5e-147">An assembly that represents the add-in's view of the object types and methods that are used to communicate with the host.</span></span> <span data-ttu-id="72d5e-148">Представление надстройки — это абстрактный базовый класс или интерфейс.</span><span class="sxs-lookup"><span data-stu-id="72d5e-148">The add-in view is an abstract base class or interface.</span></span><br /><br /> <span data-ttu-id="72d5e-149">Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибута.</span><span class="sxs-lookup"><span data-stu-id="72d5e-149">This pipeline segment is identified by using the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute.</span></span><br /><br /> <span data-ttu-id="72d5e-150">Каждая сборка в каталоге AddInViews, который содержит тип, имеющий <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут загружается в домен приложения надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-150">Each assembly in the AddInViews directory that contains a type that has an <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute is loaded into the add-in's application domain.</span></span>|  
|<span data-ttu-id="72d5e-151">Надстройка</span><span class="sxs-lookup"><span data-stu-id="72d5e-151">Add-in</span></span>|<span data-ttu-id="72d5e-152">Экземпляры типа, который выполняет службы для узла.</span><span class="sxs-lookup"><span data-stu-id="72d5e-152">An instantiated type that performs a service for the host.</span></span>|  
  
## <a name="pipeline-activation-path"></a><span data-ttu-id="72d5e-153">Путь активации конвейера</span><span class="sxs-lookup"><span data-stu-id="72d5e-153">Pipeline Activation Path</span></span>  
 <span data-ttu-id="72d5e-154">На следующем рисунке активации типов при активизации add-in.</span><span class="sxs-lookup"><span data-stu-id="72d5e-154">The following illustration shows the activation of types when an add-in is activated.</span></span> <span data-ttu-id="72d5e-155">Он также показывает передача объектов узла, например результатов вычисления или коллекции объектов.</span><span class="sxs-lookup"><span data-stu-id="72d5e-155">It also shows the passing of objects to the host, such as the results of a calculation or a collection of objects.</span></span> <span data-ttu-id="72d5e-156">Это наиболее типичный сценарий.</span><span class="sxs-lookup"><span data-stu-id="72d5e-156">This is the most typical scenario.</span></span>  
  
 <span data-ttu-id="72d5e-157">![Добавить&#45;в модели с путем активации. ] (../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span><span class="sxs-lookup"><span data-stu-id="72d5e-157">![Add&#45;in model with activation path.](../../../docs/framework/add-ins/media/addin6.png "AddIn6")</span></span>  
<span data-ttu-id="72d5e-158">Путь активации из надстройки на узле</span><span class="sxs-lookup"><span data-stu-id="72d5e-158">Activation path from the add-in to the host</span></span>  
  
 <span data-ttu-id="72d5e-159">Путь активации конвейера происходит следующим образом:</span><span class="sxs-lookup"><span data-stu-id="72d5e-159">The activation path of the pipeline occurs as follows:</span></span>  
  
1.  <span data-ttu-id="72d5e-160">Ведущее приложение активирует надстройку в <xref:System.AddIn.Hosting.AddInToken.Activate%2A> метод.</span><span class="sxs-lookup"><span data-stu-id="72d5e-160">The host application activates the add-in with the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method.</span></span>  
  
2.  <span data-ttu-id="72d5e-161">Представление надстройки, надстройка, адаптер на стороне надстройки и контракта сборки загружаются в домен приложения надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-161">The add-in, add-in view, add-in-side adapter, and the contract assemblies are loaded into the add-in's application domain.</span></span>  
  
3.  <span data-ttu-id="72d5e-162">Экземпляр адаптера стороне надстройки создается с помощью представления надстройки (определяется в классе <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут) как его конструктор.</span><span class="sxs-lookup"><span data-stu-id="72d5e-162">An instance of the add-in-side adapter is created using the add-in view (with the class identified by the <xref:System.AddIn.Pipeline.AddInBaseAttribute> attribute) as its constructor.</span></span> <span data-ttu-id="72d5e-163">Адаптер на стороне надстройки наследует от контракта.</span><span class="sxs-lookup"><span data-stu-id="72d5e-163">The add-in-side adapter inherits from the contract.</span></span>  
  
4.  <span data-ttu-id="72d5e-164">Адаптер на стороне надстройки, который типизируется как контракт, передается конструктору узлового адаптера через границы изоляции (необязательно).</span><span class="sxs-lookup"><span data-stu-id="72d5e-164">The add-in-side adapter, which is typed as the contract, is passed across the (optional) isolation boundary to the host-side adapter's constructor.</span></span>  
  
5.  <span data-ttu-id="72d5e-165">Представление узла адаптер надстройки, главного узла и сборок контракта загружаются в домен приложения ведущего приложения.</span><span class="sxs-lookup"><span data-stu-id="72d5e-165">The host view of the add-in, host-side adapter, and the contract assemblies are loaded into the host's application domain.</span></span>  
  
6.  <span data-ttu-id="72d5e-166">Экземпляр адаптера узла создается с помощью контракта в качестве конструктора.</span><span class="sxs-lookup"><span data-stu-id="72d5e-166">An instance of the host-side adapter is created using the contract as its constructor.</span></span> <span data-ttu-id="72d5e-167">Адаптер хоста наследует от хост-представление надстройки.</span><span class="sxs-lookup"><span data-stu-id="72d5e-167">The host-side adapter inherits from the host view of the add-in.</span></span>  
  
7.  <span data-ttu-id="72d5e-168">Узел имеет надстройку, которая типизируется как основное представление надстройки и может продолжить вызывать его методы.</span><span class="sxs-lookup"><span data-stu-id="72d5e-168">The host has the add-in, which is typed as the host view of the add-in, and can continue calling its methods.</span></span>  
  
## <a name="walkthroughs"></a><span data-ttu-id="72d5e-169">Пошаговые руководства</span><span class="sxs-lookup"><span data-stu-id="72d5e-169">Walkthroughs</span></span>  
 <span data-ttu-id="72d5e-170">Существует три руководства, описывающие, как создавать конвейеры в Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="72d5e-170">There are three walkthrough topics that describe how to create pipelines using Visual Studio:</span></span>  
  
-   [<span data-ttu-id="72d5e-171">Пошаговое руководство. Создание расширяемого приложения</span><span class="sxs-lookup"><span data-stu-id="72d5e-171">Walkthrough: Creating an Extensible Application</span></span>](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     <span data-ttu-id="72d5e-172">Описание надстройки калькулятора, которая выполняет сложение, вычитание, умножение и деление для узла.</span><span class="sxs-lookup"><span data-stu-id="72d5e-172">Describes a calculator add-in that performs addition, subtraction, multiplication, and divsion calculations for the host.</span></span>  
  
-   [<span data-ttu-id="72d5e-173">Пошаговое руководство: Включение обратной совместимости, как изменения узла</span><span class="sxs-lookup"><span data-stu-id="72d5e-173">Walkthrough: Enabling Backward Compatibility as Your Host Changes</span></span>](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     <span data-ttu-id="72d5e-174">Описание надстройки калькулятора с улучшает возможности вычисления, а также для обеспечения совместимости с первой надстройки калькулятора.</span><span class="sxs-lookup"><span data-stu-id="72d5e-174">Describes a calculator add-in with enhanced calculation capabilities, and how to maintain compatibility with the first calculator add-in.</span></span>  
  
-   [<span data-ttu-id="72d5e-175">Пошаговое руководство: Передача коллекций между узлами и надстройки</span><span class="sxs-lookup"><span data-stu-id="72d5e-175">Walkthrough: Passing Collections Between Hosts and Add-Ins</span></span>](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     <span data-ttu-id="72d5e-176">Описывает способ передачи коллекций данных через конвейер с помощью сценария хранилище книги.</span><span class="sxs-lookup"><span data-stu-id="72d5e-176">Describes how to pass data collections over the pipeline using a book store scenario.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="72d5e-177">См. также</span><span class="sxs-lookup"><span data-stu-id="72d5e-177">See Also</span></span>  
 [<span data-ttu-id="72d5e-178">Сценарии конвейера надстройки</span><span class="sxs-lookup"><span data-stu-id="72d5e-178">Add-in Pipeline Scenarios</span></span>](http://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [<span data-ttu-id="72d5e-179">Надстройки и расширения среды</span><span class="sxs-lookup"><span data-stu-id="72d5e-179">Add-ins and Extensibility</span></span>](../../../docs/framework/add-ins/index.md)
