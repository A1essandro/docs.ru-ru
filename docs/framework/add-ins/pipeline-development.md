---
title: Разработка конвейера
ms.date: 03/30/2017
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: f981d667f3cbf35ab010ac5bd26a9ecd5c2aae11
ms.sourcegitcommit: 9bd8f213b50f0e1a73e03bd1e840c917fbd6d20a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/26/2018
ms.locfileid: "50135454"
---
# <a name="pipeline-development"></a>Разработка конвейера
Конвейер надстройки — это путь сегментов конвейера, ведущее приложение и его надстройки необходимо использовать для взаимодействия друг с другом.  
  
 Ниже показан конвейер взаимодействия и его сегменты.  
  
 ![Добавить&#45;в модели конвейера. ](../../../docs/framework/add-ins/media/addin1.png "AddIn1")  
Конвейер надстройки  
  
 Ведущее приложение находится на одном конце конвейера и надстройки — на другом конце. Начиная с каждого конца и перемещаясь к середине, ведущее приложение и надстройка имеют абстрактный базовый класс, определяющий представление объектной модели, оба они совместно используют. Эти типы (классы) составляют сегмента конвейера представления надстройки и серверное представление сегмента надстройки конвейера. Сегмента конвейера представления надстройки часто содержит более одного абстрактного класса, но класс надстройки наследует известен как база надстройки.  
  
 Адаптер на стороне надстройки сегмента конвейера и convert сегмента конвейера адаптера узла над передачей типов между их сегменты представления конвейера и сегмента конвейера контракта. Центральная сегмента конвейера — это контракт, который является производным от <xref:System.AddIn.Contract.IContract> интерфейс. Этот контракт определяет методы, которые ведущим приложением и надстройкой будут использоваться.  
  
 Если вы загружаете узла и надстройки в различные домены приложения, у вас есть границу изоляции, которая разделяет область ведущего приложения из области видимости из надстройки. Контракт — это единственная сборка, который загружается в узле и в доменах приложений надстроек. Основное приложение и надстройка каждого ссылаться только на их представление методов контракта. Таким образом они разделяются уровень абстракции от контракта.  
  
 Чтобы разработать сегменты конвейера, необходимо создать структуру каталогов, которая будет содержать их. Дополнительные сведения о требования к разработке и рекомендации по области, см. в разделе [требования к разработке конвейера](https://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
 Ниже приведены типы, составляющие сегментов конвейера. Имена типов, показано на рисунке произвольны, но всех типов, за исключением узла и узла просматривать атрибуты требуют надстройки, поэтому они могут быть обнаружены методы, составляющие хранилище данных.  
  
 ![Добавить&#45;в модели с обязательными атрибутами для типов. ](../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")  
Конвейер надстройки с типами  
  
 В следующей таблице описаны сегментов конвейера для активации надстройки. Дополнительные сведения об этих сегментах см. в разделе [контракты, представления и адаптеры](https://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).  
  
|Сегмента конвейера|Описание|  
|----------------------|-----------------|  
|Ведущее приложение|Сборка приложения, которая создает экземпляр надстройки.|  
|Серверное представление надстройки|Представляет представление ведущего приложения типы объектов и методы, используемые для взаимодействия с надстройкой. Представление главного приложения — это абстрактный базовый класс или интерфейс.|  
|Адаптер на стороне узла|Сборки с помощью одного или нескольких классов, адаптирующий методы для и от контракта.<br /><br /> Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.HostAdapterAttribute> атрибута.<br /><br /> Сборки с несколькими модулями не поддерживаются.|  
|Контракт|Интерфейс, который является производным от <xref:System.AddIn.Contract.IContract> интерфейс и который определяет протокол для взаимодействующих типов между основным приложением и надстройкой.<br /><br /> Этот сегмент конвейера определяется посредством задания <xref:System.AddIn.Pipeline.AddInContractAttribute> атрибута.|  
|Адаптер на стороне надстройки|Сборки с помощью одного или нескольких классов, адаптирующий методы для и от контракта.<br /><br /> Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибута.<br /><br /> Каждая сборка в каталоге адаптер на стороне надстройки, который содержит тип, имеющий <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибут загружается в домен приложения надстройки.<br /><br /> Каждая сборка в каталоге стороне надстройки загружается в свой собственный домен приложения.<br /><br /> Сборки с несколькими модулями не поддерживаются.|  
|Представление надстройки|Сборка, представляющий представление надстройки типы объектов и методов, которые используются для связи с узлом. Представление надстройки — это абстрактный базовый класс или интерфейс.<br /><br /> Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибута.<br /><br /> Каждая сборка в каталоге AddInViews, который содержит тип, имеющий <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут загружается в домен приложения надстройки.|  
|Надстройка|Экземпляры типа, который исполняет службу для узла.|  
  
## <a name="pipeline-activation-path"></a>Путь активации конвейера  
 Ниже показан активация типов при активации надстройки. Передача объектов также показано, для узла, например результаты вычисления или коллекции объектов. Это наиболее типичный сценарий.  
  
 ![Добавить&#45;в модели с путем активации. ](../../../docs/framework/add-ins/media/addin6.png "AddIn6")  
Путь активации из надстройки к узлу  
  
 Путь активации конвейера происходит следующим образом:  
  
1.  Ведущее приложение активирует надстройку в <xref:System.AddIn.Hosting.AddInToken.Activate%2A> метод.  
  
2.  Представление надстройки, надстройка, адаптер на стороне надстройки и контракта сборки загружаются в домен приложения надстройки.  
  
3.  Экземпляр адаптера на стороне надстройки создается с помощью представления надстройки (с классом, идентифицируемый <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут) как его конструктор. Адаптер на стороне надстройки наследует от контракта.  
  
4.  Адаптер на стороне надстройки, который типизируется как контракт, передается конструктору адаптер на стороне узла через границы изоляции (необязательно).  
  
5.  Серверное представление надстройки, -адаптер хоста и сборки контракта загружается в домен приложения ведущего приложения.  
  
6.  Экземпляр адаптера узла создается с помощью контракта в качестве конструктора. Адаптер наследует от серверное представление надстройки.  
  
7.  У узла есть надстройки, которая типизируется как основное представление надстройки и может продолжить вызывать его методы.  
  
## <a name="walkthroughs"></a>Пошаговые руководства  
 Существует три руководства, описывающие конвейеры с помощью Visual Studio.  
  
-   [Пошаговое руководство. Создание расширяемого приложения](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     Описание надстройки калькулятора, которая выполняет сложение, вычитание, умножение и деление для узла.  
  
-   [Пошаговое руководство: Включение обратной совместимости при изменении основного приложения](https://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     Описание надстройки калькулятора с улучшает возможности вычисления и как обеспечить совместимость с первой надстройки калькулятора.  
  
-   [Пошаговое руководство: Передача коллекций между узлами и надстройки](https://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     Описывает способ передачи коллекций данных через конвейер, с помощью сценария хранилище книги.  
  
## <a name="see-also"></a>См. также  
- [Сценарии конвейера надстройки](https://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
- [Надстройки и расширения среды](../../../docs/framework/add-ins/index.md)
