---
title: "Разработка конвейера"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- add-in pipeline [.NET Framework], segments
- activation path for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], activation path
- communication pipeline for add-ins [.NET Framework]
- add-in pipeline [.NET Framework], about
- add-ins [.NET Framework], pipeline development
ms.assetid: 932788f2-b87d-44cf-82f9-04492a8b2722
caps.latest.revision: "31"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 33646bbd7b0043cb5fc036b9b11aa4cf37cd537f
ms.sourcegitcommit: c0dd436f6f8f44dc80dc43b07f6841a00b74b23f
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2018
---
# <a name="pipeline-development"></a>Разработка конвейера
Конвейер надстройки — это путь сегментов конвейера, ведущее приложение и его надстройки необходимо использовать для взаимодействия друг с другом.  
  
 Ниже показан конвейер взаимодействия и его сегменты.  
  
 ![Добавить &#45; в модель конвейера. ] (../../../docs/framework/add-ins/media/addin1.png "AddIn1")  
Конвейер надстройки  
  
 Основное приложение находится на одном конце конвейера и надстройки — на другом конце. Начиная с каждого конца и перемещаясь к середине, ведущее приложение и надстройка имеют абстрактный базовый класс, который определяет представление объектной модели, совместно используемое ими. Эти типы (классы) составляют сегмента конвейера представление надстройки и серверное представление сегмента конвейера надстройки. Сегмент трубопровода представления надстройки часто содержит более одного абстрактного класса, но надстройка наследует класс называется базой надстройки.  
  
 Сегмент трубопровода адаптера на стороне надстройки и адаптера узла конвейера сегмент convert поток типов между их сегменты представления конвейера и сегмент контракта в конвейер. Контракт, который является производным от является центральным сегментом конвейера <xref:System.AddIn.Contract.IContract> интерфейса. Этот контракт определяет методы, которые ведущим приложением и надстройкой будут использоваться.  
  
 При загрузке основным приложением и надстройкой в отдельных доменах приложений, у вас есть границу изоляции, который разделяет области ведущего приложения из области действия надстройки. Контракт является только сборка, которая загружается на узле и доменами приложений надстроек. Основным приложением и надстройкой каждого ссылаться только на их просмотр методы контракта. Таким образом они разделяются уровень абстракции от контракта.  
  
 При разработке сегментов конвейера, необходимо создать структуру каталогов, которая будет содержать их. Дополнительные сведения о требованиях к разработки и рекомендации по области см. в разделе [требования к разработке конвейера](http://msdn.microsoft.com/library/ef9fa986-e80b-43e1-868b-247f4c1d9da5).  
  
 Ниже показаны типы, которые составляют сегменты конвейера. Имена типов, показанных на рисунке произвольны, но всех типов, за исключением узел и узел просматривать атрибуты требуются надстройки, поэтому они могут быть обнаружены методы, составляющие хранилище данных.  
  
 ![Добавить &#45; в модели с обязательными атрибутами для типов. ] (../../../docs/framework/add-ins/media/addin-model.png "AddIn_Model")  
Конвейер надстройки с типами  
  
 В следующей таблице описаны сегменты конвейера для активации надстройки. Дополнительные сведения об этих сегментах см. в разделе [контракты, представления и адаптеры](http://msdn.microsoft.com/library/a6460173-9507-4b87-8c07-d4ee245d715c).  
  
|Сегмент конвейера|Описание:|  
|----------------------|-----------------|  
|Ведущее приложение|Сборка приложения, которая создает экземпляр надстройки.|  
|Хост-представление надстройки|Представляет представление типов объектов и методов, используемых для взаимодействия с надстройкой ведущего приложения. Представление основного приложения — это абстрактный базовый класс или интерфейс.|  
|Адаптер узла|Сборка с одного или нескольких классов, преобразует методы для и от контракта.<br /><br /> Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.HostAdapterAttribute> атрибута.<br /><br /> Многомодульные сборки не поддерживаются.|  
|Контракт|Интерфейс, который является производным от <xref:System.AddIn.Contract.IContract> интерфейс и который определяет протокол для взаимодействующих типов между основным приложением и надстройкой.<br /><br /> Этот сегмент конвейера определяется <xref:System.AddIn.Pipeline.AddInContractAttribute> атрибута.|  
|Адаптер на стороне надстройки|Сборка с одного или нескольких классов, преобразует методы для и от контракта.<br /><br /> Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибута.<br /><br /> Каждая сборка в каталоге адаптера на стороне надстройки, который содержит тип, имеющий <xref:System.AddIn.Pipeline.AddInAdapterAttribute> атрибут загружается в домен приложения надстройки.<br /><br /> Каждая сборка в каталоге стороне надстройки загружается в свой собственный домен приложения.<br /><br /> Многомодульные сборки не поддерживаются.|  
|Представление надстройки|Сборку, которая представляет надстройки в представление типов объектов и методы, используемые для взаимодействия с узлом. Представление надстройки — это абстрактный базовый класс или интерфейс.<br /><br /> Этот сегмент конвейера определяется с помощью <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибута.<br /><br /> Каждая сборка в каталоге AddInViews, который содержит тип, имеющий <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут загружается в домен приложения надстройки.|  
|Надстройка|Экземпляры типа, который выполняет службы для узла.|  
  
## <a name="pipeline-activation-path"></a>Путь активации конвейера  
 На следующем рисунке активации типов при активизации add-in. Он также показывает передача объектов узла, например результатов вычисления или коллекции объектов. Это наиболее типичный сценарий.  
  
 ![Добавить &#45; в модель с путем активации. ] (../../../docs/framework/add-ins/media/addin6.png "AddIn6")  
Путь активации из надстройки на узле  
  
 Путь активации конвейера происходит следующим образом:  
  
1.  Ведущее приложение активирует надстройку в <xref:System.AddIn.Hosting.AddInToken.Activate%2A> метод.  
  
2.  Представление надстройки, надстройка, адаптер на стороне надстройки и контракта сборки загружаются в домен приложения надстройки.  
  
3.  Экземпляр адаптера стороне надстройки создается с помощью представления надстройки (определяется в классе <xref:System.AddIn.Pipeline.AddInBaseAttribute> атрибут) как его конструктор. Адаптер на стороне надстройки наследует от контракта.  
  
4.  Адаптер на стороне надстройки, который типизируется как контракт, передается конструктору узлового адаптера через границы изоляции (необязательно).  
  
5.  Представление узла адаптер надстройки, главного узла и сборок контракта загружаются в домен приложения ведущего приложения.  
  
6.  Экземпляр адаптера узла создается с помощью контракта в качестве конструктора. Адаптер хоста наследует от хост-представление надстройки.  
  
7.  Узел имеет надстройку, которая типизируется как основное представление надстройки и может продолжить вызывать его методы.  
  
## <a name="walkthroughs"></a>Пошаговые руководства  
 Существует три руководства, описывающие, как создавать конвейеры в Visual Studio.  
  
-   [Пошаговое руководство. Создание расширяемого приложения](../../../docs/framework/add-ins/walkthrough-create-extensible-app.md)  
  
     Описание надстройки калькулятора, которая выполняет сложение, вычитание, умножение и деление для узла.  
  
-   [Пошаговое руководство: Включение обратной совместимости, как изменения узла](http://msdn.microsoft.com/library/6fa15bb5-8f04-407d-bd7d-675dc043c848)  
  
     Описание надстройки калькулятора с улучшает возможности вычисления, а также для обеспечения совместимости с первой надстройки калькулятора.  
  
-   [Пошаговое руководство: Передача коллекций между узлами и надстройки](http://msdn.microsoft.com/library/b532c604-548e-4fab-b11c-377257dd0ee5)  
  
     Описывает способ передачи коллекций данных через конвейер с помощью сценария хранилище книги.  
  
## <a name="see-also"></a>См. также  
 [Сценарии конвейера надстройки](http://msdn.microsoft.com/library/feb70e0b-8734-494c-aeaf-b567f014043e)  
 [Надстройки и расширения среды](../../../docs/framework/add-ins/index.md)
