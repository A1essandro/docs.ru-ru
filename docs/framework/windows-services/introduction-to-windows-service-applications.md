---
title: Знакомство с приложениями служб Windows
ms.date: 03/30/2017
f1_keywords:
- ServiceController
helpviewer_keywords:
- Windows Service applications, deploying
- OnStop method
- OnPause method
- services, about services
- Service class, Windows Service applications
- framework services, creating services
- ServiceController components, about Windows services
- Win32OwnProcess service type
- services, lifetime
- OnContinue method
- Windows Service applications, about Windows Service applications
- services, states
- service states
- WaitForStatus method
- Win32ShareProcess service type
- Windows Service applications, lifetime
ms.assetid: 1b1b5e67-3ff3-40c0-8154-322cfd6ef0ae
author: ghogen
manager: douge
ms.openlocfilehash: e0720b90d89e5117cbac15ce7e38a41071f1c13e
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
---
# <a name="introduction-to-windows-service-applications"></a>Знакомство с приложениями служб Windows
Службы Microsoft Windows, ранее известные как службы NT, позволяют создавать долго выполняющихся исполняемыми приложениями, которые выполняются в собственных сеансах Windows. Эти службы могут запускаться автоматически при запуске компьютера, можно приостановить и перезапустить и не содержат элементов пользовательского интерфейса. Эти особенности делают службы идеальным для использования на сервере, или каждый раз, когда требуется длительное время, не влияют на работу других пользователей, работающих на том же компьютере. Службы могут выполняться в контексте безопасности определенной учетной записи пользователя, отличное от вошедшего в систему пользователя или учетной записи компьютера по умолчанию. Дополнительные сведения о службах и сеансах Windows см. в документации пакета SDK для Windows.  
  
 Можно легко создавать службы путем создания приложения, которое устанавливается как служба. Например предположим, что нужно отслеживать данные счетчика производительности и реагировать на пороговые значения. Можно написать приложение службы Windows, прослушивающая данных счетчиков производительности, развертывания приложения и начать сбор и анализ данных.  
  
 Создании службы как проект Microsoft Visual Studio, определение код внутри него, который определяет, какие команды могут отправляться в службе и какие действия должны быть выполнены, при получении этих команд. Команды, которые могут быть отправлены в службу включают запуск, приостановка, возобновление и остановке службы; Можно также выполнять пользовательские команды.  
  
 После создания и построения приложения, его можно установить, запустив программу командной строки InstallUtil.exe и передача пути к исполняемому файлу службы. Затем можно использовать **диспетчера управления службами** Чтобы запустить, остановить, приостановить, возобновить и настроить службу. Можно также выполнять многие из этих задач в **службы** узел в **обозревателя серверов** или с помощью <xref:System.ServiceProcess.ServiceController> класса.  
  
## <a name="service-applications-vs-other-visual-studio-applications"></a>Приложения-службы или. Другие приложения Visual Studio  
 Функция службы приложений отличается от других типов проектов несколькими способами:  
  
-   Скомпилированный исполняемый файл, который создает проект приложения службы должны устанавливаться на сервере, чтобы проект можно работать более удобным образом. Не удается выполнить отладку или запустите приложение службы, нажав клавишу F5 или F11; Невозможно запустить сразу же службы или этапа в его код. Вместо этого необходимо установить и запустить службу и затем присоединить отладчик к процессу службы. Дополнительные сведения см. в разделе [как: отладка приложений служб Windows](../../../docs/framework/windows-services/how-to-debug-windows-service-applications.md).  
  
-   В отличие от некоторых типах проектов необходимо создать компонента установки для приложений служб. Компоненты установки установить и зарегистрировать службу на сервере и создать запись для службы с помощью Windows **диспетчера управления службами**. Дополнительные сведения см. в разделе [как: добавление установщиков к приложению службы](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md).  
  
-   `Main` Метод для приложения службы должен выдать команду запуска службы проекта содержит. `Run` Метод загружает службы в **диспетчера управления службами** на соответствующем сервере. Если вы используете **служб Windows** шаблона проекта, этот метод создается автоматически. Обратите внимание, что загрузка службы — не то же самое, что ее запуск. В разделе «Время существования службы» ниже для получения дополнительной информации.  
  
-   Приложения служб Windows выполняются в отдельной рабочей станции, отличной от станции вошедшего пользователя. Рабочая станция является безопасной объект, содержащий буфер обмена, набор глобальных атомами и группу объектов рабочего стола. Поскольку станция службы Windows не интерактивной, диалоговые окна, создаваемые приложения службы не будут видны и могут привести к зависанию программы Windows. Аналогичным образом сообщения об ошибках должны записываться в журнал событий Windows, а не появляется в пользовательском интерфейсе.  
  
     Классы служб Windows, поддерживаемые .NET Framework не поддерживают взаимодействие с интерактивной станции, то есть, вошедшего в систему пользователя. .NET Framework также включает классы, представляющие станции и рабочие столы. Если служба Windows должна взаимодействовать с другими станциями, необходимо будет получить доступ к неуправляемый интерфейс API Windows. Дополнительные сведения см. в документации пакета SDK для Windows.  
  
     Взаимодействие службы с пользователем или другими станциями должно быть тщательно спроектировано с учетом таких ситуаций существует как нет пользователя или пользователя, имеющего непредвиденный набор объектов рабочего стола Windows. В некоторых случаях может быть более удобным использовать для написания приложения Windows, работающего под управлением пользователя.  
  
-   Приложения служб Windows выполняются в контексте безопасности и запускаются до входа пользователя в компьютер Windows, на котором они установлены. Следует тщательно Планируйте какую учетную запись пользователя для запуска службы Служба выполняется под учетной записью системы имеет дополнительные разрешения и права доступа, чем учетная запись пользователя.  
  
## <a name="service-lifetime"></a>Время существования службы  
 Служба проходит через несколько состояний за время его существования. Во-первых служба устанавливается на компьютер, на котором будут выполняться. Этот процесс для проекта службы установщики и загружает службу в **диспетчера управления службами** для этого компьютера. **Диспетчера управления службами** является основным средством управления службами Windows.  
  
 После загрузки службы ее необходимо запустить. После запуска служба может выполнять свои задачи. Можно запустить службу из **диспетчера управления службами**, из **обозревателя серверов**, или программным путем вызова <xref:System.ServiceProcess.ServiceController.Start%2A> метод. <xref:System.ServiceProcess.ServiceController.Start%2A> Метод передает обработку в приложение <xref:System.ServiceProcess.ServiceBase.OnStart%2A> метод и обрабатывает любой код, содержащийся.  
  
 Служба может находиться в этом состоянии бесконечно, пока он не будет остановлена или приостановлена или до завершения работы компьютера. Существуют три основных состояния службы: <xref:System.ServiceProcess.ServiceControllerStatus.Running>, <xref:System.ServiceProcess.ServiceControllerStatus.Paused>, или <xref:System.ServiceProcess.ServiceControllerStatus.Stopped>. Служба также может сообщать о состоянии ожидания выполнения команды: <xref:System.ServiceProcess.ServiceControllerStatus.ContinuePending>, <xref:System.ServiceProcess.ServiceControllerStatus.PausePending>, <xref:System.ServiceProcess.ServiceControllerStatus.StartPending>, или <xref:System.ServiceProcess.ServiceControllerStatus.StopPending>. Эти состояния указывают, что команда была выполнена, например, команда приостановки или запуска службы, но не была выполнена еще. Вы можете запрашивать <xref:System.ServiceProcess.ServiceController.Status%2A> чтобы определить, в каком состоянии находится служба, или используйте <xref:System.ServiceProcess.ServiceController.WaitForStatus%2A> выполнить действие, если любой из этих состояний происходит.  
  
 Можно приостановить, остановить или возобновить работу службы из **диспетчера управления службами**, из **обозревателя серверов**, или путем вызова методов в коде. Каждое из этих действий вызывает соответствующую процедуру, в службе (<xref:System.ServiceProcess.ServiceBase.OnStop%2A>, <xref:System.ServiceProcess.ServiceBase.OnPause%2A>, или <xref:System.ServiceProcess.ServiceBase.OnContinue%2A>), в котором можно определить дополнительной обработки, выполняемой при изменении состояния службы.  
  
## <a name="types-of-services"></a>Типы служб  
 Существует два типа службы, которые можно создать в Visual Studio с помощью .NET Framework. Службы, которые являются только службы в процессе назначается тип <xref:System.ServiceProcess.ServiceType.Win32OwnProcess>. Службы, находящиеся в процессе совместно с другими службами, назначается тип <xref:System.ServiceProcess.ServiceType.Win32ShareProcess>. Тип службы можно получить, запросив <xref:System.ServiceProcess.ServiceController.ServiceType%2A> свойство.  
  
 Считать служб других типов при выполнении запроса служб, которые не были созданы в Visual Studio. Дополнительные сведения об этом см. в разделе <xref:System.ServiceProcess.ServiceType>.  
  
## <a name="services-and-the-servicecontroller-component"></a>Службы и с помощью компонента ServiceController  
 <xref:System.ServiceProcess.ServiceController> Компонент будет использоваться для подключения к установленной службе и изменения ее состояния; с помощью <xref:System.ServiceProcess.ServiceController> компонента, можно запустить и остановить службу, приостановить и продолжить выполнение и отправить службе пользовательские команды. Тем не менее, необходимо использовать <xref:System.ServiceProcess.ServiceController> компонента при создании приложения службы. Фактически в большинстве случаев вашей <xref:System.ServiceProcess.ServiceController> компонента должна находиться в отдельном приложении из приложения службы Windows, который определяет службу.  
  
 Дополнительные сведения см. в разделе <xref:System.ServiceProcess.ServiceController>.  
  
## <a name="requirements"></a>Требования  
  
-   Службы должны создаваться в **службы Windows** проект приложения или другой проект, поддерживающие .NET Framework, который создает файл .exe при построении и наследует от <xref:System.ServiceProcess.ServiceBase> класса.  
  
-   Проектов, содержащих службы Windows должны быть компоненты установки для проекта и его службы. Это легко сделать с **свойства** окна. Дополнительные сведения см. в разделе [как: добавление установщиков к приложению службы](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md).  
  
## <a name="see-also"></a>См. также  
 [Приложения служб Windows](../../../docs/framework/windows-services/index.md)  
 [Программная архитектура приложений служб](../../../docs/framework/windows-services/service-application-programming-architecture.md)  
 [Практическое руководство. Создание служб Windows](../../../docs/framework/windows-services/how-to-create-windows-services.md)  
 [Практическое руководство. Установка и удаление служб](../../../docs/framework/windows-services/how-to-install-and-uninstall-services.md)  
 [Практическое руководство. Запуск служб](../../../docs/framework/windows-services/how-to-start-services.md)  
 [Практическое руководство. Отладка приложений служб Windows](../../../docs/framework/windows-services/how-to-debug-windows-service-applications.md)  
 [Пошаговое руководство. Создание приложения служб Windows в конструкторе компонентов](../../../docs/framework/windows-services/walkthrough-creating-a-windows-service-application-in-the-component-designer.md)  
 [Практическое руководство. Добавление установщиков в приложение служб](../../../docs/framework/windows-services/how-to-add-installers-to-your-service-application.md)
