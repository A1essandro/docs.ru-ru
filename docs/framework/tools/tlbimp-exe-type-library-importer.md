---
title: "Tlbimp.exe (Type Library Importer) | Microsoft Docs"
ms.custom: ""
ms.date: "03/30/2017"
ms.prod: ".net-framework"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "dotnet-clr"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
helpviewer_keywords: 
  - "type libraries [.NET Framework], importing"
  - "importing type library"
  - "Tlbimp.exe"
  - "type definition conversion"
  - "Type Library Importer"
  - "type libraries"
  - "converting type definitions"
ms.assetid: ec0a8d63-11b3-4acd-b398-da1e37e97382
caps.latest.revision: 29
author: "rpetrusha"
ms.author: "ronpet"
manager: "wpickett"
caps.handback.revision: 27
---
# Tlbimp.exe (Type Library Importer)
Программа импорта библиотек типов преобразует определения типов, содержащиеся в библиотеке типов COM, в эквивалентные определения сборки среды CLR.  Tlbimp.exe выводит двоичный файл \(сборку\), содержащий метаданные среды выполнения для типов, определенных в исходной библиотеке типов.  Этот файл можно просмотреть с помощью таких средств, как [Ildasm.exe](../../../docs/framework/tools/ildasm-exe-il-disassembler.md).  
  
 Эта программа автоматически устанавливается вместе с Visual Studio.  Программу можно запустить из командной строки разработчика \(или из командной строки Visual Studio в Windows 7\).  Дополнительные сведения см. в разделе [Командные строки](../../../docs/framework/tools/developer-command-prompt-for-vs.md).  
  
 В командной строке введите следующее.  
  
## Синтаксис  
  
```  
  
tlbimp tlbFile [options]  
```  
  
#### Параметры  
  
|Аргумент|Описание|  
|--------------|--------------|  
|*tlbFile*|Имя любого файла, содержащего библиотеку типов COM.|  
  
|Параметр|Описание|  
|--------------|--------------|  
|**\/asmversion:** *номер\_версии*|Задает номер версии создаваемой сборки.  Аргумент *номер\_версии* задается в формате *главная.вспомогательная.построение.редакция*.|  
|**\/company:** `companyinformation`|Добавляет сведения об организации в выходную сборку.|  
|**\/copyright:** `copyrightinformation`|Добавляет сведения об авторских правах в выходную сборку.  Эти сведения можно просмотреть в диалоговом окне **Свойства файла** сборки.|  
|**\/delaysign**|Указывает Tlbimp.exe подписать результирующую сборку строгим именем с использованием отложенной подписи.  Этот параметр необходимо задавать вместе с параметром **\/keycontainer:**, **\/keyfile:** или **\/publickey:**.  Дополнительные сведения о процессе отложенной подписи см. в разделе [Отложенная подпись сборки](../../../docs/framework/app-domains/delay-sign-assembly.md).|  
|**\/help**|Отображает синтаксис команд и параметров программы.|  
|**\/keycontainer:** *имя\_контейнера*|Подписывает результирующую сборку строгим именем, используя пару ключей \(открытый\-закрытый\) из контейнера ключей, заданного аргументом *имя\_контейнера*.|  
|**\/keyfile:** *имя\_файла*|Подписывает результирующую сборку строгим именем, используя официальную пару ключей издателя \(открытый\-закрытый\) из файла *имя\_файла*.|  
|**\/machine:** `machinetype`|Создает сборку, ориентированную на указанный тип компьютера \(микропроцессор\).  Поддерживаемые типы компьютеров: x86, x64, Itanium и кроссплатформенный.|  
|**\/namespace:** *пространство\_имен*|Задает пространство имен, в котором создается сборка.|  
|**\/noclassmembers**|Блокирует добавление программой Tlbimp.exe членов в классы.  Это позволяет избежать исключения <xref:System.TypeLoadException>.|  
|**\/nologo**|Отключает отображение эмблемы Майкрософт при запуске.|  
|**\/out:** *имя\_файла*|Задает имя выходного файла, сборки и пространства имен, в который записываются определения метаданных.  Параметр **\/out** не влияет на пространство имен сборки, если библиотека типов задает пользовательский атрибут IDL, который явно определяет пространство имен сборки.  Если этот параметр не задан, Tlbimp.exe записывает метаданные в файл с именем фактической библиотеки типов, определенной во входном файле, и присваивает ему расширение DLL.  Если имя выходного файла совпадает с именем входного файла, программа выдаст ошибку для предотвращения перезаписи библиотеки типов.|  
|**\/primary**|Создает основную сборку взаимодействия для указанной библиотеки типов.  В сборку добавляются сведения о том, что ее создал издатель библиотеки типов.  Если задать основную сборку взаимодействия, то сборку издателя можно будет отличить от других сборок, созданных на основе библиотеки типов с помощью Tlbimp.exe.  Параметр **\/primary** должен указываться только издателем библиотеки типов, импортируемой при помощи средства Tlbimp.exe.  Обратите внимание, что основную сборку взаимодействия необходимо подписывать [строгим именем](../../../docs/framework/app-domains/strong-named-assemblies.md).  Дополнительные сведения см. в разделе [Основные сборки взаимодействия](http://msdn.microsoft.com/ru-ru/b977a8be-59a0-40a0-a806-b11ffba5c080).|  
|**\/product:** `productinformation`|Добавляет сведения о продукте в выходную сборку.  Эти сведения можно просмотреть в диалоговом окне **Свойства файла** сборки.|  
|**\/productversion:** `productversioninformation`|Добавляет сведения о версии продукта в выходную сборку.  Можно использовать любой формат.  Эти сведения можно просмотреть в диалоговом окне **Свойства файла** сборки.|  
|**\/publickey:** *имя\_файла*|Задает файл, содержащий открытый ключ для подписи результирующей сборки.  Если вместо параметра **\/publickey:** задан параметр **\/keyfile:** или **\/keycontainer:**, программа Tlbimp.exe создает открытый ключ из пары "открытый\-закрытый", заданной в параметре **\/keyfile:** или **\/keycontainer:**.  Параметр **\/publickey:**  поддерживает сценарии тестовых ключей и отложенной подписи.  Файл имеет формат файлов, создаваемых средством Sn.exe.  Дополнительные сведения см. в сведениях о параметре **\-p** программы Sn.exe в разделе [Программа Strong Name \(Sn.exe\)](../../../docs/framework/tools/sn-exe-strong-name-tool.md).|  
|**\/reference:** *имя\_файла*|Задает файл сборки, который используется для разрешения ссылок на типы, определенные вне текущей библиотеки типов.  Если параметр **\/reference**  не задан, программа Tlbimp.exe автоматически выполняет рекурсивный импорт всех внешних библиотек типов, на которые ссылается импортируемая библиотека типов.  Если параметр **\/reference**  задан, перед импортом других библиотек типов программа пытается разрешить внешние типы в сборках, на которые имеются ссылки.|  
|**\/silence:** `warningnumber`|Отключает отображение конкретного предупреждения.  Этот параметр невозможно использовать с параметром **\/silent**.|  
|**\/silent**|Запрещает отображение сообщений об успешно выполненных операциях.  Этот параметр невозможно использовать с параметром **\/silence**.|  
|**\/strictref**|Не импортирует библиотеку типов, если программа не может разрешить все ссылки в текущей сборке, в сборках, заданных параметром **\/reference**, или в зарегистрированных основных сборках взаимодействия.|  
|**\/strictref:nopia**|Эквивалентен **\/strictref**, однако игнорирует первичные сборки взаимодействия.|  
|**\/sysarray**|Задает программу для импорта типа SafeArray стиля COM как управляемого типа [класса System.Array](frlrfSystemArrayClassTopic).|  
|**\/tlbreference:** *имя\_файла*|Задает файл библиотеки типов для разрешения ссылок на библиотеку типов без обращения к реестру.<br /><br /> Обратите внимание, что при выборе этого параметра не будут загружаться некоторые более старые форматы библиотек типов.  Однако их можно загрузить неявным образом с помощью реестра или текущего каталога.|  
|**\/trademark:** `trademarkinformation`|Добавляет сведения о товарном знаке в выходную сборку.  Эти сведения можно просмотреть в диалоговом окне **Свойства файла** сборки.|  
|**\/transform:** *имя\_преобразования*|Преобразует метаданные в соответствии с параметром *имя\_преобразования*.<br /><br /> Задайте параметру *имя\_преобразования* значение **dispret**, чтобы преобразовать параметры \[out, retval\] методов интерфейсов диспетчеризации в возвращаемые значения.<br /><br /> Дополнительные сведения об этом параметре см. далее в примерах этого раздела.|  
|**\/unsafe**|Создает интерфейсы, не выполняя проверки безопасности .NET Framework.  Вызов метода в данной форме может создавать угрозу безопасности.  Этот параметр следует использовать только в том случае, если вам известно о рисках, связанных с вызовом этого кода.|  
|**\/verbose**|Задает режим подробного протоколирования; отображает дополнительные сведения об импортируемой библиотеке типов.|  
|**\/VariantBoolFieldToBool**|Преобразует поля `VARIANT_BOOL` в структурах в <xref:System.Boolean>.|  
|**\/?**|Отображает синтаксис команд и параметров программы.|  
  
> [!NOTE]
>  В параметрах командной строки для Tlbimp.exe не учитывается регистр и они могут задаваться в любом порядке.  Можно вводить только часть имени параметра, достаточную для его однозначной идентификации.  То есть запись **\/n** эквивалентна записи **\/nologo**, а **\/ou:** *outfile.dll* — записи **\/out:** *outfile.dll*.  
  
## Заметки  
 Tlbimp.exe преобразует только библиотеки типов целиком.  С помощью этой программы невозможно создать сведения о подмножестве типов, определенных в одной библиотеке типов.  
  
 Часто бывает удобно или необходимо присваивать сборкам [строгие имена](../../../docs/framework/app-domains/strong-named-assemblies.md).  Поэтому Tlbimp.exe имеет параметры, позволяющие предоставлять сведения, необходимые для создания сборок со строгими именами.  Как параметр **\/keyfile:**, так и параметр **\/keycontainer:** подписывают сборки строгими именами.  Поэтому логично использовать только один из этих параметров.  
  
 Можно указать несколько ссылочных сборок, используя параметр **\/reference** несколько раз.  
  
 При импорте библиотеки типов из модуля, содержащего несколько библиотек типов, к файлу библиотеки типов можно добавить идентификатор ресурса.  Tlbimp.exe находит этот файл, только если он расположен в текущем каталоге или к нему задан полный путь.  См. пример далее в этом разделе.  
  
## Примеры  
 Следующая команда создает сборку с таким же именем, как у библиотеки типов в `myTest.tlb`, и расширением DLL.  
  
```  
tlbimp myTest.tlb   
```  
  
 Следующая команда создает сборку с именем `myTest.dll`.  
  
```  
tlbimp  myTest.tlb  /out:myTest.dll  
```  
  
 Следующая команда создает сборку с таким же именем, как у заданной `MyModule.dll\1` библиотеки типов, и расширением DLL.  Сборка `MyModule.dll\1` должна находиться в текущем каталоге.  
  
```  
tlbimp MyModule.dll\1  
```  
  
 Следующая команда создает сборку с именем `myTestLib.dll` для библиотеки типов `TestLib.dll`.  Параметр **\/transform:dispret**  преобразует все параметры \[out, retval\] методов в интерфейсах диспетчеризации из библиотеки типов в возвращаемые значения в управляемой библиотеке.  
  
```  
tlbimp TestLib.dll /transform:dispret /out:myTestLib.dll  
```  
  
 Библиотека типов `TestLib.dll` из предыдущего примера включает метод интерфейса диспетчеризации с именем `SomeMethod`, который возвращает тип void и имеет параметр \[out, retval\].  Следующая строка кода является подписью метода входной библиотеки типов для метода`SomeMethod` в библиотеке `TestLib.dll`.  
  
```  
void SomeMethod([out, retval] VARIANT_BOOL*);  
```  
  
 Если задан параметр **\/transform:dispret**, программа Tlbimp.exe преобразует параметр `[out, retval]` метода `SomeMethod`  в возвращаемое значение `bool`.  Ниже представлена подпись метода, создаваемая программой Tlbimp.exe для метода `SomeMethod` в управляемой библиотеке `myTestLib.dll`, когда задан параметр **\/transform:dispret**.  
  
```csharp  
bool SomeMethod();  
```  
  
 Если вы создаете с помощью Tlbimp.exe управляемую библиотеку для `TestLib.dll` и не задаете параметр **\/transform:dispret**, программа создаст следующую подпись метода для метода `SomeMethod` в управляемой библиотеке `myTestLib.dll`.  
  
```csharp  
void SomeMethod(out bool x);  
```  
  
## См. также  
 [Tools](../../../docs/framework/tools/index.md)   
 [Tlbexp.exe \(Type Library Exporter\)](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)   
 [Importing a Type Library as an Assembly](../../../docs/framework/interop/importing-a-type-library-as-an-assembly.md)   
 [Type Library to Assembly Conversion Summary](http://msdn.microsoft.com/ru-ru/bf3f90c5-4770-4ab8-895c-3ba1055cc958)   
 [Ildasm.exe \(IL Disassembler\)](../../../docs/framework/tools/ildasm-exe-il-disassembler.md)   
 [Sn.exe \(Strong Name Tool\)](../../../docs/framework/tools/sn-exe-strong-name-tool.md)   
 [Сборки со строгими именами](../../../docs/framework/app-domains/strong-named-assemblies.md)   
 [Attributes for Importing Type Libraries into Interop Assemblies](http://msdn.microsoft.com/ru-ru/81e587b8-393f-43e1-9add-c4b05e65cbfd)   
 [Командные строки](../../../docs/framework/tools/developer-command-prompt-for-vs.md)