---
title: Практическое руководство. Настройка приложения для поддержки платформы .NET Framework 4 или 4.5
ms.date: 03/30/2017
helpviewer_keywords:
- configuring apps to support .NET Framework 4
- .NET Framework 4, configuring apps
- .NET Framework 4.5, configuring apps
ms.assetid: 63c6b9a8-0088-4077-9aa3-521ab7290f79
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 45044e286fa48149c117e97c2e22aa8a0b7d5ce3
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/04/2018
ms.locfileid: "33393706"
---
# <a name="how-to-configure-an-app-to-support-net-framework-4-or-45"></a><span data-ttu-id="8a908-102">Практическое руководство. Настройка приложения для поддержки платформы .NET Framework 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-102">How to: Configure an App to Support .NET Framework 4 or 4.5</span></span>
<span data-ttu-id="8a908-103">Все приложения, которые размещают в себе среду CLR, должны запускать или *активировать* среду CLR для выполнения управляемого кода.</span><span class="sxs-lookup"><span data-stu-id="8a908-103">All apps that host the common language runtime (CLR) need to start, or *activate*, the CLR in order to run managed code.</span></span> <span data-ttu-id="8a908-104">Как правило, приложение .NET Framework запускается в той версии среды CLR, в которой оно было собрано, однако для приложений для настольных систем это поведение можно изменить с помощью файла конфигурации приложения (иногда называемого файлом app.config).</span><span class="sxs-lookup"><span data-stu-id="8a908-104">Typically, a   .NET Framework app runs on the version of the CLR that it was built on, but you can change this behavior for desktop apps by using an application configuration file (sometimes referred to as an app.config file).</span></span> <span data-ttu-id="8a908-105">Однако, для приложений Магазина Windows или приложений Windows Phone, изменить предусмотренное по умолчанию поведение активации с помощью файла конфигурации приложения невозможно.</span><span class="sxs-lookup"><span data-stu-id="8a908-105">However, you cannot change the default activation behavior for Windows Store apps or Windows Phone apps by using an application configuration file.</span></span> <span data-ttu-id="8a908-106">В этой статье поясняется, как разрешить приложению для настольных систем запускаться в другой версии .NET Framework, а также приводятся примеры нацеливания на версию 4 или 4.5.</span><span class="sxs-lookup"><span data-stu-id="8a908-106">This article explains how to enable your desktop app to run on another version of the .NET Framework and provides an example of how to target version 4 or 4.5.</span></span>  
  
 <span data-ttu-id="8a908-107">Версия .NET Framework, в которой запускается приложение, определяется в следующем порядке:</span><span class="sxs-lookup"><span data-stu-id="8a908-107">The version of the .NET Framework that an app runs on is determined in the following order:</span></span>  
  
-   <span data-ttu-id="8a908-108">Файл конфигурации.</span><span class="sxs-lookup"><span data-stu-id="8a908-108">Configuration file.</span></span>  
  
     <span data-ttu-id="8a908-109">Если файл конфигурации приложения содержит записи [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md), в которых указана одна или несколько версий платформы .NET Framework, и одна из этих версий присутствует на компьютере пользователя, приложение запускается в этой версии.</span><span class="sxs-lookup"><span data-stu-id="8a908-109">If the application configuration file includes [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md) entries that specify one or more .NET Framework versions, and one of those versions is present on the user's computer, the app runs on that version.</span></span> <span data-ttu-id="8a908-110">Записи [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md) в файле конфигурации считываются в порядке следования, и используется первая указанная версия платформы .NET Framework, которая есть на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="8a908-110">The configuration file reads [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md) entries in the order they are listed, and uses the first .NET Framework version listed that is present on the user's computer.</span></span> <span data-ttu-id="8a908-111">(Для версии 1.0 используется [элемент \<requiredRuntime>](../../../docs/framework/configure-apps/file-schema/startup/requiredruntime-element.md)).</span><span class="sxs-lookup"><span data-stu-id="8a908-111">(Use the [\<requiredRuntime> element](../../../docs/framework/configure-apps/file-schema/startup/requiredruntime-element.md) for version 1.0.)</span></span>  
  
-   <span data-ttu-id="8a908-112">Скомпилированная версия.</span><span class="sxs-lookup"><span data-stu-id="8a908-112">Compiled version.</span></span>  
  
     <span data-ttu-id="8a908-113">Если файла конфигурации нет, но версия .NET Framework, в которой было собрано приложение, присутствует на компьютере пользователя, приложение запускается в этой версии.</span><span class="sxs-lookup"><span data-stu-id="8a908-113">If there is no configuration file, but the version of the .NET Framework that the app was built on is present on the user's computer, the app runs on that version.</span></span>  
  
-   <span data-ttu-id="8a908-114">Последняя установленная версия.</span><span class="sxs-lookup"><span data-stu-id="8a908-114">Latest version installed.</span></span>  
  
     <span data-ttu-id="8a908-115">Если версия .NET Framework, для которой было собрано приложение, отсутствует, и в файле конфигурации не указана версия в [элементе \<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md), приложение пытается запуститься в последней версии .NET Framework, присутствующей на компьютере пользователя.</span><span class="sxs-lookup"><span data-stu-id="8a908-115">If the version of the .NET Framework that the app was built on is not present and a configuration file does not specify a version in a [\<supportedRuntime> element](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md), the app tries to run on the latest version of the .NET Framework that is present on the user's computer.</span></span>  
  
     <span data-ttu-id="8a908-116">Однако приложения .NET Framework 1.0, 1.1, 2.0, 3.0 и 3.5 не запускаются автоматически в .NET Framework 4 или более поздних версиях, и в некоторых случаях пользователь может получить сообщение об ошибке, и ему будет предложено установить .NET Framework 3.5.</span><span class="sxs-lookup"><span data-stu-id="8a908-116">However, .NET Framework 1.0, 1.1, 2.0, 3.0, and 3.5 apps do not automatically run on the .NET Framework 4 or later, and in some cases, the user may receive an error and may be prompted to install the .NET Framework 3.5.</span></span> <span data-ttu-id="8a908-117">Поведение активации может также зависеть от операционной системы пользователя, потому что в состав разных версий Windows входят разные версии .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8a908-117">The activation behavior may also depend on the user’s operating system, because  different versions of Windows system include different versions of the .NET Framework.</span></span> <span data-ttu-id="8a908-118">Если приложение поддерживает и .NET Framework 3.5, и .NET Framework 4 или более поздние версии, рекомендуется указывать это путем включения в файл конфигурации нескольких записей во избежание ошибок инициализации .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8a908-118">If your app supports both the .NET Framework 3.5 and 4 or later, we recommend that you indicate this with multiple entries in the configuration file to avoid .NET Framework initialization errors.</span></span> <span data-ttu-id="8a908-119">Дополнительные сведения см. в статье [Версии и зависимости платформы .NET Framework](../../../docs/framework/migration-guide/versions-and-dependencies.md).</span><span class="sxs-lookup"><span data-stu-id="8a908-119">For more information, see [Versions and Dependencies](../../../docs/framework/migration-guide/versions-and-dependencies.md).</span></span>  
  
 <span data-ttu-id="8a908-120">Также можно настроить приложения .NET Framework 3.5 для запуска на платформе .NET Framework 4 или 4.5 даже на компьютерах, на которых установлена .NET Framework 3.5, чтобы воспользоваться направленными на повышение производительности преимуществами версий 4 и 4.5.</span><span class="sxs-lookup"><span data-stu-id="8a908-120">You might also want to configure your .NET Framework 3.5 apps to run on the .NET Framework 4 or 4.5, even on computers that have the .NET Framework 3.5 installed, to take advantage of the performance improvements in versions 4 and 4.5.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="8a908-121">Рекомендуется всегда тестировать приложение в каждой из поддерживаемых им версий .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8a908-121">We recommend that you always test your app on every .NET Framework version that you support.</span></span> <span data-ttu-id="8a908-122">Сведения об обновлении приложения для поддержки более поздних версий платформы .NET Framework см. в статье [Совместимость версий в .NET Framework](../../../docs/framework/migration-guide/version-compatibility.md).</span><span class="sxs-lookup"><span data-stu-id="8a908-122">See [Version Compatibility](../../../docs/framework/migration-guide/version-compatibility.md) for information about upgrading your application to support later .NET Framework versions.</span></span>  
  
 <span data-ttu-id="8a908-123">Сведения о том, как внести в приложения .NET Framework 1.0 и 1.1 изменения для поддержки Windows 7 и Windows 8, см. в статье [Миграция из .NET Framework 1.1](../../../docs/framework/migration-guide/migrating-from-the-net-framework-1-1.md).</span><span class="sxs-lookup"><span data-stu-id="8a908-123">For information about modifying your .NET Framework 1.0 and 1.1 apps to support Windows 7 and Windows 8, see [Migrating from the .NET Framework 1.1](../../../docs/framework/migration-guide/migrating-from-the-net-framework-1-1.md).</span></span>  
  
### <a name="to-configure-your-app-to-run-on-the-net-framework-4-or-45"></a><span data-ttu-id="8a908-124">Настройка приложения для запуска в .NET Framework 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-124">To configure your app to run on the .NET Framework 4 or 4.5</span></span>  
  
1.  <span data-ttu-id="8a908-125">Добавьте или найдите файл конфигурации проекта .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8a908-125">Add or locate the configuration file for the .NET Framework project.</span></span> <span data-ttu-id="8a908-126">Файл конфигурации приложения находится в том же каталоге, что и приложение, и имеет то же имя, однако с расширением .config.</span><span class="sxs-lookup"><span data-stu-id="8a908-126">The configuration file for an app is in the same directory and has the same name as the app, but has a .config extension.</span></span> <span data-ttu-id="8a908-127">Например, для приложения с именем MyExecutable.exe файл конфигурации приложения называется MyExecutable.exe.config.</span><span class="sxs-lookup"><span data-stu-id="8a908-127">For example, for an app named MyExecutable.exe, the application configuration file is named MyExecutable.exe.config.</span></span>  
  
     <span data-ttu-id="8a908-128">Чтобы добавить файл конфигурации, в строке меню Visual Studio выберите **Проект**, **Добавить новый элемент**.</span><span class="sxs-lookup"><span data-stu-id="8a908-128">To add a configuration file, on the Visual Studio menu bar, choose **Project**, **Add New Item**.</span></span> <span data-ttu-id="8a908-129">Выберите **Общие** в области слева, а затем выберите **Файл конфигурации**.</span><span class="sxs-lookup"><span data-stu-id="8a908-129">Choose **General** from the left pane, and then choose **Configuration File**.</span></span>  <span data-ttu-id="8a908-130">Назовите файл конфигурации *appName*.exe.config. Для проектов приложений Магазина Windows или Windows Phone эти элементы меню недоступны, поскольку изменить политику активации на этих платформах невозможно.</span><span class="sxs-lookup"><span data-stu-id="8a908-130">Name the configuration file *appName*.exe.config. These menu choices are not available for Windows Store app or Windows phone app projects, because you cannot change the activation policy on those platforms.</span></span>  
  
2.  <span data-ttu-id="8a908-131">Добавьте в файл конфигурации приложения элемент [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md) следующим образом:</span><span class="sxs-lookup"><span data-stu-id="8a908-131">Add the [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md) element as follows to the application configuration file:</span></span>  
  
    ```xml  
    <configuration>  
      <startup>  
        <supportedRuntime version="<version>"/>  
      </startup>  
    </configuration>  
    ```  
  
     <span data-ttu-id="8a908-132">где *\<version>* указывает версию среды CLR, соответствующей версии платформы .NET Framework, которую поддерживает приложение.</span><span class="sxs-lookup"><span data-stu-id="8a908-132">where *\<version>* specifies the CLR version that aligns with the .NET Framework version that your app supports.</span></span> <span data-ttu-id="8a908-133">Можно использовать следующие строки:</span><span class="sxs-lookup"><span data-stu-id="8a908-133">Use the following strings:</span></span>  
  
    -   <span data-ttu-id="8a908-134">.NET Framework 1.0: "v1.0.3705"</span><span class="sxs-lookup"><span data-stu-id="8a908-134">.NET Framework 1.0: "v1.0.3705"</span></span>  
  
    -   <span data-ttu-id="8a908-135">.NET Framework 1.1: "v1.1.4322"</span><span class="sxs-lookup"><span data-stu-id="8a908-135">.NET Framework 1.1: "v1.1.4322"</span></span>  
  
    -   <span data-ttu-id="8a908-136">.NET Framework 2.0, 3.0 и 3.5: "v2.0.50727"</span><span class="sxs-lookup"><span data-stu-id="8a908-136">.NET Framework 2.0, 3.0, and 3.5: "v2.0.50727"</span></span>  
  
    -   <span data-ttu-id="8a908-137">.NET Framework 4 и 4.5 (включая точечные выпуски, например 4.5.1): "v4.0"</span><span class="sxs-lookup"><span data-stu-id="8a908-137">.NET Framework 4 and 4.5 (including point releases such as 4.5.1): "v4.0"</span></span>  
  
     <span data-ttu-id="8a908-138">Можно добавить несколько элементов [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md), перечислив их в порядке предпочтения, чтобы задать поддержку нескольких версий .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8a908-138">You can add multiple [\<supportedRuntime>](../../../docs/framework/configure-apps/file-schema/startup/supportedruntime-element.md) elements, listed in order of preference, to specify support for multiple versions of the .NET Framework.</span></span>  
  
 <span data-ttu-id="8a908-139">В следующей таблице показано, как параметры файла конфигурации приложения и версии платформы .NET Framework, установленные на компьютере, определяют версию, в которой запускается приложение .NET Framework 3.5.</span><span class="sxs-lookup"><span data-stu-id="8a908-139">The following table demonstrates how application configuration file settings and the .NET Framework versions installed on a computer determine the version that a .NET Framework 3.5 app runs on.</span></span> <span data-ttu-id="8a908-140">Примеры относятся к приложению .NET Framework 3.5, однако аналогичную логику можно использовать для нацеливания приложений, собранных с использованием более ранних версий .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="8a908-140">The examples are specific to a .NET Framework 3.5 application, but you can use similar logic to target applications built with earlier .NET Framework versions.</span></span> <span data-ttu-id="8a908-141">Обратите внимание, что для указания .NET Framework 3.5 в файле конфигурации приложения используется номер версии .NET Framework 2.0 (v2.0.50727).</span><span class="sxs-lookup"><span data-stu-id="8a908-141">Note that the .NET Framework 2.0 version number (v2.0.50727) is used to specify the .NET Framework 3.5 in the application configuration file.</span></span>  
  
|<span data-ttu-id="8a908-142">Параметр файла app.config</span><span class="sxs-lookup"><span data-stu-id="8a908-142">App.config file setting</span></span>|<span data-ttu-id="8a908-143">На компьютере с установленной версией 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-143">On computer with version 3.5 installed</span></span>|<span data-ttu-id="8a908-144">На компьютере с установленными версиями 3.5 и 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-144">On computer with versions 3.5 and 4 or 4.5 installed</span></span>|<span data-ttu-id="8a908-145">На компьютере с установленной версией 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-145">On computer with version 4 or 4.5 installed</span></span>|  
|-|-|-|-|  
|<span data-ttu-id="8a908-146">Нет</span><span class="sxs-lookup"><span data-stu-id="8a908-146">None</span></span>|<span data-ttu-id="8a908-147">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-147">Runs on 3.5</span></span>|<span data-ttu-id="8a908-148">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-148">Runs on 3.5</span></span>|<span data-ttu-id="8a908-149">Выводит сообщение об ошибке, предлагая пользователю установить нужную версию \*</span><span class="sxs-lookup"><span data-stu-id="8a908-149">Displays error message that prompts user to install the correct version\*</span></span>|  
|`<supportedRuntime version="v2.0.50727"/>`|<span data-ttu-id="8a908-150">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-150">Runs on 3.5</span></span>|<span data-ttu-id="8a908-151">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-151">Runs on 3.5</span></span>|<span data-ttu-id="8a908-152">Выводит сообщение об ошибке, предлагая пользователю установить нужную версию \*</span><span class="sxs-lookup"><span data-stu-id="8a908-152">Displays error message that prompts user to install the correct version\*</span></span>|  
|`<supportedRuntime version="v2.0.50727"/>` <br /> `<supportedRuntime version="v4.0"/>`|<span data-ttu-id="8a908-153">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-153">Runs on 3.5</span></span>|<span data-ttu-id="8a908-154">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-154">Runs on 3.5</span></span>|<span data-ttu-id="8a908-155">Запускается в 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-155">Runs on 4 or 4.5</span></span>|  
|`<supportedRuntime version="v4.0"/>` <br /> `<supportedRuntime version="v2.0.50727"/>`|<span data-ttu-id="8a908-156">Запускается в 3.5</span><span class="sxs-lookup"><span data-stu-id="8a908-156">Runs on 3.5</span></span>|<span data-ttu-id="8a908-157">Запускается в 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-157">Runs on 4 or 4.5</span></span>|<span data-ttu-id="8a908-158">Запускается в 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-158">Runs on 4 or 4.5</span></span>|  
|`<supportedRuntime version="v4.0"/>`|<span data-ttu-id="8a908-159">Выводит сообщение об ошибке, предлагая пользователю установить нужную версию \*</span><span class="sxs-lookup"><span data-stu-id="8a908-159">Displays error message that prompts user to install the correct version\*</span></span>|<span data-ttu-id="8a908-160">Запускается в 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-160">Runs on 4 or 4.5</span></span>|<span data-ttu-id="8a908-161">Запускается в 4 или 4.5</span><span class="sxs-lookup"><span data-stu-id="8a908-161">Runs on 4 or 4.5</span></span>|  
  
 <span data-ttu-id="8a908-162">\*Дополнительные сведения об этом сообщении об ошибке и о том, как избежать этой ошибки, см. в статье [Ошибки инициализации платформы .NET Framework. Управление взаимодействием с пользователем](../../../docs/framework/deployment/initialization-errors-managing-the-user-experience.md).</span><span class="sxs-lookup"><span data-stu-id="8a908-162">\* For more information about this error message and ways to avoid it, see [.NET Framework Initialization Errors: Managing the User Experience](../../../docs/framework/deployment/initialization-errors-managing-the-user-experience.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8a908-163">См. также</span><span class="sxs-lookup"><span data-stu-id="8a908-163">See Also</span></span>  
 [<span data-ttu-id="8a908-164">Миграция из .NET Framework 1.1</span><span class="sxs-lookup"><span data-stu-id="8a908-164">Migrating from the .NET Framework 1.1</span></span>](../../../docs/framework/migration-guide/migrating-from-the-net-framework-1-1.md)  
 [<span data-ttu-id="8a908-165">Руководство по миграции</span><span class="sxs-lookup"><span data-stu-id="8a908-165">Migration Guide</span></span>](../../../docs/framework/migration-guide/index.md)
