---
title: Оркестрация микрослужбами и multicontainer приложений высокий уровень масштабируемости и доступности
description: Жизненный цикл контейнерного приложения Docker на основе платформы и средств Майкрософт
ms.prod: .net
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/19/2017
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 59c03755bebce98e018f56fc7213b00a0d3eae38
ms.sourcegitcommit: 2e8acae16ae802f2d6d04e3ce0a6dbf04e476513
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/18/2018
---
# <a name="orchestrating-microservices-and-multicontainer-applications-for-high-scalability-and-availability"></a><span data-ttu-id="8644a-103">Оркестрация микрослужбами и multicontainer приложений высокий уровень масштабируемости и доступности</span><span class="sxs-lookup"><span data-stu-id="8644a-103">Orchestrating microservices and multicontainer applications for high scalability and availability</span></span>

<span data-ttu-id="8644a-104">Использование оркестраторов для приложений, готовых к развертыванию в рабочей среде, крайне важно, если приложение основано на микрослужбах или просто разнесено по нескольким контейнерам.</span><span class="sxs-lookup"><span data-stu-id="8644a-104">Using orchestrators for production-ready applications is essential if your application is based on microservices or simply split across multiple containers.</span></span> <span data-ttu-id="8644a-105">Как было сказано ранее, в рамках подхода на основе микрослужб каждая микрослужба имеет собственную модель и данные, поэтому она является автономной с точки зрения разработки и развертывания.</span><span class="sxs-lookup"><span data-stu-id="8644a-105">As introduced previously, in a microservice-based approach, each microservice owns its model and data so that it will be autonomous from a development and deployment point of view.</span></span> <span data-ttu-id="8644a-106">Но даже если у вас есть более традиционным приложения, состоящего из нескольких служб (например, SOA), также имеется несколько контейнеров или служб, образующих одной бизнес-приложений, необходимо развернуть как распределенная система.</span><span class="sxs-lookup"><span data-stu-id="8644a-106">But even if you have a more traditional application that is composed of multiple services (like SOA), you also will have multiple containers or services comprising a single business application that need to be deployed as a distributed system.</span></span> <span data-ttu-id="8644a-107">Эти виды систем сложны для горизонтального масштабирования и управления ими; Таким образом абсолютной необходимости orchestrator чтобы multicontainer приложение, в рабочей среде и масштабируемость.</span><span class="sxs-lookup"><span data-stu-id="8644a-107">These kinds of systems are complex to scale out and manage; therefore, you absolutely need an orchestrator if you want to have a production-ready and scalable multicontainer application.</span></span>

<span data-ttu-id="8644a-108">Рис. 4-6 иллюстрирует развертывание на кластеры, состоящие из нескольких микрослужбами (контейнеров) приложения.</span><span class="sxs-lookup"><span data-stu-id="8644a-108">Figure 4-6 illustrates deployment into a cluster of an application composed of multiple microservices (containers).</span></span>

![](./media/image6.png)

<span data-ttu-id="8644a-109">Рис. 4-6: кластер контейнеров</span><span class="sxs-lookup"><span data-stu-id="8644a-109">Figure 4-6: A cluster of containers</span></span>

<span data-ttu-id="8644a-110">Такой подход выглядит логичным.</span><span class="sxs-lookup"><span data-stu-id="8644a-110">It looks like a logical approach.</span></span> <span data-ttu-id="8644a-111">Но, как вы будете балансировки нагрузки, маршрутизацию и управляя операциями этих составных приложений?</span><span class="sxs-lookup"><span data-stu-id="8644a-111">But how are you handling load balancing, routing, and orchestrating these composed applications?</span></span>

<span data-ttu-id="8644a-112">Интерфейс командной строки Docker (CLI) потребностям управление один контейнер на одном узле, но не хватает, когда дело доходит до управление несколько контейнеров, которые развернуты на нескольких узлах для более сложных распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="8644a-112">The Docker command-line interface (CLI) meets the needs of managing one container on one host, but it falls short when it comes to managing multiple containers deployed on multiple hosts for more complex distributed applications.</span></span> <span data-ttu-id="8644a-113">В большинстве случаев требуется платформа управления, который будет автоматически запустить контейнеры, приостанавливать их, или отключать их при необходимости и в идеале управляют как при доступе к ресурсам, например сети и хранения данных.</span><span class="sxs-lookup"><span data-stu-id="8644a-113">In most cases, you need a management platform that will automatically start containers, suspend them, or shut them down when needed, and ideally also control how they access resources like the network and data storage.</span></span>

<span data-ttu-id="8644a-114">Чтобы перейти от управления отдельными контейнерами или очень простыми составными приложениями к управлению крупными корпоративными приложениями с микрослужбами, следует прибегнуть к платформам оркестрации и кластеризации.</span><span class="sxs-lookup"><span data-stu-id="8644a-114">To go beyond the management of individual containers or very simple composed apps and move toward larger enterprise applications with microservices, you must turn to orchestration and clustering platforms.</span></span>

<span data-ttu-id="8644a-115">С архитектуры и разработки точки зрения при наличии построение, крупным, основанный на микрослужбами, приложений, важно понять следующие платформы и продукты, которые поддерживают сложные сценарии:</span><span class="sxs-lookup"><span data-stu-id="8644a-115">From an architecture and development point of view, if you are building large, enterprise, microservices-based, applications, it is important to understand the following platforms and products that support advanced scenarios:</span></span>

-   <span data-ttu-id="8644a-116">**Кластеры и orchestrators** при необходимости масштабировать-приложениям на многих узлах Docker, такие как с большого приложения на основе микрослужбами крайне важно иметь возможность управлять всех этих узлов как кластер с Абстрагирование сложности базовой платформы.</span><span class="sxs-lookup"><span data-stu-id="8644a-116">**Clusters and orchestrators** When you need to scale-out applications across many Docker hosts, such as with a large microservices-based application, it is critical to be able to manage all of those hosts as a single cluster by abstracting the complexity of the underlying platform.</span></span> <span data-ttu-id="8644a-117">Именно такую возможность предоставляют кластеры контейнеров и оркестраторы.</span><span class="sxs-lookup"><span data-stu-id="8644a-117">That is what the container clusters and orchestrators provide.</span></span> <span data-ttu-id="8644a-118">Примерами orchestrators являются помощью Docker Swarm, Mesosphere DC/OS, Kubernetes (первые три через контейнера службы Azure) и Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-118">Examples of orchestrators are Docker Swarm, Mesosphere DC/OS, Kubernetes (the first three available through Azure Container Service), and Azure Service Fabric.</span></span>

-   <span data-ttu-id="8644a-119">**Планировщики** *планирования* означает возможность администратор может запустить контейнеры в кластере, чтобы они также предоставляют пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="8644a-119">**Schedulers** *Scheduling* means to have the capability for an administrator to launch containers in a cluster so that they also provide a user interface.</span></span> <span data-ttu-id="8644a-120">Планировщик кластера имеет несколько функций: для эффективного использования ресурсов кластера, чтобы задать ограничения, предоставленный пользователем, эффективно контейнеры балансировки нагрузки между узлами или узлы и быть надежными от ошибок, обеспечивая высокий доступность.</span><span class="sxs-lookup"><span data-stu-id="8644a-120">A cluster scheduler has several responsibilities: to use the cluster's resources efficiently, to set the constraints provided by the user, to efficiently load-balance containers across nodes or hosts, and to be robust against errors while providing high availability.</span></span>

<span data-ttu-id="8644a-121">Понятия кластера и планировщика тесно связаны друг с другом, поэтому продукты, предоставляемые разными поставщиками, часто включают в себя оба набора возможностей.</span><span class="sxs-lookup"><span data-stu-id="8644a-121">The concepts of a cluster and a scheduler are closely related, so the products provided by different vendors often provide both sets of capabilities.</span></span> <span data-ttu-id="8644a-122">В таблице 4-1 перечислены наиболее важные платформы и программного обеспечения варианты выбора для кластеров и планировщики.</span><span class="sxs-lookup"><span data-stu-id="8644a-122">Table 4-1 lists the most important platform and software choices you have for clusters and schedulers.</span></span> <span data-ttu-id="8644a-123">Эти кластеры обычно предоставляются в общедоступных облаках, таких как Azure.</span><span class="sxs-lookup"><span data-stu-id="8644a-123">These clusters are generally offered in public clouds like Azure.</span></span>

<span data-ttu-id="8644a-124">Таблица 4-1: платформы программное обеспечение для кластеризации контейнера, управление и планирование</span><span class="sxs-lookup"><span data-stu-id="8644a-124">Table 4-1: Software platforms for container clustering, orchestration, and scheduling</span></span>

| <span data-ttu-id="8644a-125">Platform</span><span class="sxs-lookup"><span data-stu-id="8644a-125">Platform</span></span> | <span data-ttu-id="8644a-126">Описание</span><span class="sxs-lookup"><span data-stu-id="8644a-126">Description</span></span> |
|---|---|
| <span data-ttu-id="8644a-127">Docker Swarm</span><span class="sxs-lookup"><span data-stu-id="8644a-127">Docker Swarm</span></span><br/> ![http://rancher.com/wp-content/themes/rancher-2016/assets/images/swarm.png?v=2016-07-10-am](./media/image7.png) | <span data-ttu-id="8644a-128">Docker группу мелких объектов дает возможность кластера и запланировать контейнеры Docker.</span><span class="sxs-lookup"><span data-stu-id="8644a-128">Docker Swarm gives you the ability to cluster and schedule Docker containers.</span></span> <span data-ttu-id="8644a-129">С помощью Swarm можно превратить пул узлов Docker в единый виртуальный узел Docker.</span><span class="sxs-lookup"><span data-stu-id="8644a-129">By using Swarm, you can turn a pool of Docker hosts into a single, virtual Docker host.</span></span> <span data-ttu-id="8644a-130">Клиенты могут выполнять запросы API для группу мелких объектов, таким же образом, как и на узлах, это означает, что группу мелких объектов позволяет масштабировать приложения с несколькими узлами.</span><span class="sxs-lookup"><span data-stu-id="8644a-130">Clients can make API requests to Swarm in the same way that they do to hosts, meaning that Swarm makes it easy for applications to scale to multiple hosts.</span></span> <br /><br /> <span data-ttu-id="8644a-131">Решение Docker Swarm предоставляется компанией Docker.</span><span class="sxs-lookup"><span data-stu-id="8644a-131">Docker Swarm is a product from Docker, the company.</span></span> <br /><br /> <span data-ttu-id="8644a-132">В Docker 1.12 или более поздней версии имеется встроенный режим Swarm.</span><span class="sxs-lookup"><span data-stu-id="8644a-132">Docker v1.12 or later can run native and built-in Swarm Mode.</span></span> |
| <span data-ttu-id="8644a-133">Mesosphere DC/OS</span><span class="sxs-lookup"><span data-stu-id="8644a-133">Mesosphere DC/OS</span></span><br/>![https://mesosphere.com/wp-content/uploads/2016/04/logo-horizontal-styled.png](./media/image8.png) |  <span data-ttu-id="8644a-134">Mesosphere Enterprise DC/OS (на основе Apache Mesos) — это готовая к использованию в рабочей среде платформа для выполнения контейнеров и распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="8644a-134">Mesosphere Enterprise DC/OS (based on Apache Mesos) is a production-ready platform for running containers and distributed applications.</span></span> <br /><br /> <span data-ttu-id="8644a-135">DC/OS абстрагирует коллекцию ресурсов, доступных в кластере, и предоставляет доступ к ним компонентам, построенным на базе платформы.</span><span class="sxs-lookup"><span data-stu-id="8644a-135">DC/OS works by abstracting a collection of the resources available in the cluster and making those resources available to components built on top of it.</span></span> <span data-ttu-id="8644a-136">В качестве планировщика, интегрированного с DC/OS, обычно используется Marathon.</span><span class="sxs-lookup"><span data-stu-id="8644a-136">Marathon is usually used as a scheduler integrated with DC/OS.</span></span> |
| <span data-ttu-id="8644a-137">Google Kubernetes</span><span class="sxs-lookup"><span data-stu-id="8644a-137">Google Kubernetes</span></span><br />![https://pbs.twimg.com/media/Bt\_pEfqCAAAiVyz.png](./media/image9.png) | <span data-ttu-id="8644a-139">Kubernetes — это решение с открытым кодом, которое предоставляет широкий ряд возможностей: от организации инфраструктуры кластера и планирования контейнеров до оркестрации.</span><span class="sxs-lookup"><span data-stu-id="8644a-139">Kubernetes is an open-source product that provides functionality that ranges from cluster infrastructure and container scheduling to orchestrating capabilities.</span></span> <span data-ttu-id="8644a-140">С его помощью можно автоматизировать развертывание, масштабирование и операций контейнеров приложения ко всем кластерам узлов.</span><span class="sxs-lookup"><span data-stu-id="8644a-140">With it, you can automate deployment, scaling, and operations of application containers across clusters of hosts.</span></span> <br /><br /> <span data-ttu-id="8644a-141">Kubernetes предоставляет ориентированную на контейнеры инфраструктуру, которая объединяет контейнеры приложений в логические блоки, чтобы упростить управление и обнаружение.</span><span class="sxs-lookup"><span data-stu-id="8644a-141">Kubernetes provides a container-centric infrastructure that groups application containers into logical units for easy management and discovery.</span></span> |
| <span data-ttu-id="8644a-142">Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="8644a-142">Azure Service Fabric</span></span><br />![https://azure.microsoft.com/svghandler/service-fabric?width=600&height=315](./media/image10.png) | <span data-ttu-id="8644a-143">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) — это платформа микрослужб от корпорации Майкрософт, которая предназначена для создания приложений.</span><span class="sxs-lookup"><span data-stu-id="8644a-143">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) is a Microsoft microservices platform for building applications.</span></span> <span data-ttu-id="8644a-144">Она позволяет [оркестрировать](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) службы и создавать кластеры компьютеров.</span><span class="sxs-lookup"><span data-stu-id="8644a-144">It is an [orchestrator](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) of services and creates clusters of machines.</span></span> <span data-ttu-id="8644a-145">По умолчанию Service Fabric развертывает и активирует службы как процессы, но Service Fabric можно развернуть службы в образы контейнеров Docker.</span><span class="sxs-lookup"><span data-stu-id="8644a-145">By default, Service Fabric deploys and activates services as processes, but Service Fabric can deploy services in Docker container images.</span></span> <span data-ttu-id="8644a-146">Более важно, можно комбинировать службами в процессах со службами в контейнерах в одном приложении.</span><span class="sxs-lookup"><span data-stu-id="8644a-146">More important, you can mix services in processes with services in containers in the same application.</span></span> <br /><br /> <span data-ttu-id="8644a-147">По состоянию на май 2017 г. компонент Service Fabric, поддерживающего развертывание службы как контейнеры Docker находится в состоянии предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="8644a-147">As of May 2017, the feature of Service Fabric that supports deploying services as Docker containers is in preview state.</span></span> <br /><br /> <span data-ttu-id="8644a-148">Можно разработать служб Service Fabric различными способами, с помощью [Service Fabric модели программирования](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework) до развертывания [гостевой исполняемые файлы](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-existing-app) и контейнеры.</span><span class="sxs-lookup"><span data-stu-id="8644a-148">You can develop Service Fabric services in many ways, from using the [Service Fabric programming models](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework) to deploying [guest executables](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-existing-app) as well as containers.</span></span> <span data-ttu-id="8644a-149">Service Fabric поддерживает модели конкретные приложения как [служб с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) и [службы Reliable Actor](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span><span class="sxs-lookup"><span data-stu-id="8644a-149">Service Fabric supports prescriptive application models like [stateful services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) and [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span></span>

## <a name="using-container-based-orchestrators-in-azure"></a><span data-ttu-id="8644a-150">С помощью orchestrators на основе контейнера в Azure</span><span class="sxs-lookup"><span data-stu-id="8644a-150">Using container-based orchestrators in Azure</span></span>

<span data-ttu-id="8644a-151">Несколько поставщиков облачных обеспечивают поддержку контейнеры Docker, а также кластеры Docker и orchestration, включая поддержку Azure, контейнер службы Amazon EC2 и подсистема контейнеров Google.</span><span class="sxs-lookup"><span data-stu-id="8644a-151">Several cloud vendors offer Docker containers support plus Docker clusters and orchestration support, including Azure, Amazon EC2 Container Service, and Google Container Engine.</span></span> <span data-ttu-id="8644a-152">Azure поддерживает Docker кластера и orchestrator через службу контейнера Azure, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="8644a-152">Azure provides Docker cluster and orchestrator support through Azure Container Service, as explained in the next section.</span></span>

<span data-ttu-id="8644a-153">Другой вариант — использовать Azure Service Fabric также поддерживает Docker на основе Linux и контейнеров Windows.</span><span class="sxs-lookup"><span data-stu-id="8644a-153">Another choice is to use Azure Service Fabric, which also supports Docker based on Linux and Windows Containers.</span></span> <span data-ttu-id="8644a-154">Service Fabric запускается в Azure или любые другие облака в том числе в [локальной](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-anywhere).</span><span class="sxs-lookup"><span data-stu-id="8644a-154">Service Fabric runs on Azure or any other cloud as well as [on-premises](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-anywhere).</span></span>

## <a name="using-azure-container-service"></a><span data-ttu-id="8644a-155">Использование службы контейнеров Azure</span><span class="sxs-lookup"><span data-stu-id="8644a-155">Using Azure Container Service</span></span>

<span data-ttu-id="8644a-156">Кластер Docker объединяет несколько узлов Docker в пул и предоставляет доступ к ним как к единому виртуальному узлу Docker, что позволяет развертывать несколько узлов в кластере.</span><span class="sxs-lookup"><span data-stu-id="8644a-156">A Docker cluster pools multiple Docker hosts and exposes them as a single virtual Docker host, so you can deploy multiple containers into the cluster.</span></span> <span data-ttu-id="8644a-157">Кластер будет обрабатывать всё сложного управления например масштабируемость и работоспособности.</span><span class="sxs-lookup"><span data-stu-id="8644a-157">The cluster will handle all the complex management plumbing such as scalability and health.</span></span> <span data-ttu-id="8644a-158">Рис. 4-7 представляет сопоставление кластера Docker для составных приложений для службы контейнеров.</span><span class="sxs-lookup"><span data-stu-id="8644a-158">Figure 4-7 represents how a Docker cluster for composed applications maps to Container Service.</span></span>

<span data-ttu-id="8644a-159">Контейнер службы предоставляет способ для упрощения создания, настройки и управления, кластера виртуальных машин, настроенных для запуска приложений в контейнерах.</span><span class="sxs-lookup"><span data-stu-id="8644a-159">Container Service provides a way to simplify the creation, configuration, and management of a cluster of VMs that are preconfigured to run containerized applications.</span></span> <span data-ttu-id="8644a-160">С помощью оптимизированного конфигурации популярных средств планирования и orchestration открытым исходным кодом, контейнер службы дает возможность использовать существующие навыки и отрисовки в теле большое и возрастающее опытом сообщества для развертывания и управления на основе контейнера приложения в Azure.</span><span class="sxs-lookup"><span data-stu-id="8644a-160">Using an optimized configuration of popular open-source scheduling and orchestration tools, Container Service gives you the ability to use your existing skills or draw on a large and growing body of community expertise to deploy and manage container-based applications in Azure.</span></span>

<span data-ttu-id="8644a-161">Контейнер службы оптимизирует конфигурации популярных Docker кластеризации открытым исходным кодом и технологии специально для Azure.</span><span class="sxs-lookup"><span data-stu-id="8644a-161">Container Service optimizes the configuration of popular Docker clustering open-source tools and technologies specifically for Azure.</span></span> <span data-ttu-id="8644a-162">Вы получаете открытое решение, которое обеспечивает переносимость как контейнеров, так и конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="8644a-162">You get an open solution that offers portability for both your containers and your application configuration.</span></span> <span data-ttu-id="8644a-163">Вы выбираете размер, число узлов и средства оркестрации, а служба контейнеров делает все остальное.</span><span class="sxs-lookup"><span data-stu-id="8644a-163">You select the size, the number of hosts, and the orchestrator tools, and Container Service handles everything else.</span></span>

<span data-ttu-id="8644a-164">Контейнер службы использует образы Docker чтобы обеспечить полную переносимость контейнеры вашего приложения.</span><span class="sxs-lookup"><span data-stu-id="8644a-164">Container Service uses Docker images to ensure that your application containers are fully portable.</span></span> <span data-ttu-id="8644a-165">Он поддерживает выбор orchestration с открытым исходным кодом платформы, такие как DC/OS, Kubernetes и с помощью Docker Swarm чтобы убедиться, что эти приложения можно масштабировать до тысяч или даже десятков тысяч контейнеров.</span><span class="sxs-lookup"><span data-stu-id="8644a-165">It supports your choice of open-source orchestration platforms like DC/OS, Kubernetes, and Docker Swarm to ensure that these applications can scale to thousands or even tens of thousands of containers.</span></span>

<span data-ttu-id="8644a-166">С помощью контейнера службы Azure вы сможете использовать высококлассные возможности Azure одновременно сохраняя переносимость приложения, включая orchestration уровнями.</span><span class="sxs-lookup"><span data-stu-id="8644a-166">With Azure Container Service, you can take advantage of the enterprise-grade features of Azure while still maintaining application portability, including at the orchestration layers.</span></span>

![](./media/image11.png)

<span data-ttu-id="8644a-167">Рис. 4-7: кластеризации вариантов в контейнере службы Azure</span><span class="sxs-lookup"><span data-stu-id="8644a-167">Figure 4-7: Clustering choices in Azure Container Service</span></span>

<span data-ttu-id="8644a-168">Как показано на рисунке 4-8, служба контейнер является просто инфраструктуры Azure для развертывания контроллера домена/OS, Kubernetes или с помощью Docker Swarm, но он не реализует все дополнительные orchestrator.</span><span class="sxs-lookup"><span data-stu-id="8644a-168">As shown in Figure 4-8, Container Service is simply the infrastructure provided by Azure in order to deploy DC/OS, Kubernetes, or Docker Swarm, but it does not implement any additional orchestrator.</span></span> <span data-ttu-id="8644a-169">Таким образом служба контейнер является не orchestrator, таким образом; Это только это инфраструктура, которая использует преимущества существующей orchestrators с открытым исходным кодом для контейнеров.</span><span class="sxs-lookup"><span data-stu-id="8644a-169">Therefore, Container Service is not an orchestrator, as such; it is only an infrastructure that takes advantage of existing open-source orchestrators for containers.</span></span>

![](./media/image12.png)

<span data-ttu-id="8644a-170">Рис. 4-8: Orchestrators в контейнер службы</span><span class="sxs-lookup"><span data-stu-id="8644a-170">Figure 4-8: Orchestrators in Container Service</span></span>

<span data-ttu-id="8644a-171">С точки зрения использования службы контейнера предназначена для предоставления среды размещения контейнера с помощью популярных средств с открытым исходным кодом и технологий.</span><span class="sxs-lookup"><span data-stu-id="8644a-171">From a usage perspective, the goal of Container Service is to provide a container hosting environment by using popular open-source tools and technologies.</span></span> <span data-ttu-id="8644a-172">С этой целью она предоставляет стандартные конечные точки API для выбранного оркестратора.</span><span class="sxs-lookup"><span data-stu-id="8644a-172">To this end, it exposes the standard API endpoints for your chosen orchestrator.</span></span> <span data-ttu-id="8644a-173">Используя эти конечные точки, можно использовать программное обеспечение, которое может взаимодействовать с этими конечными точками.</span><span class="sxs-lookup"><span data-stu-id="8644a-173">By using these endpoints, you can use any software that can communicate to those endpoints.</span></span> <span data-ttu-id="8644a-174">Например в случае с помощью Docker Swarm конечной точки, можно использовать Docker CLI.</span><span class="sxs-lookup"><span data-stu-id="8644a-174">For example, in the case of the Docker Swarm endpoint, you might choose to use the Docker CLI.</span></span> <span data-ttu-id="8644a-175">Для DC/OS можно выбрать интерфейс командной строки DC/OS.</span><span class="sxs-lookup"><span data-stu-id="8644a-175">For DC/OS, you might choose to use the DC/OS CLI.</span></span>

### <a name="getting-started-with-container-service"></a><span data-ttu-id="8644a-176">Приступая к работе со службой контейнера</span><span class="sxs-lookup"><span data-stu-id="8644a-176">Getting started with Container Service</span></span>

<span data-ttu-id="8644a-177">Чтобы начать использование контейнера службы, развертывание кластера службы контейнеров из портала Azure с помощью шаблона Azure Resource Manager или [CLI](https://docs.microsoft.com/cli/azure/install-azure-cli).</span><span class="sxs-lookup"><span data-stu-id="8644a-177">To begin using Container Service, you deploy a Container Service cluster from the Azure portal by using an Azure Resource Manager template or the [CLI](https://docs.microsoft.com/cli/azure/install-azure-cli).</span></span> <span data-ttu-id="8644a-178">Доступные шаблоны включают в себя [Docker Swarm](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-swarm), [Kubernetes](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-kubernetes) и [DC/OS](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-dcos).</span><span class="sxs-lookup"><span data-stu-id="8644a-178">Available templates include [Docker Swarm](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-swarm), [Kubernetes](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-kubernetes), and [DC/OS](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-dcos).</span></span> <span data-ttu-id="8644a-179">Примеры использования шаблонов, чтобы включить дополнительные или расширенные конфигурации Azure можно изменить.</span><span class="sxs-lookup"><span data-stu-id="8644a-179">You can modify the quickstart templates to include additional or advanced Azure configuration.</span></span>

<span data-ttu-id="8644a-180">**Дополнительные сведения о** Дополнительные сведения о развертывании контейнера службы кластеров, на сайте Azure [развертывание кластера службы контейнера Azure](https://docs.microsoft.com/azure/container-service/dcos-swarm/container-service-deployment).</span><span class="sxs-lookup"><span data-stu-id="8644a-180">**More info** To learn more about deploying a Container Service cluster, on the Azure website, read [Deploy an Azure Container Service cluster](https://docs.microsoft.com/azure/container-service/dcos-swarm/container-service-deployment).</span></span>

<span data-ttu-id="8644a-181">За программное обеспечение, устанавливаемое по умолчанию в составе службы ACS, плата не взимается.</span><span class="sxs-lookup"><span data-stu-id="8644a-181">There are no fees for any of the software installed by default as part of ACS.</span></span> <span data-ttu-id="8644a-182">Все возможности по умолчанию реализуются с помощью ПО с открытым кодом.</span><span class="sxs-lookup"><span data-stu-id="8644a-182">All default options are implemented with open-source software.</span></span>

<span data-ttu-id="8644a-183">Контейнер службы в настоящее время доступен для стандартных A, D, доменных служб Active Directory, G и GS серии виртуальных машин Linux в Azure.</span><span class="sxs-lookup"><span data-stu-id="8644a-183">Container Service is currently available for Standard A, D, DS, G, and GS series Linux VMs in Azure.</span></span> <span data-ttu-id="8644a-184">Плата взимается только для экземпляров вычислений, выбрать и другие базовой инфраструктуры ресурсы, используемые, такие как хранилища и сети.</span><span class="sxs-lookup"><span data-stu-id="8644a-184">You are charged only for the compute instances you choose as well as the other underlying infrastructure resources consumed, such as storage and networking.</span></span> <span data-ttu-id="8644a-185">Отсутствуют добавочное накладные расходы для службы контейнеров сам.</span><span class="sxs-lookup"><span data-stu-id="8644a-185">There are no incremental charges for Container Service itself.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="8644a-186">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="8644a-186">Additional resources</span></span>

<span data-ttu-id="8644a-187">Ниже перечислены расположения, где можно найти дополнительные сведения:</span><span class="sxs-lookup"><span data-stu-id="8644a-187">Following are locations where you can find additional information:</span></span>

-   <span data-ttu-id="8644a-188">Введение в контейнер Docker размещения решений с помощью контейнера службы.</span><span class="sxs-lookup"><span data-stu-id="8644a-188">Introduction to Docker container hosting solutions with Container Service:</span></span>  
    https://docs.microsoft.com/azure/container-service/kubernetes/container-service-intro-kubernetes>

-   <span data-ttu-id="8644a-189">Общие сведения о docker группу мелких объектов:</span><span class="sxs-lookup"><span data-stu-id="8644a-189">Docker Swarm overview:</span></span>  
    <https://docs.docker.com/swarm/overview/>

-   <span data-ttu-id="8644a-190">Общие сведения о режиме группу мелких объектов:</span><span class="sxs-lookup"><span data-stu-id="8644a-190">Swarm mode overview:</span></span>  
    <https://docs.docker.com/engine/swarm/>

-   <span data-ttu-id="8644a-191">Общие сведения о mesosphere DC/OS:</span><span class="sxs-lookup"><span data-stu-id="8644a-191">Mesosphere DC/OS Overview:</span></span>    
    <https://docs.mesosphere.com/1.7/overview/>

-   <span data-ttu-id="8644a-192">Kubernetes (официальный сайт):</span><span class="sxs-lookup"><span data-stu-id="8644a-192">Kubernetes (the official site):</span></span>  
    <https://kubernetes.io/>

## <a name="using-service-fabric"></a><span data-ttu-id="8644a-193">С помощью Service Fabric</span><span class="sxs-lookup"><span data-stu-id="8644a-193">Using Service Fabric</span></span>

<span data-ttu-id="8644a-194">От корпорации Майкрософт переход от доставки для доставки служб «поля» программных продуктов, которые были обычно монолитные в стиле, возникших Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-194">Service Fabric arose from Microsoft's transition from delivering "box" products, which were typically monolithic in style, to delivering services.</span></span> <span data-ttu-id="8644a-195">Процесс построения и эксплуатации больших служб в масштабе, например базы данных SQL Azure, Azure DB документа, Azure Service Bus или серверной Cortana в форму Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-195">The experience of building and operating large services at scale, such as Azure SQL Database, Azure Document DB, Azure Service Bus, or Cortana's Backend, shaped Service Fabric.</span></span> <span data-ttu-id="8644a-196">Она продолжала развиваться по мере внедрения во множестве служб.</span><span class="sxs-lookup"><span data-stu-id="8644a-196">The platform evolved over time as more and more services adopted it.</span></span> <span data-ttu-id="8644a-197">Важно отметить, что Service Fabric работает не только в среде Azure, но и в автономных развертываниях Windows Server.</span><span class="sxs-lookup"><span data-stu-id="8644a-197">Importantly, Service Fabric had to run not only in Azure but also in standalone Windows Server deployments.</span></span>

<span data-ttu-id="8644a-198">Для решения сложных проблем построения и запуска службы и эффективно использовать ресурсы инфраструктуры, чтобы команды можно решать бизнес-задачи, используя подход микрослужбами является целью Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-198">The aim of Service Fabric is to solve the difficult problems of building and running a service and utilizing infrastructure resources efficiently so that teams can solve business problems using a microservices approach.</span></span>

<span data-ttu-id="8644a-199">Service Fabric предоставляет два масштабных решения, которые позволяют создавать приложения в рамках подхода на основе микрослужб.</span><span class="sxs-lookup"><span data-stu-id="8644a-199">Service Fabric provides two broad areas to help you build applications that use a microservices approach:</span></span>

-   <span data-ttu-id="8644a-200">Платформа, которая предоставляет системные службы для развертывания, обновления, обнаружения и перезапуска служб, в которых произошел сбой, а также обнаружения служб, управления состоянием и мониторинга работоспособности.</span><span class="sxs-lookup"><span data-stu-id="8644a-200">A platform that provides system services to deploy, scale, upgrade, detect, and restart failed services, discover service location, manage state, and monitor health.</span></span> <span data-ttu-id="8644a-201">Эти системные службы фактически предоставляют многие характеристики микрослужбами было описано выше.</span><span class="sxs-lookup"><span data-stu-id="8644a-201">These system services in effect provide many of the characteristics of microservices described previously.</span></span>

-   <span data-ttu-id="8644a-202">Программные интерфейсы (API) или платформы, позволяющие создавать приложения как микрослужбы: [Reliable Actors и Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span><span class="sxs-lookup"><span data-stu-id="8644a-202">Programming APIs, or frameworks, to help you build applications as microservices: [reliable actors and reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span></span> <span data-ttu-id="8644a-203">Для создания микрослужбы можно использовать любой код. Однако программные интерфейсы не только упрощают задачу, но и обеспечивают более глубокую интеграцию с платформой.</span><span class="sxs-lookup"><span data-stu-id="8644a-203">Of course, you can choose any code to build your microservice, but these APIs make the job more straightforward, and they integrate with the platform at a deeper level.</span></span> <span data-ttu-id="8644a-204">Так вы можете, например, получать информацию о работоспособности и данные диагностики, а также пользоваться преимуществами средств управления надежным состоянием.</span><span class="sxs-lookup"><span data-stu-id="8644a-204">This way you can get health and diagnostics information, or you can take advantage of reliable state management.</span></span>

<span data-ttu-id="8644a-205">Для Service Fabric не важен способ создания службы, поэтому вы можете использовать любую технологию.</span><span class="sxs-lookup"><span data-stu-id="8644a-205">Service Fabric is agnostic with respect to how you build your service, and you can use any technology.</span></span> <span data-ttu-id="8644a-206">Но эта платформа предоставляет встроенные интерфейсы API, упрощающие создание микрослужб.</span><span class="sxs-lookup"><span data-stu-id="8644a-206">However, it provides built-in programming APIs that make it easier to build microservices.</span></span>

<span data-ttu-id="8644a-207">На рисунке 4 – 9 показано, как создать и запустить микрослужбами в Service Fabric в виде простых процессов или как контейнеры Docker.</span><span class="sxs-lookup"><span data-stu-id="8644a-207">Figure 4-9 demonstrates how you can create and run microservices in Service Fabric either as simple processes or as Docker containers.</span></span> <span data-ttu-id="8644a-208">Микрослужбы на основе контейнеров можно также сочетать с микрослужбами на основе процессов в рамках одного кластера Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-208">It is also possible to mix container-based microservices with process-based microservices within the same Service Fabric cluster.</span></span>

![](./media/image13.png)

<span data-ttu-id="8644a-209">На рисунке 4 – 9: развертывание микрослужбами как процессы или контейнеры в Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="8644a-209">Figure 4-9: Deploying microservices as processes or as containers in Azure Service Fabric</span></span>

<span data-ttu-id="8644a-210">Структуры службы кластеров на основе на узлах Linux и Windows можно запускать контейнеры Docker Linux и Windows.</span><span class="sxs-lookup"><span data-stu-id="8644a-210">Service Fabric clusters based on Linux and Windows hosts can run Docker Linux containers and Windows Containers.</span></span>

<span data-ttu-id="8644a-211">**Дополнительные сведения о** актуальные сведения о поддержке контейнеры в Service Fabric на сайте Azure чтения [Service Fabric и контейнеры](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="8644a-211">**More info** For up-to-date information about containers support in Service Fabric, on the Azure website, read [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

<span data-ttu-id="8644a-212">Структура службы — это хороший пример платформы, с помощью которого можно определить другой логической архитектуры (business микрослужбами или ограниченного контексты) от физической реализации.</span><span class="sxs-lookup"><span data-stu-id="8644a-212">Service Fabric is a good example of a platform with which you can define a different logical architecture (business microservices or Bounded Contexts) than the physical implementation.</span></span> <span data-ttu-id="8644a-213">Например, если вы реализуете [надежных служб с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) в [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), которого представлены в следующем разделе «[Stateless сравнение с отслеживанием состояния микрослужбами](#stateless-versus-stateful-microservices),» у вас есть бизнес-концепция микрослужбу, с несколькими физический службами.</span><span class="sxs-lookup"><span data-stu-id="8644a-213">For example, if you implement [Stateful Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) in [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), which are introduced in the next section, "[Stateless versus stateful microservices](#stateless-versus-stateful-microservices)," you have a business microservice concept with multiple physical services.</span></span>

<span data-ttu-id="8644a-214">Как показано на рис. 4-10 и решения с точки зрения логического или business микрослужбу, при реализации службы с отслеживанием состояния надежные службы структуры обычно необходимо реализовать два уровня служб.</span><span class="sxs-lookup"><span data-stu-id="8644a-214">As shown in Figure 4-10, and thinking from a logical/business microservice perspective, when implementing a Service Fabric Stateful Reliable Service, you usually will need to implement two tiers of services.</span></span> <span data-ttu-id="8644a-215">Первый — в серверной части с отслеживанием состояния надежного службу, которая обрабатывает несколько секций.</span><span class="sxs-lookup"><span data-stu-id="8644a-215">The first is the back-end stateful reliable service, which handles multiple partitions.</span></span> <span data-ttu-id="8644a-216">Второй уровень — это внешняя служба или служба шлюза, которая отвечает за маршрутизацию и объединение данных в разных разделах или экземплярах служб с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="8644a-216">The second is the front-end service, or Gateway service, in charge of routing and data aggregation across multiple partitions or stateful service instances.</span></span> <span data-ttu-id="8644a-217">Эту службу шлюза также обрабатывает клиентские взаимодействие с циклами повторных попыток доступа к внутренней службе, использовать в сочетании с Service Fabric [обратный прокси-сервер](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy).</span><span class="sxs-lookup"><span data-stu-id="8644a-217">That Gateway service also handles client-side communication with retry loops accessing the back-end service used in conjunction with the Service Fabric [reverse proxy](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy).</span></span>

![](./media/image14.png)

<span data-ttu-id="8644a-218">Рис. 4-10: микрослужбу бизнеса с нескольких служб с отслеживанием состояния и без сохранения состояния в Service Fabric</span><span class="sxs-lookup"><span data-stu-id="8644a-218">Figure 4-10: Business microservice with several stateful and stateless services in Service Fabric</span></span>

<span data-ttu-id="8644a-219">В любом случае при использовании надежных служб Service Fabric с отслеживанием состояния у вас также есть логическая микрослужба или бизнес-микрослужба (ограниченный контекст), которая обычно состоит из нескольких физических служб.</span><span class="sxs-lookup"><span data-stu-id="8644a-219">In any case, when you use Service Fabric Stateful Reliable Services, you also have a logical or business microservice (Bounded Context) that is usually composed of multiple physical services.</span></span> <span data-ttu-id="8644a-220">Каждый из них, служба шлюза и разделов службы может быть реализован как службы веб-API ASP.NET, как показано на рисунке 4-10.</span><span class="sxs-lookup"><span data-stu-id="8644a-220">Each of them, the Gateway service, and Partition service could be implemented as ASP.NET Web API services, as shown in Figure 4-10.</span></span>

<span data-ttu-id="8644a-221">В Service Fabric службы можно объединять в группы и развертывать как [приложение Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), которое представляет собой модуль упаковки и развертывания для оркестратора или кластера.</span><span class="sxs-lookup"><span data-stu-id="8644a-221">In Service Fabric, you can group and deploy groups of services as a [Service Fabric Application](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), which is the unit of packaging and deployment for the orchestrator or cluster.</span></span> <span data-ttu-id="8644a-222">Таким образом приложение Service Fabric может быть сопоставлен этот самостоятельных и микрослужбу логических границ или ограниченного контекста, также.</span><span class="sxs-lookup"><span data-stu-id="8644a-222">Therefore, the Service Fabric Application could be mapped to this autonomous business and logical microservice boundary or Bounded Context, as well.</span></span>

### <a name="service-fabric-and-containers"></a><span data-ttu-id="8644a-223">Service Fabric и контейнеры</span><span class="sxs-lookup"><span data-stu-id="8644a-223">Service Fabric and containers</span></span>

<span data-ttu-id="8644a-224">По отношению к контейнерам в Service Fabric можно развернуть службы в образы контейнеров в пределах кластера Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-224">With regard to containers in Service Fabric, you also can deploy services in container images within a Service Fabric cluster.</span></span> <span data-ttu-id="8644a-225">Рис. 4-11 показана, большую часть времени, может содержать только один контейнер каждой службы.</span><span class="sxs-lookup"><span data-stu-id="8644a-225">Figure 4-11 illustrates that most of the time there will be only one container per service.</span></span>

![](./media/image15.png)

<span data-ttu-id="8644a-226">Рис. 4-11: микрослужбу бизнеса с несколькими службами (контейнеров) в Service Fabric</span><span class="sxs-lookup"><span data-stu-id="8644a-226">Figure 4-11: Business microservice with several services (containers) in Service Fabric</span></span>

<span data-ttu-id="8644a-227">Тем не менее так называемые «сопроводительные» контейнеры (двух контейнеров, которые должны быть развернуты вместе как часть службы логических) также возможны в Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-227">However, so-called "sidecar" containers (two containers that must be deployed together as part of a logical service) are also possible in Service Fabric.</span></span> <span data-ttu-id="8644a-228">Важным моментом является то, что бизнес-микрослужба — это логическая граница вокруг нескольких связанных элементов.</span><span class="sxs-lookup"><span data-stu-id="8644a-228">The important thing is that a business microservice is the logical boundary around several cohesive elements.</span></span> <span data-ttu-id="8644a-229">Во многих случаях может быть одной службы с одной модели данных, но в некоторых других случаях может потребоваться физического несколько служб, а также.</span><span class="sxs-lookup"><span data-stu-id="8644a-229">In many cases, it might be a single service with a single data model, but in some other cases you might have physical several services, as well.</span></span>

<span data-ttu-id="8644a-230">Начиная с этой записи (апреле 2017 г.), в Service Fabric невозможно развернуть SF надежных служб с отслеживанием состояния в контейнерах, можно развернуть только контейнеры гостевой службы без сохранения состояния и служб субъекта в контейнерах.</span><span class="sxs-lookup"><span data-stu-id="8644a-230">As of this writing (April 2017), in Service Fabric you cannot deploy SF Reliable Stateful Services on containers—you can deploy only guest containers, stateless services, or actor services in containers.</span></span> <span data-ttu-id="8644a-231">Но Обратите внимание, что вы можете сочетать в процессах и службы в контейнеры, в то же приложение Service Fabric как показано на рисунке 4-12.</span><span class="sxs-lookup"><span data-stu-id="8644a-231">But note that you can mix services in processes and services in containers in the same Service Fabric application, as shown in Figure 4-12.</span></span>

![](./media/image16.png)

<span data-ttu-id="8644a-232">Рис. 4-12: Business микрослужбу сопоставлен с контейнерами и служб с отслеживанием состояния приложения Service Fabric</span><span class="sxs-lookup"><span data-stu-id="8644a-232">Figure 4-12: Business microservice mapped to a Service Fabric application with containers and stateful services</span></span>

<span data-ttu-id="8644a-233">Поддержка также отличается в зависимости от того, используете ли вы контейнеры Docker на контейнеры Windows или Linux.</span><span class="sxs-lookup"><span data-stu-id="8644a-233">Support is also different depending on whether you are using Docker containers on Linux or Windows Containers.</span></span> <span data-ttu-id="8644a-234">Поддержка контейнеров в Service Fabric будет расширение в будущих выпусках.</span><span class="sxs-lookup"><span data-stu-id="8644a-234">Support for containers in Service Fabric will be expanding in upcoming releases.</span></span> <span data-ttu-id="8644a-235">Последние новости о поддержке контейнера в Service Fabric на сайте Azure чтения [Service Fabric и контейнеры](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="8644a-235">For up-to-date news about container support in Service Fabric, on the Azure website, read [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

## <a name="stateless-versus-stateful-microservices"></a><span data-ttu-id="8644a-236">Микрослужбы с отслеживанием и без отслеживания состояния</span><span class="sxs-lookup"><span data-stu-id="8644a-236">Stateless versus stateful microservices</span></span>

<span data-ttu-id="8644a-237">Как уже упоминалось, у каждой микрослужбы (логического ограниченного контекста) должна быть своя модель предметной области (данные и логика).</span><span class="sxs-lookup"><span data-stu-id="8644a-237">As mentioned earlier, each microservice (logical Bounded Context) must own its domain model (data and logic).</span></span> <span data-ttu-id="8644a-238">В случае без сохранения состояния микрослужбами базы данных будут внешних данных, построенных на реляционной вариантах, например SQL Server или NoSQL вариантах, например MongoDB или Azure DocumentDB.</span><span class="sxs-lookup"><span data-stu-id="8644a-238">In the case of stateless microservices, the databases will be external, employing relational options like SQL Server, or NoSQL options like MongoDB or Azure DocumentDB.</span></span>

<span data-ttu-id="8644a-239">Однако сами службы также можно с отслеживанием состояния, это означает, что данные находятся в пределах микрослужбу.</span><span class="sxs-lookup"><span data-stu-id="8644a-239">But the services themselves also can be stateful, which means that the data resides within the microservice.</span></span> <span data-ttu-id="8644a-240">Эти данные могут существовать не только на том же сервере, но внутри процесса микрослужбу в памяти и на дисках сохраняются и реплицируются на другие узлы.</span><span class="sxs-lookup"><span data-stu-id="8644a-240">This data might exist not just on the same server, but within the microservice process, in memory, and persisted on drives and replicated to other nodes.</span></span> <span data-ttu-id="8644a-241">Рис. 4-13 показаны различные подходы.</span><span class="sxs-lookup"><span data-stu-id="8644a-241">Figure 4-13 shows the different approaches.</span></span>

![](./media/image17.png)

<span data-ttu-id="8644a-242">На рисунке 4 — 13: без учета состояния, сравнение с отслеживанием состояния микрослужбами</span><span class="sxs-lookup"><span data-stu-id="8644a-242">Figure 4-13: Stateless versus stateful microservices</span></span>

<span data-ttu-id="8644a-243">Правильный подход без сохранения состояния и проще реализовать чем микрослужбами с отслеживанием состояния, поскольку подход аналогичен шаблонов традиционных и хорошо известных.</span><span class="sxs-lookup"><span data-stu-id="8644a-243">A stateless approach is perfectly valid and is easier to implement than stateful microservices because the approach is similar to traditional and well-known patterns.</span></span> <span data-ttu-id="8644a-244">Но микрослужбы без отслеживания состояния вызывают задержку при взаимодействии процесса с источниками данных</span><span class="sxs-lookup"><span data-stu-id="8644a-244">But stateless microservices impose latency between the process and data sources.</span></span> <span data-ttu-id="8644a-245">и вдобавок содержат больше "движущихся деталей", что осложняет повышение производительности за счет дополнительного кэша и очередей.</span><span class="sxs-lookup"><span data-stu-id="8644a-245">They also involve more moving pieces when you are trying to improve performance with additional cache and queues.</span></span> <span data-ttu-id="8644a-246">Результат таков: вы можете получить более сложные архитектуры со слишком большим количеством уровней.</span><span class="sxs-lookup"><span data-stu-id="8644a-246">The result is that you can end up with complex architectures that have too many tiers.</span></span>

<span data-ttu-id="8644a-247">Напротив [с отслеживанием состояния микрослужбами](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) можно excel в сложных сценариях, так как нет задержка между доменную логику и данные.</span><span class="sxs-lookup"><span data-stu-id="8644a-247">In contrast, [stateful microservices](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can excel in advanced scenarios because there is no latency between the domain logic and data.</span></span> <span data-ttu-id="8644a-248">Обработка большого объема данных, игры заканчивается обратной, базы данных как службы и другие сценарии низкой задержкой, все преимущества служб с отслеживанием состояния, которые предоставляют локального состояния для более быстрого доступа.</span><span class="sxs-lookup"><span data-stu-id="8644a-248">Heavy data processing, gaming back-ends, databases as a service, and other low-latency scenarios all benefit from stateful services, which provide local state for faster access.</span></span>

<span data-ttu-id="8644a-249">Службы без отслеживания состояния и с отслеживанием состояния дополняют друг друга.</span><span class="sxs-lookup"><span data-stu-id="8644a-249">Stateless and stateful services are complementary.</span></span> <span data-ttu-id="8644a-250">Для экземпляра службы с отслеживанием состояния можно разбить на несколько разделов.</span><span class="sxs-lookup"><span data-stu-id="8644a-250">For instance, a stateful service could be split into multiple partitions.</span></span> <span data-ttu-id="8644a-251">Для доступа к этим разделам может потребоваться служба без отслеживания состояния, выступающая в роли службы шлюза и способная обращаться к каждому разделу с помощью ключей разделов.</span><span class="sxs-lookup"><span data-stu-id="8644a-251">To access those partitions, you might need a stateless service acting as a gateway service that knows how to address each partition based on partition keys.</span></span>

<span data-ttu-id="8644a-252">У служб с отслеживанием состояния есть недостатки.</span><span class="sxs-lookup"><span data-stu-id="8644a-252">Stateful services do have drawbacks.</span></span> <span data-ttu-id="8644a-253">Уровень сложности, что позволяет масштабировать ресурсов. Функциональность, которая обычно реализовывалась бы в рамках внешней базы данных, должна обрабатывать такие операции, как репликация данных между микрослужбами с отслеживанием состояния и секционирование данных.</span><span class="sxs-lookup"><span data-stu-id="8644a-253">They impose a level of complexity that allows them to scale out. Functionality that would usually be implemented by external database systems must be addressed for tasks such as data replication across stateful microservices and data partitioning.</span></span> <span data-ttu-id="8644a-254">Тем не менее, это одна из областей, где orchestrator, например [Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) с его [надежных служб с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) помогут наиболее — за счет упрощения разработки и жизненного цикла с отслеживанием состояния с помощью микрослужбами [надежные API служб](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) и [службы Reliable Actor](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span><span class="sxs-lookup"><span data-stu-id="8644a-254">However, this is one of the areas where an orchestrator like [Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) with its [stateful reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can help the most—by simplifying the development and lifecycle of stateful microservices using the [Reliable Services API](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) and [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span></span>

<span data-ttu-id="8644a-255">К другим платформам микрослужб, которые допускают использование служб с отслеживанием состояния и поддерживают шаблон субъекта, повышая отказоустойчивость и снижая задержки при взаимодействии между бизнес-логикой и данными, относятся Microsoft [Orleans](https://github.com/dotnet/orleans) от Microsoft Research и [Akka.NET](https://getakka.net/).</span><span class="sxs-lookup"><span data-stu-id="8644a-255">Other microservice frameworks that allow stateful services, that support the Actor pattern, and that improve fault tolerance and latency between business logic and data are Microsoft [Orleans](https://github.com/dotnet/orleans), from Microsoft Research, and [Akka.NET](https://getakka.net/).</span></span> <span data-ttu-id="8644a-256">В настоящее время идет работа над улучшением поддержки Docker в обеих этих платформах.</span><span class="sxs-lookup"><span data-stu-id="8644a-256">Both frameworks are currently improving their support for Docker.</span></span>

<span data-ttu-id="8644a-257">Учтите, что контейнеры Docker сами по себе не поддерживают отслеживание состояния.</span><span class="sxs-lookup"><span data-stu-id="8644a-257">Note that Docker containers are themselves stateless.</span></span> <span data-ttu-id="8644a-258">Чтобы реализовать службу с отслеживанием состояния, вам потребуется одна из высокоуровневых платформ, указанных выше.</span><span class="sxs-lookup"><span data-stu-id="8644a-258">If you want to implement a stateful service, you need one of the additional prescriptive and higher-level frameworks noted earlier.</span></span> <span data-ttu-id="8644a-259">Однако на момент написания этой статьи с отслеживанием состояния службы в Service Fabric не поддерживается как контейнеры, только как обычный микрослужбами.</span><span class="sxs-lookup"><span data-stu-id="8644a-259">However, as of this writing, stateful services in Service Fabric are not supported as containers, only as plain microservices.</span></span> <span data-ttu-id="8644a-260">Надежные службы поддержки в контейнерах, будут доступны в будущих версиях Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="8644a-260">Reliable services support in containers will be available in upcoming versions of Service Fabric.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="8644a-261">[Предыдущие] (soa-applications.md) [Далее] (docker приложения development-environment.md)</span><span class="sxs-lookup"><span data-stu-id="8644a-261">[Previous] (soa-applications.md) [Next] (docker-apps-development-environment.md)</span></span>
