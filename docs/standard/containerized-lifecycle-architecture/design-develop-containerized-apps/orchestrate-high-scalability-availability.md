---
title: Управление микрослужбами и многоконтейнерными приложениями для обеспечения высокого уровня масштабируемости и доступности
description: Жизненный цикл контейнерного приложения Docker на основе платформы и средств Майкрософт
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/19/2017
ms.openlocfilehash: 993f1d18637f39b6df4d876db8a0fe86e34391e3
ms.sourcegitcommit: 9bd8f213b50f0e1a73e03bd1e840c917fbd6d20a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2018
ms.locfileid: "50170358"
---
# <a name="orchestrating-microservices-and-multicontainer-applications-for-high-scalability-and-availability"></a><span data-ttu-id="4168e-103">Управление микрослужбами и многоконтейнерными приложениями для обеспечения высокого уровня масштабируемости и доступности</span><span class="sxs-lookup"><span data-stu-id="4168e-103">Orchestrating microservices and multicontainer applications for high scalability and availability</span></span>

<span data-ttu-id="4168e-104">Использование оркестраторов для приложений, готовых к развертыванию в рабочей среде, крайне важно, если приложение основано на микрослужбах или просто разнесено по нескольким контейнерам.</span><span class="sxs-lookup"><span data-stu-id="4168e-104">Using orchestrators for production-ready applications is essential if your application is based on microservices or simply split across multiple containers.</span></span> <span data-ttu-id="4168e-105">Как было сказано ранее, в рамках подхода на основе микрослужб каждая микрослужба имеет собственную модель и данные, поэтому она является автономной с точки зрения разработки и развертывания.</span><span class="sxs-lookup"><span data-stu-id="4168e-105">As introduced previously, in a microservice-based approach, each microservice owns its model and data so that it will be autonomous from a development and deployment point of view.</span></span> <span data-ttu-id="4168e-106">Но даже если у вас есть более традиционные приложения, состоящего из нескольких служб (например, SOA), также имеется несколько контейнеров или служб, составляющих бизнес-приложение, которое необходимо развернуть по принципу распределенной системы.</span><span class="sxs-lookup"><span data-stu-id="4168e-106">But even if you have a more traditional application that is composed of multiple services (like SOA), you also will have multiple containers or services comprising a single business application that need to be deployed as a distributed system.</span></span> <span data-ttu-id="4168e-107">Такие системы сложны для горизонтального масштабирования и управления ими; Таким образом вы оркестратор абсолютно необходим, если требуется, чтобы производственную и масштабируемое многоконтейнерного приложения.</span><span class="sxs-lookup"><span data-stu-id="4168e-107">These kinds of systems are complex to scale out and manage; therefore, you absolutely need an orchestrator if you want to have a production-ready and scalable multicontainer application.</span></span>

<span data-ttu-id="4168e-108">Рис. 4-6 показано развертывание в кластере приложения, состоящего из нескольких микрослужб (контейнеров).</span><span class="sxs-lookup"><span data-stu-id="4168e-108">Figure 4-6 illustrates deployment into a cluster of an application composed of multiple microservices (containers).</span></span>

![](./media/image6.png)

<span data-ttu-id="4168e-109">Рис. 4-6: кластер контейнеров</span><span class="sxs-lookup"><span data-stu-id="4168e-109">Figure 4-6: A cluster of containers</span></span>

<span data-ttu-id="4168e-110">Такой подход выглядит логичным.</span><span class="sxs-lookup"><span data-stu-id="4168e-110">It looks like a logical approach.</span></span> <span data-ttu-id="4168e-111">Но как вы обрабатываются балансировки нагрузки, маршрутизацию и оркестрация этих составных приложений?</span><span class="sxs-lookup"><span data-stu-id="4168e-111">But how are you handling load balancing, routing, and orchestrating these composed applications?</span></span>

<span data-ttu-id="4168e-112">Интерфейс командной строки Docker (CLI) соответствует требованиям управления один контейнер на одном узле, но ее недостаточно, если требуется управлять множеством контейнеров, развернутых на нескольких узлах для более сложных распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="4168e-112">The Docker command-line interface (CLI) meets the needs of managing one container on one host, but it falls short when it comes to managing multiple containers deployed on multiple hosts for more complex distributed applications.</span></span> <span data-ttu-id="4168e-113">В большинстве случаев требуется платформа управления, который будет автоматически запускать контейнеры, приостановки, или завершать их работу, при необходимости и в идеале также контролировать доступ к ресурсам, как сеть и хранилище данных.</span><span class="sxs-lookup"><span data-stu-id="4168e-113">In most cases, you need a management platform that will automatically start containers, suspend them, or shut them down when needed, and ideally also control how they access resources like the network and data storage.</span></span>

<span data-ttu-id="4168e-114">Чтобы перейти от управления отдельными контейнерами или очень простыми составными приложениями к управлению крупными корпоративными приложениями с микрослужбами, следует прибегнуть к платформам оркестрации и кластеризации.</span><span class="sxs-lookup"><span data-stu-id="4168e-114">To go beyond the management of individual containers or very simple composed apps and move toward larger enterprise applications with microservices, you must turn to orchestration and clustering platforms.</span></span>

<span data-ttu-id="4168e-115">С архитектуры и разработки точки зрения Если построение корпоративных больших, на основе микрослужб, приложений, очень важно знать следующие платформы и продукты, которые поддерживают расширенные сценарии:</span><span class="sxs-lookup"><span data-stu-id="4168e-115">From an architecture and development point of view, if you are building large, enterprise, microservices-based, applications, it is important to understand the following platforms and products that support advanced scenarios:</span></span>

-   <span data-ttu-id="4168e-116">**Кластеры и оркестраторы** при необходимости масштабировать-приложениям на множестве узлов Docker, такие как с помощью большого приложения на базе микрослужб, крайне важно иметь возможность управлять всеми этими узлами как единым кластером, абстрагируясь от сложности базовой платформы.</span><span class="sxs-lookup"><span data-stu-id="4168e-116">**Clusters and orchestrators** When you need to scale-out applications across many Docker hosts, such as with a large microservices-based application, it is critical to be able to manage all of those hosts as a single cluster by abstracting the complexity of the underlying platform.</span></span> <span data-ttu-id="4168e-117">Вот какие преимущества предоставляет кластеры контейнеров и оркестраторы.</span><span class="sxs-lookup"><span data-stu-id="4168e-117">That is what the container clusters and orchestrators provide.</span></span> <span data-ttu-id="4168e-118">Примерами оркестраторов могут Docker Swarm, Mesosphere DC/OS, Kubernetes (первые три доступных через службу контейнеров Azure) и Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-118">Examples of orchestrators are Docker Swarm, Mesosphere DC/OS, Kubernetes (the first three available through Azure Container Service), and Azure Service Fabric.</span></span>

-   <span data-ttu-id="4168e-119">**Планировщики** *планирование* означает, что возможность администратору возможность запускать контейнеры в кластере таким образом, чтобы они также предоставляют пользовательский интерфейс.</span><span class="sxs-lookup"><span data-stu-id="4168e-119">**Schedulers** *Scheduling* means to have the capability for an administrator to launch containers in a cluster so that they also provide a user interface.</span></span> <span data-ttu-id="4168e-120">Планировщик кластера имеет несколько функций: для эффективного использования ресурсов кластера, чтобы задать ограничения, предоставленный пользователем, чтобы эффективно Балансировка нагрузки контейнеров между узлами и быть устойчивости к ошибкам, обеспечивая высокий доступность.</span><span class="sxs-lookup"><span data-stu-id="4168e-120">A cluster scheduler has several responsibilities: to use the cluster's resources efficiently, to set the constraints provided by the user, to efficiently load-balance containers across nodes or hosts, and to be robust against errors while providing high availability.</span></span>

<span data-ttu-id="4168e-121">Понятия кластера и планировщика тесно связаны друг с другом, поэтому продукты, предоставляемые разными поставщиками, часто включают в себя оба набора возможностей.</span><span class="sxs-lookup"><span data-stu-id="4168e-121">The concepts of a cluster and a scheduler are closely related, so the products provided by different vendors often provide both sets of capabilities.</span></span> <span data-ttu-id="4168e-122">В таблице 4-1 перечислены наиболее важных платформ и программного обеспечения варианты кластерами и планирования.</span><span class="sxs-lookup"><span data-stu-id="4168e-122">Table 4-1 lists the most important platform and software choices you have for clusters and schedulers.</span></span> <span data-ttu-id="4168e-123">Эти кластеры обычно предоставляются в общедоступных облаках, таких как Azure.</span><span class="sxs-lookup"><span data-stu-id="4168e-123">These clusters are generally offered in public clouds like Azure.</span></span>

<span data-ttu-id="4168e-124">В таблице 4-1: программные платформы для кластеризации контейнеров, оркестрации и планирования</span><span class="sxs-lookup"><span data-stu-id="4168e-124">Table 4-1: Software platforms for container clustering, orchestration, and scheduling</span></span>

| <span data-ttu-id="4168e-125">Platform</span><span class="sxs-lookup"><span data-stu-id="4168e-125">Platform</span></span> | <span data-ttu-id="4168e-126">Описание</span><span class="sxs-lookup"><span data-stu-id="4168e-126">Description</span></span> |
|---|---|
| <span data-ttu-id="4168e-127">Docker Swarm</span><span class="sxs-lookup"><span data-stu-id="4168e-127">Docker Swarm</span></span><br/> ![Логотип docker Swarm](./media/image7.png) | <span data-ttu-id="4168e-129">Docker Swarm предоставляет возможность кластеризации и планирования контейнеров Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-129">Docker Swarm gives you the ability to cluster and schedule Docker containers.</span></span> <span data-ttu-id="4168e-130">С помощью Swarm можно превратить пул узлов Docker в единый виртуальный узел Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-130">By using Swarm, you can turn a pool of Docker hosts into a single, virtual Docker host.</span></span> <span data-ttu-id="4168e-131">Клиенты могут выполнять запросы API к Swarm так же, как и к узлам, это означает, что Swarm упрощает масштабирование приложений в нескольких узлах.</span><span class="sxs-lookup"><span data-stu-id="4168e-131">Clients can make API requests to Swarm in the same way that they do to hosts, meaning that Swarm makes it easy for applications to scale to multiple hosts.</span></span> <br /><br /> <span data-ttu-id="4168e-132">Решение Docker Swarm предоставляется компанией Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-132">Docker Swarm is a product from Docker, the company.</span></span> <br /><br /> <span data-ttu-id="4168e-133">В Docker 1.12 или более поздней версии имеется встроенный режим Swarm.</span><span class="sxs-lookup"><span data-stu-id="4168e-133">Docker v1.12 or later can run native and built-in Swarm Mode.</span></span> |
| <span data-ttu-id="4168e-134">Mesosphere DC/OS</span><span class="sxs-lookup"><span data-stu-id="4168e-134">Mesosphere DC/OS</span></span><br/>![Логотип mesosphere DC/OS](./media/image8.png) |  <span data-ttu-id="4168e-136">Mesosphere Enterprise DC/OS (на основе Apache Mesos) — это готовая к использованию в рабочей среде платформа для выполнения контейнеров и распределенных приложений.</span><span class="sxs-lookup"><span data-stu-id="4168e-136">Mesosphere Enterprise DC/OS (based on Apache Mesos) is a production-ready platform for running containers and distributed applications.</span></span> <br /><br /> <span data-ttu-id="4168e-137">DC/OS абстрагирует коллекцию ресурсов, доступных в кластере, и предоставляет доступ к ним компонентам, построенным на базе платформы.</span><span class="sxs-lookup"><span data-stu-id="4168e-137">DC/OS works by abstracting a collection of the resources available in the cluster and making those resources available to components built on top of it.</span></span> <span data-ttu-id="4168e-138">В качестве планировщика, интегрированного с DC/OS, обычно используется Marathon.</span><span class="sxs-lookup"><span data-stu-id="4168e-138">Marathon is usually used as a scheduler integrated with DC/OS.</span></span> |
| <span data-ttu-id="4168e-139">Google Kubernetes</span><span class="sxs-lookup"><span data-stu-id="4168e-139">Google Kubernetes</span></span><br />![Логотип Google Kubernetes](./media/image9.png) | <span data-ttu-id="4168e-141">Kubernetes — это решение с открытым кодом, которое предоставляет широкий ряд возможностей: от организации инфраструктуры кластера и планирования контейнеров до оркестрации.</span><span class="sxs-lookup"><span data-stu-id="4168e-141">Kubernetes is an open-source product that provides functionality that ranges from cluster infrastructure and container scheduling to orchestrating capabilities.</span></span> <span data-ttu-id="4168e-142">С ее помощью можно автоматизировать развертывание, масштабирование и операций в контейнерах приложений в кластерах узлов.</span><span class="sxs-lookup"><span data-stu-id="4168e-142">With it, you can automate deployment, scaling, and operations of application containers across clusters of hosts.</span></span> <br /><br /> <span data-ttu-id="4168e-143">Kubernetes предоставляет ориентированную на контейнеры инфраструктуру, которая объединяет контейнеры приложений в логические блоки, чтобы упростить управление и обнаружение.</span><span class="sxs-lookup"><span data-stu-id="4168e-143">Kubernetes provides a container-centric infrastructure that groups application containers into logical units for easy management and discovery.</span></span> |
| <span data-ttu-id="4168e-144">Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4168e-144">Azure Service Fabric</span></span><br />![Логотип Azure Service Fabric](./media/image10.png) | <span data-ttu-id="4168e-146">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) — это платформа микрослужб от корпорации Майкрософт, которая предназначена для создания приложений.</span><span class="sxs-lookup"><span data-stu-id="4168e-146">[Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview) is a Microsoft microservices platform for building applications.</span></span> <span data-ttu-id="4168e-147">Она позволяет [оркестрировать](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) службы и создавать кластеры компьютеров.</span><span class="sxs-lookup"><span data-stu-id="4168e-147">It is an [orchestrator](https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-resource-manager-introduction) of services and creates clusters of machines.</span></span> <span data-ttu-id="4168e-148">По умолчанию Service Fabric развертывает и активирует службы как процессы, но Service Fabric позволяет развертывать службы в образах контейнеров Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-148">By default, Service Fabric deploys and activates services as processes, but Service Fabric can deploy services in Docker container images.</span></span> <span data-ttu-id="4168e-149">Что более важно, можно комбинировать службы в процессах и службы в контейнерах в одном приложении.</span><span class="sxs-lookup"><span data-stu-id="4168e-149">More important, you can mix services in processes with services in containers in the same application.</span></span> <br /><br /> <span data-ttu-id="4168e-150">По состоянию на май 2017 г. особенностью Service Fabric, которая поддерживает развертывание службы в качестве контейнеров Docker находится в состоянии предварительной версии.</span><span class="sxs-lookup"><span data-stu-id="4168e-150">As of May 2017, the feature of Service Fabric that supports deploying services as Docker containers is in preview state.</span></span> <br /><br /> <span data-ttu-id="4168e-151">Вы можете разрабатывать службы Service Fabric во многих отношениях, с помощью [моделей программирования Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework) развертыванию [гостевых исполняемых файлов](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-existing-app) а также контейнеры.</span><span class="sxs-lookup"><span data-stu-id="4168e-151">You can develop Service Fabric services in many ways, from using the [Service Fabric programming models](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework) to deploying [guest executables](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-existing-app) as well as containers.</span></span> <span data-ttu-id="4168e-152">Service Fabric поддерживает модели конкретные приложения, например [служб с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) и [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span><span class="sxs-lookup"><span data-stu-id="4168e-152">Service Fabric supports prescriptive application models like [stateful services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) and [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span></span>

## <a name="using-container-based-orchestrators-in-azure"></a><span data-ttu-id="4168e-153">Использование оркестраторов на основе контейнеров в Azure</span><span class="sxs-lookup"><span data-stu-id="4168e-153">Using container-based orchestrators in Azure</span></span>

<span data-ttu-id="4168e-154">Несколько поставщиков облачных решений предлагают поддержку контейнеров Docker, а также кластеров Docker и поддержки оркестрации, включая Azure, Amazon EC2 Container Service и Google Container Engine.</span><span class="sxs-lookup"><span data-stu-id="4168e-154">Several cloud vendors offer Docker containers support plus Docker clusters and orchestration support, including Azure, Amazon EC2 Container Service, and Google Container Engine.</span></span> <span data-ttu-id="4168e-155">Azure предоставляет поддержку кластера и оркестратора посредством службы контейнеров Azure, Docker, как описано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="4168e-155">Azure provides Docker cluster and orchestrator support through Azure Container Service, as explained in the next section.</span></span>

<span data-ttu-id="4168e-156">Другой вариант — использовать Azure Service Fabric, которая также поддерживает Docker на основе Linux и контейнеров Windows.</span><span class="sxs-lookup"><span data-stu-id="4168e-156">Another choice is to use Azure Service Fabric, which also supports Docker based on Linux and Windows Containers.</span></span> <span data-ttu-id="4168e-157">Service Fabric выполняется на Azure, любое иное облако производительны [локальной](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-anywhere).</span><span class="sxs-lookup"><span data-stu-id="4168e-157">Service Fabric runs on Azure or any other cloud as well as [on-premises](https://docs.microsoft.com/azure/service-fabric/service-fabric-deploy-anywhere).</span></span>

## <a name="using-azure-container-service"></a><span data-ttu-id="4168e-158">Использование службы контейнеров Azure</span><span class="sxs-lookup"><span data-stu-id="4168e-158">Using Azure Container Service</span></span>

<span data-ttu-id="4168e-159">Кластер Docker объединяет несколько узлов Docker в пул и предоставляет доступ к ним как к единому виртуальному узлу Docker, что позволяет развертывать несколько узлов в кластере.</span><span class="sxs-lookup"><span data-stu-id="4168e-159">A Docker cluster pools multiple Docker hosts and exposes them as a single virtual Docker host, so you can deploy multiple containers into the cluster.</span></span> <span data-ttu-id="4168e-160">Кластер будет обрабатывать всё комплексного управления например масштабируемости и работоспособности.</span><span class="sxs-lookup"><span data-stu-id="4168e-160">The cluster will handle all the complex management plumbing such as scalability and health.</span></span> <span data-ttu-id="4168e-161">Рис. 4-7 представляет сопоставление кластер Docker для составных приложений в службе контейнеров.</span><span class="sxs-lookup"><span data-stu-id="4168e-161">Figure 4-7 represents how a Docker cluster for composed applications maps to Container Service.</span></span>

<span data-ttu-id="4168e-162">Служба контейнеров позволяет упростить создание, Настройка и управление этим кластером виртуальных машин, настроенных для запуска контейнерных приложений.</span><span class="sxs-lookup"><span data-stu-id="4168e-162">Container Service provides a way to simplify the creation, configuration, and management of a cluster of VMs that are preconfigured to run containerized applications.</span></span> <span data-ttu-id="4168e-163">Благодаря оптимизированной конфигурации популярных средств планирования и оркестрации открытым исходным кодом, служба контейнеров позволяет использовать имеющиеся навыки или прибегая тела большого и постоянно растущего сообщества опыт развертывания и управления ими на основе контейнеров приложения в Azure.</span><span class="sxs-lookup"><span data-stu-id="4168e-163">Using an optimized configuration of popular open-source scheduling and orchestration tools, Container Service gives you the ability to use your existing skills or draw on a large and growing body of community expertise to deploy and manage container-based applications in Azure.</span></span>

<span data-ttu-id="4168e-164">Служба контейнеров оптимизирует специально под Azure конфигурацию популярных средств с открытым кодом кластеризации Docker и технологий.</span><span class="sxs-lookup"><span data-stu-id="4168e-164">Container Service optimizes the configuration of popular Docker clustering open-source tools and technologies specifically for Azure.</span></span> <span data-ttu-id="4168e-165">Вы получаете открытое решение, которое обеспечивает переносимость как контейнеров, так и конфигурации приложения.</span><span class="sxs-lookup"><span data-stu-id="4168e-165">You get an open solution that offers portability for both your containers and your application configuration.</span></span> <span data-ttu-id="4168e-166">Вы выбираете размер, число узлов и средства оркестрации, а служба контейнеров делает все остальное.</span><span class="sxs-lookup"><span data-stu-id="4168e-166">You select the size, the number of hosts, and the orchestrator tools, and Container Service handles everything else.</span></span>

<span data-ttu-id="4168e-167">Служба контейнеров использует образы Docker, чтобы убедиться, что контейнеры приложений можно полностью перенести.</span><span class="sxs-lookup"><span data-stu-id="4168e-167">Container Service uses Docker images to ensure that your application containers are fully portable.</span></span> <span data-ttu-id="4168e-168">Он поддерживает свой выбор платформ оркестрации с открытым кодом, например DC/OS, Kubernetes и Docker Swarm, чтобы убедиться, что эти приложения можно масштабировать до тысяч или даже десятков тысяч контейнеров.</span><span class="sxs-lookup"><span data-stu-id="4168e-168">It supports your choice of open-source orchestration platforms like DC/OS, Kubernetes, and Docker Swarm to ensure that these applications can scale to thousands or even tens of thousands of containers.</span></span>

<span data-ttu-id="4168e-169">Со службой контейнеров Azure можно воспользоваться преимуществами функций корпоративного уровня платформы Azure, сохраняя при этом переносимость приложений, в том числе на уровнях оркестрации.</span><span class="sxs-lookup"><span data-stu-id="4168e-169">With Azure Container Service, you can take advantage of the enterprise-grade features of Azure while still maintaining application portability, including at the orchestration layers.</span></span>

![](./media/image11.png)

<span data-ttu-id="4168e-170">Рис. 4-7: варианты кластеризации в службе контейнеров Azure</span><span class="sxs-lookup"><span data-stu-id="4168e-170">Figure 4-7: Clustering choices in Azure Container Service</span></span>

<span data-ttu-id="4168e-171">Как показано на рис. 4-8, служба контейнеров — просто инфраструктура, предоставляемая Azure для развертывания DC/OS, Kubernetes или Docker Swarm, но не реализован собственный Оркестратор.</span><span class="sxs-lookup"><span data-stu-id="4168e-171">As shown in Figure 4-8, Container Service is simply the infrastructure provided by Azure in order to deploy DC/OS, Kubernetes, or Docker Swarm, but it does not implement any additional orchestrator.</span></span> <span data-ttu-id="4168e-172">Таким образом служба контейнеров является не оркестратором, таким образом; Это лишь инфраструктурой, которая использует существующие оркестраторы с открытым исходным кодом для контейнеров.</span><span class="sxs-lookup"><span data-stu-id="4168e-172">Therefore, Container Service is not an orchestrator, as such; it is only an infrastructure that takes advantage of existing open-source orchestrators for containers.</span></span>

![](./media/image12.png)

<span data-ttu-id="4168e-173">Рис. 4-8: Оркестраторы в службе контейнеров</span><span class="sxs-lookup"><span data-stu-id="4168e-173">Figure 4-8: Orchestrators in Container Service</span></span>

<span data-ttu-id="4168e-174">С точки зрения использования службы контейнеров призвано обеспечить среды размещения контейнеров с помощью популярных средств с открытым исходным кодом и технологий.</span><span class="sxs-lookup"><span data-stu-id="4168e-174">From a usage perspective, the goal of Container Service is to provide a container hosting environment by using popular open-source tools and technologies.</span></span> <span data-ttu-id="4168e-175">С этой целью она предоставляет стандартные конечные точки API для выбранного оркестратора.</span><span class="sxs-lookup"><span data-stu-id="4168e-175">To this end, it exposes the standard API endpoints for your chosen orchestrator.</span></span> <span data-ttu-id="4168e-176">Используя эти конечные точки, можно использовать любое программное обеспечение, который может взаимодействовать с этими конечными точками.</span><span class="sxs-lookup"><span data-stu-id="4168e-176">By using these endpoints, you can use any software that can communicate to those endpoints.</span></span> <span data-ttu-id="4168e-177">Например в случае с конечной точкой Docker Swarm, вы можете использовать интерфейс командной строки Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-177">For example, in the case of the Docker Swarm endpoint, you might choose to use the Docker CLI.</span></span> <span data-ttu-id="4168e-178">Для DC/OS можно выбрать интерфейс командной строки DC/OS.</span><span class="sxs-lookup"><span data-stu-id="4168e-178">For DC/OS, you might choose to use the DC/OS CLI.</span></span>

### <a name="getting-started-with-container-service"></a><span data-ttu-id="4168e-179">Приступая к работе со службой контейнеров</span><span class="sxs-lookup"><span data-stu-id="4168e-179">Getting started with Container Service</span></span>

<span data-ttu-id="4168e-180">Чтобы начать работу со службой контейнеров, развертывается кластер службы контейнеров на портале Azure с помощью шаблона Azure Resource Manager или [CLI](https://docs.microsoft.com/cli/azure/install-azure-cli).</span><span class="sxs-lookup"><span data-stu-id="4168e-180">To begin using Container Service, you deploy a Container Service cluster from the Azure portal by using an Azure Resource Manager template or the [CLI](https://docs.microsoft.com/cli/azure/install-azure-cli).</span></span> <span data-ttu-id="4168e-181">Доступные шаблоны включают в себя [Docker Swarm](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-swarm), [Kubernetes](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-kubernetes) и [DC/OS](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-dcos).</span><span class="sxs-lookup"><span data-stu-id="4168e-181">Available templates include [Docker Swarm](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-swarm), [Kubernetes](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-kubernetes), and [DC/OS](https://github.com/Azure/azure-quickstart-templates/tree/master/101-acs-dcos).</span></span> <span data-ttu-id="4168e-182">Можно изменить шаблоны быстрого запуска, чтобы включить дополнительную или расширенную конфигурацию Azure.</span><span class="sxs-lookup"><span data-stu-id="4168e-182">You can modify the quickstart templates to include additional or advanced Azure configuration.</span></span>

<span data-ttu-id="4168e-183">**Дополнительные сведения о** Дополнительные сведения о развертывании кластера службы контейнеров, на веб-сайте Azure, [развертывание кластера службы контейнеров Azure](https://docs.microsoft.com/azure/container-service/dcos-swarm/container-service-deployment).</span><span class="sxs-lookup"><span data-stu-id="4168e-183">**More info** To learn more about deploying a Container Service cluster, on the Azure website, read [Deploy an Azure Container Service cluster](https://docs.microsoft.com/azure/container-service/dcos-swarm/container-service-deployment).</span></span>

<span data-ttu-id="4168e-184">За программное обеспечение, устанавливаемое по умолчанию в составе службы ACS, плата не взимается.</span><span class="sxs-lookup"><span data-stu-id="4168e-184">There are no fees for any of the software installed by default as part of ACS.</span></span> <span data-ttu-id="4168e-185">Все возможности по умолчанию реализуются с помощью ПО с открытым кодом.</span><span class="sxs-lookup"><span data-stu-id="4168e-185">All default options are implemented with open-source software.</span></span>

<span data-ttu-id="4168e-186">Служба контейнеров в настоящее время доступна для Standard A, D, DS, G и GS серии виртуальных машин Linux в Azure.</span><span class="sxs-lookup"><span data-stu-id="4168e-186">Container Service is currently available for Standard A, D, DS, G, and GS series Linux VMs in Azure.</span></span> <span data-ttu-id="4168e-187">Плата только за выбранные вычислительные выбран, а также другие используемые ресурсы базовой инфраструктуры, такие как хранилище и сети.</span><span class="sxs-lookup"><span data-stu-id="4168e-187">You are charged only for the compute instances you choose as well as the other underlying infrastructure resources consumed, such as storage and networking.</span></span> <span data-ttu-id="4168e-188">Существует оплата не начисляется для службы контейнеров сам.</span><span class="sxs-lookup"><span data-stu-id="4168e-188">There are no incremental charges for Container Service itself.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="4168e-189">Дополнительные ресурсы</span><span class="sxs-lookup"><span data-stu-id="4168e-189">Additional resources</span></span>

<span data-ttu-id="4168e-190">Ниже перечислены расположения, где можно найти дополнительные сведения:</span><span class="sxs-lookup"><span data-stu-id="4168e-190">Following are locations where you can find additional information:</span></span>

-   <span data-ttu-id="4168e-191">Общие сведения о решениях с помощью службы контейнеров для размещения контейнера Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-191">Introduction to Docker container hosting solutions with Container Service:</span></span>  
    https://docs.microsoft.com/azure/container-service/kubernetes/container-service-intro-kubernetes>

-   <span data-ttu-id="4168e-192">Обзор docker Swarm:</span><span class="sxs-lookup"><span data-stu-id="4168e-192">Docker Swarm overview:</span></span>  
    <https://docs.docker.com/swarm/overview/>

-   <span data-ttu-id="4168e-193">Общие сведения о режиме swarm:</span><span class="sxs-lookup"><span data-stu-id="4168e-193">Swarm mode overview:</span></span>  
    <https://docs.docker.com/engine/swarm/>

-   <span data-ttu-id="4168e-194">Общие сведения о mesosphere DC/OS:</span><span class="sxs-lookup"><span data-stu-id="4168e-194">Mesosphere DC/OS Overview:</span></span>    
    <https://docs.mesosphere.com/1.7/overview/>

-   <span data-ttu-id="4168e-195">Kubernetes (официальный сайт):</span><span class="sxs-lookup"><span data-stu-id="4168e-195">Kubernetes (the official site):</span></span>  
    <https://kubernetes.io/>

## <a name="using-service-fabric"></a><span data-ttu-id="4168e-196">С помощью Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4168e-196">Using Service Fabric</span></span>

<span data-ttu-id="4168e-197">Service Fabric создана в рамках перехода корпорации Майкрософт от предоставления «коробочных» продуктов, зачастую монолитных в стиле, к предоставлению служб.</span><span class="sxs-lookup"><span data-stu-id="4168e-197">Service Fabric arose from Microsoft's transition from delivering "box" products, which were typically monolithic in style, to delivering services.</span></span> <span data-ttu-id="4168e-198">Ее создании учитывался опыт разработки и эксплуатации масштабных служб, таких как базы данных SQL Azure, Azure Document DB, служебную шину Azure или серверная часть Кортаны, Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-198">The experience of building and operating large services at scale, such as Azure SQL Database, Azure Document DB, Azure Service Bus, or Cortana's Backend, shaped Service Fabric.</span></span> <span data-ttu-id="4168e-199">Она продолжала развиваться по мере внедрения во множестве служб.</span><span class="sxs-lookup"><span data-stu-id="4168e-199">The platform evolved over time as more and more services adopted it.</span></span> <span data-ttu-id="4168e-200">Важно отметить, что Service Fabric работает не только в среде Azure, но и в автономных развертываниях Windows Server.</span><span class="sxs-lookup"><span data-stu-id="4168e-200">Importantly, Service Fabric had to run not only in Azure but also in standalone Windows Server deployments.</span></span>

<span data-ttu-id="4168e-201">Service Fabric предназначен для решения сложных проблем построения и запуска службы и эффективным использованием ресурсов инфраструктуры, таким образом, чтобы командам решать бизнес-проблем, с использованием микрослужб.</span><span class="sxs-lookup"><span data-stu-id="4168e-201">The aim of Service Fabric is to solve the difficult problems of building and running a service and utilizing infrastructure resources efficiently so that teams can solve business problems using a microservices approach.</span></span>

<span data-ttu-id="4168e-202">Service Fabric предоставляет два масштабных решения, которые позволяют создавать приложения в рамках подхода на основе микрослужб.</span><span class="sxs-lookup"><span data-stu-id="4168e-202">Service Fabric provides two broad areas to help you build applications that use a microservices approach:</span></span>

-   <span data-ttu-id="4168e-203">Платформа, которая предоставляет системные службы для развертывания, обновления, обнаружения и перезапуска служб, в которых произошел сбой, а также обнаружения служб, управления состоянием и мониторинга работоспособности.</span><span class="sxs-lookup"><span data-stu-id="4168e-203">A platform that provides system services to deploy, scale, upgrade, detect, and restart failed services, discover service location, manage state, and monitor health.</span></span> <span data-ttu-id="4168e-204">По сути, эти системные службы предоставляют множество характеристик микрослужб, описанных ранее.</span><span class="sxs-lookup"><span data-stu-id="4168e-204">These system services in effect provide many of the characteristics of microservices described previously.</span></span>

-   <span data-ttu-id="4168e-205">Программные интерфейсы (API) или платформы, позволяющие создавать приложения как микрослужбы: [Reliable Actors и Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span><span class="sxs-lookup"><span data-stu-id="4168e-205">Programming APIs, or frameworks, to help you build applications as microservices: [reliable actors and reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-choose-framework).</span></span> <span data-ttu-id="4168e-206">Для создания микрослужбы можно использовать любой код. Однако программные интерфейсы не только упрощают задачу, но и обеспечивают более глубокую интеграцию с платформой.</span><span class="sxs-lookup"><span data-stu-id="4168e-206">Of course, you can choose any code to build your microservice, but these APIs make the job more straightforward, and they integrate with the platform at a deeper level.</span></span> <span data-ttu-id="4168e-207">Так вы можете, например, получать информацию о работоспособности и данные диагностики, а также пользоваться преимуществами средств управления надежным состоянием.</span><span class="sxs-lookup"><span data-stu-id="4168e-207">This way you can get health and diagnostics information, or you can take advantage of reliable state management.</span></span>

<span data-ttu-id="4168e-208">Для Service Fabric не важен способ создания службы, поэтому вы можете использовать любую технологию.</span><span class="sxs-lookup"><span data-stu-id="4168e-208">Service Fabric is agnostic with respect to how you build your service, and you can use any technology.</span></span> <span data-ttu-id="4168e-209">Но эта платформа предоставляет встроенные интерфейсы API, упрощающие создание микрослужб.</span><span class="sxs-lookup"><span data-stu-id="4168e-209">However, it provides built-in programming APIs that make it easier to build microservices.</span></span>

<span data-ttu-id="4168e-210">Рис. 4-9 показано, как создавать и запускать микрослужбы в Service Fabric как простые процессы или как контейнеры Docker.</span><span class="sxs-lookup"><span data-stu-id="4168e-210">Figure 4-9 demonstrates how you can create and run microservices in Service Fabric either as simple processes or as Docker containers.</span></span> <span data-ttu-id="4168e-211">Микрослужбы на основе контейнеров можно также сочетать с микрослужбами на основе процессов в рамках одного кластера Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-211">It is also possible to mix container-based microservices with process-based microservices within the same Service Fabric cluster.</span></span>

![](./media/image13.png)

<span data-ttu-id="4168e-212">Рис. 4-9: развертывание микрослужб в виде процессов или контейнеров в Azure Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4168e-212">Figure 4-9: Deploying microservices as processes or as containers in Azure Service Fabric</span></span>

<span data-ttu-id="4168e-213">Кластеры Service Fabric, на основе узлов Linux и Windows можно запустить контейнеры Linux и контейнеров Windows.</span><span class="sxs-lookup"><span data-stu-id="4168e-213">Service Fabric clusters based on Linux and Windows hosts can run Docker Linux containers and Windows Containers.</span></span>

<span data-ttu-id="4168e-214">**Дополнительные сведения о** актуальные сведения о поддержке контейнеров в Service Fabric на сайте Azure. в статье [Service Fabric и контейнеры](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="4168e-214">**More info** For up-to-date information about containers support in Service Fabric, on the Azure website, read [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

<span data-ttu-id="4168e-215">Service Fabric представляет собой хороший пример платформы, с помощью которого можно определить логическую архитектуру (бизнес-микрослужбы или ограниченные контексты) от физической реализации.</span><span class="sxs-lookup"><span data-stu-id="4168e-215">Service Fabric is a good example of a platform with which you can define a different logical architecture (business microservices or Bounded Contexts) than the physical implementation.</span></span> <span data-ttu-id="4168e-216">Например, если вы реализуете [надежных служб с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) в [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), которые представлены в следующем разделе, "[и микрослужбы с отслеживанием состояниябезотслеживаниясостояния](#stateless-versus-stateful-microservices),» у вас есть бизнес-микрослужба с нескольких физических служб.</span><span class="sxs-lookup"><span data-stu-id="4168e-216">For example, if you implement [Stateful Reliable Services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction) in [Azure Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-overview), which are introduced in the next section, "[Stateless versus stateful microservices](#stateless-versus-stateful-microservices)," you have a business microservice concept with multiple physical services.</span></span>

<span data-ttu-id="4168e-217">Как показано на рисунке 4-10 и мышление с точки зрения логической архитектуры микрослужб, при реализации службы Reliable Service Fabric с отслеживанием состояния обычно необходимо реализовать два уровня служб.</span><span class="sxs-lookup"><span data-stu-id="4168e-217">As shown in Figure 4-10, and thinking from a logical/business microservice perspective, when implementing a Service Fabric Stateful Reliable Service, you usually will need to implement two tiers of services.</span></span> <span data-ttu-id="4168e-218">Первый — службу с отслеживанием состояния надежных серверной части, которая обеспечивает работу нескольких разделов.</span><span class="sxs-lookup"><span data-stu-id="4168e-218">The first is the back-end stateful reliable service, which handles multiple partitions.</span></span> <span data-ttu-id="4168e-219">Второй — внешняя служба или служба шлюза, ответственный за маршрутизацию и объединение данных в нескольких секций или экземпляры службы с отслеживанием состояния.</span><span class="sxs-lookup"><span data-stu-id="4168e-219">The second is the front-end service, or Gateway service, in charge of routing and data aggregation across multiple partitions or stateful service instances.</span></span> <span data-ttu-id="4168e-220">Служба шлюза также обрабатывает клиентскую связь с выполнение повторных обращений к внутренней службе, используется в сочетании с Service Fabric [обратный прокси-сервер](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy).</span><span class="sxs-lookup"><span data-stu-id="4168e-220">That Gateway service also handles client-side communication with retry loops accessing the back-end service used in conjunction with the Service Fabric [reverse proxy](https://docs.microsoft.com/azure/service-fabric/service-fabric-reverseproxy).</span></span>

![](./media/image14.png)

<span data-ttu-id="4168e-221">Рис. 4-10: бизнес-микрослужба с несколькими службами с отслеживанием и без отслеживания состояния в Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4168e-221">Figure 4-10: Business microservice with several stateful and stateless services in Service Fabric</span></span>

<span data-ttu-id="4168e-222">В любом случае при использовании надежных служб Service Fabric с отслеживанием состояния у вас также есть логическая микрослужба или бизнес-микрослужба (ограниченный контекст), которая обычно состоит из нескольких физических служб.</span><span class="sxs-lookup"><span data-stu-id="4168e-222">In any case, when you use Service Fabric Stateful Reliable Services, you also have a logical or business microservice (Bounded Context) that is usually composed of multiple physical services.</span></span> <span data-ttu-id="4168e-223">Каждый из их, служба шлюза и служб раздела можно реализовать как службы веб-API ASP.NET, как показано на рисунке 4-10.</span><span class="sxs-lookup"><span data-stu-id="4168e-223">Each of them, the Gateway service, and Partition service could be implemented as ASP.NET Web API services, as shown in Figure 4-10.</span></span>

<span data-ttu-id="4168e-224">В Service Fabric службы можно объединять в группы и развертывать как [приложение Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), которое представляет собой модуль упаковки и развертывания для оркестратора или кластера.</span><span class="sxs-lookup"><span data-stu-id="4168e-224">In Service Fabric, you can group and deploy groups of services as a [Service Fabric Application](https://docs.microsoft.com/azure/service-fabric/service-fabric-application-model), which is the unit of packaging and deployment for the orchestrator or cluster.</span></span> <span data-ttu-id="4168e-225">Таким образом приложение Service Fabric может быть сопоставлен этот автономной и логической микрослужбой или ограниченным контекстом, а также.</span><span class="sxs-lookup"><span data-stu-id="4168e-225">Therefore, the Service Fabric Application could be mapped to this autonomous business and logical microservice boundary or Bounded Context, as well.</span></span>

### <a name="service-fabric-and-containers"></a><span data-ttu-id="4168e-226">Service Fabric и контейнеры</span><span class="sxs-lookup"><span data-stu-id="4168e-226">Service Fabric and containers</span></span>

<span data-ttu-id="4168e-227">Что касается контейнеров в Service Fabric вы также можете развернуть службы в образах контейнеров в кластере Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-227">With regard to containers in Service Fabric, you also can deploy services in container images within a Service Fabric cluster.</span></span> <span data-ttu-id="4168e-228">Рис. 4-11 показано, что большую часть времени, может содержать только один контейнер для каждой службы.</span><span class="sxs-lookup"><span data-stu-id="4168e-228">Figure 4-11 illustrates that most of the time there will be only one container per service.</span></span>

![](./media/image15.png)

<span data-ttu-id="4168e-229">Рис. 4-11: бизнес-микрослужба с несколькими службами (контейнерами) в Service Fabric</span><span class="sxs-lookup"><span data-stu-id="4168e-229">Figure 4-11: Business microservice with several services (containers) in Service Fabric</span></span>

<span data-ttu-id="4168e-230">Тем не менее так называемые «сцепленные» контейнеры (два контейнера, которые должны развертываться вместе как часть логической службы) также возможны в Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-230">However, so-called "sidecar" containers (two containers that must be deployed together as part of a logical service) are also possible in Service Fabric.</span></span> <span data-ttu-id="4168e-231">Важным моментом является то, что бизнес-микрослужба — это логическая граница вокруг нескольких связанных элементов.</span><span class="sxs-lookup"><span data-stu-id="4168e-231">The important thing is that a business microservice is the logical boundary around several cohesive elements.</span></span> <span data-ttu-id="4168e-232">Во многих случаях может быть одна служба с единственной моделью данных, но в некоторых других случаях может потребоваться несколько физических служб, а также.</span><span class="sxs-lookup"><span data-stu-id="4168e-232">In many cases, it might be a single service with a single data model, but in some other cases you might have physical several services, as well.</span></span>

<span data-ttu-id="4168e-233">На момент написания этой статьи (апрель 2017 г.), в Service Fabric нельзя развернуть SF надежных служб с отслеживанием состояния в контейнерах, можно развернуть только гостевых контейнеров, службы без отслеживания состояния или службы субъектов в контейнерах.</span><span class="sxs-lookup"><span data-stu-id="4168e-233">As of this writing (April 2017), in Service Fabric you cannot deploy SF Reliable Stateful Services on containers—you can deploy only guest containers, stateless services, or actor services in containers.</span></span> <span data-ttu-id="4168e-234">Но Обратите внимание на то, что вы можете сочетать службы в процессах и служб в контейнерах в одном приложении Service Fabric, как показано на рисунке 4-12.</span><span class="sxs-lookup"><span data-stu-id="4168e-234">But note that you can mix services in processes and services in containers in the same Service Fabric application, as shown in Figure 4-12.</span></span>

![](./media/image16.png)

<span data-ttu-id="4168e-235">Рис. 4-12: бизнес-микрослужба, сопоставляются с приложения Service Fabric с контейнерами и служб с отслеживанием состояния</span><span class="sxs-lookup"><span data-stu-id="4168e-235">Figure 4-12: Business microservice mapped to a Service Fabric application with containers and stateful services</span></span>

<span data-ttu-id="4168e-236">Поддержка также отличается в зависимости от того, вы используете контейнеры Docker на контейнеры Windows или Linux.</span><span class="sxs-lookup"><span data-stu-id="4168e-236">Support is also different depending on whether you are using Docker containers on Linux or Windows Containers.</span></span> <span data-ttu-id="4168e-237">В будущих выпусках будет расширять поддержку контейнеров в Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-237">Support for containers in Service Fabric will be expanding in upcoming releases.</span></span> <span data-ttu-id="4168e-238">Последние новости о поддержке контейнеров в Service Fabric на сайте Azure. в статье [Service Fabric и контейнеры](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span><span class="sxs-lookup"><span data-stu-id="4168e-238">For up-to-date news about container support in Service Fabric, on the Azure website, read [Service Fabric and containers](https://docs.microsoft.com/azure/service-fabric/service-fabric-containers-overview).</span></span>

## <a name="stateless-versus-stateful-microservices"></a><span data-ttu-id="4168e-239">Микрослужбы с отслеживанием и без отслеживания состояния</span><span class="sxs-lookup"><span data-stu-id="4168e-239">Stateless versus stateful microservices</span></span>

<span data-ttu-id="4168e-240">Как уже упоминалось, у каждой микрослужбы (логического ограниченного контекста) должна быть своя модель предметной области (данные и логика).</span><span class="sxs-lookup"><span data-stu-id="4168e-240">As mentioned earlier, each microservice (logical Bounded Context) must own its domain model (data and logic).</span></span> <span data-ttu-id="4168e-241">В случае микрослужб без отслеживания состояния базы данных будут внешними — применение реляционных параметрами, такими как SQL Server или NoSQL, например MongoDB или Azure DocumentDB.</span><span class="sxs-lookup"><span data-stu-id="4168e-241">In the case of stateless microservices, the databases will be external, employing relational options like SQL Server, or NoSQL options like MongoDB or Azure DocumentDB.</span></span>

<span data-ttu-id="4168e-242">Но сами службы также может быть с отслеживанием состояния, что означает, что данные находятся в микрослужбе.</span><span class="sxs-lookup"><span data-stu-id="4168e-242">But the services themselves also can be stateful, which means that the data resides within the microservice.</span></span> <span data-ttu-id="4168e-243">Эти данные могут существовать не только на одном сервере, но внутри процесса микрослужбы, в памяти и на дисках сохраняются и реплицируются на другие узлы.</span><span class="sxs-lookup"><span data-stu-id="4168e-243">This data might exist not just on the same server, but within the microservice process, in memory, and persisted on drives and replicated to other nodes.</span></span> <span data-ttu-id="4168e-244">Рис. 4-13 показаны различные подходы.</span><span class="sxs-lookup"><span data-stu-id="4168e-244">Figure 4-13 shows the different approaches.</span></span>

![](./media/image17.png)

<span data-ttu-id="4168e-245">Рис. 4-13: без отслеживания состояния и микрослужбы с отслеживанием состояния</span><span class="sxs-lookup"><span data-stu-id="4168e-245">Figure 4-13: Stateless versus stateful microservices</span></span>

<span data-ttu-id="4168e-246">Подход без сохранения состояния — вполне допустимый и проще в реализации, чем микрослужбы с отслеживанием состояния, так как подобен традиционным и общеизвестным шаблонам.</span><span class="sxs-lookup"><span data-stu-id="4168e-246">A stateless approach is perfectly valid and is easier to implement than stateful microservices because the approach is similar to traditional and well-known patterns.</span></span> <span data-ttu-id="4168e-247">Но микрослужбы без отслеживания состояния вызывают задержку при взаимодействии процесса с источниками данных</span><span class="sxs-lookup"><span data-stu-id="4168e-247">But stateless microservices impose latency between the process and data sources.</span></span> <span data-ttu-id="4168e-248">и вдобавок содержат больше "движущихся деталей", что осложняет повышение производительности за счет дополнительного кэша и очередей.</span><span class="sxs-lookup"><span data-stu-id="4168e-248">They also involve more moving pieces when you are trying to improve performance with additional cache and queues.</span></span> <span data-ttu-id="4168e-249">Результат таков: вы можете получить более сложные архитектуры со слишком большим количеством уровней.</span><span class="sxs-lookup"><span data-stu-id="4168e-249">The result is that you can end up with complex architectures that have too many tiers.</span></span>

<span data-ttu-id="4168e-250">Напротив [микрослужбы с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) могут показывать превосходство в сложных сценариях, так как нет задержка между домена логику и данные.</span><span class="sxs-lookup"><span data-stu-id="4168e-250">In contrast, [stateful microservices](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can excel in advanced scenarios because there is no latency between the domain logic and data.</span></span> <span data-ttu-id="4168e-251">Интенсивная обработка данных, игровые серверов, баз данных как услуга и других сценариев малым временем задержки, все преимущества служб с отслеживанием состояния, которые предоставляют локальное состояние для более быстрого доступа.</span><span class="sxs-lookup"><span data-stu-id="4168e-251">Heavy data processing, gaming back-ends, databases as a service, and other low-latency scenarios all benefit from stateful services, which provide local state for faster access.</span></span>

<span data-ttu-id="4168e-252">Службы без отслеживания состояния и с отслеживанием состояния дополняют друг друга.</span><span class="sxs-lookup"><span data-stu-id="4168e-252">Stateless and stateful services are complementary.</span></span> <span data-ttu-id="4168e-253">Например службы с отслеживанием состояния можно разбить на несколько секций.</span><span class="sxs-lookup"><span data-stu-id="4168e-253">For instance, a stateful service could be split into multiple partitions.</span></span> <span data-ttu-id="4168e-254">Для доступа к этим разделам может потребоваться служба без отслеживания состояния, выступающая в роли службы шлюза и способная обращаться к каждому разделу с помощью ключей разделов.</span><span class="sxs-lookup"><span data-stu-id="4168e-254">To access those partitions, you might need a stateless service acting as a gateway service that knows how to address each partition based on partition keys.</span></span>

<span data-ttu-id="4168e-255">У служб с отслеживанием состояния есть недостатки.</span><span class="sxs-lookup"><span data-stu-id="4168e-255">Stateful services do have drawbacks.</span></span> <span data-ttu-id="4168e-256">Они повышают уровень сложности, что дает возможность масштабировать. Функциональность, которая обычно реализовывалась бы в рамках внешней базы данных, должна обрабатывать такие операции, как репликация данных между микрослужбами с отслеживанием состояния и секционирование данных.</span><span class="sxs-lookup"><span data-stu-id="4168e-256">They impose a level of complexity that allows them to scale out. Functionality that would usually be implemented by external database systems must be addressed for tasks such as data replication across stateful microservices and data partitioning.</span></span> <span data-ttu-id="4168e-257">Тем не менее, это одна из областей, где оркестратор, например [Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) с его [надежных служб с отслеживанием состояния](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) помогут наиболее, упрощая разработку и жизненный цикл с отслеживанием состояния с помощью микрослужб [Reliable Services API](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) и [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span><span class="sxs-lookup"><span data-stu-id="4168e-257">However, this is one of the areas where an orchestrator like [Service Fabric](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-platform-architecture) with its [stateful reliable services](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-services-introduction#when-to-use-reliable-services-apis) can help the most—by simplifying the development and lifecycle of stateful microservices using the [Reliable Services API](https://docs.microsoft.com/azure/service-fabric/service-fabric-work-with-reliable-collections) and [Reliable Actors](https://docs.microsoft.com/azure/service-fabric/service-fabric-reliable-actors-introduction).</span></span>

<span data-ttu-id="4168e-258">К другим платформам микрослужб, которые допускают использование служб с отслеживанием состояния и поддерживают шаблон субъекта, повышая отказоустойчивость и снижая задержки при взаимодействии между бизнес-логикой и данными, относятся Microsoft [Orleans](https://github.com/dotnet/orleans) от Microsoft Research и [Akka.NET](https://getakka.net/).</span><span class="sxs-lookup"><span data-stu-id="4168e-258">Other microservice frameworks that allow stateful services, that support the Actor pattern, and that improve fault tolerance and latency between business logic and data are Microsoft [Orleans](https://github.com/dotnet/orleans), from Microsoft Research, and [Akka.NET](https://getakka.net/).</span></span> <span data-ttu-id="4168e-259">В настоящее время идет работа над улучшением поддержки Docker в обеих этих платформах.</span><span class="sxs-lookup"><span data-stu-id="4168e-259">Both frameworks are currently improving their support for Docker.</span></span>

<span data-ttu-id="4168e-260">Учтите, что контейнеры Docker сами по себе не поддерживают отслеживание состояния.</span><span class="sxs-lookup"><span data-stu-id="4168e-260">Note that Docker containers are themselves stateless.</span></span> <span data-ttu-id="4168e-261">Чтобы реализовать службу с отслеживанием состояния, вам потребуется одна из высокоуровневых платформ, указанных выше.</span><span class="sxs-lookup"><span data-stu-id="4168e-261">If you want to implement a stateful service, you need one of the additional prescriptive and higher-level frameworks noted earlier.</span></span> <span data-ttu-id="4168e-262">Однако на момент написания этой статьи служб с отслеживанием состояния в Service Fabric не поддерживаются как контейнеры, только как простой микрослужбы.</span><span class="sxs-lookup"><span data-stu-id="4168e-262">However, as of this writing, stateful services in Service Fabric are not supported as containers, only as plain microservices.</span></span> <span data-ttu-id="4168e-263">Поддержка надежных служб в контейнерах, будет доступна в будущих версиях Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="4168e-263">Reliable services support in containers will be available in upcoming versions of Service Fabric.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="4168e-264">[Назад](soa-applications.md)
[Вперед](docker-apps-development-environment.md)</span><span class="sxs-lookup"><span data-stu-id="4168e-264">[Previous](soa-applications.md)
[Next](docker-apps-development-environment.md)</span></span>
