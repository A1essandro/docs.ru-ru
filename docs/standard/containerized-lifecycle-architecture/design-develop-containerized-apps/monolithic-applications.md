---
title: Монолитные приложения
description: Жизненный цикл контейнерного приложения Docker на основе платформы и средств Майкрософт
ms.prod: .net
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 09/22/2017
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 9be0ac088a90bd34bb93550925d2e0aee5b91a21
ms.sourcegitcommit: 9a4fe1a1c37b26532654b4bbe22d702237950009
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="monolithic-applications"></a><span data-ttu-id="33d4b-103">Монолитные приложения</span><span class="sxs-lookup"><span data-stu-id="33d4b-103">Monolithic applications</span></span>

<span data-ttu-id="33d4b-104">В этом сценарии вы построение одно- и монолитные веб-приложения или службы и развертывание его в качестве контейнера.</span><span class="sxs-lookup"><span data-stu-id="33d4b-104">In this scenario, you are building a single and monolithic web application or service and deploying it as a container.</span></span> <span data-ttu-id="33d4b-105">В приложении структуру может оказаться монолитные; также может содержать несколько библиотек, компонентов или даже слои (уровня приложения, уровня домена, уровень доступа к данным, и т. д.).</span><span class="sxs-lookup"><span data-stu-id="33d4b-105">Within the application, the structure might not be monolithic; it might comprise several libraries, components, or even layers (application layer, domain layer, data access layer, etc.).</span></span> <span data-ttu-id="33d4b-106">Извне это один контейнер, как единый процесс, одного веб-приложения или службы единого.</span><span class="sxs-lookup"><span data-stu-id="33d4b-106">Externally, it is a single container, like a single process, single web application, or single service.</span></span>

<span data-ttu-id="33d4b-107">Для управления этой моделью вы развертываете один контейнер, представляющий собой приложение.</span><span class="sxs-lookup"><span data-stu-id="33d4b-107">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="33d4b-108">Чтобы масштабировать его, необходимо просто добавьте несколько копий с балансировкой нагрузки на переднем плане.</span><span class="sxs-lookup"><span data-stu-id="33d4b-108">To scale it, just add a few more copies with a load balancer in front.</span></span> <span data-ttu-id="33d4b-109">Простота поступает от управления одно развертывание в одном контейнере или виртуальной машины (VM).</span><span class="sxs-lookup"><span data-stu-id="33d4b-109">The simplicity comes from managing a single deployment in a single container or virtual machine (VM).</span></span>

<span data-ttu-id="33d4b-110">Следующий основной сервер делает самое только в один контейнер и делает это в одном процессе объединенный шаблон находится в конфликте.</span><span class="sxs-lookup"><span data-stu-id="33d4b-110">Following the principal that a container does one thing only, and does it in one process, the monolithic pattern is in conflict.</span></span> <span data-ttu-id="33d4b-111">Как показано на рисунке 4-1, может включать несколько компонентов и библиотек или внутренней уровней в каждом контейнере.</span><span class="sxs-lookup"><span data-stu-id="33d4b-111">You can include multiple components/libraries or internal layers within each container, as illustrated in Figure 4-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="33d4b-112">Рис. 4-1: пример архитектуры монолитные приложения</span><span class="sxs-lookup"><span data-stu-id="33d4b-112">Figure 4-1: An example of monolithic application architecture</span></span>

<span data-ttu-id="33d4b-113">Недостатком этого подхода поступает, если или при расширении приложения, требующие масштабирование.</span><span class="sxs-lookup"><span data-stu-id="33d4b-113">The downside to this approach comes if or when the application grows, requiring it to scale.</span></span> <span data-ttu-id="33d4b-114">Если масштабируется приложение целиком, все получится.</span><span class="sxs-lookup"><span data-stu-id="33d4b-114">If the entire application scaled, it's not really a problem.</span></span> <span data-ttu-id="33d4b-115">В большинстве случаев несколько частей приложения весьма стягиванием точки, которые требуется масштабирование, в то время как менее используются другими компонентами.</span><span class="sxs-lookup"><span data-stu-id="33d4b-115">However, in most cases, a few parts of the application are the choke points that require scaling, whereas other components are used less.</span></span>

<span data-ttu-id="33d4b-116">Используя пример типичных электронной коммерции, скорее всего, необходим для масштабирования сведения компонента продукта.</span><span class="sxs-lookup"><span data-stu-id="33d4b-116">Using the typical e-commerce example, what you likely need is to scale the product information component.</span></span> <span data-ttu-id="33d4b-117">Клиенты чаще просматривают товары, чем приобретают их.</span><span class="sxs-lookup"><span data-stu-id="33d4b-117">Many more customers browse products than purchase them.</span></span> <span data-ttu-id="33d4b-118">Клиенты чаще складывают товары в корзину, чем оплачивают их.</span><span class="sxs-lookup"><span data-stu-id="33d4b-118">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="33d4b-119">Не так много клиентов пишут комментарии или просматривают историю покупок.</span><span class="sxs-lookup"><span data-stu-id="33d4b-119">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="33d4b-120">И, скорее всего имеется лишь небольшое число сотрудников в одной области, необходимые для управления содержимым и маркетинговых кампаний.</span><span class="sxs-lookup"><span data-stu-id="33d4b-120">And you likely have only a handful of employees, in a single region, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="33d4b-121">По масштабирование монолитные конструкции, весь код разворачивается несколько раз.</span><span class="sxs-lookup"><span data-stu-id="33d4b-121">By scaling the monolithic design, all of the code is deployed multiple times.</span></span>

<span data-ttu-id="33d4b-122">В дополнение к «масштаб-все» проблему, изменений к одному компоненту требуется полное повторное тестирование всего приложения, а также завершить повторное развертывание всех экземпляров.</span><span class="sxs-lookup"><span data-stu-id="33d4b-122">In addition to the "scale-everything" problem, changes to a single component require complete retesting of the entire application as well as a complete redeployment of all the instances.</span></span>

<span data-ttu-id="33d4b-123">Объединенный подход часто, и во многих организациях разрабатываемом с помощью этого метода архитектуры.</span><span class="sxs-lookup"><span data-stu-id="33d4b-123">The monolithic approach is common, and many organizations are developing with this architectural method.</span></span> <span data-ttu-id="33d4b-124">Многие предоставляются блага достаточное количество результатов, в то время как другие возникнуть ограничения.</span><span class="sxs-lookup"><span data-stu-id="33d4b-124">Many enjoy good enough results, whereas others encounter limits.</span></span> <span data-ttu-id="33d4b-125">Многие открыт свои приложения в этой модели, так как средства и инфраструктура были слишком трудно реализовать SOA, и они не увидят необходимость, пока его размер увеличивается.</span><span class="sxs-lookup"><span data-stu-id="33d4b-125">Many designed their applications in this model because the tools and infrastructure were too difficult to build SOAs, and they didn't see the need—until the app grew.</span></span>

<span data-ttu-id="33d4b-126">С точки зрения инфраструктуры каждого сервера можно выполнять многие приложения, в том же узле и имеют допустимые доля эффективность в использования ресурсов, как показано на рисунке 4-2.</span><span class="sxs-lookup"><span data-stu-id="33d4b-126">From an infrastructure perspective, each server can run many applications within the same host and have an acceptable ratio of efficiency in your resources usage, as shown in Figure 4-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="33d4b-127">Рис. 4-2: узел под управлением нескольких приложений или контейнеров</span><span class="sxs-lookup"><span data-stu-id="33d4b-127">Figure 4-2: A host running multiple apps/containers</span></span>

<span data-ttu-id="33d4b-128">Монолитные приложения в Azure можно развернуть с помощью выделенных виртуальных машин для каждого экземпляра.</span><span class="sxs-lookup"><span data-stu-id="33d4b-128">You can deploy monolithic applications in Azure by using dedicated VMs for each instance.</span></span> <span data-ttu-id="33d4b-129">С помощью [набора масштабирования виртуальных Машин Azure](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), можно легко масштабировать виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="33d4b-129">Using [Azure VM Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can scale the VMs easily.</span></span> <span data-ttu-id="33d4b-130">[Службы приложений Azure](https://azure.microsoft.com/en-us/services/app-service/) также могут выполнять монолитные приложения и легко масштабировать экземпляры, и вам не придется управлять виртуальными машинами.</span><span class="sxs-lookup"><span data-stu-id="33d4b-130">[Azure App Services](https://azure.microsoft.com/en-us/services/app-service/) can run monolithic applications and easily scale instances without having to manage the VMs.</span></span> <span data-ttu-id="33d4b-131">С момента 2016 г. службы приложений Azure можно запустить отдельные экземпляры контейнеры Docker, а также упрощения развертывания.</span><span class="sxs-lookup"><span data-stu-id="33d4b-131">Since 2016, Azure App Services can run single instances of Docker containers, as well, simplifying the deployment.</span></span> <span data-ttu-id="33d4b-132">И с помощью Docker, можно развернуть в одной виртуальной Машины узел Docker и запустить несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="33d4b-132">And, using Docker, you can deploy a single VM as a Docker host and run multiple instances.</span></span> <span data-ttu-id="33d4b-133">С помощью балансировки Azure, как показано на рисунке 4-3, вы можете управлять масштабирования.</span><span class="sxs-lookup"><span data-stu-id="33d4b-133">Using the Azure balancer, as illustrated in the Figure 4-3, you can manage scaling.</span></span>

![](./media/image3.png)

<span data-ttu-id="33d4b-134">Рис. 4-3: несколько узлов масштабирования одного приложения приложений или контейнеры Docker</span><span class="sxs-lookup"><span data-stu-id="33d4b-134">Figure 4-3: Multiple hosts scaling-out a single Docker application apps/containers</span></span>

<span data-ttu-id="33d4b-135">Вы можете управлять для различных узлов через традиционные методы развертывания.</span><span class="sxs-lookup"><span data-stu-id="33d4b-135">You can manage the deployment to the various hosts via traditional deployment techniques.</span></span> <span data-ttu-id="33d4b-136">Узлы Docker можно управлять с помощью команды `docker run` вручную, с помощью автоматизации, такие как конвейеры непрерывной поставки (CD), которые объясняются ниже в этой книге e.</span><span class="sxs-lookup"><span data-stu-id="33d4b-136">You can manage Docker hosts by using commands like `docker run` manually, through automation such as Continuous Delivery (CD) pipelines, which we explain later in this e-book.</span></span>

## <a name="monolithic-application-deployed-as-a-container"></a><span data-ttu-id="33d4b-137">Развертывание монолитного приложения в контейнере</span><span class="sxs-lookup"><span data-stu-id="33d4b-137">Monolithic application deployed as a container</span></span>

<span data-ttu-id="33d4b-138">Существуют преимущества при использовании контейнеров для управления развертываниями монолитные.</span><span class="sxs-lookup"><span data-stu-id="33d4b-138">There are benefits to using containers to manage monolithic deployments.</span></span> <span data-ttu-id="33d4b-139">Масштабировать экземпляры контейнера гораздо быстрее и проще, чем развертывать дополнительные виртуальные машины.</span><span class="sxs-lookup"><span data-stu-id="33d4b-139">Scaling the instances of containers is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="33d4b-140">Несмотря на то, что набора масштабирования виртуальных Машин — Это прекрасная возможность для масштабирования виртуальных машин, которые требуются для размещения в контейнеры Docker, они принимают времени для установки.</span><span class="sxs-lookup"><span data-stu-id="33d4b-140">Although VM Scale Sets are a great feature to scale VMs, which are required to host your Docker containers, they take time to set up.</span></span> <span data-ttu-id="33d4b-141">При развертывании в виде экземпляров приложения управление конфигурацией приложения осуществляется в составе виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="33d4b-141">When deployed as app instances, the configuration of the app is managed as part of the VM.</span></span>

<span data-ttu-id="33d4b-142">Развертывание обновлений в виде образов Docker выполняется гораздо быстрее и эффективнее с точки зрения использования сети.</span><span class="sxs-lookup"><span data-stu-id="33d4b-142">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="33d4b-143">Vn экземпляры можно настроить на те же узлы, как экземпляры Vn-1, устраняя добавлены затраты, возникающие в результате дополнительных ВМ.</span><span class="sxs-lookup"><span data-stu-id="33d4b-143">The Vn instances can be set up on the same hosts as your Vn-1 instances, eliminating added costs resulting from additional VMs.</span></span> <span data-ttu-id="33d4b-144">Образы docker, как правило, начинается в секундах, что позволяет ускорить процесс развертывания.</span><span class="sxs-lookup"><span data-stu-id="33d4b-144">Docker images typically start in seconds, speeding rollouts.</span></span> <span data-ttu-id="33d4b-145">То закрытие экземпляра Docker можно так же легко, как вызов `docker stop` команду, обычно Завершение менее чем за секунду.</span><span class="sxs-lookup"><span data-stu-id="33d4b-145">Tearing down a Docker instance is as easy as invoking the `docker stop` command, typically completing in less than a second.</span></span>

<span data-ttu-id="33d4b-146">Поскольку контейнеры являются по своей природе неизменяемыми, намеренно, никогда не нужно беспокоиться о поврежденных виртуальные машины, поскольку забыли сценарий обновления с учетом некоторых определенной конфигурации или файл, оставшегося на диске.</span><span class="sxs-lookup"><span data-stu-id="33d4b-146">Because containers are inherently immutable, by design, you never need to worry about corrupted VMs because an update script forgot to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="33d4b-147">Несмотря на то, что монолитные приложения могут использовать преимущества Docker, мы прервать на только советы преимущества.</span><span class="sxs-lookup"><span data-stu-id="33d4b-147">Although monolithic apps can benefit from Docker, we're touching on only the tips of the benefits.</span></span> <span data-ttu-id="33d4b-148">Увеличить преимущества управления контейнерами поступает из развертывание с помощью orchestrators контейнера, управлять различных экземпляров и жизненный цикл экземпляра каждого контейнера.</span><span class="sxs-lookup"><span data-stu-id="33d4b-148">The larger benefits of managing containers comes from deploying with container orchestrators that manage the various instances and life cycle of each container instance.</span></span> <span data-ttu-id="33d4b-149">Когда вы разбиваете монолитное приложение на подсистемы, которые затем можно масштабировать, разрабатывать и развертывать по отдельности, вы переходите на уровень микрослужб.</span><span class="sxs-lookup"><span data-stu-id="33d4b-149">Breaking up the monolithic application into subsystems that can be scaled, developed, and deployed individually is your entry point into the realm of microservices.</span></span>

## <a name="publishing-a-single-docker-container-app-to-azure-app-service"></a><span data-ttu-id="33d4b-150">Публикация одного контейнера Docker приложения в службе приложений Azure</span><span class="sxs-lookup"><span data-stu-id="33d4b-150">Publishing a single Docker container app to Azure App Service</span></span>

<span data-ttu-id="33d4b-151">Либо потому, что вы хотите получить быстрый проверки контейнера, развернутой в Azure, либо потому, что приложение просто контейнер одного приложения службы приложений Azure предоставляет отличный способ предоставления масштабируемой один контейнер служб.</span><span class="sxs-lookup"><span data-stu-id="33d4b-151">Either because you want to get a quick validation of a container deployed to Azure or because the app is simply a single-container app, Azure App Services provides a great way to provide scalable single-container services.</span></span>

<span data-ttu-id="33d4b-152">Служба приложений Azure с помощью интуитивно понятный и приступить к и быстрый запуск, так как она обеспечивает значительные Git интеграции использования вашего кода сборки в Microsoft Visual Studio, а также развернуть его непосредственно в Azure.</span><span class="sxs-lookup"><span data-stu-id="33d4b-152">Using Azure App Service is intuitive and you can get up and running quickly because it provides great Git integration to take your code, build it in Microsoft Visual Studio, and directly deploy it to Azure.</span></span> <span data-ttu-id="33d4b-153">Но, в большинстве случаев (с не Docker), при необходимости других возможностей, платформах и зависимости, которые не поддерживаются в службы приложения, необходимо дождаться, пока группа Azure обновляет эти зависимости в службе приложений или переключается на другие службы, такие как Service Fabric, облачные службы или даже простой виртуальных машин, для которых имеют управления и установить необходимый компонент или framework для приложения.</span><span class="sxs-lookup"><span data-stu-id="33d4b-153">But, traditionally (with no Docker), if you needed other capabilities, frameworks, or dependencies that aren't supported in App Services, you needed to wait for it until the Azure team updates those dependencies in App Service or switched to other services like Service Fabric, Cloud Services, or even plain VMs, for which you have further control and can install a required component or framework for your application.</span></span>

<span data-ttu-id="33d4b-154">Теперь, но при этом (объявлено в Microsoft Connect 2016 в ноябре 2016) и как показано на 4‑4 рисунке, при использовании Visual Studio 2017 г., поддержка контейнера в службе приложений Azure дает возможность включать любые необходимые в вашей среде приложения.</span><span class="sxs-lookup"><span data-stu-id="33d4b-154">Now, however, (announced at Microsoft Connect 2016 in November 2016) and as shown in Figure 4‑4, when using Visual Studio 2017, container support in Azure App Service gives you the ability to include whatever you want in your app environment.</span></span> <span data-ttu-id="33d4b-155">При добавлении зависимость приложения, так как вы используете его в контейнере, вы получаете возможность, в том числе эти зависимости в образ файла Dockerfile или Docker.</span><span class="sxs-lookup"><span data-stu-id="33d4b-155">If you added a dependency to your app, because you are running it in a container, you get the capability of including those dependencies in your Dockerfile or Docker image.</span></span>

![](./media/image4.png)

<span data-ttu-id="33d4b-156">Рис. 4-4: публикации контейнер службы приложений Azure из Visual Studio приложения контейнеры</span><span class="sxs-lookup"><span data-stu-id="33d4b-156">Figure 4-4: Publishing a container to Azure App Service from Visual Studio apps/containers</span></span>

<span data-ttu-id="33d4b-157">Рис. 4-4 также показывает, что поток публикации помещает изображения с помощью реестра контейнера, который может быть реестра контейнера Azure (реестра вблизи к развертываниям в Azure и защищены учетные записи и группы Azure Active Directory) или любые другие реестра Docker как и реестров центр Docker или в локальной среде.</span><span class="sxs-lookup"><span data-stu-id="33d4b-157">Figure 4-4 also shows that the publish flow pushes an image through a Container Registry, which can be the Azure Container Registry (a registry near to your deployments in Azure and secured by Azure Active Directory groups and accounts) or any other Docker Registry like Docker Hub or on-premises registries.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="33d4b-158">[Предыдущие] (Общие контейнера конструктора principles.md) [Далее] (state-and-data-in-docker-applications.md)</span><span class="sxs-lookup"><span data-stu-id="33d4b-158">[Previous] (common-container-design-principles.md) [Next] (state-and-data-in-docker-applications.md)</span></span>
