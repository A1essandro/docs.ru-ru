---
title: Состояние и данные в приложениях Docker
description: Жизненный цикл контейнерного приложения Docker на основе платформы и средств Майкрософт
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 09/22/2017
ms.openlocfilehash: 78db191bdec4c25c11728d819d89eaaaff4bd7da
ms.sourcegitcommit: f513a91160b3fec289dd06646d0d6f81f8fcf910
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/18/2018
ms.locfileid: "46008772"
---
# <a name="state-and-data-in-docker-applications"></a><span data-ttu-id="c59af-103">Состояние и данные в приложениях Docker</span><span class="sxs-lookup"><span data-stu-id="c59af-103">State and data in Docker applications</span></span>

<span data-ttu-id="c59af-104">Примитив контейнеров — неизменяемости.</span><span class="sxs-lookup"><span data-stu-id="c59af-104">A primitive of containers is immutability.</span></span> <span data-ttu-id="c59af-105">По сравнению с виртуальной Машины, контейнеры не исчезают в результате это обычное дело.</span><span class="sxs-lookup"><span data-stu-id="c59af-105">When compared to a VM, containers don't disappear as a common occurrence.</span></span> <span data-ttu-id="c59af-106">Виртуальная машина может завершиться ошибкой в различных формах dead процессы, перегруженных ЦП или полной или сбоя диска.</span><span class="sxs-lookup"><span data-stu-id="c59af-106">A VM might fail in various forms from dead processes, overloaded CPU, or a full or failed disk.</span></span> <span data-ttu-id="c59af-107">Тем не менее мы ожидаем, что виртуальной Машины доступен и дисков RAID-МАССИВОВ широко распространены и убедиться, что ошибки диска хранения данных.</span><span class="sxs-lookup"><span data-stu-id="c59af-107">Yet, we expect the VM to be available and RAID drives are commonplace to assure drive failures maintain data.</span></span>

<span data-ttu-id="c59af-108">Тем не менее контейнеры, предположительно могут быть экземпляры процессов.</span><span class="sxs-lookup"><span data-stu-id="c59af-108">However, containers are thought to be instances of processes.</span></span> <span data-ttu-id="c59af-109">Процесс не поддерживает состоянием долговременного хранения.</span><span class="sxs-lookup"><span data-stu-id="c59af-109">A process doesn't maintain durable state.</span></span> <span data-ttu-id="c59af-110">Несмотря на то, что контейнер может записывать данные в локальное хранилище, при условии, что этот экземпляр всегда будет на месте будет эквивалентен при условии, что памяти одной копии будет быть постоянными.</span><span class="sxs-lookup"><span data-stu-id="c59af-110">Even though a container can write to its local storage, assuming that that instance will be around indefinitely would be equivalent to assuming a single-copy memory will be durable.</span></span> <span data-ttu-id="c59af-111">Предполагается, что контейнеры, как и процессы, повторяются, с точки, или при управлении с оркестратором контейнеров, они могут перемещаться.</span><span class="sxs-lookup"><span data-stu-id="c59af-111">You should assume that containers, like processes, are duplicated, killed, or, when managed with a container orchestrator, they might be moved.</span></span>

<span data-ttu-id="c59af-112">Docker используется функция, называемая *оверлейная файловая система* реализовать процесс копирования при записи, в которой хранятся все обновленные сведения о корневой файловой системы контейнера, по сравнению с исходным изображением, на котором он основан.</span><span class="sxs-lookup"><span data-stu-id="c59af-112">Docker uses a feature known as an *overlay file system* to implement a copy-on-write process that stores any updated information to the root file system of a container, compared to the original image on which it is based.</span></span> <span data-ttu-id="c59af-113">Эти изменения будут потеряны, если контейнер впоследствии удаляется из системы.</span><span class="sxs-lookup"><span data-stu-id="c59af-113">These changes are lost if the container is subsequently deleted from the system.</span></span> <span data-ttu-id="c59af-114">Контейнер, следовательно, не имеет постоянное хранилище по умолчанию.</span><span class="sxs-lookup"><span data-stu-id="c59af-114">A container, therefore, does not have persistent storage by default.</span></span> <span data-ttu-id="c59af-115">Несмотря на то, что существует возможность сохранения состояния контейнера, проектирование системы по такой бы конфликтует с принципом контейнера архитектуры.</span><span class="sxs-lookup"><span data-stu-id="c59af-115">Although it's possible to save the state of a container, designing a system around this would be in conflict with the principle of container architecture.</span></span>

<span data-ttu-id="c59af-116">Для управления постоянными данными в приложениях Docker, существуют распространенные решения:</span><span class="sxs-lookup"><span data-stu-id="c59af-116">To manage persistent data in Docker applications, there are common solutions:</span></span>

-   <span data-ttu-id="c59af-117">[**Тома данных**](https://docs.docker.com/engine/tutorials/dockervolumes/) они подключаются к узлу, как только что отмечено выше.</span><span class="sxs-lookup"><span data-stu-id="c59af-117">[**Data volumes**](https://docs.docker.com/engine/tutorials/dockervolumes/) These mount to the host, as just noted.</span></span>

-   <span data-ttu-id="c59af-118">[**Контейнеры томов данных**](https://docs.docker.com/engine/tutorials/dockervolumes/#/creating-and-mounting-a-data-volume-container) эти обеспечивающие общее хранилище для контейнеров, с помощью которой можно цикл внешнего контейнера.</span><span class="sxs-lookup"><span data-stu-id="c59af-118">[**Data volume containers**](https://docs.docker.com/engine/tutorials/dockervolumes/#/creating-and-mounting-a-data-volume-container) These provide shared storage across containers, using an external container that can cycle.</span></span>

-   <span data-ttu-id="c59af-119">[**Подключаемые модули томов**](https://docs.docker.com/engine/tutorials/dockervolumes/#/mount-a-shared-storage-volume-as-a-data-volume) эти подключение томов в удаленные расположения, обеспечивая Долгосрочное хранение.</span><span class="sxs-lookup"><span data-stu-id="c59af-119">[**Volume Plugins**](https://docs.docker.com/engine/tutorials/dockervolumes/#/mount-a-shared-storage-volume-as-a-data-volume) These mount volumes to remote locations, providing long-term persistence.</span></span>

-   <span data-ttu-id="c59af-120">**Удаленные источники данных** примеры включают базы данных SQL и SQL нет или кэшировать служб, таких как Redis.</span><span class="sxs-lookup"><span data-stu-id="c59af-120">**Remote data sources** Examples include SQL and NO-SQL databases or cache services like Redis.</span></span>

-   <span data-ttu-id="c59af-121">[**Служба хранилища Azure**](https://docs.microsoft.com/azure/storage/) это предоставляет географически распространяемый платформу как услугу (PaaS) хранилище, обеспечивая лучшее из контейнеров, как Долгосрочное хранение.</span><span class="sxs-lookup"><span data-stu-id="c59af-121">[**Azure Storage**](https://docs.microsoft.com/azure/storage/) This provides geo distributable platform as a service (PaaS) storage, providing the best of containers as long-term persistence.</span></span>

<span data-ttu-id="c59af-122">Тома данных специально обозначены каталогов в один или несколько контейнеров, которые обходят [объединения файловой системы](https://docs.docker.com/glossary/?term=Union%20file%20system).</span><span class="sxs-lookup"><span data-stu-id="c59af-122">Data volumes are specially designated directories within one or more containers that bypass the [Union File System](https://docs.docker.com/glossary/?term=Union%20file%20system).</span></span> <span data-ttu-id="c59af-123">Тома данных предназначены для сохранения данных, независимо от контейнера жизненного цикла.</span><span class="sxs-lookup"><span data-stu-id="c59af-123">Data volumes are designed to maintain data, independent of the container's life cycle.</span></span> <span data-ttu-id="c59af-124">Docker таким образом никогда не автоматически удаляет тома при вам удалить контейнер, а также его «сбор мусора» томов, на которые больше не ссылается контейнер.</span><span class="sxs-lookup"><span data-stu-id="c59af-124">Docker therefore never automatically deletes volumes when you remove a container, nor will it "garbage collect" volumes that are no longer referenced by a container.</span></span> <span data-ttu-id="c59af-125">Операционной системы можно просматривать и изменять данные в любой том свободно, который является просто еще одна причина для использования только в случае необходимости тома данных.</span><span class="sxs-lookup"><span data-stu-id="c59af-125">The host operating system can browse and edit the data in any volume freely, which is just another reason to use data volumes sparingly.</span></span>

<span data-ttu-id="c59af-126">Объект [контейнер томов данных](https://docs.docker.com/glossary/?term=volume) по сравнению с обычных томов данных.</span><span class="sxs-lookup"><span data-stu-id="c59af-126">A [data volume container](https://docs.docker.com/glossary/?term=volume) is an improvement over regular data volumes.</span></span> <span data-ttu-id="c59af-127">Это по сути неактивные контейнер, который имеет один или несколько томов данных, созданные внутри него (как описано выше).</span><span class="sxs-lookup"><span data-stu-id="c59af-127">It is essentially a dormant container that has one or more data volumes created within it (as described earlier).</span></span> <span data-ttu-id="c59af-128">Контейнер томов данных предоставляет контейнерам доступ из центральной точки подключения.</span><span class="sxs-lookup"><span data-stu-id="c59af-128">The data volume container provides access to containers from a central mount point.</span></span> <span data-ttu-id="c59af-129">Преимущество этого метода доступа является то, что учитывается расположение исходных данных, Создание точки подключения логического контейнера данных.</span><span class="sxs-lookup"><span data-stu-id="c59af-129">The benefit of this method of access is that it abstracts the location of the original data, making the data container a logical mount point.</span></span> <span data-ttu-id="c59af-130">Он также позволяет доступ к томам данных контейнера для создаваться и уничтожаться, сохраняя постоянный в выделенный контейнер данных, контейнеров «приложение».</span><span class="sxs-lookup"><span data-stu-id="c59af-130">It also allows "application" containers accessing the data container volumes to be created and destroyed while keeping the data persistent in a dedicated container.</span></span>

<span data-ttu-id="c59af-131">Рис. 4-5 показано, что обычные тома Docker могут размещаться в хранилище за пределами самих контейнерами, но в физических границах сервера или виртуальной Машины узла.</span><span class="sxs-lookup"><span data-stu-id="c59af-131">Figure 4-5 shows that regular Docker volumes can be placed on storage out of the containers themselves but within the host server/VM physical boundaries.</span></span> <span data-ttu-id="c59af-132">*Тома docker нет возможности использовать тома из одного узла сервера или виртуальной Машины на другой*.</span><span class="sxs-lookup"><span data-stu-id="c59af-132">*Docker volumes don't have the ability to use a volume from one host server/VM to another*.</span></span>

![](./media/image5.png)

<span data-ttu-id="c59af-133">Рис. 4-5: тома данных и внешние источники данных для контейнеров приложений или контейнеров</span><span class="sxs-lookup"><span data-stu-id="c59af-133">Figure 4-5: Data volumes and external data sources for containers apps/containers</span></span>

<span data-ttu-id="c59af-134">Из-за невозможности управлять данными контейнеров, работающих на разных физических узлах, рекомендуется не использовать тома для бизнес-данных Если узел Docker — основных узлов и виртуальных Машин, так как при использовании контейнеров Docker в orchestrator контейнеры должны быть перемещается из одного на другой узел в рамках оптимизации, которые будут произведены методом кластера.</span><span class="sxs-lookup"><span data-stu-id="c59af-134">Due to the inability to manage data shared between containers that run on separate physical hosts, it is recommended that you not use volumes for business data unless the Docker host is a fixed host/VM, because when using Docker containers in an orchestrator, containers are expected to be moved from one to another host, depending on the optimizations to be performed by the cluster.</span></span>

<span data-ttu-id="c59af-135">Таким образом обычных томов данных являются прекрасным механизмом для работы с файлы трассировки, временными файлами или любой похожая концепция, не влияют на целостность бизнес-данных, если или при перемещении на нескольких узлах контейнеров.</span><span class="sxs-lookup"><span data-stu-id="c59af-135">Therefore, regular data volumes are a good mechanism to work with trace files, temporal files, or any similar concept that won't affect the business data consistency if or when your containers are moved across multiple hosts.</span></span>

<span data-ttu-id="c59af-136">[Подключаемые модули томов](https://docs.docker.com/engine/extend/plugins_volume/) предоставляют данные между всеми узлами в кластере.</span><span class="sxs-lookup"><span data-stu-id="c59af-136">[Volume plug-ins](https://docs.docker.com/engine/extend/plugins_volume/) provide data across all hosts in a cluster.</span></span> <span data-ttu-id="c59af-137">Несмотря на то, что не все подключаемые модули томов создаются одинаково, подключаемые модули томов обычно предоставляют надежным внешним хранилищем неизменных контейнеров.</span><span class="sxs-lookup"><span data-stu-id="c59af-137">Although not all volume plug-ins are created equally, volume plug-ins typically provide externalized persistent reliable storage from the immutable containers.</span></span>

<span data-ttu-id="c59af-138">Удаленные источники данных и кэшей база данных SQL, DocumentDB или удаленного кэша как Redis будет таким же, как разработке без контейнеров.</span><span class="sxs-lookup"><span data-stu-id="c59af-138">Remote data sources and caches like SQL Database, DocumentDB, or a remote cache like Redis would be the same as developing without containers.</span></span> <span data-ttu-id="c59af-139">Это один из способов предпочтительным и проверенные, для хранения данных бизнес-приложений.</span><span class="sxs-lookup"><span data-stu-id="c59af-139">This is one of the preferred, and proven, ways to store business application data.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="c59af-140">[Назад](monolithic-applications.md)
[Вперед](soa-applications.md)</span><span class="sxs-lookup"><span data-stu-id="c59af-140">[Previous](monolithic-applications.md)
[Next](soa-applications.md)</span></span>
