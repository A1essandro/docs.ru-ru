---
title: Критические изменения и библиотеки .NET
description: Практические рекомендации для перемещения по критические изменения, при создании библиотек .NET.
author: jamesnk
ms.author: mairaw
ms.date: 10/02/2018
ms.openlocfilehash: 83c01fdad7d836877bf692b87eeb0230219ded36
ms.sourcegitcommit: fd8d4587cc26e53f0e27e230d6e27d828ef4306b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/16/2018
ms.locfileid: "49370341"
---
# <a name="breaking-changes"></a>Критические изменения

Очень важно для библиотеки .NET найти баланс между стабильности для существующих пользователей и инновации в будущем. Авторы библиотеки бережливого рефакторинг и Переосмысление кода, пока она идеально подходит, но критические существующим пользователям оказывает негативное влияние, особенно для библиотек низкого уровня.

## <a name="project-types-and-breaking-changes"></a>Типы проектов и критические изменения

Использование библиотеки в сообществе .NET изменяет эффект изменений, нарушающих работу разработчиков, конечных пользователей.

* **Низкого и среднего уровня библиотеки** например сериализатор, средство синтаксического анализа HTML, объектно реляционным модулем сопоставления базы данных или веб-платформа являются наиболее пострадавших, критические изменения.

  Стандартный блок пакетов используются конечным пользователем разработчикам создавать приложения и другие библиотеки как зависимостей NuGet. К примеру вы создаете приложение и используете клиент с открытым кодом для вызова веб-службы. В обновлении критические зависимости, в которую клиент использует не то, что вы можете исправить. Это клиент с открытым кодом, который необходимо изменить, и у вас нет контроль над компьютером. Вам нужно найти совместимые версии библиотек или отправить команду, чтобы клиентская библиотека и ожидать от новой версии. Худшего случая ситуация, если вы хотите использовать две библиотеки, которые зависят от взаимно несовместимые версии третий библиотеки.

* **Высокоуровневые библиотеки** как набор пользовательского интерфейса элементов управления менее чувствительны к критические изменения.

  Высокоуровневые библиотеки указываются непосредственно в приложение конечного пользователя. При возникновении критических изменений, разработчик можете обновить до последней версии, или можно изменить их приложения для работы с критическим изменением.

**СДЕЛАТЬ ✔️** подумайте об использовании библиотеки. Какой эффект окажет критические изменения в приложения и библиотеки, которые используют его?

**СДЕЛАТЬ ✔️** свести к минимуму критических изменений при разработке это низкоуровневая библиотека .NET.

**Рассмотрите ВОЗМОЖНОСТЬ ✔️** публикации основной переписать библиотеки как новый пакет NuGet.

## <a name="types-of-breaking-changes"></a>Типы критические изменения

Критические изменения делятся на разные категории и не столь же важные тенденции.

### <a name="source-breaking-change"></a>Критическое изменение источника

Источник, критическое изменение не влияет на выполнение программы, но приводит к ошибкам компиляции в следующий раз повторной компиляции приложения. Например новая перегрузка может создавать неоднозначность при вызове методов, которые ранее были однозначными или переименованный параметр приведет к разрыву вызывающих объектов, использующих именованные параметры.

```csharp
public class Task
{
    // Adding a type called Task could conflict with System.Threading.Tasks.Task at compilation
}
```

Так как источник, критическое изменение только опасные при разработчикам перекомпиляции своих приложений, они не наименее травмирующие критическое изменение. Разработчики могут легко исправить свои собственные неработающих исходный код.

### <a name="behavior-breaking-change"></a>Критические изменения в работе

Изменения в поведении являются наиболее распространенным типом критическое изменение: почти любое изменение в поведении может нарушить кто-то. Изменения в библиотеку, в подписи метода, исключения, исключение или входных или выходных данных форматов данных, все будут отрицательно воздействовать на ваши пользователей библиотеки. Даже исправления ошибки можно определять как критические изменения, если применяли ранее неработающих поведение.

Добавлением функций и улучшение плохие очень удобно, но без внимания он может сделать его очень сложной задачей для существующих пользователей для обновления. Чтобы скрыть их за параметры является одним из подходов к помогает разработчикам справиться с поведением, критические изменения. Параметры позволяют разработчикам обновить до последней версии библиотеки, в то же время, решили согласиться или отказаться от критических изменений. Эта стратегия позволяет разработчикам Оставайтесь в курсе событий при этом разрешив много кода адаптировать со временем.

Например, ASP.NET Core MVC использует концепцию [совместимости версии](/aspnet/core/mvc/compatibility-version) , изменяющий возможности включать и отключать на `MvcOptions`.

**Рассмотрите ВОЗМОЖНОСТЬ ✔️** опустить новые функции по умолчанию, если они влияют на существующих пользователей и позволяют разработчикам согласиться на функции с параметром.

### <a name="binary-breaking-change"></a>Двоичный критическое изменение

Двоичный файл, критическое изменение происходит при изменении открытого API-интерфейса библиотеки, чтобы сборки, скомпилированные для более старых версий библиотеки больше не можете для вызова API. Например, изменение сигнатуры метода путем добавления нового параметра приведет к сборки, скомпилированные для более старой версии библиотеки для создания <xref:System.MissingMethodException>.

Критическое изменение двоичный файл можно также вставить разрыв **всю сборку**. Переименование сборки `AssemblyName` изменится удостоверения сборки, как добавлять, удалять или изменять ключ строгого именования сборки. Изменение удостоверения сборки нарушит работу всех скомпилированный код, который его использует.

**❌ НЕ** изменить имя сборки.

**❌ НЕ** добавления, удаления или изменения ключа строгого именования.

**Рассмотрите ВОЗМОЖНОСТЬ ✔️** вместо абстрактных базовых классов и интерфейсов.

> Добавление ничего в интерфейс вызовет существующие типы, реализующие к сбою. Абстрактный базовый класс позволяет добавлять виртуальные реализацию по умолчанию.

**Рассмотрите ВОЗМОЖНОСТЬ ✔️** размещение <xref:System.ObsoleteAttribute> для типов и членов, которые вы собираетесь удалить. Атрибут должен иметь инструкции по обновлению кода больше не использовать устаревшие API.

> Код, который вызывает типы и методы с <xref:System.ObsoleteAttribute> выдаст предупреждение сборки с сообщением, предоставленные для атрибута. Предупреждения предоставляют пользователям время поверхности устаревший API миграции таким образом, когда удаляется устаревший API, большинство больше не рекомендуется.

```csharp
public class Document
{
    [Obsolete("LoadDocument(string) is obsolete. Use LoadDocument(Uri) instead.")]
    public static Document LoadDocument(string uri)
    {
        return LoadDocument(new Uri(uri));
    }

    public static Document LoadDocument(Uri uri)
    {
        // Load the document
    }
}
```

## <a name="see-also"></a>См. также

* [Рекомендации по версии и обновления для разработчиков на C#](../../csharp/whats-new/version-update-considerations.md)
* [Полное руководство по API-критические изменения в .NET](https://stackoverflow.com/questions/1456785/a-definitive-guide-to-api-breaking-changes-in-net)
* [CoreFX критическое изменение правила](https://github.com/dotnet/corefx/blob/master/Documentation/coding-guidelines/breaking-change-rules.md)

>[!div class="step-by-step"]
[Назад](./versioning.md)
