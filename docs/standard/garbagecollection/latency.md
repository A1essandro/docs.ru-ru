---
title: "Режимы задержки"
description: "Режимы задержки"
keywords: .NET, .NET Core
author: stevehoag
manager: wpickett
ms.date: 08/18/2016
ms.topic: article
ms.prod: .net-core
ms.technology: .net-core-technologies
ms.devlang: dotnet
ms.assetid: 810bd8be-5a48-42c6-b080-3afdb31fc61b
translationtype: Human Translation
ms.sourcegitcommit: de0dab146fc811e895dc32f98f877db5e757f82b
ms.openlocfilehash: e063482aaa1fad01f8e0cd9e8552c87a0b247571

---

# <a name="latency-modes"></a>Режимы задержки

Чтобы освободить объекты, сборщик мусора должен остановить все выполняющиеся потоки приложения. В некоторых ситуациях, например, когда приложение получает данные или отображает содержимое, полная сборка мусора может произойти в критическое время и снизить производительность. Степень вмешательства сборщика мусора можно настроить, присвоив свойству [GCSettings.LatencyMode](xref:System.Runtime.GCSettings.LatencyMode) одно из значений [System.Runtime.GCLatencyMode](xref:System.Runtime.GCLatencyMode). 

Периоды ожидания указывает время, когда сборщик мусора может активизироваться в приложении. В периоды небольшого времени ожидания сборщик мусора более осторожен и меньше вмешивается в освобождение объектов. Перечисление [System.Runtime.GCLatencyMode](xref:System.Runtime.GCLatencyMode) предоставляет 2 параметра малого времени ожидания:

* [LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) отключает сборку мусора для объектов поколения 2 и выполняет только сборку мусора для объектов поколений 0 и 1. Его можно использовать только в течение коротких периодов времени. Если в системе за продолжительный период возникнет нехватка памяти, сборщик мусора начнет сборку, что приведет к кратковременной остановке приложения и прервет срочную задачу. Этот параметр доступен только для сборки мусора на рабочей станции. 

* [SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) отключает приоритетную сборку мусора для объектов поколения 2 и выполняет только сборку объектов поколений 0 и 1 и фоновую сборку объектов поколения 2. Его можно использовать дольше и он доступен для сборки мусора как на рабочей станции, так и на сервере. Этот параметр нельзя использовать, если [параллельная сборка мусора](https://msdn.microsoft.com/library/yhwwzef8.aspx) отключена.

В периоды небольшого времени ожидания сборка мусора для объектов поколения 2 подавляется, пока не произойдет одно из следующего:

* система получит уведомление о нехватке памяти от операционной системы;

* код приложения запустит сборку мусора путем вызова метода [GC.Collect](xref:System.GC.Collect(System.Int32)) и укажет значение 2 для параметра generation.

В следующей таблице перечислены сценарии работы приложений с использованием значений [GCLatencyMode](xref:System.Runtime.GCLatencyMode).

Режим периода ожидания | Сценарии приложения
------------ | --------------------- 
[Batch](xref:System.Runtime.GCLatencyMode.Batch) | Для приложений, которые не имеют пользовательского интерфейса или операций на стороне сервера. Этот режим используется по умолчанию, если [параллельная сборка мусора](https://msdn.microsoft.com/library/yhwwzef8.aspx) отключена.
[Interactive](xref:System.Runtime.GCLatencyMode.Interactive) | Для большинства приложений, имеющих пользовательский интерфейс. Для приложений, которые не имеют пользовательского интерфейса или операций на стороне сервера. Этот режим используется по умолчанию, если [параллельная сборка мусора](https://msdn.microsoft.com/library/yhwwzef8.aspx) включена.
[LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) | Для приложений, которые осуществляют операции, чувствительные ко времени выполнения, для которых перерывы в работе из-за сборки мусора могут иметь резко отрицательные последствия. Например, это приложения, которые выполняют функции анимации или получения данных.
[SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) | Для приложений, которые осуществляют операции, чувствительные ко времени выполнения, время выполнения которых ограничено, но может быть достаточно продолжительным, для которых перерывы в работе из-за сборки мусора могут иметь резко отрицательные последствия. Например, приложения, требующие быстрого отклика при изменении рыночных показателей в торговую сессию.   Этот режим использует больший размер управляемой кучи, нежели другие режимы. Так как он не сжимает управляемую кучу, возможен больший уровень фрагментации. Необходимо обеспечить достаточный объем памяти.
 
## <a name="guidelines-for-using-low-latency"></a>Рекомендации по использованию режима небольшого времени ожидания

При использовании режима [LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) придерживайтесь следующих рекомендаций.

* Продолжительность периодов небольшого времени ожидания должна быть как можно более короткой.

* Избегайте выделения больших объемов памяти в периоды небольшого времени ожидания. Могут возникать уведомления о нехватке памяти, потому что сборщик мусора освобождает меньше объектов. 

* В режиме небольшого времени ожидания необходимо свести к минимуму число выделений, в частности выделений в куче для больших объектов и закрепленных объектов. 

* Не забывайте про потоки, которые могут выделять память. Поскольку свойство [LatencyMode](xref:System.Runtime.GCSettings.LatencyMode) относится ко всему процессу, то можно создать [OutOfMemoryException](xref:System.OutOfMemoryException) в любом потоке, выделяющем память. 

* Можно принудительно запускать освобождение объектов поколения 2 в периоды небольшого времени ожидания путем вызова метода [GC.Collect(Int32, GCCollectionMode)](xref:System.GC.Collect(System.Int32,System.GCCollectionMode)).

## <a name="see-also"></a>См. также

[System.GC](xref:System.GC)

[Индуцированные коллекции](induced.md)

[Сборка мусора в .NET](index.md)



<!--HONumber=Nov16_HO1-->


