---
title: "Общие архитектурах веб-приложений"
description: "Архитектора современных веб-приложений с помощью ASP.NET Core и Microsoft Azure | Общие архитектурах веб-приложений"
author: ardalis
ms.author: wiwagn
ms.date: 10/06/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.openlocfilehash: b6236cfab290211f930d6a1987075abeade4fd6d
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
#<a name="common-web-application-architectures"></a><span data-ttu-id="9c443-103">Общие архитектурах веб-приложений</span><span class="sxs-lookup"><span data-stu-id="9c443-103">Common Web Application Architectures</span></span>

> <span data-ttu-id="9c443-104">«Если вы считаете, что расходуется хорошей архитектуры, попробуйте неправильный архитектуры».</span><span class="sxs-lookup"><span data-stu-id="9c443-104">"If you think good architecture is expensive, try bad architecture."</span></span>  
> <span data-ttu-id="9c443-105">_-Нижний колонтитул Брайан и Джозеф Yoder_</span><span class="sxs-lookup"><span data-stu-id="9c443-105">_- Brian Foote and Joseph Yoder_</span></span>

## <a name="summary"></a><span data-ttu-id="9c443-106">Сводка</span><span class="sxs-lookup"><span data-stu-id="9c443-106">Summary</span></span>

<span data-ttu-id="9c443-107">Большинство традиционных приложений .NET, развертываются как один элемент, соответствующий исполняемый файл или одного веб-приложения, запущенного в рамках одного домена приложений служб IIS.</span><span class="sxs-lookup"><span data-stu-id="9c443-107">Most traditional .NET applications are deployed as single units corresponding to an executable or a single web application running within a single IIS appdomain.</span></span> <span data-ttu-id="9c443-108">Это самая легкая модель развертывания и служит многие внутренние и более мелкие открытые приложения очень хорошо.</span><span class="sxs-lookup"><span data-stu-id="9c443-108">This is the simplest deployment model and serves many internal and smaller public applications very well.</span></span> <span data-ttu-id="9c443-109">Однако наиболее нетривиальной бизнес-приложения даже Учитывая это единый элемент развертывания, преимущества некоторых логическое разделение в нескольких уровней.</span><span class="sxs-lookup"><span data-stu-id="9c443-109">However, even given this single unit of deployment, most non-trivial business applications benefit from some logical separation into several layers.</span></span>

## <a name="what-is-a-monolithic-application"></a><span data-ttu-id="9c443-110">Что такое монолитные приложения?</span><span class="sxs-lookup"><span data-stu-id="9c443-110">What is a monolithic application?</span></span>

<span data-ttu-id="9c443-111">Монолитные приложения — это полностью замкнутую, с точки зрения его поведения.</span><span class="sxs-lookup"><span data-stu-id="9c443-111">A monolithic application is one that is entirely self-contained, in terms of its behavior.</span></span> <span data-ttu-id="9c443-112">Он может взаимодействовать с другими хранилищами служб и данных во время выполнения операции, но ядро его поведение работает в собственном процессе и всего приложения обычно развертывается как единое целое.</span><span class="sxs-lookup"><span data-stu-id="9c443-112">It may interact with other services or data stores in the course of performing its operations, but the core of its behavior runs within its own process and the entire application is typically deployed as a single unit.</span></span> <span data-ttu-id="9c443-113">Если такого приложения должен горизонтальное масштабирование, обычно на нескольких серверах или виртуальных машин дублируется всего приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-113">If such an application needs to scale horizontally, typically the entire application is duplicated across multiple servers or virtual machines.</span></span>

## <a name="all-in-one-applications"></a><span data-ttu-id="9c443-114">В одном приложений</span><span class="sxs-lookup"><span data-stu-id="9c443-114">All-in-One applications</span></span>

<span data-ttu-id="9c443-115">Наименьшее возможное число проектов для архитектуры приложения является одним.</span><span class="sxs-lookup"><span data-stu-id="9c443-115">The smallest possible number of projects for an application architecture is one.</span></span> <span data-ttu-id="9c443-116">В этой архитектуре вся логика приложения является содержится в одном проекте, компилируются в одну сборку и развернут как единое целое.</span><span class="sxs-lookup"><span data-stu-id="9c443-116">In this architecture, the entire logic of the application is contained in a single project, compiled to a single assembly, and deployed as a single unit.</span></span>

<span data-ttu-id="9c443-117">Новый проект ASP.NET Core, создается в Visual Studio или из командной строки ли начинается как простой монолита «все в одном».</span><span class="sxs-lookup"><span data-stu-id="9c443-117">A new ASP.NET Core project, whether created in Visual Studio or from the command line, starts out as a simple "all-in-one" monolith.</span></span> <span data-ttu-id="9c443-118">Он содержит все возможности приложения, включая доступ логики презентации, business и данных.</span><span class="sxs-lookup"><span data-stu-id="9c443-118">It contains all of the behavior of the application, including presentation, business, and data access logic.</span></span> <span data-ttu-id="9c443-119">Рис. 5-1 показана структура файла приложения один проект.</span><span class="sxs-lookup"><span data-stu-id="9c443-119">Figure 5-1 shows the file structure of a single-project app.</span></span>

<span data-ttu-id="9c443-120">**Рис. 5-1.**</span><span class="sxs-lookup"><span data-stu-id="9c443-120">**Figure 5-1.**</span></span> <span data-ttu-id="9c443-121">Один проект приложения ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="9c443-121">A single project ASP.NET Core app</span></span>

![](./media/image5-1.png)

<span data-ttu-id="9c443-122">В одном проекте сценарии разделение достигается за счет использования папки.</span><span class="sxs-lookup"><span data-stu-id="9c443-122">In a single project scenario, separation of concerns is achieved through the use of folders.</span></span> <span data-ttu-id="9c443-123">Шаблон по умолчанию включает в себя отдельные папки для обязанности шаблон MVC моделей, представлений и контроллеров, а также дополнительные папки для данных и служб.</span><span class="sxs-lookup"><span data-stu-id="9c443-123">The default template includes separate folders for MVC pattern responsibilities of Models, Views, and Controllers, as well as additional folders for Data and Services.</span></span> <span data-ttu-id="9c443-124">В этом случае представления сведений следует ограничиваться максимально папку Views и сведения о реализации данных access должна выполняться только для классов, которые хранятся в папке данных.</span><span class="sxs-lookup"><span data-stu-id="9c443-124">In this arrangement, presentation details should be limited as much as possible to the Views folder, and data access implementation details should be limited to classes kept in the Data folder.</span></span> <span data-ttu-id="9c443-125">Бизнес-логики должен находиться в службы и классы в папке «Models».</span><span class="sxs-lookup"><span data-stu-id="9c443-125">Business logic should reside in services and classes within the Models folder.</span></span>

<span data-ttu-id="9c443-126">Хотя простой, один проект решения монолитные имеет свои недостатки.</span><span class="sxs-lookup"><span data-stu-id="9c443-126">Although simple, the single-project monolithic solution has some disadvantages.</span></span> <span data-ttu-id="9c443-127">При увеличении размера и сложности проекта количество файлов и папок будет продолжать расти также.</span><span class="sxs-lookup"><span data-stu-id="9c443-127">As the project's size and complexity grows, the number of files and folders will continue to grow as well.</span></span> <span data-ttu-id="9c443-128">Проблемы пользовательского интерфейса (модели, представления и контроллеры) находятся в нескольких папках, которые не сгруппированы вместе в алфавитном порядке.</span><span class="sxs-lookup"><span data-stu-id="9c443-128">UI concerns (models, views, controllers) reside in multiple folders, which are not grouped together alphabetically.</span></span> <span data-ttu-id="9c443-129">Эта проблема только усугубляется, когда дополнительные конструкции уровня пользовательского интерфейса, таких как фильтры или ModelBinders, добавляются в разные папки.</span><span class="sxs-lookup"><span data-stu-id="9c443-129">This issue only gets worse when additional UI-level constructs, such as Filters or ModelBinders, are added in their own folders.</span></span> <span data-ttu-id="9c443-130">Бизнес-логика является разбросаны между папками моделей и службы, и никак не очистить которого классы, в каких папках должны зависеть от какие другие.</span><span class="sxs-lookup"><span data-stu-id="9c443-130">Business logic is scattered between the Models and Services folders, and there is no clear indication of which classes in which folders should depend on which others.</span></span> <span data-ttu-id="9c443-131">Отсутствие организации на уровне проекта, часто приводят к [тестированию кода](http://deviq.com/spaghetti-code/).</span><span class="sxs-lookup"><span data-stu-id="9c443-131">This lack of organization at the project level frequently leads to [spaghetti code](http://deviq.com/spaghetti-code/).</span></span>

<span data-ttu-id="9c443-132">Для решения этих проблем, часто развития приложений в решений для нескольких проектов, где каждый проект считается должна находиться в определенном *слой* приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-132">In order to address these issues, applications often evolve into multi-project solutions, where each project is considered to reside in a particular *layer* of the application.</span></span>

## <a name="what-are-layers"></a><span data-ttu-id="9c443-133">Что такое слоев</span><span class="sxs-lookup"><span data-stu-id="9c443-133">What are layers?</span></span>

<span data-ttu-id="9c443-134">По мере роста сложности приложения для управления этой сложности можно разбить приложения в соответствии с его обязанности или проблемы.</span><span class="sxs-lookup"><span data-stu-id="9c443-134">As applications grow in complexity, one way to manage that complexity is to break the application up according to its responsibilities or concerns.</span></span> <span data-ttu-id="9c443-135">Это следует разделение принцип проблемы и обеспечения растущих codebase организации, чтобы разработчики можно легко находить, где реализуется определенные функции.</span><span class="sxs-lookup"><span data-stu-id="9c443-135">This follows the separation of concerns principle, and can help keep a growing codebase organized so that developers can easily find where certain functionality is implemented.</span></span> <span data-ttu-id="9c443-136">Многоуровневой архитектуры обеспечивает ряд преимуществ за пределами организации код так же, хотя.</span><span class="sxs-lookup"><span data-stu-id="9c443-136">Layered architecture offers a number of advantages beyond just code organization, though.</span></span>

<span data-ttu-id="9c443-137">Организуя кода в слои, общие низкоуровневые функции может быть использован в приложении.</span><span class="sxs-lookup"><span data-stu-id="9c443-137">By organizing code into layers, common low-level functionality can be reused throughout the application.</span></span> <span data-ttu-id="9c443-138">Повторное использование будет полезно, так как это означает, что необходимо записать меньший объем кода и она позволяет приложению стандартизировать одной реализации, следуя ТОНЕРА принцип.</span><span class="sxs-lookup"><span data-stu-id="9c443-138">This reuse is beneficial because it means less code needs to be written and because it can allow the application to standardize on a single implementation, following the DRY principle.</span></span>

<span data-ttu-id="9c443-139">С помощью многоуровневой архитектуры приложения могут принудительно применять ограничения, на которых слои могут взаимодействовать с другими слоями.</span><span class="sxs-lookup"><span data-stu-id="9c443-139">With a layered architecture, applications can enforce restrictions on which layers can communicate with other layers.</span></span> <span data-ttu-id="9c443-140">Это помогает добиться инкапсуляции.</span><span class="sxs-lookup"><span data-stu-id="9c443-140">This helps to achieve encapsulation.</span></span> <span data-ttu-id="9c443-141">При изменении или заменить слоя, должен влиять только те слои, которые работают с ним.</span><span class="sxs-lookup"><span data-stu-id="9c443-141">When a layer is changed or replaced, only those layers that work with it should be impacted.</span></span> <span data-ttu-id="9c443-142">Ограничивая которой слои, зависят от на которых другие слои, влияние изменений могут быть уменьшены одно изменение влияет всего приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-142">By limiting which layers depend on which other layers, the impact of changes can be mitigated so that a single change doesn't impact the entire application.</span></span>

<span data-ttu-id="9c443-143">Слои (и инкапсуляции) стала намного проще замена функциональных возможностей в приложении.</span><span class="sxs-lookup"><span data-stu-id="9c443-143">Layers (and encapsulation) make it much easier to replace functionality within the application.</span></span> <span data-ttu-id="9c443-144">Например приложение изначально может использовать собственную базу данных SQL Server для постоянного хранения, но позже можно использовать стратегию сохраняемости на основе облака, или один за веб-API.</span><span class="sxs-lookup"><span data-stu-id="9c443-144">For example, an application might initially use its own SQL Server database for persistence, but later could choose to use a cloud-based persistence strategy, or one behind a web API.</span></span> <span data-ttu-id="9c443-145">Если приложение правильно инкапсулированы его реализация сохраняемости в логический слой, конкретного слоя, SQL Server может быть заменен новый реализации один и тот же открытый интерфейс.</span><span class="sxs-lookup"><span data-stu-id="9c443-145">If the application has properly encapsulated its persistence implementation within a logical layer, that SQL Server specific layer could be replaced by a new one implementing the same public interface.</span></span>

<span data-ttu-id="9c443-146">Помимо возможности замены реализаций в ответ на будущие изменения в требования к уровней приложения можно также упростить его выгрузить реализации для целей тестирования.</span><span class="sxs-lookup"><span data-stu-id="9c443-146">In addition to the potential of swapping out implementations in response to future changes in requirements, application layers can also make it easier to swap out implementations for testing purposes.</span></span> <span data-ttu-id="9c443-147">Вместо того, чтобы создать тесты, которые работают с реальными данными уровень или уровень пользовательского интерфейса приложения, эти слои можно заменить во время тестирования фиктивное реализациями, которые предоставляют известных ответы на запросы.</span><span class="sxs-lookup"><span data-stu-id="9c443-147">Instead of having to write tests that operate against the real data layer or UI layer of the application, these layers can be replaced at test time with fake implementations that provide known responses to requests.</span></span> <span data-ttu-id="9c443-148">Обычно в результате тесты намного проще и быстрее для выполнения по сравнению с выполняется повторная проверка реальные инфраструктуры приложений.</span><span class="sxs-lookup"><span data-stu-id="9c443-148">This typically makes tests much easier to write and much faster to run when compared to running tests again the application's real infrastructure.</span></span>

<span data-ttu-id="9c443-149">Логических слоев-это стандартная техника улучшения организации кода в корпоративных приложениях программного обеспечения, и существует несколько способов, в которых код могут быть организованы в слои.</span><span class="sxs-lookup"><span data-stu-id="9c443-149">Logical layering is a common technique for improving the organization of code in enterprise software applications, and there are several ways in which code can be organized into layers.</span></span>

> [!NOTE]
> <span data-ttu-id="9c443-150">*Слои* представляют логическое разделение в приложении.</span><span class="sxs-lookup"><span data-stu-id="9c443-150">*Layers* represent logical separation within the application.</span></span> <span data-ttu-id="9c443-151">В случае, если логику приложения физически распределенным для разделения серверов или процессов, эти целевые объекты отдельное развертывание физических называются *уровни*.</span><span class="sxs-lookup"><span data-stu-id="9c443-151">In the event that application logic is physically distributed to separate servers or processes, these separate physical deployment targets are referred to as *tiers*.</span></span> <span data-ttu-id="9c443-152">Это возможно и довольно часто уровня N приложение развертывается для одного уровня.</span><span class="sxs-lookup"><span data-stu-id="9c443-152">It's possible, and quite common, to have an N-Layer application that is deployed to a single tier.</span></span>

## <a name="traditional-n-layer-architecture-applications"></a><span data-ttu-id="9c443-153">Традиционные приложения архитектуры «N-слоя»</span><span class="sxs-lookup"><span data-stu-id="9c443-153">Traditional "N-Layer" architecture applications</span></span>

<span data-ttu-id="9c443-154">Наиболее распространенные организацию логику приложения в уровнях его показано на рисунке 5-2.</span><span class="sxs-lookup"><span data-stu-id="9c443-154">The most common organization of application logic into layers it shown in Figure 5-2.</span></span>

<span data-ttu-id="9c443-155">**Рис. 5-2.**</span><span class="sxs-lookup"><span data-stu-id="9c443-155">**Figure 5-2.**</span></span> <span data-ttu-id="9c443-156">Типичное приложение слои.</span><span class="sxs-lookup"><span data-stu-id="9c443-156">Typical application layers.</span></span>

![](./media/image5-2.png)

<span data-ttu-id="9c443-157">Часто эти уровни обозначаются как пользовательский Интерфейс, уровень бизнес-ЛОГИКИ (уровень бизнес-логики) и DAL (уровень доступа к данным).</span><span class="sxs-lookup"><span data-stu-id="9c443-157">These layers are frequently abbreviated as UI, BLL (Business Logic Layer), and DAL (Data Access Layer).</span></span> <span data-ttu-id="9c443-158">С помощью этой архитектуры, пользователям выполнять запросы через уровень пользовательского интерфейса, который взаимодействует только с помощью МЕТОДА.</span><span class="sxs-lookup"><span data-stu-id="9c443-158">Using this architecture, users make requests through the UI layer, which interacts only with the BLL.</span></span> <span data-ttu-id="9c443-159">Уровень бизнес-ЛОГИКИ, в свою очередь, может вызывать DAL для запросов доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="9c443-159">The BLL, in turn, can call the DAL for data access requests.</span></span> <span data-ttu-id="9c443-160">Уровень пользовательского интерфейса не следует вносить любые запросы DAL непосредственно, и не должно взаимодействовать с сохраняемости другими способами.</span><span class="sxs-lookup"><span data-stu-id="9c443-160">The UI layer should not make any requests to the DAL directly, nor should it interact with persistence directly through other means.</span></span> <span data-ttu-id="9c443-161">Аналогичным образом уровень бизнес-ЛОГИКИ необходимо взаимодействовать только с сохраняемости через DAL.</span><span class="sxs-lookup"><span data-stu-id="9c443-161">Likewise, the BLL should only interact with persistence by going through the DAL.</span></span> <span data-ttu-id="9c443-162">Таким образом каждый уровень имеет свои собственные хорошо известных ответственности.</span><span class="sxs-lookup"><span data-stu-id="9c443-162">In this way, each layer has its own well-known responsibility.</span></span>

<span data-ttu-id="9c443-163">Недостаток этого подхода традиционных слоев означает, что зависимости времени компиляции работать сверху вниз.</span><span class="sxs-lookup"><span data-stu-id="9c443-163">One disadvantage of this traditional layering approach is that compile-time dependencies run from the top to the bottom.</span></span> <span data-ttu-id="9c443-164">То есть уровень пользовательского интерфейса зависит от МЕТОДА, который зависит от DAL.</span><span class="sxs-lookup"><span data-stu-id="9c443-164">That is, the UI layer depends on the BLL, which depends on the DAL.</span></span> <span data-ttu-id="9c443-165">Это означает, что уровень бизнес-ЛОГИКИ, который обычно содержит наиболее важные логики в приложении, зависимые на сведения о реализации данных access (и часто на существование базы данных).</span><span class="sxs-lookup"><span data-stu-id="9c443-165">This means that the BLL, which usually holds the most important logic in the application, is dependent on data access implementation details (and often on the existence of a database).</span></span> <span data-ttu-id="9c443-166">Тестирование бизнес-логики в такой архитектуры сложно часто, требующие тестовую базу данных.</span><span class="sxs-lookup"><span data-stu-id="9c443-166">Testing business logic in such an architecture is often difficult, requiring a test database.</span></span> <span data-ttu-id="9c443-167">Принципом инверсии зависимостей можно использовать для решения этой проблемы, как будет показано в следующем разделе.</span><span class="sxs-lookup"><span data-stu-id="9c443-167">The dependency inversion principle can be used to address this issue, as you'll see in the next section.</span></span>

<span data-ttu-id="9c443-168">Рис. 5-3 показан пример решения, остановом три проекта приложения ответственности (или уровень).</span><span class="sxs-lookup"><span data-stu-id="9c443-168">Figure 5-3 shows an example solution, breaking the application into three projects by responsibility (or layer).</span></span>

<span data-ttu-id="9c443-169">**Рис.**</span><span class="sxs-lookup"><span data-stu-id="9c443-169">**Figure 5-3.**</span></span> <span data-ttu-id="9c443-170">Простое приложение монолитные с трех проектов.</span><span class="sxs-lookup"><span data-stu-id="9c443-170">A simple monolithic application with three projects.</span></span>

![](./media/image5-3.png)

<span data-ttu-id="9c443-171">Несмотря на то, что в данном приложении используется несколько проектов в организационных целях, он по-прежнему развертывается как единое целое, и его клиенты будут взаимодействовать с ней как одного веб-приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-171">Although this application uses several projects for organizational purposes, it is still deployed as a single unit and its clients will interact with it as a single web app.</span></span> <span data-ttu-id="9c443-172">Это обеспечивает очень простой процесс развертывания.</span><span class="sxs-lookup"><span data-stu-id="9c443-172">This allows for very simple deployment process.</span></span> <span data-ttu-id="9c443-173">Рис. 5-4 показано, как могут быть такие приложения размещенного с помощью Windows Azure.</span><span class="sxs-lookup"><span data-stu-id="9c443-173">Figure 5-4 shows how such an app might be hosted using Windows Azure.</span></span>

![](./media/image5-4.png)

<span data-ttu-id="9c443-174">**Рис.**</span><span class="sxs-lookup"><span data-stu-id="9c443-174">**Figure 5-4.**</span></span> <span data-ttu-id="9c443-175">Простое развертывание веб-приложения Azure</span><span class="sxs-lookup"><span data-stu-id="9c443-175">Simple deployment of Azure Web App</span></span>

<span data-ttu-id="9c443-176">По мере роста приложения может потребоваться более сложным и надежным решений для развертывания.</span><span class="sxs-lookup"><span data-stu-id="9c443-176">As application needs grow, more complex and robust deployment solutions may be required.</span></span> <span data-ttu-id="9c443-177">Рис. 5-5 показан пример более сложные плана развертывания, которая поддерживает дополнительные возможности.</span><span class="sxs-lookup"><span data-stu-id="9c443-177">Figure 5-5 shows an example of a more complex deployment plan that supports additional capabilities.</span></span>

![](./media/image5-5.png)

<span data-ttu-id="9c443-178">**Рис.**</span><span class="sxs-lookup"><span data-stu-id="9c443-178">**Figure 5-5.**</span></span> <span data-ttu-id="9c443-179">Развертывание веб-приложения на службу приложений Azure</span><span class="sxs-lookup"><span data-stu-id="9c443-179">Deploying a web app to an Azure App Service</span></span>

<span data-ttu-id="9c443-180">На внутреннем уровне организации этого проекта на несколько проектов, в зависимости от ответственности повышает удобство поддержки приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-180">Internally, this project's organization into multiple projects based on responsibility improves the maintainability of the application.</span></span>

<span data-ttu-id="9c443-181">Это устройство может масштабироваться вверх или вниз, чтобы воспользоваться преимуществами облачного масштабируемость по запросу.</span><span class="sxs-lookup"><span data-stu-id="9c443-181">This unit can be scaled up or out to take advantage of cloud-based on-demand scalability.</span></span> <span data-ttu-id="9c443-182">Масштабирование вверх означает добавление дополнительных ЦП, памяти, места на диске или других ресурсов для серверов размещения приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-182">Scaling up means adding additional CPU, memory, disk space, or other resources to the server(s) hosting your app.</span></span> <span data-ttu-id="9c443-183">Горизонтальное масштабирование означает добавление дополнительных экземпляров такие серверы ли это физических серверах или виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="9c443-183">Scaling out means adding additional instances of such servers, whether these are physical servers or virtual machines.</span></span> <span data-ttu-id="9c443-184">При размещении приложения на нескольких экземплярах подсистемы балансировки нагрузки используется для назначения запросы для отдельных экземпляров.</span><span class="sxs-lookup"><span data-stu-id="9c443-184">When your app is hosted across multiple instances, a load balancer is used to assign requests to individual app instances.</span></span>

<span data-ttu-id="9c443-185">Самый простой способ масштабирования веб-приложения в Azure — настроить масштабирование вручную в план служб приложений приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-185">The simplest approach to scaling a web application in Azure is to configure scaling manually in the application's App Service Plan.</span></span> <span data-ttu-id="9c443-186">Рис. 5-6 отображение экрана соответствующую панель мониторинга Azure для настройки того, сколько экземпляров обслуживающих приложение.</span><span class="sxs-lookup"><span data-stu-id="9c443-186">Figure 5-6 show the appropriate Azure dashboard screen to configure how many instances are serving an app.</span></span>

![](./media/image5-6.png)

<span data-ttu-id="9c443-187">**Рис. 5-6.**</span><span class="sxs-lookup"><span data-stu-id="9c443-187">**Figure 5-6.**</span></span> <span data-ttu-id="9c443-188">План службы приложений, масштабирование в Azure.</span><span class="sxs-lookup"><span data-stu-id="9c443-188">App Service Plan scaling in Azure.</span></span>

## <a name="clean-architecture"></a><span data-ttu-id="9c443-189">Очистить архитектуры</span><span class="sxs-lookup"><span data-stu-id="9c443-189">Clean architecture</span></span>

<span data-ttu-id="9c443-190">Приложения, с которыми принципом инверсии зависимостей, а также принципы проектирования сей (DDD), как правило, чтобы образовать схожую архитектуру.</span><span class="sxs-lookup"><span data-stu-id="9c443-190">Applications that follow the Dependency Inversion Principle as well as Domain-Driven Design (DDD) principles tend to arrive at a similar architecture.</span></span> <span data-ttu-id="9c443-191">Эта архитектура прошел много имен за несколько лет.</span><span class="sxs-lookup"><span data-stu-id="9c443-191">This architecture has gone by many names over the years.</span></span> <span data-ttu-id="9c443-192">Одно из имен первого был шестиугольник архитектуры, следуют порты адаптеров.</span><span class="sxs-lookup"><span data-stu-id="9c443-192">One of the first names was Hexagonal Architecture, followed by Ports-and-Adapters.</span></span> <span data-ttu-id="9c443-193">Раньше, его является был указан как [архитектура режим](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/) или [чистой архитектура](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html).</span><span class="sxs-lookup"><span data-stu-id="9c443-193">More recently, it's been cited as the [Onion Architecture](http://jeffreypalermo.com/blog/the-onion-architecture-part-1/) or [Clean Architecture](https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html).</span></span> <span data-ttu-id="9c443-194">Это это Фамилия чистой архитектуры, который используется в качестве основы для описания архитектура эта электронная книга.</span><span class="sxs-lookup"><span data-stu-id="9c443-194">It is this last name, Clean Architecture, that is used as the basis for describing the architecture in this e-book.</span></span>

> [!NOTE]
> <span data-ttu-id="9c443-195">Термин чистой архитектура могут быть применены для приложений, построенных с использованием принципов DDD также для тех, которые не были собраны с помощью ддд.</span><span class="sxs-lookup"><span data-stu-id="9c443-195">The term Clean Architecture can be applied to applications that are built using DDD Principles as well as to those that are not built using DDD.</span></span> <span data-ttu-id="9c443-196">В случае первое из них, эта комбинация может называться «Чистая DDD архитектура».</span><span class="sxs-lookup"><span data-stu-id="9c443-196">In the case of the former, this combination may be referred to as "Clean DDD Architecture".</span></span>

<span data-ttu-id="9c443-197">Очистить архитектура помещает бизнес-логики и приложение модели в центральной части приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-197">Clean architecture puts the business logic and application model at the center of the application.</span></span> <span data-ttu-id="9c443-198">Вместо того, бизнес-логики, которые зависят от доступа к данным или других проблем инфраструктуры, инвертировано эту зависимость: сведения инфраструктуры и реализация зависит от основных приложений.</span><span class="sxs-lookup"><span data-stu-id="9c443-198">Instead of having business logic depend on data access or other infrastructure concerns, this dependency is inverted: infrastructure and implementation details depend on the Application Core.</span></span> <span data-ttu-id="9c443-199">Это достигается путем определения абстрактные классы или интерфейсы, в основном приложения, который впоследствии реализуется типов, определенных на уровне инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-199">This is achieved by defining abstractions, or interfaces, in the Application Core, which are then implemented by types defined in the Infrastructure layer.</span></span> <span data-ttu-id="9c443-200">Распространенным способом визуализации этой архитектуры является использование ряда концентрических окружностей аналогично режим.</span><span class="sxs-lookup"><span data-stu-id="9c443-200">A common way of visualizing this architecture is to use a series of concentric circles, similar to an onion.</span></span> <span data-ttu-id="9c443-201">На рисунке 5 X показан пример этого стиля представления архитектуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-201">Figure 5-X shows an example of this style of architectural representation.</span></span>

![](./media/image5-7.png)

<span data-ttu-id="9c443-202">**Рис.**</span><span class="sxs-lookup"><span data-stu-id="9c443-202">**Figure 5-7.**</span></span> <span data-ttu-id="9c443-203">Очистка архитектура; режим представления</span><span class="sxs-lookup"><span data-stu-id="9c443-203">Clean Architecture; onion view</span></span>

<span data-ttu-id="9c443-204">На этой диаграмме зависимостей потока к внутренней окружности.</span><span class="sxs-lookup"><span data-stu-id="9c443-204">In this diagram, dependencies flow toward the innermost circle.</span></span> <span data-ttu-id="9c443-205">Таким образом вы увидите, что основные приложения (который будет использовано имя его положение в основе этой схеме) не имеет зависимостей от других уровней приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-205">Thus, you can see that the Application Core (which takes its name from its position at the core of this diagram) has no dependencies on other application layers.</span></span> <span data-ttu-id="9c443-206">В центре очень являются сущностями приложения и интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9c443-206">At the very center are the application's entities and interfaces.</span></span> <span data-ttu-id="9c443-207">За пределами, но по-прежнему в основном приложении являются доменных служб, которые обычно реализуют интерфейсы, определенные в внутренней окружности.</span><span class="sxs-lookup"><span data-stu-id="9c443-207">Just outside, but still in the Application Core, are domain services, which typically implement interfaces defined in the inner circle.</span></span> <span data-ttu-id="9c443-208">За пределами ядро приложения пользовательского интерфейса и слои инфраструктуры зависят от на основные приложения, но не на друг с другом (обязательно).</span><span class="sxs-lookup"><span data-stu-id="9c443-208">Outside of the Application Core, both the User Interface and the Infrastructure layers depend on the Application Core, but not on one another (necessarily).</span></span>

<span data-ttu-id="9c443-209">5 X рисунке более традиционным схема горизонтальной слоев, которая лучше отражает зависимости между пользовательского интерфейса и на других уровнях.</span><span class="sxs-lookup"><span data-stu-id="9c443-209">Figure 5-X shows a more traditional horizontal layer diagram that better reflects the dependency between the UI and other layers.</span></span>

![](./media/image5-8.png)

<span data-ttu-id="9c443-210">**Рис.**</span><span class="sxs-lookup"><span data-stu-id="9c443-210">**Figure 5-8.**</span></span> <span data-ttu-id="9c443-211">Очистка архитектура; Горизонтальная уровень представления</span><span class="sxs-lookup"><span data-stu-id="9c443-211">Clean Architecture; horizontal layer view</span></span>

<span data-ttu-id="9c443-212">Обратите внимание, что сплошной стрелки обозначают зависимости времени компиляции, пока штриховая стрелка представляет зависимость только для среды выполнения.</span><span class="sxs-lookup"><span data-stu-id="9c443-212">Note that the solid arrows represent compile-time dependencies, while the dashed arrow represents a runtime-only dependency.</span></span> <span data-ttu-id="9c443-213">С помощью чистой архитектуры, уровень пользовательского интерфейса работает с интерфейсы, определенные в основном приложения во время компиляции, и в идеале следует знания типы реализации определен на уровне инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-213">Using the clean architecture, the UI layer works with interfaces defined in the Application Core at compile time, and ideally should not have any knowledge of the implementation types defined in the Infrastructure layer.</span></span> <span data-ttu-id="9c443-214">Во время выполнения Однако эти типы реализации будет необходимые приложению для выполнения, им необходимо будет присутствовать и проводных до приложения базовых интерфейсов через внедрения зависимостей.</span><span class="sxs-lookup"><span data-stu-id="9c443-214">At runtime, however, these implementation types will be required for the app to execute, so they will need to be present and wired up to the Application Core interfaces via dependency injection.</span></span>

<span data-ttu-id="9c443-215">Рис. 5-9 показан более подробное представление архитектуры приложения ASP.NET Core при построении, следуя приведенным ниже рекомендациям.</span><span class="sxs-lookup"><span data-stu-id="9c443-215">Figure 5-9 shows a more detailed view of an ASP.NET Core application's architecture when built following these recommendations.</span></span>

![Базовая архитектура ASPNET](./media/image5-9.png)

<span data-ttu-id="9c443-217">**Рис. 5-9.**</span><span class="sxs-lookup"><span data-stu-id="9c443-217">**Figure 5-9.**</span></span> <span data-ttu-id="9c443-218">Диаграмма архитектуры ASP.NET Core после чистой архитектуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-218">ASP.NET Core architecture diagram following Clean Architecture.</span></span>

<span data-ttu-id="9c443-219">Поскольку ядро приложения не зависит от инфраструктуры, легко создавать автоматических модульных тестов для этого слоя.</span><span class="sxs-lookup"><span data-stu-id="9c443-219">Because the Application Core doesn't depend on Infrastructure, it is very easy to write automated unit tests for this layer.</span></span> <span data-ttu-id="9c443-220">Фигуры 5 – 10 и 5 11 показано, как тесты помещаются в этой архитектуре.</span><span class="sxs-lookup"><span data-stu-id="9c443-220">Figures 5-10 and 5-11 show how tests fit into this architecture.</span></span>

![UnitTestCore](./media/image5-10.png)

<span data-ttu-id="9c443-222">**Рис. 5-10.**</span><span class="sxs-lookup"><span data-stu-id="9c443-222">**Figure 5-10.**</span></span> <span data-ttu-id="9c443-223">Тестирование приложения ядра в изоляции.</span><span class="sxs-lookup"><span data-stu-id="9c443-223">Unit testing Application Core in isolation.</span></span>

![IntegrationTests](./media/image5-11.png)

<span data-ttu-id="9c443-225">**Рис. 5-11.**</span><span class="sxs-lookup"><span data-stu-id="9c443-225">**Figure 5-11.**</span></span> <span data-ttu-id="9c443-226">Интеграция тестирования реализации инфраструктуры с внешними зависимостями.</span><span class="sxs-lookup"><span data-stu-id="9c443-226">Integration testing Infrastructure implementations with external dependencies.</span></span>

<span data-ttu-id="9c443-227">Поскольку уровень пользовательского интерфейса не имеет прямой зависимости в типах, определенных в проекте инфраструктуры, аналогичным образом можно очень легко поменять местами реализаций, либо для тестирования или в ответ на изменения требований приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-227">Since the UI layer doesn't have any direct dependency on types defined in the Infrastructure project, it is likewise very easy to swap out implementations, either to facilitate testing or in response to changing application requirements.</span></span> <span data-ttu-id="9c443-228">Использование встроенных ASP.NET Core и поддержка внедрения зависимостей становится эта архитектура наиболее подходящий способ структуры нетривиальной монолитные приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-228">ASP.NET Core's built-in use of and support for dependency injection makes this architecture the most appropriate way to structure non-trivial monolithic applications.</span></span>

<span data-ttu-id="9c443-229">Для приложений, объединенный проекты основных приложений, инфраструктуры и пользовательский интерфейс запускаются как одно приложение.</span><span class="sxs-lookup"><span data-stu-id="9c443-229">For monolithic applications the Application Core, Infrastructure, and User Interface projects are all run as a single application.</span></span> <span data-ttu-id="9c443-230">Архитектура приложения среды выполнения может выглядеть как на рисунке 5-12.</span><span class="sxs-lookup"><span data-stu-id="9c443-230">The runtime application architecture might look something like Figure 5-12.</span></span>

![Базовая архитектура ASPNET 2](./media/image5-12.png)

<span data-ttu-id="9c443-232">**Рис. 5-12.**</span><span class="sxs-lookup"><span data-stu-id="9c443-232">**Figure 5-12.**</span></span> <span data-ttu-id="9c443-233">Архитектура среды выполнения примера приложения ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="9c443-233">A sample ASP.NET Core app's runtime architecture.</span></span>

### <a name="organizing-code-in-clean-architecture"></a><span data-ttu-id="9c443-234">Организация кода в чистую архитектуры</span><span class="sxs-lookup"><span data-stu-id="9c443-234">Organizing Code in Clean Architecture</span></span>

<span data-ttu-id="9c443-235">В решении чистой архитектура каждый проект имеет очистить обязанности.</span><span class="sxs-lookup"><span data-stu-id="9c443-235">In a Clean Architecture solution, each project has clear responsibilities.</span></span> <span data-ttu-id="9c443-236">Таким образом будет принадлежать определенных типов в каждом проекте, и вы найдете часто папки соответствующие для таких типов в соответствующий проект.</span><span class="sxs-lookup"><span data-stu-id="9c443-236">As such, certain types will belong in each project and you'll frequently find folders corresponding to these types in the appropriate project.</span></span>

<span data-ttu-id="9c443-237">Основные приложения содержит бизнес-модели, которое содержит сущности, служб и интерфейсов.</span><span class="sxs-lookup"><span data-stu-id="9c443-237">The Application Core holds the business model, which includes entities, services, and interfaces.</span></span> <span data-ttu-id="9c443-238">Среди этих интерфейсов: абстракции для операций, которые будут выполняться с помощью инфраструктуры, такие как доступ к данным, доступ к файловой системе, сетевых вызовов, и т. д. Иногда служб или интерфейсы, определенные на этом уровне нужно для работы с несущностные типы, которые не имеют зависимостей на пользовательский Интерфейс или инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-238">These interfaces include abstractions for operations that will be performed using Infrastructure, such as data access, file system access, network calls, etc. Sometimes services or interfaces defined at this layer will need to work with non-entity types that have no dependencies on UI or Infrastructure.</span></span> <span data-ttu-id="9c443-239">Они могут определяться как простые объекты передачи данных (DTO).</span><span class="sxs-lookup"><span data-stu-id="9c443-239">These can be defined as simple Data Transfer Objects (DTOs).</span></span>

> ### <a name="application-core-types"></a><span data-ttu-id="9c443-240">Типы основных приложений</span><span class="sxs-lookup"><span data-stu-id="9c443-240">Application Core Types</span></span>
> -   <span data-ttu-id="9c443-241">Сущности (business классов модели, которые сохраняются)</span><span class="sxs-lookup"><span data-stu-id="9c443-241">Entities (business model classes that are persisted)</span></span>
> -   <span data-ttu-id="9c443-242">Интерфейсы</span><span class="sxs-lookup"><span data-stu-id="9c443-242">Interfaces</span></span>
> -   <span data-ttu-id="9c443-243">Службы</span><span class="sxs-lookup"><span data-stu-id="9c443-243">Services</span></span>
> -   <span data-ttu-id="9c443-244">Спроектируйте</span><span class="sxs-lookup"><span data-stu-id="9c443-244">DTOs</span></span>

<span data-ttu-id="9c443-245">Как правило, проект инфраструктуры включает данные удаленного доступа.</span><span class="sxs-lookup"><span data-stu-id="9c443-245">The Infrastructure project will typically include data access implementations.</span></span> <span data-ttu-id="9c443-246">В типичных веб-приложений ASP.NET Core Сюда входят класс DbContext Entity Framework, любой миграции Core EF, были определены и классов для реализации доступа к данным.</span><span class="sxs-lookup"><span data-stu-id="9c443-246">In a typical ASP.NET Core web application, this will include the Entity Framework DbContext, any EF Core Migrations that have been defined, and data access implementation classes.</span></span> <span data-ttu-id="9c443-247">Является наиболее распространенным способом абстрагировать код реализации для доступа к данным, использования [шаблон репозитория](http://deviq.com/repository-pattern/).</span><span class="sxs-lookup"><span data-stu-id="9c443-247">The most common way to abstract data access implementation code is through the use of the [Repository design pattern](http://deviq.com/repository-pattern/).</span></span>

<span data-ttu-id="9c443-248">Помимо данных удаленного доступа инфраструктура проект должен содержать реализации службы, которые должны взаимодействовать с вопросами инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-248">In addition to data access implementations, the Infrastructure project should contain implementations of services that must interact with infrastructure concerns.</span></span> <span data-ttu-id="9c443-249">Эти службы должны реализовывать интерфейсы, определенные в основном приложения и поэтому инфраструктура должна иметь ссылку на проект основных приложений.</span><span class="sxs-lookup"><span data-stu-id="9c443-249">These services should implement interfaces defined in the Application Core, and so Infrastructure should have a reference to the Application Core project.</span></span>

> ### <a name="infrastructure-types"></a><span data-ttu-id="9c443-250">Типы инфраструктуры</span><span class="sxs-lookup"><span data-stu-id="9c443-250">Infrastructure Types</span></span>
> -   <span data-ttu-id="9c443-251">Базовые типы EF (DbContext, миграция)</span><span class="sxs-lookup"><span data-stu-id="9c443-251">EF Core types (DbContext, Migrations)</span></span>
> -   <span data-ttu-id="9c443-252">Реализация типов доступа к данным (репозиториев)</span><span class="sxs-lookup"><span data-stu-id="9c443-252">Data access implementation types (Repositories)</span></span>
> -   <span data-ttu-id="9c443-253">Зависящие от инфраструктуры службы (FileLogger, SmtpNotifier, и т. д.)</span><span class="sxs-lookup"><span data-stu-id="9c443-253">Infrastructure-specific services (FileLogger, SmtpNotifier, etc.)</span></span>

<span data-ttu-id="9c443-254">Уровень пользовательского интерфейса в приложении ASP.NET Core MVC будет точкой входа для приложения и будут проекта ASP.NET Core MVC.</span><span class="sxs-lookup"><span data-stu-id="9c443-254">The user interface layer in an ASP.NET Core MVC application will be the entry point for the application, and will be an ASP.NET Core MVC project.</span></span> <span data-ttu-id="9c443-255">Этот проект должен ссылаться на проект основных компонентов приложения и его типы должны взаимодействовать с инфраструктурой исключительно через интерфейсы, определенные в основных приложений.</span><span class="sxs-lookup"><span data-stu-id="9c443-255">This project should reference the Application Core project, and its types should interact with infrastructure strictly through interfaces defined in Application Core.</span></span> <span data-ttu-id="9c443-256">Нет прямого создания экземпляра (или статические вызовы) типы инфраструктуры слой должен быть разрешен в уровень пользовательского интерфейса.</span><span class="sxs-lookup"><span data-stu-id="9c443-256">No direct instantiation of (or static calls to) Infrastructure layer types should be permitted in the UI layer.</span></span>

> ### <a name="ui-layer-types"></a><span data-ttu-id="9c443-257">Типы пользовательского интерфейса слоя</span><span class="sxs-lookup"><span data-stu-id="9c443-257">UI Layer Types</span></span>
> -   <span data-ttu-id="9c443-258">Контроллеры</span><span class="sxs-lookup"><span data-stu-id="9c443-258">Controllers</span></span>
> -   <span data-ttu-id="9c443-259">Фильтры</span><span class="sxs-lookup"><span data-stu-id="9c443-259">Filters</span></span>
> -   <span data-ttu-id="9c443-260">Представления</span><span class="sxs-lookup"><span data-stu-id="9c443-260">Views</span></span>
> -   <span data-ttu-id="9c443-261">ViewModels</span><span class="sxs-lookup"><span data-stu-id="9c443-261">ViewModels</span></span>
> -   <span data-ttu-id="9c443-262">Запуск</span><span class="sxs-lookup"><span data-stu-id="9c443-262">Startup</span></span>

<span data-ttu-id="9c443-263">Класс Startup отвечает для настройки приложения и типы реализации подключение к интерфейсам, позволяя внедрения зависимостей для правильной работы во время выполнения.</span><span class="sxs-lookup"><span data-stu-id="9c443-263">The Startup class is responsible for configuring the application, and for wiring up implementation types to interfaces, allowing dependency injection to work properly at run time.</span></span>

> [!NOTE]
> <span data-ttu-id="9c443-264">Чтобы подключить внедрение зависимостей в ConfigureServices в файле Startup.cs файле проекта пользовательского интерфейса, проект может потребоваться ссылки на проект инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-264">In order to wire up dependency injection in ConfigureServices in the Startup.cs file of the UI project, the project may need to reference the Infrastructure project.</span></span> <span data-ttu-id="9c443-265">Эту зависимость можно устранить, проще всего с помощью настраиваемого DI контейнера.</span><span class="sxs-lookup"><span data-stu-id="9c443-265">This dependency can be eliminated, most easily by using a custom DI container.</span></span> <span data-ttu-id="9c443-266">Для целей этого образца самым простым подходом является предоставление проекта пользовательского интерфейса для ссылки на проект инфраструктуры.</span><span class="sxs-lookup"><span data-stu-id="9c443-266">For the purposes of this sample, the simplest approach is to allow the UI project to reference the Infrastructure project.</span></span>

## <a name="monolithic-applications-and-containers"></a><span data-ttu-id="9c443-267">Монолитные приложения и контейнеров</span><span class="sxs-lookup"><span data-stu-id="9c443-267">Monolithic Applications and Containers</span></span> 

<span data-ttu-id="9c443-268">Можно построить одно- и монолитные развертывания на основе веб-приложения или службы и развернуть его как контейнер.</span><span class="sxs-lookup"><span data-stu-id="9c443-268">You can build a single and monolithic-deployment based Web Application or Service and deploy it as a container.</span></span> <span data-ttu-id="9c443-269">В приложении может оказаться монолитные но организованных в несколько библиотек, компонентов или уровней.</span><span class="sxs-lookup"><span data-stu-id="9c443-269">Within the application, it might not be monolithic but organized into several libraries, components or layers.</span></span> <span data-ttu-id="9c443-270">Внешне это одного контейнера как единый процесс, одного веб-приложения или одной службы.</span><span class="sxs-lookup"><span data-stu-id="9c443-270">Externally it is a single container like a single process, single web application or single service.</span></span>

<span data-ttu-id="9c443-271">Для управления этой модели, развернуть один контейнер для представления приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-271">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="9c443-272">Чтобы масштабировать, просто добавьте дополнительные копии с балансировкой нагрузки на переднем плане.</span><span class="sxs-lookup"><span data-stu-id="9c443-272">To scale, just add additional copies with a load balancer in front.</span></span> <span data-ttu-id="9c443-273">Простота поступает из управления одно развертывание в одном контейнере или виртуальной Машины.</span><span class="sxs-lookup"><span data-stu-id="9c443-273">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![](./media/image5-13.png)

<span data-ttu-id="9c443-274">Как показано на рисунке 5 X могут включать несколько компонентов и библиотек или внутренней уровней в каждом контейнере.</span><span class="sxs-lookup"><span data-stu-id="9c443-274">You can include multiple components/libraries or internal layers within each container, as illustrated in Figure 5-X.</span></span> <span data-ttu-id="9c443-275">Но, следуя участника контейнера *» выполняет один контейнер и делает это в одном процессе*», монолитные шаблон может возникнуть конфликт.</span><span class="sxs-lookup"><span data-stu-id="9c443-275">But, following the container principal of *"a container does one thing, and does it in one process*", the monolithic pattern might be a conflict.</span></span>

<span data-ttu-id="9c443-276">Недостаток этого подхода поставляется при роста приложения, требующие масштабирование.</span><span class="sxs-lookup"><span data-stu-id="9c443-276">The downside of this approach comes if/when the application grows, requiring it to scale.</span></span> <span data-ttu-id="9c443-277">Если масштабировать приложение в целом, это не действительно проблемы.</span><span class="sxs-lookup"><span data-stu-id="9c443-277">If the entire application scaled, it's not really a problem.</span></span> <span data-ttu-id="9c443-278">Однако в большинстве случаев несколько частей приложения являются стягиванием точки, требующие масштабирование, пока другие компоненты находятся в используется реже.</span><span class="sxs-lookup"><span data-stu-id="9c443-278">However, in most cases, a few parts of the application are the choke points requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="9c443-279">Используя пример типичных электронной коммерции; что вы скорее всего, потребуется выполнить масштабирование — это компонент сведения продукта.</span><span class="sxs-lookup"><span data-stu-id="9c443-279">Using the typical eCommerce example; what you likely need to scale is the product information component.</span></span> <span data-ttu-id="9c443-280">Многие Дополнительные клиенты просматривать продукты, чем их приобретение.</span><span class="sxs-lookup"><span data-stu-id="9c443-280">Many more customers browse products than purchase them.</span></span> <span data-ttu-id="9c443-281">Дополнительные клиенты использовать свою корзину не использовать конвейер оплаты.</span><span class="sxs-lookup"><span data-stu-id="9c443-281">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="9c443-282">Меньшее количество клиентов, добавить комментарии или Просмотр истории покупок.</span><span class="sxs-lookup"><span data-stu-id="9c443-282">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="9c443-283">И вы скорее всего лишь небольшое число сотрудников в одной области, необходимые для управления содержимым и маркетинговых кампаний.</span><span class="sxs-lookup"><span data-stu-id="9c443-283">And you likely only have a handful of employees, in a single region, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="9c443-284">По масштабирование монолитные конструкции, весь код разворачивается несколько раз.</span><span class="sxs-lookup"><span data-stu-id="9c443-284">By scaling the monolithic design, all the code is deployed multiple times.</span></span>

<span data-ttu-id="9c443-285">Помимо шкалы проблем, все изменения к одному компоненту требуется полное повторное тестирование всего приложения и завершить повторное развертывание всех экземпляров.</span><span class="sxs-lookup"><span data-stu-id="9c443-285">In addition to the scale everything problem, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="9c443-286">Объединенный подход часто, и во многих организациях разрабатываемом с помощью этого архитектурный подход.</span><span class="sxs-lookup"><span data-stu-id="9c443-286">The monolithic approach is common, and many organizations are developing with this architectural approach.</span></span> <span data-ttu-id="9c443-287">Многие возникают блага достаточное количество результатов, пока другие, достигнуты ограничения.</span><span class="sxs-lookup"><span data-stu-id="9c443-287">Many are having good enough results, while others are hitting limits.</span></span> <span data-ttu-id="9c443-288">Многие предназначены свои приложения в этой модели, так как средства и инфраструктура были слишком трудно реализовать ориентированные на службы архитектуры (SOA), и он не увидит необходимость -, пока его размер увеличивается.</span><span class="sxs-lookup"><span data-stu-id="9c443-288">Many designed their applications in this model, because the tools and infrastructure were too difficult to build service oriented architectures (SOA), and they didn't see the need - until the app grew.</span></span> <span data-ttu-id="9c443-289">Если обнаружится, что встретились ограничения монолитные подхода, разделить приложения, чтобы он мог лучше использовать контейнеры и микрослужбами может быть следующим логическим шагом.</span><span class="sxs-lookup"><span data-stu-id="9c443-289">If you find you're hitting the limits of the monolithic approach, breaking the app up to enable it to better leverage containers and microservices may be the next logical step.</span></span>

![](./media/image5-14.png)

<span data-ttu-id="9c443-290">Развертывание монолитные приложений в Microsoft Azure может осуществляться с помощью выделенных виртуальных машин для каждого экземпляра.</span><span class="sxs-lookup"><span data-stu-id="9c443-290">Deploying monolithic applications in Microsoft Azure can be achieved using dedicated VMs for each instance.</span></span> <span data-ttu-id="9c443-291">С помощью [набора масштабирования виртуальных Машин Azure](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), можно легко масштабировать виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="9c443-291">Using [Azure VM Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="9c443-292">[Службы приложений Azure](https://azure.microsoft.com/services/app-service/) можно запускать монолитные приложения и легко масштабировать экземпляры без необходимости управления виртуальными машинами.</span><span class="sxs-lookup"><span data-stu-id="9c443-292">[Azure App Services](https://azure.microsoft.com/services/app-service/) can run monolithic applications and easily scale instances without having to manage the VMs.</span></span> <span data-ttu-id="9c443-293">Службы приложений Azure можно запустить отдельные экземпляры контейнеры Docker, а также упрощения развертывания.</span><span class="sxs-lookup"><span data-stu-id="9c443-293">Azure App Services can run single instances of Docker containers as well, simplifying the deployment.</span></span> <span data-ttu-id="9c443-294">С помощью Docker, можно развернуть узел Docker одной виртуальной Машины и запустить несколько экземпляров.</span><span class="sxs-lookup"><span data-stu-id="9c443-294">Using Docker, you can deploy a single VM as a Docker host, and run multiple instances.</span></span> <span data-ttu-id="9c443-295">С помощью балансировки Azure, как показано в на рисунке 5-14, вы можете управлять масштабирования.</span><span class="sxs-lookup"><span data-stu-id="9c443-295">Using the Azure balancer, as shown in the Figure 5-14, you can manage scaling.</span></span>

<span data-ttu-id="9c443-296">Развертывание на различных узлах осуществляется с помощью традиционные методы.</span><span class="sxs-lookup"><span data-stu-id="9c443-296">The deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="9c443-297">Узлах Docker можно управлять с помощью команды **запуска docker** выполнить вручную или с помощью автоматизации, такие как конвейеров непрерывной поставки (CD).</span><span class="sxs-lookup"><span data-stu-id="9c443-297">The Docker hosts can be managed with commands like **docker run** performed manually, or through automation such as Continuous Delivery (CD) pipelines.</span></span>

### <a name="monolithic-application-deployed-as-a-container"></a><span data-ttu-id="9c443-298">Монолитные приложения, развернуть как контейнер</span><span class="sxs-lookup"><span data-stu-id="9c443-298">Monolithic application deployed as a container</span></span>

<span data-ttu-id="9c443-299">Имеется ряд преимуществ использования контейнеров для управления развертываниями монолитные приложения.</span><span class="sxs-lookup"><span data-stu-id="9c443-299">There are benefits of using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="9c443-300">Масштабирование экземпляров контейнеров гораздо быстрее и проще, чем развертывание дополнительных виртуальных машин.</span><span class="sxs-lookup"><span data-stu-id="9c443-300">Scaling the instances of containers is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="9c443-301">Даже при использовании набора масштабирования виртуальных Машин для масштабирования виртуальных машин, они принимают время к экземпляру.</span><span class="sxs-lookup"><span data-stu-id="9c443-301">Even when using VM Scale Sets to scale VMs, they take time to instance.</span></span> <span data-ttu-id="9c443-302">При развертывании в качестве экземпляров приложения, конфигурацию приложения осуществляется в рамках виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="9c443-302">When deployed as app instances, the configuration of the app is managed as part of the VM.</span></span>

<span data-ttu-id="9c443-303">Развертывание обновлений, как образы Docker гораздо быстрее и эффективно сети.</span><span class="sxs-lookup"><span data-stu-id="9c443-303">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="9c443-304">Образы docker, как правило, начинается в секундах, что позволяет ускорить процесс развертывания.</span><span class="sxs-lookup"><span data-stu-id="9c443-304">Docker Images typically start in seconds, speeding rollouts.</span></span> <span data-ttu-id="9c443-305">То закрытие экземпляра Docker можно так же легко, как выдача **docker stop** команду, обычно Завершение менее чем за секунду.</span><span class="sxs-lookup"><span data-stu-id="9c443-305">Tearing down a Docker instance is as easy as issuing a **docker stop** command, typically completing in less than a second.</span></span>

<span data-ttu-id="9c443-306">Как контейнеры являются по своей природе неизменяемыми намеренно, вам никогда не потребуется беспокоиться о поврежденных виртуальных машин, а может забыть сценарии обновления с учетом некоторых определенной конфигурации или влево файла на диске.</span><span class="sxs-lookup"><span data-stu-id="9c443-306">As containers are inherently immutable by design, you never need to worry about corrupted VMs, whereas update scripts might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="9c443-307">Монолитные приложения могут использовать преимущества Docker, разделить монолитные приложения в sub системы, которые можно масштабировать, разработки и развертывания по отдельности может выполняться в точку входа в область микрослужбами.</span><span class="sxs-lookup"><span data-stu-id="9c443-307">While monolithic apps can benefit from Docker, breaking up the monolithic application into sub systems which can be scaled, developed and deployed individually may be your entry point into the realm of microservices.</span></span>

> ### <a name="references--common-web-architectures"></a><span data-ttu-id="9c443-308">Ссылки — общих архитектур Web</span><span class="sxs-lookup"><span data-stu-id="9c443-308">References – Common Web Architectures</span></span>
> - <span data-ttu-id="9c443-309">**Очистить архитектуры**</span><span class="sxs-lookup"><span data-stu-id="9c443-309">**The Clean Architecture**</span></span>  
> <span data-ttu-id="9c443-310"><https://8thlight.com/blog/uncle-Bob/2012/08/13/the-Clean-Architecture.HTML></span><span class="sxs-lookup"><span data-stu-id="9c443-310"><https://8thlight.com/blog/uncle-bob/2012/08/13/the-clean-architecture.html></span></span>
> - <span data-ttu-id="9c443-311">**Архитектура режим**</span><span class="sxs-lookup"><span data-stu-id="9c443-311">**The Onion Architecture**</span></span>  
> <span data-ttu-id="9c443-312"><http://jeffreypalermo.com/blog/the-Onion-Architecture-Part-1/></span><span class="sxs-lookup"><span data-stu-id="9c443-312"><http://jeffreypalermo.com/blog/the-onion-architecture-part-1/></span></span>
> - <span data-ttu-id="9c443-313">**Шаблон репозитория**</span><span class="sxs-lookup"><span data-stu-id="9c443-313">**The Repository Pattern**</span></span>  
> <span data-ttu-id="9c443-314"><http://deviq.com/Repository-pattern/></span><span class="sxs-lookup"><span data-stu-id="9c443-314"><http://deviq.com/repository-pattern/></span></span>
> - <span data-ttu-id="9c443-315">**Образец чистой архитектура решения**</span><span class="sxs-lookup"><span data-stu-id="9c443-315">**Clean Architecture Solution Sample**</span></span>  
> <span data-ttu-id="9c443-316"><https://github.com/ardalis/cleanarchitecture></span><span class="sxs-lookup"><span data-stu-id="9c443-316"><https://github.com/ardalis/cleanarchitecture></span></span>
> - <span data-ttu-id="9c443-317">**Проектирование архитектуры электронная книга Микрослужбами** <http://aka.ms/MicroservicesEbook></span><span class="sxs-lookup"><span data-stu-id="9c443-317">**Architecting Microservices e-book** <http://aka.ms/MicroservicesEbook></span></span>

>[!div class="step-by-step"]
<span data-ttu-id="9c443-318">[Предыдущие] (архитектуры principles.md) [Далее] (общий клиент стороны web-technologies.md)</span><span class="sxs-lookup"><span data-stu-id="9c443-318">[Previous] (architectural-principles.md) [Next] (common-client-side-web-technologies.md)</span></span>
