---
title: Состояния управляемых потоков
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- threading [.NET Framework], states
ms.assetid: 63890d5e-6025-4a7c-aaf0-d8bfd54b455f
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: cbf7db4d9369eade62767e55035df4118d5248ed
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/23/2019
ms.locfileid: "54646650"
---
# <a name="managed-thread-states"></a><span data-ttu-id="caa31-102">Состояния управляемых потоков</span><span class="sxs-lookup"><span data-stu-id="caa31-102">Managed Thread States</span></span>
<span data-ttu-id="caa31-103">Свойство <xref:System.Threading.Thread.ThreadState%2A?displayProperty=nameWithType> предоставляет битовую маску, которая указывает текущее состояние потока.</span><span class="sxs-lookup"><span data-stu-id="caa31-103">The property <xref:System.Threading.Thread.ThreadState%2A?displayProperty=nameWithType> provides a bit mask that indicates the thread's current state.</span></span> <span data-ttu-id="caa31-104">Поток постоянно находится по крайней мере в одном из возможных состояний, указанных в перечислении <xref:System.Threading.ThreadState> , и может иметь несколько состояний одновременно.</span><span class="sxs-lookup"><span data-stu-id="caa31-104">A thread is always in at least one of the possible states in the <xref:System.Threading.ThreadState> enumeration, and can be in multiple states at the same time.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="caa31-105">Состояние потока используется только в некоторых сценариях отладки.</span><span class="sxs-lookup"><span data-stu-id="caa31-105">Thread state is only of interest in a few debugging scenarios.</span></span> <span data-ttu-id="caa31-106">Не используйте в коде состояния потоков для синхронизации действий потоков.</span><span class="sxs-lookup"><span data-stu-id="caa31-106">Your code should never use thread state to synchronize the activities of threads.</span></span>  
  
 <span data-ttu-id="caa31-107">При создании управляемого потока он находится в состоянии <xref:System.Threading.ThreadState.Unstarted> .</span><span class="sxs-lookup"><span data-stu-id="caa31-107">When you create a managed thread, it is in the <xref:System.Threading.ThreadState.Unstarted> state.</span></span> <span data-ttu-id="caa31-108">Поток остается в состоянии <xref:System.Threading.ThreadState.Unstarted> , пока не будет переведен в состояние запуска операционной системой.</span><span class="sxs-lookup"><span data-stu-id="caa31-108">The thread remains in the <xref:System.Threading.ThreadState.Unstarted> state until it is moved into the started state by the operating system.</span></span> <span data-ttu-id="caa31-109">Вызов метода <xref:System.Threading.Thread.Start%2A> служит для того, чтобы сообщить системе, что поток можно запустить. При этом состояние потока не меняется.</span><span class="sxs-lookup"><span data-stu-id="caa31-109">Calling <xref:System.Threading.Thread.Start%2A> lets the operating system know that the thread can be started; it does not change the state of the thread.</span></span>  
  
 <span data-ttu-id="caa31-110">Неуправляемые потоки, которые входят в управляемую среду, уже запущены.</span><span class="sxs-lookup"><span data-stu-id="caa31-110">Unmanaged threads that enter the managed environment are already in the started state.</span></span> <span data-ttu-id="caa31-111">После запуска потока его состояние можно изменить, совершив с ним определенные действия.</span><span class="sxs-lookup"><span data-stu-id="caa31-111">Once a thread is in the started state, a number of actions can cause it to change states.</span></span> <span data-ttu-id="caa31-112">В приведенной ниже таблице представлены действия, изменяющие состояние потока, а также его новые состояния.</span><span class="sxs-lookup"><span data-stu-id="caa31-112">The following table lists the actions that cause a change of state, along with the corresponding new state.</span></span>  
  
|<span data-ttu-id="caa31-113">Действие</span><span class="sxs-lookup"><span data-stu-id="caa31-113">Action</span></span>|<span data-ttu-id="caa31-114">Новое состояние</span><span class="sxs-lookup"><span data-stu-id="caa31-114">Resulting new state</span></span>|  
|------------|-------------------------|  
|<span data-ttu-id="caa31-115">Вызывается конструктор класса <xref:System.Threading.Thread> .</span><span class="sxs-lookup"><span data-stu-id="caa31-115">The constructor for the <xref:System.Threading.Thread> class is called.</span></span>|<xref:System.Threading.ThreadState.Unstarted>|  
|<span data-ttu-id="caa31-116">Другой поток вызывает метод <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-116">Another thread calls <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType>.</span></span>|<xref:System.Threading.ThreadState.Unstarted>|  
|<span data-ttu-id="caa31-117">Поток отвечает на <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> и начинает выполняться.</span><span class="sxs-lookup"><span data-stu-id="caa31-117">The thread responds to <xref:System.Threading.Thread.Start%2A?displayProperty=nameWithType> and starts running.</span></span>|<xref:System.Threading.ThreadState.Running>|  
|<span data-ttu-id="caa31-118">Поток вызывает <xref:System.Threading.Thread.Sleep%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-118">The thread calls <xref:System.Threading.Thread.Sleep%2A?displayProperty=nameWithType>.</span></span>|<xref:System.Threading.ThreadState.WaitSleepJoin>|  
|<span data-ttu-id="caa31-119">Поток вызывает <xref:System.Threading.Monitor.Wait%2A?displayProperty=nameWithType> другого объекта.</span><span class="sxs-lookup"><span data-stu-id="caa31-119">The thread calls <xref:System.Threading.Monitor.Wait%2A?displayProperty=nameWithType> on another object.</span></span>|<xref:System.Threading.ThreadState.WaitSleepJoin>|  
|<span data-ttu-id="caa31-120">Поток вызывает <xref:System.Threading.Thread.Join%2A?displayProperty=nameWithType> другого потока.</span><span class="sxs-lookup"><span data-stu-id="caa31-120">The thread calls <xref:System.Threading.Thread.Join%2A?displayProperty=nameWithType> on another thread.</span></span>|<xref:System.Threading.ThreadState.WaitSleepJoin>|  
|<span data-ttu-id="caa31-121">Другой поток вызывает <xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-121">Another thread calls <xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType>.</span></span>|<xref:System.Threading.ThreadState.SuspendRequested>|  
|<span data-ttu-id="caa31-122">Поток отвечает на запрос <xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-122">The thread responds to a <xref:System.Threading.Thread.Suspend%2A?displayProperty=nameWithType> request.</span></span>|<xref:System.Threading.ThreadState.Suspended>|  
|<span data-ttu-id="caa31-123">Другой поток вызывает <xref:System.Threading.Thread.Resume%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-123">Another thread calls <xref:System.Threading.Thread.Resume%2A?displayProperty=nameWithType>.</span></span>|<xref:System.Threading.ThreadState.Running>|  
|<span data-ttu-id="caa31-124">Другой поток вызывает <xref:System.Threading.Thread.Abort%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-124">Another thread calls <xref:System.Threading.Thread.Abort%2A?displayProperty=nameWithType>.</span></span>|<xref:System.Threading.ThreadState.AbortRequested>|  
|<span data-ttu-id="caa31-125">Поток отвечает на <xref:System.Threading.Thread.Abort%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="caa31-125">The thread responds to an <xref:System.Threading.Thread.Abort%2A?displayProperty=nameWithType>.</span></span>|<span data-ttu-id="caa31-126"><xref:System.Threading.ThreadState.Aborted>, а затем <xref:System.Threading.ThreadState.Stopped></span><span class="sxs-lookup"><span data-stu-id="caa31-126"><xref:System.Threading.ThreadState.Aborted>, then <xref:System.Threading.ThreadState.Stopped></span></span>|  
  
 <span data-ttu-id="caa31-127">Так как состоянию <xref:System.Threading.ThreadState.Running> соответствует значение 0, для определения этого состояния невозможно применить побитовую проверку.</span><span class="sxs-lookup"><span data-stu-id="caa31-127">Because the <xref:System.Threading.ThreadState.Running> state has a value of 0, it is not possible to perform a bit test to discover this state.</span></span> <span data-ttu-id="caa31-128">Вместо этого можно использовать следующий тест (на псевдокоде):</span><span class="sxs-lookup"><span data-stu-id="caa31-128">Instead, the following test (in pseudo-code) can be used:</span></span>  
  
```  
if ((state & (Unstarted | Stopped)) == 0)   // implies Running     
```  
  
 <span data-ttu-id="caa31-129">Как правило, поток одновременно имеет более одного состояния.</span><span class="sxs-lookup"><span data-stu-id="caa31-129">Threads are often in more than one state at any given time.</span></span> <span data-ttu-id="caa31-130">Например, если поток заблокируется при вызове <xref:System.Threading.Monitor.Wait%2A?displayProperty=nameWithType> и другой поток вызывает метод <xref:System.Threading.Thread.Abort%2A> того же потока, этот поток будет находиться в состояниях <xref:System.Threading.ThreadState.WaitSleepJoin> и <xref:System.Threading.ThreadState.AbortRequested> одновременно.</span><span class="sxs-lookup"><span data-stu-id="caa31-130">For example, if a thread is blocked on a <xref:System.Threading.Monitor.Wait%2A?displayProperty=nameWithType> call and another thread calls <xref:System.Threading.Thread.Abort%2A> on that same thread, the thread will be in both the <xref:System.Threading.ThreadState.WaitSleepJoin> and the <xref:System.Threading.ThreadState.AbortRequested> states at the same time.</span></span> <span data-ttu-id="caa31-131">В этом случае, как только поток выполнит возврат из метода <xref:System.Threading.Monitor.Wait%2A> или его работа будет прервана, он получит исключение <xref:System.Threading.ThreadAbortException>.</span><span class="sxs-lookup"><span data-stu-id="caa31-131">In that case, as soon as the thread returns from the call to <xref:System.Threading.Monitor.Wait%2A> or is interrupted, it will receive the <xref:System.Threading.ThreadAbortException>.</span></span>  
  
 <span data-ttu-id="caa31-132">Если поток был выведен из состояния <xref:System.Threading.ThreadState.Unstarted> в результате вызова метода <xref:System.Threading.Thread.Start%2A>, он не может вернуться в состояние <xref:System.Threading.ThreadState.Unstarted> ни при каких условиях.</span><span class="sxs-lookup"><span data-stu-id="caa31-132">Once a thread leaves the <xref:System.Threading.ThreadState.Unstarted> state as the result of a call to <xref:System.Threading.Thread.Start%2A>, it can never return to the <xref:System.Threading.ThreadState.Unstarted> state.</span></span> <span data-ttu-id="caa31-133">Поток никогда не может выйти из состояния <xref:System.Threading.ThreadState.Stopped> .</span><span class="sxs-lookup"><span data-stu-id="caa31-133">A thread can never leave the <xref:System.Threading.ThreadState.Stopped> state.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="caa31-134">См. также</span><span class="sxs-lookup"><span data-stu-id="caa31-134">See also</span></span>

- <xref:System.Threading.ThreadAbortException>
- <xref:System.Threading.Thread>
- <xref:System.Threading.ThreadState>
- [<span data-ttu-id="caa31-135">Работа с потоками</span><span class="sxs-lookup"><span data-stu-id="caa31-135">Threading</span></span>](../../../docs/standard/threading/index.md)
