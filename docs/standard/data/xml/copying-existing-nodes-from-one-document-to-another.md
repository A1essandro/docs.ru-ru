---
title: "Копирование существующих узлов из одного документа в другой"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: "4"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: 0f20e5bd595c8eb49360e58f281a8cf6eda89acf
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/18/2017
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a>Копирование существующих узлов из одного документа в другой
**ImportNode** метод — это механизм, с помощью которого узел или целое поддерево узлов копируется из одного **XmlDocument** в другой. Узел, возвращенный после вызова, является копией узла из исходного документа, включая значения атрибутов, имя узла, тип узла и все атрибуты, связанные с пространством имен, такие как префикс, локальное имя и URI пространства имен. Исходный документ не изменяется. После импорта узла его необходимо добавить к дереву с помощью одного из методов, используемых для вставки узлов.  
  
 При присоединении узла к новому документу, узел принадлежит этому документу. Причина в том, что каждый узел при создании принадлежит какому-нибудь документу, даже если узлы создаются в разных фрагментах документа. Это требование модель объектов XML документа (DOM) и обеспечивается структурой создания фабрики на **XmlDocument** класса. Например **CreateElement**, это единственный способ создания новых узлов.  
  
 В зависимости от типа импортированного узла и значения *глубокой* параметр дополнительной информацией копируется соответствующим образом. Этот метод пытается зеркально воспроизвести поведение, ожидаемое, если фрагмент исходного XML или HTML копируется из одного документа в другой, с учетом того факта, касающегося XML, что два документа могут иметь различные определения типа документа (DTD).  
  
 В следующей таблице описаны особенности поведения каждого типа узла, который может быть импортирован.  
  
|Тип узла|*глубокие* параметр имеет значение true|*глубокие* параметр имеет значение false|  
|---------------|------------------------------|-------------------------------|  
|XmlAttribute|<xref:System.Xml.XmlAttribute.Specified%2A> Равно **true** на XmlAttribute. Потомки исходного **XmlAttribute** рекурсивно импортируются, а результирующие узлы создаются заново и составляют соответствующее поддерево.|*Глубокой* параметр не применяется к **XmlAttribute** узлов, так как они всегда импортируются дочерние узлы вместе с ними.|  
|XmlCDataSection|Копирует узел вместе с данными.|Копирует узел вместе с данными.|  
|XmlComment|Копирует узел вместе с данными.|Копирует узел вместе с данными.|  
|XmlDocumentFragment|Потомки исходного узла рекурсивно импортируются, а результирующие узлы создаются заново и составляют соответствующее поддерево.|Пустой **XmlDocumentFragment** создается.|  
|XmlDocumentType|Копирует узел вместе с данными.*|Копирует узел вместе с данными.*|  
|XmlElement|Потомки исходного элемента рекурсивно импортируются, а результирующие узлы создаются заново и составляют соответствующее поддерево. **Примечание:** атрибуты по умолчанию не копируются. Если документ, в который выполняется импорт, определяет атрибуты по умолчанию для данного имени элемента, они назначаются.|Указанный атрибут узлы исходного элемента импортируются, а сформированные **XmlAttribute** узлы присоединяются к новому элементу. Узлы-потомки не копируются. **Примечание:** атрибуты по умолчанию не копируются. Если документ, в который выполняется импорт, определяет атрибуты по умолчанию для данного имени элемента, они назначаются.|  
|XmlEntityReference|Так как исходный и конечный документы могут иметь по-разному определенные сущности, этот метод копирует только **XmlEntityReference** узла. Текст замены не включается. Если в документе назначения определена сущность, ей назначается значение.|Так как исходный и конечный документы могут иметь по-разному определенные сущности, этот метод копирует только **XmlEntityReference** узла. Текст замены не включается. Если в документе назначения определена сущность, ей назначается значение.|  
|XmlProcessingInstruction|Копирует цель и значение данных из импортируемого узла.|Копирует цель и значение данных из импортируемого узла.|  
|XmlText|Копирует узел вместе с данными.|Копирует узел вместе с данными.|  
|XmlSignificantWhitespace|Копирует узел вместе с данными.|Копирует узел вместе с данными.|  
|XmlWhitespace|Копирует узел вместе с данными.|Копирует узел вместе с данными.|  
|XmlDeclaration|Копирует цель и значение данных из импортируемого узла.|Копирует цель и значение данных из импортируемого узла.|  
|Все остальные типы узлов|Эти типы узлов импортировать нельзя.|Эти типы узлов импортировать нельзя.|  
  
> [!NOTE]
>  Хотя узлы DocumentType можно импортировать, у документа может быть только один узел DocumentType. Поэтому после импорта типа документа, перед вставкой его в дерево, необходимо убедиться, что в документе нет типа документа. Сведения об удалении узлов см. в разделе [удаление узлов, содержимого и значений из XML-документа](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).  
  
## <a name="see-also"></a>См. также  
 [Модель объектов XML-документов (DOM)](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
