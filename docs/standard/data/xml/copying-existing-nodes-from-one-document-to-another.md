---
title: Копирование существующих узлов из одного документа в другой
ms.custom: ''
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: ''
ms.suite: ''
ms.technology: dotnet-standard
ms.tgt_pltfrm: ''
ms.topic: article
ms.assetid: 3caa78c1-3448-4b7b-b83c-228ee857635e
caps.latest.revision: ''
author: mairaw
ms.author: mairaw
manager: wpickett
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 958dccfc184857b0edd12cd1d9afe7b3b468b1e6
ms.sourcegitcommit: c883637b41ee028786edceece4fa872939d2e64c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/26/2018
---
# <a name="copying-existing-nodes-from-one-document-to-another"></a><span data-ttu-id="4b872-102">Копирование существующих узлов из одного документа в другой</span><span class="sxs-lookup"><span data-stu-id="4b872-102">Copying Existing Nodes from One Document to Another</span></span>
<span data-ttu-id="4b872-103">Метод **ImportNode** позволяет скопировать узел или целое поддерево узлов из одного документа **XmlDocument** в другой.</span><span class="sxs-lookup"><span data-stu-id="4b872-103">The **ImportNode** method is the mechanism by which a node or entire node subtree is copied from one **XmlDocument** to another.</span></span> <span data-ttu-id="4b872-104">Узел, возвращенный после вызова, является копией узла из исходного документа, включая значения атрибутов, имя узла, тип узла и все атрибуты, связанные с пространством имен, такие как префикс, локальное имя и URI пространства имен.</span><span class="sxs-lookup"><span data-stu-id="4b872-104">The node returned from the call is a copy of the node from the source document, including attribute values, the node name, node type, and all namespace-related attributes such as the prefix, local name, and namespace Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="4b872-105">Исходный документ не изменяется.</span><span class="sxs-lookup"><span data-stu-id="4b872-105">The source document is not changed.</span></span> <span data-ttu-id="4b872-106">После импорта узла его необходимо добавить к дереву с помощью одного из методов, используемых для вставки узлов.</span><span class="sxs-lookup"><span data-stu-id="4b872-106">After you have imported the node, you still have to add it to the tree using one of the methods used to insert nodes.</span></span>  
  
 <span data-ttu-id="4b872-107">При присоединении узла к новому документу, узел принадлежит этому документу.</span><span class="sxs-lookup"><span data-stu-id="4b872-107">When the node is attached to its new document, the new document owns the node.</span></span> <span data-ttu-id="4b872-108">Причина в том, что каждый узел при создании принадлежит какому-нибудь документу, даже если узлы создаются в разных фрагментах документа.</span><span class="sxs-lookup"><span data-stu-id="4b872-108">The reason is that each node, when created, has an owning document, even if the nodes are created in separate document fragments.</span></span> <span data-ttu-id="4b872-109">Это требование объектной модели DOM XML-документа, которое обусловлено структурой создания фабрики в классе **XmlDocument**.</span><span class="sxs-lookup"><span data-stu-id="4b872-109">This is a requirement of the XML Document Object Model (DOM) and is enforced by the factory creation design on the **XmlDocument** class.</span></span> <span data-ttu-id="4b872-110">Например, метод **CreateElement** является единственным способом создания новых узлов.</span><span class="sxs-lookup"><span data-stu-id="4b872-110">For example, **CreateElement**, is the only way to create new nodes.</span></span>  
  
 <span data-ttu-id="4b872-111">В зависимости от типа импортированного узла и значения параметра *deep*, дополнительные данные копируются по мере необходимости.</span><span class="sxs-lookup"><span data-stu-id="4b872-111">Depending on the node type of the imported node and the value of the *deep* parameter, additional information is copied as appropriate.</span></span> <span data-ttu-id="4b872-112">Этот метод пытается зеркально воспроизвести поведение, ожидаемое, если фрагмент исходного XML или HTML копируется из одного документа в другой, с учетом того факта, касающегося XML, что два документа могут иметь различные определения типа документа (DTD).</span><span class="sxs-lookup"><span data-stu-id="4b872-112">This method attempts to mirror the behavior expected if a fragment of XML or HTML source was copied from one document to another, accounting for the fact that for XML, the two documents may have different document type definitions (DTDs).</span></span>  
  
 <span data-ttu-id="4b872-113">В следующей таблице описаны особенности поведения каждого типа узла, который может быть импортирован.</span><span class="sxs-lookup"><span data-stu-id="4b872-113">The following table describes the specific behavior for each type of node that can be imported.</span></span>  
  
|<span data-ttu-id="4b872-114">Тип узла</span><span class="sxs-lookup"><span data-stu-id="4b872-114">Node Type</span></span>|<span data-ttu-id="4b872-115">Параметр *deep* имеет значение TRUE</span><span class="sxs-lookup"><span data-stu-id="4b872-115">*deep* parameter is true</span></span>|<span data-ttu-id="4b872-116">Параметр *deep* имеет значение FALSE</span><span class="sxs-lookup"><span data-stu-id="4b872-116">*deep* parameter is false</span></span>|  
|---------------|------------------------------|-------------------------------|  
|<span data-ttu-id="4b872-117">XmlAttribute</span><span class="sxs-lookup"><span data-stu-id="4b872-117">XmlAttribute</span></span>|<span data-ttu-id="4b872-118"><xref:System.Xml.XmlAttribute.Specified%2A> в XmlAttribute имеет значение **TRUE**.</span><span class="sxs-lookup"><span data-stu-id="4b872-118">The <xref:System.Xml.XmlAttribute.Specified%2A> is set to **true** on the XmlAttribute.</span></span> <span data-ttu-id="4b872-119">Потомки исходного узла **XmlAttribute** рекурсивно импортируются, а результирующие узлы собираются в поддерево.</span><span class="sxs-lookup"><span data-stu-id="4b872-119">The descendants of the source **XmlAttribute** are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="4b872-120">Параметр *deep* не применяется к узлам **XmlAttribute**, так как вместе с ними всегда импортируются дочерние узлы.</span><span class="sxs-lookup"><span data-stu-id="4b872-120">The *deep* parameter does not apply to **XmlAttribute** nodes, because they always carry their child nodes with them when imported.</span></span>|  
|<span data-ttu-id="4b872-121">XmlCDataSection</span><span class="sxs-lookup"><span data-stu-id="4b872-121">XmlCDataSection</span></span>|<span data-ttu-id="4b872-122">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-122">Copies the node, including its data.</span></span>|<span data-ttu-id="4b872-123">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-123">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="4b872-124">XmlComment</span><span class="sxs-lookup"><span data-stu-id="4b872-124">XmlComment</span></span>|<span data-ttu-id="4b872-125">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-125">Copies the node, including its data.</span></span>|<span data-ttu-id="4b872-126">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-126">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="4b872-127">XmlDocumentFragment</span><span class="sxs-lookup"><span data-stu-id="4b872-127">XmlDocumentFragment</span></span>|<span data-ttu-id="4b872-128">Потомки исходного узла рекурсивно импортируются, а результирующие узлы создаются заново и составляют соответствующее поддерево.</span><span class="sxs-lookup"><span data-stu-id="4b872-128">The descendants of the source node are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span>|<span data-ttu-id="4b872-129">Создается пустой узел **XmlDocumentFragment**.</span><span class="sxs-lookup"><span data-stu-id="4b872-129">An empty **XmlDocumentFragment** is created.</span></span>|  
|<span data-ttu-id="4b872-130">XmlDocumentType</span><span class="sxs-lookup"><span data-stu-id="4b872-130">XmlDocumentType</span></span>|<span data-ttu-id="4b872-131">Копирует узел вместе с данными.\*</span><span class="sxs-lookup"><span data-stu-id="4b872-131">Copies the node, including its data.\*</span></span>|<span data-ttu-id="4b872-132">Копирует узел вместе с данными.\*</span><span class="sxs-lookup"><span data-stu-id="4b872-132">Copies the node, including its data.\*</span></span>|  
|<span data-ttu-id="4b872-133">XmlElement</span><span class="sxs-lookup"><span data-stu-id="4b872-133">XmlElement</span></span>|<span data-ttu-id="4b872-134">Потомки исходного элемента рекурсивно импортируются, а результирующие узлы создаются заново и составляют соответствующее поддерево.</span><span class="sxs-lookup"><span data-stu-id="4b872-134">The descendants of the source element are recursively imported and the resulting nodes reassembled to form the corresponding subtree.</span></span> <span data-ttu-id="4b872-135">**Примечание.** Атрибуты по умолчанию не копируются.</span><span class="sxs-lookup"><span data-stu-id="4b872-135">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="4b872-136">Если документ, в который выполняется импорт, определяет атрибуты по умолчанию для данного имени элемента, они назначаются.</span><span class="sxs-lookup"><span data-stu-id="4b872-136">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|<span data-ttu-id="4b872-137">Импортируются указанные атрибутивные узлы исходного элемента, а затем созданные узлы **XmlAttribute** присоединяются к новому элементу.</span><span class="sxs-lookup"><span data-stu-id="4b872-137">Specified attribute nodes of the source element are imported, and the generated **XmlAttribute** nodes are attached to the new element.</span></span> <span data-ttu-id="4b872-138">Узлы-потомки не копируются.</span><span class="sxs-lookup"><span data-stu-id="4b872-138">The descendant nodes are not copied.</span></span> <span data-ttu-id="4b872-139">**Примечание.** Атрибуты по умолчанию не копируются.</span><span class="sxs-lookup"><span data-stu-id="4b872-139">**Note:**  Default attributes are not copied.</span></span> <span data-ttu-id="4b872-140">Если документ, в который выполняется импорт, определяет атрибуты по умолчанию для данного имени элемента, они назначаются.</span><span class="sxs-lookup"><span data-stu-id="4b872-140">If the document being imported into defines default attributes for this element name, those are assigned.</span></span>|  
|<span data-ttu-id="4b872-141">XmlEntityReference</span><span class="sxs-lookup"><span data-stu-id="4b872-141">XmlEntityReference</span></span>|<span data-ttu-id="4b872-142">Так как в исходном и целевом документах сущности могут быть определены по-разному, этот метод копирует только узел **XmlEntityReference**.</span><span class="sxs-lookup"><span data-stu-id="4b872-142">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="4b872-143">Текст замены не включается.</span><span class="sxs-lookup"><span data-stu-id="4b872-143">The replacement text is not included.</span></span> <span data-ttu-id="4b872-144">Если в документе назначения определена сущность, ей назначается значение.</span><span class="sxs-lookup"><span data-stu-id="4b872-144">If the destination document has the entity defined, its value is assigned.</span></span>|<span data-ttu-id="4b872-145">Так как в исходном и целевом документах сущности могут быть определены по-разному, этот метод копирует только узел **XmlEntityReference**.</span><span class="sxs-lookup"><span data-stu-id="4b872-145">Because the source and destination documents could have the entities defined differently, this method only copies the **XmlEntityReference** node.</span></span> <span data-ttu-id="4b872-146">Текст замены не включается.</span><span class="sxs-lookup"><span data-stu-id="4b872-146">The replacement text is not included.</span></span> <span data-ttu-id="4b872-147">Если в документе назначения определена сущность, ей назначается значение.</span><span class="sxs-lookup"><span data-stu-id="4b872-147">If the destination document has the entity defined, its value is assigned.</span></span>|  
|<span data-ttu-id="4b872-148">XmlProcessingInstruction</span><span class="sxs-lookup"><span data-stu-id="4b872-148">XmlProcessingInstruction</span></span>|<span data-ttu-id="4b872-149">Копирует цель и значение данных из импортируемого узла.</span><span class="sxs-lookup"><span data-stu-id="4b872-149">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="4b872-150">Копирует цель и значение данных из импортируемого узла.</span><span class="sxs-lookup"><span data-stu-id="4b872-150">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="4b872-151">XmlText</span><span class="sxs-lookup"><span data-stu-id="4b872-151">XmlText</span></span>|<span data-ttu-id="4b872-152">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-152">Copies the node, including its data.</span></span>|<span data-ttu-id="4b872-153">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-153">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="4b872-154">XmlSignificantWhitespace</span><span class="sxs-lookup"><span data-stu-id="4b872-154">XmlSignificantWhitespace</span></span>|<span data-ttu-id="4b872-155">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-155">Copies the node, including its data.</span></span>|<span data-ttu-id="4b872-156">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-156">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="4b872-157">XmlWhitespace</span><span class="sxs-lookup"><span data-stu-id="4b872-157">XmlWhitespace</span></span>|<span data-ttu-id="4b872-158">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-158">Copies the node, including its data.</span></span>|<span data-ttu-id="4b872-159">Копирует узел вместе с данными.</span><span class="sxs-lookup"><span data-stu-id="4b872-159">Copies the node, including its data.</span></span>|  
|<span data-ttu-id="4b872-160">XmlDeclaration</span><span class="sxs-lookup"><span data-stu-id="4b872-160">XmlDeclaration</span></span>|<span data-ttu-id="4b872-161">Копирует цель и значение данных из импортируемого узла.</span><span class="sxs-lookup"><span data-stu-id="4b872-161">Copies the target and data value from the imported node.</span></span>|<span data-ttu-id="4b872-162">Копирует цель и значение данных из импортируемого узла.</span><span class="sxs-lookup"><span data-stu-id="4b872-162">Copies the target and data value from the imported node.</span></span>|  
|<span data-ttu-id="4b872-163">Все остальные типы узлов</span><span class="sxs-lookup"><span data-stu-id="4b872-163">All other node types</span></span>|<span data-ttu-id="4b872-164">Эти типы узлов импортировать нельзя.</span><span class="sxs-lookup"><span data-stu-id="4b872-164">These node types cannot be imported.</span></span>|<span data-ttu-id="4b872-165">Эти типы узлов импортировать нельзя.</span><span class="sxs-lookup"><span data-stu-id="4b872-165">These node types cannot be imported.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="4b872-166">Хотя узлы DocumentType можно импортировать, у документа может быть только один узел DocumentType.</span><span class="sxs-lookup"><span data-stu-id="4b872-166">Although DocumentType nodes can be imported, a document can only have one DocumentType.</span></span> <span data-ttu-id="4b872-167">Поэтому после импорта типа документа, перед вставкой его в дерево, необходимо убедиться, что в документе нет типа документа.</span><span class="sxs-lookup"><span data-stu-id="4b872-167">So, once you have imported the document type, before inserting it into tree you have to make sure that there is no document type in the document.</span></span> <span data-ttu-id="4b872-168">Дополнительные сведения об удалении узлов см. в статье [Удаление узлов, содержимого и значений из XML-документа](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span><span class="sxs-lookup"><span data-stu-id="4b872-168">For information on removing nodes, see [Removing Nodes, Content, and Values from an XML Document](../../../../docs/standard/data/xml/removing-nodes-content-and-values-from-an-xml-document.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4b872-169">См. также</span><span class="sxs-lookup"><span data-stu-id="4b872-169">See Also</span></span>  
 [<span data-ttu-id="4b872-170">Модель объектов документов XML (DOM)</span><span class="sxs-lookup"><span data-stu-id="4b872-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
