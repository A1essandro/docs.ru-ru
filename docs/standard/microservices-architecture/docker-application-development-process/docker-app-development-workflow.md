---
title: "Рабочий процесс разработки для приложений Docker"
description: "Архитектура Микрослужбами .NET для приложений .NET в контейнерах | Рабочий процесс разработки для приложений Docker"
keywords: "Docker, микрослужбы, ASP.NET, контейнер"
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 5a53aee4261a5a0bfc25b3520c50cf505b84f287
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/21/2017
---
# <a name="development-workflow-for-docker-apps"></a>Рабочий процесс разработки для приложений Docker

Жизненный цикл разработки приложений начинается каждому разработчику компьютера, где разработчик коды приложения, использующего язык и проверяет его локально. Независимо от того, какой язык, framework и платформы, разработчик выбирает в этом рабочем процессе разработчик всегда разработка и тестирование контейнеры Docker, но это локально.

Каждый контейнер (экземпляр образа Docker) включает следующие компоненты:

-   Выбор операционной системы (например, ОС Linux, Nano Windows Server или Windows Server Core).

-   Файлы, добавленные разработчиком (двоичные файлы приложения, и т. д.).

-   Сведения о конфигурации (переменные окружения и зависимости).

## <a name="workflow-for-developing-docker-container-based-applications"></a>Рабочий процесс для разработки приложений контейнера Docker

В этом разделе описываются *внутренний цикл* рабочего процесса разработки для приложений на базе контейнер Docker. Внутренний цикл рабочего процесса означает его не принимая во внимание более широкой DevOps рабочего процесса и просто фокусируется на работу разработки на компьютере разработчика. Начальные этапы настройки среды, не включаются, так как те, выполняются только один раз.

Приложение состоит из службы и дополнительные библиотеки (зависимостей). Ниже приведены основные шаги, которые обычно предпринять при построении приложения Docker, как показано на рисунке 5-1.

![](./media/image1.png)

**Рис. 5-1.** Пошаговые рабочего процесса для разработки приложений помещать в контейнеры Docker

В этом руководстве подробно описан процесс целиком и каждый важный шаг описан сосредоточиться на среде Visual Studio.

При использовании подхода разработки редактора или CLI (например, Visual Studio Code плюс Docker CLI на macOS или Windows), необходимо знать все шаги, как правило, более подробно, чем при использовании Visual Studio. Дополнительные сведения о работе в среде CLI см. электронную [жизненного цикла помещать в контейнеры Docker приложения с платформы Майкрософт и средств](http://aka.ms/dockerlifecycleebook/).

При использовании Visual Studio 2015 или Visual Studio 2017 г., многие из этих действий обрабатываются для вас, что значительно повышает производительность. Это особенно важно в тех случаях, когда используется Visual Studio 2017 г. и предназначенных для нескольких контейнера приложений. Для экземпляра только одним щелчком мыши, Visual Studio добавляет файл Dockerfile и docker compose.yml в проекты с конфигурацией для вашего приложения. При запуске приложения в Visual Studio сборке образа Docker и выполнении приложения-контейнера несколькими непосредственно в Docker; даже позволяет отлаживать сразу несколько контейнеров. Эти функции будут значительно повысить скорость разработки.

Однако только потому, что Visual Studio автоматизирует эти действия не означает не нужно знать, что по ним с помощью Docker. Таким образом в указанных рекомендаций мы подробно описывается каждый этап.

![](./media/image2.png)

## <a name="step-1-start-coding-and-create-your-initial-application-or-service-baseline"></a>Шаг 1. Начать создание кода и создания начального приложения или базовой службы

Разработка приложения Docker аналогично тому, как разрабатывать приложение без Docker. Разница заключается в том, что при разработке для Docker, развертывании и тестировании приложения или службы, работающие в контейнеры Docker в локальной среде. Контейнер может быть контейнер Linux или контейнера Windows.

### <a name="set-up-your-local-environment-with-visual-studio"></a>Настройка локальной среды с помощью Visual Studio

Чтобы начать, убедитесь, что у вас есть [Docker Community Edition (CE)](https://www.docker.com/community-edition) для Windows установлены, как описано в следующих инструкциях:

[Начало работы с Docker CE для Windows](https://docs.docker.com/docker-for-windows/)

Кроме того вам потребуется Visual Studio установлена 2017 г. Этот метод является предпочтительным по Visual Studio 2015 с набором средств Visual Studio для Docker надстройки, поскольку 2017 г. Visual Studio реализованы дополнительные поддержка Docker, такие как поддержка отладки контейнеров. Visual Studio 2017 г. включает инструментарий для Docker, если вы выбрали **.NET Core и Docker** рабочей нагрузки во время установки, как показано на рисунке 5-2.

![](./media/image3.png)

**Рис. 5-2**. При выборе **.NET Core и Docker** рабочей нагрузки во время установки Visual Studio 2017 г.

Прежде чем Docker приложения и развертывания и тестирования в Docker, можно начать кодирование приложения в обычный .NET (обычно в .NET Core, если вы планируете использовать контейнеры). Тем не менее рекомендуется начать работу над Docker как можно быстрее, поскольку, которые будут реальной среды и любые проблемы, можно выполнить обнаружение как можно быстрее. Это действие рекомендуется, поскольку Visual Studio делает так же просто, для работы с Docker, что почти, что прозрачный — примера при отладке приложения с несколькими контейнера из Visual Studio.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Начало работы с Docker CE для Windows**
    [*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)

-   **Visual Studio 2017 г**
    [*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)

![](./media/image4.png)

## <a name="step-2-create-a-dockerfile-related-to-an-existing-net-base-image"></a>Шаг 2. Создайте файл Dockerfile, связанные с существующие базовый образ .NET

Требуется файл Dockerfile для каждого настраиваемого образа, необходимо создать; необходимо также Dockerfile для каждого контейнера для развертывания, будет ли автоматически развертывать в Visual Studio или вручную с помощью Docker CLI (запуска docker и docker — составить команды). Если приложение содержит одну пользовательскую службу, необходимо один Dockerfile. Если приложение содержит несколько служб (как для архитектуры микрослужбами), необходимо один Dockerfile для каждой службы.

Dockerfile помещается в корневой папке приложения или службы. Он содержит команды, которые сообщить способ установки и запуска приложения или службы в контейнер Docker. Можно вручную создать файл Dockerfile в коде и добавить его в проект вместе с зависимостями .NET.

В Visual Studio и средствами для Docker эта задача требует нескольких щелчков мыши. При создании нового проекта в Visual Studio 2017 г имеется параметр с именем **поддержки включить контейнеров (Docker)**, как показано на рисунке 5-3.

![](./media/image5.png)

**Рис**. Включение поддержки Docker при создании нового проекта в Visual Studio 2017 г.

Можно также включить поддержку Docker на новый или существующий проект, щелкнув правой кнопкой мыши файл проекта в Visual Studio и выбрав параметр **Docker добавить проект поддерживает**, как показано на рисунке 5-4.

![](./media/image6.png)

**Рис. 5-4**. Включение поддержки Docker в существующем проекте Visual Studio 2017 г.

Это действие для проекта (например, веб-приложения ASP.NET или службы веб-API) добавляет в проект с необходимой конфигурацией файла Dockerfile. Он также добавляет в файл docker compose.yml для всего решения. В следующих разделах описаны сведения, хранящиеся в каждом из этих файлов. Visual Studio создаст для вас эту работу, однако полезно понимать, что необходимо включить в файл Dockerfile.

### <a name="option-a-creating-a-project-using-an-existing-official-net-docker-image"></a>Вариант а создание проекта с помощью существующего образа официальный .NET Docker

Обычно построения пользовательского образа для контейнера на основе базового образа, можно получить из официальный репозиторий, в [Docker Hub](https://hub.docker.com/) реестра. Это точно что происходит на самом деле, если включена поддержка Docker в Visual Studio. Dockerfile будет использовать существующий образ aspnetcore.

Ранее было показано, какие образы Docker и репозиториев, можно использовать, в зависимости от framework и операционной системы, которые вы выбрали. Например, если вы хотите использовать ASP.NET Core (Windows или Linux), изображение, используемое — microsoft / aspnetcore:2.0. Таким образом необходимо просто указать, какой базовый образ Docker, который будет использоваться для контейнера. Для этого добавьте корпорации Майкрософт или aspnetcore:2.0 для Dockerfile. Это будет автоматически выполнена с помощью Visual Studio, но в случае обновления версии обновления это значение.

Использование официальный репозиторий образов .NET из Docker Hub с номером версии гарантирует, что на всех компьютерах (включая разработку, тестирование и производственной) доступны те же возможности языка.

Приведенный ниже образец Dockerfile для контейнеров ASP.NET Core.

```
FROM microsoft/aspnetcore:2.0
  
ARG source
  
WORKDIR /app
  
EXPOSE 80
  
COPY ${source:-obj/Docker/publish} .
  
ENTRYPOINT ["dotnet", " MySingleContainerWebApp.dll "]
```

В этом случае контейнера основан на версии 2.0 официальный образа ASP.NET Core Docker (несколькими arch для Linux и Windows). Это параметр `FROM microsoft/aspnetcore:2.0`. (Дополнительные сведения об этом базового образа в разделе [образа Docker ASP.NET Core](https://hub.docker.com/r/microsoft/aspnetcore/) страницы и [образа Docker .NET Core](https://hub.docker.com/r/microsoft/dotnet/) страницы.) В файле Dockerfile необходимо также указать Docker для прослушивания TCP-порт, который будет использоваться во время выполнения (в данном случае порт 80, настроенной с помощью параметра ПРЕДОСТАВЛЯЮТ).

Можно указать дополнительные параметры конфигурации в файл Dockerfile, в зависимости от языка и framework, которую вы используете. Для экземпляра строки ENTRYPOINT с \[«dotnet», «MySingleContainerWebApp.dll»\] сообщает Docker для запуска приложения .NET Core. При использовании пакета SDK и .NET Core CLI (dotnet CLI) для построения и запуска приложения .NET, этот параметр будет отличаться. Заключается в том, ENTRYPOINT строки и другие параметры будут отличаться в зависимости от языка и платформы, которая выбирается для приложения.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Создание образов Docker для приложений .NET Core**
    [*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)

-   **Создать собственный образ**. В официальной документации Docker.
    [*https://docs.docker.com/Engine/tutorials/dockerimages/*](https://docs.docker.com/engine/tutorials/dockerimages/)

### <a name="using-multi-arch-image-repositories"></a>Использование нескольких arch изображения репозитории

Один репозиторий может содержать вариантов платформы, например в Linux образ и образ Windows. Эта функция позволяет поставщиков, таких как Microsoft (базовый образ создатели) для создания одного репозитория для охвата нескольких платформ (то есть, Windows и Linux). Например [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) репозитория в реестр Docker Hub обеспечивает поддержку для Linux и Windows Nano Server с тем же именем репозитория.

Если задать метку, использующих платформу, которая является явным образом в следующих случаях:

-   **Microsoft/aspnetcore:2.0.0-jessie**

        .NET Core 2.0 runtime-only on Linux 

-   **Microsoft/aspnetcore:2.0.0-nanoserver**

        .NET Core 2.0 runtime-only on Windows Nano Server

Однако и это новые, так как функция mid 2017 г при указании изображения с одинаковым именем, даже такой же тег, новые несколькими arch изображения (например, изображение aspnetcore, поддерживающего несколькими arch) будут использовать версию Windows или Linux в зависимости от узла Docker ОС выполняется развертывание , как показано в следующем примере:

-   **Microsoft и aspnetcore:2.0**

        Multi-arch: .NET Core 2.0 runtime-only on Linux or Windows Nano Server depending on the Docker host OS

Таким образом, когда опрос изображения с сервера Windows, он будет получать Windows variant и извлечение тем же именем образа из узла Linux будет получать Linux variant.

### <a name="option-b-creating-your-base-image-from-scratch"></a>Вариант б. Создание основной образ с нуля

Собственный базовый образ Docker можно создать с нуля. Этот сценарий не рекомендуется для тех, кто начиная с помощью Docker, но если вы хотите задать определенные биты базового образа, это можно сделать.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Образы несколькими arch .NET Core**.
https://github.com/DotNet/Announcements/issues/14 
-   **Создание базового образа**. Официальной документации Docker.
    [*https://docs.docker.com/Engine/userguide/eng-Image/baseimages/*](https://docs.docker.com/engine/userguide/eng-image/baseimages/)

![](./media/image7.png)

## <a name="step-3-create-your-custom-docker-images-and-embed-your-application-or-service-in-them"></a>Шаг 3. Создание пользовательских образов Docker и внедрить их в приложение или службу

Для каждой службы в приложении необходимо создать связанные изображения. Если приложение состоит из одной службы или веб-приложения, необходимо просто одного изображения.

Обратите внимание, что образы Docker создаются автоматически для вас в Visual Studio. Следующие шаги только для редактора/CLI рабочего процесса и рассматривается для ясности сведения о том, что происходит под.

Разработчику необходимо разрабатывать и тестировать локально, пока не будет принудительно завершенного компонентов или изменения в системе управления версиями (например, для GitHub). Это означает необходимость создания образов Docker и развернуть контейнеры на локальном узле Docker (Windows или виртуальной Машине Linux) и запуска, тестирования и отладки от этих локальных контейнеров.

Чтобы создать пользовательский образ в локальной среде с помощью Docker CLI и Dockerfile, можно использовать команду сборки docker, как показано на рисунке 5-5.

![](./media/image8.png)

**Рис**. Создание пользовательского образа Docker

При необходимости вместо непосредственного использования сборки docker из папки проекта, можно сначала создать папки развертывания с необходимые библиотеки .NET и двоичные файлы, запустив dotnet публикации, а затем использовать команду сборки docker.

Образ Docker, будет создано с именем cesardl и netcore-webapi микрослужбу-docker: первый. В этом случае: первого — тег, представляющий конкретную версию. Этот шаг можно повторить для каждого настраиваемого образа, необходимо создать приложение Docker состоит.

Когда приложение состоит из нескольких контейнеров (то есть, это приложение несколькими контейнера), можно также использовать docker создания копии — команда сборки для создания связанных изображений с помощью одной команды с помощью метаданных, представленным в связанном файлы docker compose.yml.

Можно найти существующие образы в ваш локальный репозиторий с помощью docker команда изображений, как показано на рисунке 5-6.

![](./media/image9.png)

**Рис. 5-6.** Просмотр существующих образов с помощью команды docker изображений

### <a name="creating-docker-images-with-visual-studio"></a>Создание образов Docker с помощью Visual Studio

При использовании Visual Studio для создания проекта с поддержкой Docker вы не создан явно изображения. Вместо этого образ создается автоматически при нажатии F5 и выполнения dockerized приложения или службы. Этот шаг выполняется автоматически в Visual Studio и недоступен для этого действия, но важно знать, что происходит по ним.

![](./media/image10.png)

## <a name="step-4-define-your-services-in-docker-composeyml-when-building-a-multi-container-docker-application"></a>Шаг 4. Определение службы в docker compose.yml при построении приложения несколькими контейнера Docker

[Docker compose.yml](https://docs.docker.com/compose/compose-file/) файла позволяет определить набор связанных служб для развертывания в виде составных приложений с помощью команды развертывания.

Чтобы использовать файл docker compose.yml, необходимо создать файл в ваш основной или корневой папке решения, с содержимым, аналогичного тому, который, в следующем примере:

```yml
version: '3'
  
services:

  webmvc:
    image: eshop/web
    environment:
      - CatalogUrl=http://catalog.api
      - OrderingUrl=http://ordering.api
    ports:
      - "80:80"
    depends_on:
      - catalog.api
      - ordering.api

  catalog.api:
    image: eshop/catalog.api
    environment: 
      - ConnectionString=Server=sql.data;Database=CatalogDB;…
    ports:
      - "81:80"
    depends_on:
      - sql.data

  ordering.api:
    image: eshop/ordering.api
    environment:
      - ConnectionString=Server=sql.data;Database=OrderingDb;…
    ports:
      - "82:80"
    extra_hosts:
      - "CESARDLBOOKVHD:10.0.75.1"
    depends_on:
      - sql.data

  sql.data:
    image: mssql-server-linux:latest
    environment:
      - SA_PASSWORD=Pass@word
      - ACCEPT_EULA=Y
    ports:
      - "5433:1433"

```

Обратите внимание, что этот файл docker compose.yml упрощенной и объединенной версии. Он содержит данные статической конфигурации для каждого контейнера (например, имя пользовательского образа), который всегда применяется, а также сведения о конфигурации, могут зависеть от среды развертывания, такие как строка подключения. В следующих разделах вы узнаете, как можно разделить конфигурации docker compose.yml на несколько docker соединить файлы и переопределение значений в зависимости от типа среды и выполнение (Отладка или выпуск).

Пример файла docker compose.yml определяет пять служб: webmvc службы (веб-приложения), два микрослужбами (catalog.api и ordering.api) и один источник контейнера данных, sql.data, основанных на SQL Server для ОС Linux работает как контейнер. Каждая служба развертывается как контейнер, поэтому образа Docker не требуется для каждого.

Файл docker compose.yml указывает не только используются какие контейнеры, но их по отдельности настройки. Например webmvc контейнера определению в файле .yml:

-   Использует предварительно построенного eshop-web: последнюю версию образа. Тем не менее, можно также настроить изображения, создаваемой как часть создания docker на основе выполнения с помощью дополнительной настройки со сборкой: раздела в файле docker-compose.

-   Инициализирует две переменные среды (URL-адрес каталога и OrderingUrl).

-   Пересылает предоставленный порт 80 в контейнере для внешнего порта 80 на хост-компьютере.

-   Ссылки на каталог и порядок обновления с веб-приложения зависит от\_на параметр. В результате служба ожидает запуска этих служб.

Мы вернемся файл docker compose.yml в одном из следующих разделов при будет рассматриваться как реализовать микрослужбами и несколькими контейнера приложений.

### <a name="working-with-docker-composeyml-in-visual-studio-2017"></a>Работа с docker compose.yml в Visual Studio 2017 г.

После добавления поддержки решения Docker в проект службы в решении Visual Studio, как показано на рисунке 5 – 7, Visual Studio добавляет в проект файл Dockerfile, а также добавляет раздел "службы" (проект) в решении с файлами docker compose.yml. Это простой способ создания решения несколько контейнеров. Затем можно открыть файлы docker compose.yml и обновлять их с дополнительными возможностями.

![](./media/image6.png)

**Рис**. Добавление поддержки Docker в Visual Studio 2017 г., щелкнув правой кнопкой мыши проект ASP.NET Core

Добавление поддержки Docker в Visual Studio не только добавляет в проект файл Dockerfile, но добавляет сведения о конфигурации для нескольких файлов глобального docker-compose.yml, заданные на уровне решения.

После добавления поддержки Docker в решение в Visual Studio, также появится новый узел (в файле проекта docker compose.dcproj) в обозревателе решений с файлами добавлены docker-compose.yml, как показано на рисунке 5-8.

![](./media/image11.PNG)

**Рис**. **Docker составления** узел дерева, добавленные в обозревателе решений Visual Studio 2017 г.

Можно развернуть приложение несколькими контейнера с помощью одного docker-compose.yml файла с помощью docker создания копии команды. Однако Visual Studio добавляет группу из них, можно изменить значения в зависимости от среды (разработки и производственной), при этом тип (выпуска и отладки). Эта возможность описывается в следующих разделах.

![](./media/image12.png)

## <a name="step-5-build-and-run-your-docker-application"></a>Шаг 5. Постройте и запустите приложение Docker

Если приложение имеет только один контейнер, его можно выполнить, развертывания на узле Docker (физический сервер или ВМ). Тем не менее, если приложение содержит несколько служб, можно развернуть его как состоит приложение, либо с помощью одной команды CLI (docker составить вверх), и с помощью Visual Studio с использованием этой команды на самом деле. Давайте рассмотрим различные варианты.

### <a name="option-a-running-a-single-container-with-docker-cli"></a>Вариант а, выполнив один контейнер Docker CLI

Можно запустить контейнер Docker с помощью docker, выполните команду, как показано на рисунке 5 – 9.

```
  docker run -t -d -p 80:5000 cesardl/netcore-webapi-microservice-docker:first
```

![](./media/image13.png)

**Рис. 5-9**. Запуск контейнера Docker, с помощью docker, выполните команду

В этом случае команда привязывает внутренний порт 5000 контейнера с портом 80 хост-компьютера. Это означает, что узел прослушивает порт 80 и перенаправление в порт 5000 в контейнере.

### <a name="option-b-running-a-multi-container-application"></a>Вариант б. запуск приложения несколькими контейнера

В большинстве случаев корпоративного приложения Docker будет состоять из нескольких служб, это означает, что необходимо запустить приложение несколькими контейнера, как показано на рисунке 5 – 10.

![](./media/image14.png)

**На рисунке 5 – 10**. Виртуальная машина с развернуть контейнеры Docker

#### <a name="running-a-multi-container-application-with-the-docker-cli"></a>Запуск приложения несколькими контейнера с Docker CLI

Чтобы запустить приложение несколькими контейнера с Docker CLI, можно выполнить docker-составления копирование команды. Командный файл использует docker-compose.yml наличие на уровне решения для развертывания приложения несколькими контейнера. Рис. 5-11 показаны результаты при выполнении команды из каталога основного проекта, которая содержит файл docker compose.yml.

![](./media/image15.png)

**Рис. 5-11**. Пример результатов при работе docker создания копии команды

После docker-составления копирование выполняется команда, приложения и его связанные контейнеры развертываются в узла Docker, как показано в представлении виртуальных Машин на рисунке 5 — 10.

#### <a name="running-and-debugging-a-multi-container-application-with-visual-studio"></a>Запуск и отладка приложения несколькими контейнера с помощью Visual Studio 

Запуск приложения с несколькими контейнера, с помощью Visual Studio 2017 г. не удается получить проще. Не только приложение можно запустить несколькими контейнера, но существует возможность отладки все его контейнеры непосредственно из Visual Studio с помощью обычных точек останова.

Как упоминалось ранее, каждый раз при добавлении поддержки решения Docker проекта в решении, этот проект настраивается в файле глобального docker compose.yml (на уровне решения), который позволяет запустить или отладить все решение за один раз. Visual Studio запустите один контейнер для каждого проекта, с поддержкой Docker решения и выполнения всех шагов внутренняя вам (dotnet публикации, сборки docker и т. д.).

Здесь важно то, что, как показано на рисунке 5-12, в Visual Studio 2017 г имеется дополнительный **Docker** команду для действия ключа F5. Этот параметр позволяет запустить или отладить приложение несколькими контейнера, запустив все контейнеры, которые определены в файлах docker compose.yml на уровне решения. Возможность отладки нескольких контейнерными решениями означает, что можно установить несколько точек останова, каждой точки останова в другом проекте (контейнер) и во время отладки из Visual Studio вы будет останавливаться в точках останова, определенными в разных проектах и работает на разные контейнеры.

![](./media/image16.png)

**Рис. 5-12**. Запуск нескольких контейнера приложений в Visual Studio 2017 г.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Разверните контейнер ASP.NET к удаленному узлу Docker**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)

### <a name="a-note-about-testing-and-deploying-with-orchestrators"></a>Примечание о тестировании и развертывании с orchestrators

Docker составлять вверх и команды docker запуска (или запуске и отладке контейнеров в Visual Studio) не подходит для тестирования контейнеры в среде разработки. Однако не следует использовать этот подход, если вы используете Docker кластеры и orchestrators как помощью Docker Swarm Mesosphere DC/OS и Kubernetes. При использовании кластера как [режиме с помощью Docker Swarm](https://docs.docker.com/engine/swarm/) (доступно в CE Docker для Windows и Mac с версии 1.12), необходимо развернуть и протестировать дополнительные команды, такие как [создать службу docker](https://docs.docker.com/engine/reference/commandline/service_create/) для одной службы. При развертывании приложения, состоящие из нескольких контейнеров, используйте [docker создания пакета](https://docs.docker.com/compose/reference/bundle/) и [docker развертывание myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) развертывание приложения состоит как *стека*. Дополнительные сведения см. в записи блога [введение в экспериментальном наборы распределенных приложений](https://blog.docker.com/2016/06/docker-app-bundle/) в документации Docker. на узле Docker.

Для [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) и [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) развертывания команды и сценарии также используются.

![](./media/image17.png)

## <a name="step-6-test-your-docker-application-using-your-local-docker-host"></a>Шаг 6. Протестируйте приложение Docker с помощью локального узла Docker

Этот шаг будет зависеть от действия приложения. В простой .NET Core веб-приложение, развернутое в виде одного контейнера или службы доступа к службе, открыв браузер на узле Docker и перехода к этому сайту, как показано на рисунке 5-13. (Если контейнера конфигурации в файл Dockerfile сопоставляется портов на узле, отличной от 80, указывать узел после в URL-адрес).

![](./media/image18.png)

**На рисунке 5 — 13**. Пример тестирования приложения Docker локально с помощью localhost

Если localhost не указывает на Docker узлом IP (по умолчанию, при использовании Docker CE, оно должно быть), чтобы перейти к службе, используйте IP-адрес сетевой карты для вашего компьютера.

Обратите внимание, что этот URL-адрес в браузере использует порт 80 для конкретного контейнера примера обсуждаются. Тем не менее внутри запросов осуществляется перенаправление к port 5000, поскольку, как он был развернут с помощью docker, выполните команду, как описано в предыдущем шаге.

Также можно протестировать приложение, используя перелистывание из терминала, как показано на рисунке 5-14. В случае установки Docker в Windows по умолчанию IP-узле Docker всегда используется 10.0.75.1 помимо фактический IP-адрес вашего компьютера.

![](./media/image19.png)

**Рис**. Пример тестирования приложения Docker локально с помощью curl

### <a name="testing-and-debugging-containers-with-visual-studio-2017"></a>Тестирование и отладка контейнерами с помощью Visual Studio 2017 г.

При запуске и отладке контейнерами с помощью Visual Studio 2017 г., можно отлаживать приложения .NET в так же, как при выполнении без контейнеров.

### <a name="testing-and-debugging-without-visual-studio"></a>Тестирование и отладку без Visual Studio

При разработке с помощью редактора или CLI подход, отладка контейнеров является более сложной и необходимо будет выполнить отладку путем создания трассировки.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Отладка приложений в локальном контейнере Docker**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)

-   **Стив Ласкера. Создавать, отлаживать, развертывать приложения ASP.NET Core с помощью Docker.** Видео.
    [*https://Channel9.MSDN.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115)

## <a name="simplified-workflow-when-developing-containers-with-visual-studio"></a>Упрощенная рабочего процесса при разработке контейнерами с помощью Visual Studio

По сути рабочего процесса при использовании Visual Studio, гораздо проще, чем при использовании редактора/CLI подход. Основные шаги, необходимые для Docker, связанные с Dockerfile и docker compose.yml файлы скрытых или проще благодаря Visual Studio, как показано на рисунке 5-15.

![](./media/image20.png)

**Рис. 5-15**. Упрощенная рабочий процесс во время разработки в Visual Studio

Кроме того необходимо выполнить шаг 2 (Добавление поддержки Docker в проекты) только один раз. Таким образом рабочий процесс аналогичен задачам разработки обычные при использовании для других разработки приложений .NET. Необходимо знать, что происходит на самом деле (процесс создания образа, какие базовые образы, которые вы используете, развертывание контейнеры, т. д.) и в некоторых случаях том, что также необходимо изменить файл Dockerfile или docker compose.yml, чтобы настроить поведение. Однако с помощью Visual Studio, можно сделать гораздо эффективнее упрощено большую часть работы.

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **Стив Ласкера. Разработка .NET docker с помощью Visual Studio 2017 г**
    [*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)

-   **Фриц T. Джеффри. Поместите приложении .NET Core в контейнер Docker новые средства для Visual Studio**
    [*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)

## <a name="using-powershell-commands-in-a-dockerfile-to-set-up-windows-containers"></a>С помощью команды PowerShell в Dockerfile для настройки контейнеры Windows 

[Контейнеры Windows](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) позволяют преобразовать существующие приложения Windows в Docker images и развертывать их с помощью тех же средств, что и остальная часть экосистеме Docker. Чтобы использовать контейнеры Windows, выполните команды PowerShell в Dockerfile, как показано в следующем примере:

```
FROM microsoft/windowsservercore
  
LABEL Description="IIS" Vendor="Microsoft" Version="10"
  
RUN powershell -Command Add-WindowsFeature Web-Server
  
CMD [ "ping", "localhost", "-t" ]
```

В этом случае мы с помощью базового образа Windows Server Core (параметр FROM) и установка служб IIS с помощью команды PowerShell (параметр ВЫПОЛНЕНИЯ). Аналогичным образом может также использовать команды PowerShell, чтобы настроить дополнительные компоненты, например ASP.NET 4.x .NET 4.6 и другого программного обеспечения Windows. Например следующая команда в файл Dockerfile устанавливает ASP.NET 4.5:

```
RUN powershell add-windowsfeature web-asp-net45
```

### <a name="additional-resources"></a>Дополнительные ресурсы

-   **ASPNET-docker или Dockerfile.** Примеры команд Powershell для запуска из файлов dockerfile для включения компонентов Windows.
    [*https://github.com/Microsoft/ASPNET-docker/BLOB/master/4.6.2/Dockerfile*](https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile)

>[!div class="step-by-step"]
[Предыдущие] (index.md) [Далее] (.. / net-core-single-containers-linux-windows-server-hosts/index.md)
