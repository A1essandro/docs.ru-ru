---
title: Проектирование архитектуры приложений на основе контейнеров и микрослужб
description: Архитектура микрослужб .NET для упакованных в контейнеры приложений .NET | Проектирование архитектуры приложений на основе контейнеров и микрослужб
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.openlocfilehash: f7933cc25a5fde13113d0c9c278e9bd1730d4f9d
ms.sourcegitcommit: 700b9003ea6bdd83a53458bbc436c9b5778344f1
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2018
ms.locfileid: "48264154"
---
# <a name="architecting-container--and-microservice-based-applications"></a><span data-ttu-id="47c5b-103">Проектирование архитектуры приложений на основе контейнеров и микрослужб</span><span class="sxs-lookup"><span data-stu-id="47c5b-103">Architecting Container- and Microservice-Based Applications</span></span>

<span data-ttu-id="47c5b-104">*Микрослужбы дают большие преимущества, но в то же время создают новые проблемы. Шаблоны архитектуры микрослужб являются основополагающим элементом при создании приложения на основе микрослужб.*</span><span class="sxs-lookup"><span data-stu-id="47c5b-104">*Microservices offer great benefits but also raise huge new challenges. Microservice architecture patterns are fundamental pillars when creating a microservice-based application.*</span></span>

<span data-ttu-id="47c5b-105">Ранее в этом руководстве вы ознакомились с основными понятиями, связанными с контейнерами и Docker.</span><span class="sxs-lookup"><span data-stu-id="47c5b-105">Earlier in this guide, you learned basic concepts about containers and Docker.</span></span> <span data-ttu-id="47c5b-106">Это минимальная информация, необходимая для того, чтобы приступить к работе с контейнерами.</span><span class="sxs-lookup"><span data-stu-id="47c5b-106">That was the minimum information you need in order to get started with containers.</span></span> <span data-ttu-id="47c5b-107">Хотя контейнеры обеспечивают широкие возможности и отлично подходят для микрослужб, они не обязательны для архитектуры микрослужб. Многие архитектурные решения, описываемые в этом разделе, можно реализовать и без контейнеров.</span><span class="sxs-lookup"><span data-stu-id="47c5b-107">Although, even when containers are enablers and a great fit for microservices, they are not mandatory for a microservice architecture and many architectural concepts in this architecture section could be applied without containers, too.</span></span> <span data-ttu-id="47c5b-108">Но в данном руководстве основное внимание уделяется совместному использованию этих сущностей из-за уже упоминавшейся важности контейнеров.</span><span class="sxs-lookup"><span data-stu-id="47c5b-108">However, this guidance focuses on the intersection of both due to the already introduced importance of containers.</span></span>

<span data-ttu-id="47c5b-109">Корпоративные приложения могут быть сложными и часто состоят из нескольких служб, а не одной.</span><span class="sxs-lookup"><span data-stu-id="47c5b-109">Enterprise applications can be complex and are often composed of multiple services instead of a single service-based application.</span></span> <span data-ttu-id="47c5b-110">В таких случаях необходимо разбираться в дополнительных подходах к проектированию архитектуры, таких как использование микрослужб, а также определенных шаблонах проектирования на основе доменов и принципах оркестрации контейнеров.</span><span class="sxs-lookup"><span data-stu-id="47c5b-110">For those cases, you need to understand additional architectural approaches, such as the microservices and certain Domain-Driven Design (DDD) patterns plus container orchestration concepts.</span></span> <span data-ttu-id="47c5b-111">Имейте в виду, что в этой главе описываются не только микрослужбы в контейнерах, но и любые контейнерные приложения.</span><span class="sxs-lookup"><span data-stu-id="47c5b-111">Note that this chapter describes not just microservices on containers, but any containerized application, as well.</span></span>

## <a name="container-design-principles"></a><span data-ttu-id="47c5b-112">Принципы проектирования контейнеров</span><span class="sxs-lookup"><span data-stu-id="47c5b-112">Container design principles</span></span>

<span data-ttu-id="47c5b-113">В модели на основе контейнеров экземпляр образа контейнера представляет отдельный процесс.</span><span class="sxs-lookup"><span data-stu-id="47c5b-113">In the container model, a container image instance represents a single process.</span></span> <span data-ttu-id="47c5b-114">Определив образ контейнера как границу процесса, вы можете создавать примитивы, с помощью которых можно масштабировать процесс или помещать его в пакет.</span><span class="sxs-lookup"><span data-stu-id="47c5b-114">By defining a container image as a process boundary, you can create primitives that can be used to scale the process or to batch it.</span></span>

<span data-ttu-id="47c5b-115">Когда вы проектируете образ контейнера, в Dockerfile имеется определение [ENTRYPOINT](https://docs.docker.com/engine/reference/builder/).</span><span class="sxs-lookup"><span data-stu-id="47c5b-115">When you design a container image, you will see an [ENTRYPOINT](https://docs.docker.com/engine/reference/builder/) definition in the Dockerfile.</span></span> <span data-ttu-id="47c5b-116">С его помощью определяется процесс, время существования которого контролирует время существования контейнера.</span><span class="sxs-lookup"><span data-stu-id="47c5b-116">This defines the process whose lifetime controls the lifetime of the container.</span></span> <span data-ttu-id="47c5b-117">По завершении процесса время существования контейнера истекает.</span><span class="sxs-lookup"><span data-stu-id="47c5b-117">When the process completes, the container lifecycle ends.</span></span> <span data-ttu-id="47c5b-118">Контейнеры могут представлять как длительные процессы, например веб-серверы, так и кратковременные, например пакетные задания, которые ранее могли реализовываться как [веб-задания](https://docs.microsoft.com/azure/app-service-web/websites-webjobs-resources) Azure.</span><span class="sxs-lookup"><span data-stu-id="47c5b-118">Containers might represent long-running processes like web servers, but can also represent short-lived processes like batch jobs, which formerly might have been implemented as Azure [WebJobs](https://docs.microsoft.com/azure/app-service-web/websites-webjobs-resources).</span></span>

<span data-ttu-id="47c5b-119">В случае сбоя процесса работа контейнера завершается и оркестратор принимает управление.</span><span class="sxs-lookup"><span data-stu-id="47c5b-119">If the process fails, the container ends, and the orchestrator takes over.</span></span> <span data-ttu-id="47c5b-120">Если в оркестраторе настроена поддержка пяти выполняющихся экземпляров, то в случае сбоя одного из них оркестратор создаст ему на замену еще один экземпляр контейнера.</span><span class="sxs-lookup"><span data-stu-id="47c5b-120">If the orchestrator was configured to keep five instances running and one fails, the orchestrator will create another container instance to replace the failed process.</span></span> <span data-ttu-id="47c5b-121">В пакетном задании процесс запускается с параметрами.</span><span class="sxs-lookup"><span data-stu-id="47c5b-121">In a batch job, the process is started with parameters.</span></span> <span data-ttu-id="47c5b-122">По завершении выполнения процесса работа считается выполненной.</span><span class="sxs-lookup"><span data-stu-id="47c5b-122">When the process completes, the work is complete.</span></span> <span data-ttu-id="47c5b-123">В этом руководстве оркестраторы будут рассматриваться более подробно позже.</span><span class="sxs-lookup"><span data-stu-id="47c5b-123">This guidance drills-down on orchestrators, later on.</span></span>

<span data-ttu-id="47c5b-124">Возможны ситуации, когда в одном контейнере желательно выполнять несколько процессов.</span><span class="sxs-lookup"><span data-stu-id="47c5b-124">You might find a scenario where you want multiple processes running in a single container.</span></span> <span data-ttu-id="47c5b-125">Так как каждый контейнер может иметь только одну точку входа, в таком случае в контейнере можно использовать скрипт, который будет запускать нужное количество программ.</span><span class="sxs-lookup"><span data-stu-id="47c5b-125">For that scenario, since there can be only one entry point per container, you could run a script within the container that launches as many programs as needed.</span></span> <span data-ttu-id="47c5b-126">Например, можно использовать [Supervisor](http://supervisord.org/) или аналогичное средство, отвечающее за запуск нескольких процессов в одном контейнере.</span><span class="sxs-lookup"><span data-stu-id="47c5b-126">For example, you can use [Supervisor](http://supervisord.org/) or a similar tool to take care of launching multiple processes inside a single container.</span></span> <span data-ttu-id="47c5b-127">Однако несмотря на то, что архитектуры, предусматривающие несколько процессов в контейнере, встречаются, такой подход применяется нечасто.</span><span class="sxs-lookup"><span data-stu-id="47c5b-127">However, even though you can find architectures that hold multiple processes per container, that approach is not very common.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="47c5b-128">[Назад](../net-core-net-framework-containers/official-net-docker-images.md)
[Вперед](containerize-monolithic-applications.md)</span><span class="sxs-lookup"><span data-stu-id="47c5b-128">[Previous](../net-core-net-framework-containers/official-net-docker-images.md)
[Next](containerize-monolithic-applications.md)</span></span>
