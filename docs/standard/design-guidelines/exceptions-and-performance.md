---
title: Исключения и производительность
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- tester-doer pattern
- TryParse pattern
- exceptions, throwing
- exceptions, performance
- throwing exceptions, performance
ms.assetid: 3ad6aad9-08e6-4232-b336-0e301f2493e6
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: d664b7b61394bd9bfe6d0abd7130f9f0191e7a03
ms.sourcegitcommit: 64f4baed249341e5bf64d1385bf48e3f2e1a0211
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/07/2018
ms.locfileid: "44083550"
---
# <a name="exceptions-and-performance"></a>Исключения и производительность
Одна из распространенных проблем, связанных с исключениями том, что если они используются для кода, который регулярно завершается с ошибкой, реализация будет неприемлемо. Это обоснованное предположение. Если член создает исключение, ее производительность может быть порядков медленнее. Тем не менее можно добиться высокой производительности, предназначенных исключительно для исключения рекомендации, которые запрещено использовать коды ошибок. Два шаблона, описанные в этом разделе предлагают способы сделать это.  
  
 **X DO NOT** использование кодов ошибок из-за проблемы, что исключения могут негативно повлиять на производительность.  
  
 Чтобы повысить производительность, можно использовать шаблон Tester-Doer или шаблон Try-Parse, описанные в следующих двух разделах.  
  
## <a name="tester-doer-pattern"></a>Tester-Doer-шаблон  
 Иногда можно повысить производительности члена исключения, разбив элемента на две части. Давайте взглянем на <xref:System.Collections.Generic.ICollection%601.Add%2A> метод <xref:System.Collections.Generic.ICollection%601> интерфейс.  
  
```  
ICollection<int> numbers = ...   
numbers.Add(1);  
```  
  
 Метод `Add` вызывается, если коллекция доступна только для чтения. Это может быть проблемы с производительностью в сценариях, где должна завершиться ошибкой часто вызова метода. Одним из способов, чтобы устранить проблему — проверить, является ли коллекция для записи прежде чем пытаться добавить значение.  
  
```  
ICollection<int> numbers = ...   
...  
if(!numbers.IsReadOnly){  
    numbers.Add(1);  
}  
```  
  
 Элемент, используемый для проверки того, который в нашем примере — это свойство `IsReadOnly`, называется тест-инженер. Член, используемые для операции потенциально создает исключение, `Add` метод в нашем примере называется doer.  
  
 **✓ CONSIDER** шаблон Tester-Doer для членов, которые могут вызвать исключения общие сценарии, чтобы избежать проблем с производительностью связанных с исключениями.  
  
## <a name="try-parse-pattern"></a>Шаблон try-Parse  
 Для API-интерфейсов очень важна высокая производительность следует использовать шаблон еще быстрее, чем Tester-Doer-шаблон, описанный в предыдущем разделе. Для настройки имя члена для четко определенных проверки случае частью семантику член вызывает шаблон. Например <xref:System.DateTime> определяет <xref:System.DateTime.Parse%2A> метод, который создает исключение, если синтаксический анализ строки завершается ошибкой. Он также определяет соответствующий <xref:System.DateTime.TryParse%2A> метод, который пытается выполнить синтаксический анализ, но возвращает false, при анализе завершилась неудачно и возвращает результат успешного синтаксического анализа с помощью `out` параметра.  
  
```  
public struct DateTime {  
    public static DateTime Parse(string dateTime){   
        ...   
    }  
    public static bool TryParse(string dateTime, out DateTime result){  
        ...  
    }  
}  
```  
  
 При использовании этого шаблона, очень важно в строгом условия в определении функциональности try. При сбое члена по любой причине, кроме четко определенных try, элемент по-прежнему должны вызывать соответствующее исключение.  
  
 **✓ CONSIDER** синтаксического анализа Try шаблон для членов, которые могут вызвать исключения общие сценарии, чтобы избежать проблем с производительностью связанных с исключениями.  
  
 **✓ DO** использовать префикс «Try» и логический тип возвращаемого значения для методов реализации данного шаблона.  
  
 **✓ DO** предоставляют член исключения для каждого элемента, используя шаблон синтаксического анализа Try.  
  
 *Фрагменты: © Корпорация Майкрософт (Microsoft Corporation), 2005, 2009. Все права защищены.*  
  
 *Перепечатано с разрешения Pearson Education, Inc. из книги [Инфраструктура программных проектов. Соглашения, идиомы и шаблоны для многократно используемых библиотек .NET (2-е издание)](https://www.informit.com/store/framework-design-guidelines-conventions-idioms-and-9780321545619), авторы: Кржиштоф Цвалина (Krzysztof Cwalina) и Брэд Абрамс (Brad Abrams). Книга опубликована 22 октября 2008 г. издательством Addison-Wesley Professional в рамках серии, посвященной разработке для Microsoft Windows.*  
  
## <a name="see-also"></a>См. также

- [Рекомендации по проектированию на основе Framework](../../../docs/standard/design-guidelines/index.md)  
- [Правила разработки исключений](../../../docs/standard/design-guidelines/exceptions.md)
